/**
 * scayt v3.4.4600
 * Copyright (c) 2000-2022 WebSpellChecker LLC All rights reserved.
 */

/*!
 * jQuip JavaScript Library v0.0.3
 * https://github.com/mythz/jquip
 *
 * Copyright, Demis Bellot
 * Licensed under the MIT license.
 * http://www.opensource.org/licenses/mit-license.php
 *
 */

/*!
 * Rangy, a cross-browser JavaScript range and selection library
 * http://code.google.com/p/rangy/
 *
 * Copyright 2012, Tim Down
 * Licensed under the MIT license.
 * Version: 1.3alpha.681
 * Build date: 20 July 2012
 */

/*! @license
 * JS Signals <http://millermedeiros.github.com/js-signals/>
 * Released under the MIT license
 * Author: Miller Medeiros
 * Version: 0.8.1 - Build: 266 (2012/07/31 03:33 PM)
 */

/*!
* flag-icon-css
* https://github.com/lipis/flag-icon-css
*
* Copyright 2013 Panayiotis Lipiridis
* Licensed under the MIT license.
*/ 
function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _get=function a(b,c,d){null===b&&(b=Function.prototype);var e=Object.getOwnPropertyDescriptor(b,c);if(void 0===e){var f=Object.getPrototypeOf(b);return null===f?void 0:a(f,c,d)}if("value"in e)return e.value;var g=e.get;return void 0===g?void 0:g.call(d)},_createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};!function(window){!function(){var a,b,c={node:"node",browser:"browser"};"undefined"==typeof window?(b=global,a=c.node):(b=window,a=c.browser),b.WEBSPELLCHECKER=b.WEBSPELLCHECKER||{},b.WEBSPELLCHECKER.env=a,b.WEBSPELLCHECKER.envTypes=c,a===c.node&&(module.exports=b.WEBSPELLCHECKER)}(),function(){function a(a){"use strict";var b={arrayUnique:function(a,b){for(var c=a.concat(),b=b||function(a,b){return a===b},d=0;d<c.length;d++)for(var e=d+1;e<c.length;e++)b(c[d],c[e])&&c.splice(e--,1);return c},argumentsToArray:function(a){for(var b=a.length,c=new Array(b),d=0;b>d;d++)c[d]=a[d];return c},zipArraysToObject:function(a,b){for(var c={},d=0;d<a.length;d++)c[a[d]]=b[d];return c},diffArrays:function(a,b){for(var c=[],d=b.length,e=0;d>e;e++)this.indexOf(a,b[e])<0&&c.push(b[e]);return c}};a.Utils=a.Utils||{},a.Utils.ArrayUtils=b}"undefined"==typeof window&&(module.exports=a),"undefined"!=typeof WEBSPELLCHECKER&&a(WEBSPELLCHECKER)}(),function(){function a(a){"use strict";var b={splice:function(a,b,c,d){return a.substring(0,b)+d+a.substring(b+c)},replaceFromTo:function(a,b,c,d){return a.substring(0,b)+d+a.substring(c)}};a.Utils=a.Utils||{},a.Utils.StringUtils=b}"undefined"==typeof window&&(module.exports=a),"undefined"!=typeof WEBSPELLCHECKER&&a(WEBSPELLCHECKER)}(),function(){function a(a){"use strict";if(a.env===a.envTypes.browser){var b=function(){var a=navigator.userAgent.toLowerCase(),b=a.match(/edge[ \/](\d+.?\d*)/),c=a.indexOf("trident/")>-1,d=!(!b&&!c),e=window.opera,f={ie:d,edge:!!b,opera:!!e&&e.version,webkit:!d&&a.indexOf(" applewebkit/")>-1,air:a.indexOf(" adobeair/")>-1,mac:a.indexOf("macintosh")>-1,quirks:"BackCompat"==document.compatMode&&(!document.documentMode||document.documentMode<10),mobile:a.indexOf("mobile")>-1,iOS:/(ipad|iphone|ipod)/.test(a)};f.gecko="Gecko"==navigator.product&&!f.webkit&&!f.opera&&!f.ie,f.webkit&&(a.indexOf("chrome")>-1?f.chrome=!0:f.safari=!0);var g=0;if(f.ie&&(g=b?parseFloat(b[1]):f.quirks||!document.documentMode?parseFloat(a.match(/msie (\d+)/)[1]):document.documentMode),f.gecko){var h=a.match(/rv:([\d\.]+)/);h&&(h=h[1].split("."),g=1e4*h[0]+100*(h[1]||0)+1*(h[2]||0))}return f.air&&(g=parseFloat(a.match(/ adobeair\/(\d+)/)[1])),f.webkit&&(g=parseFloat(a.match(/ applewebkit\/(\d+)/)[1])),f.version=g,f}();a.Utils=a.Utils||{},a.Utils.Browser=b}}"undefined"==typeof window&&(module.exports=a),"undefined"!=typeof WEBSPELLCHECKER&&a(WEBSPELLCHECKER)}(),function(){"use strict";"function"!=typeof Object.assign&&(Object.assign=function(a){if(null==a)throw new TypeError("Cannot convert undefined or null to object");for(var b=Object(a),c=1;c<arguments.length;c++){var d=arguments[c];if(null!=d)for(var e in d)Object.prototype.hasOwnProperty.call(d,e)&&(b[e]=d[e])}return b}),"function"!=typeof Object.create&&(Object.create=function(){function a(){}var b=Object.prototype.hasOwnProperty;return function(c){if("object"!=("undefined"==typeof c?"undefined":_typeof(c)))throw TypeError("Object prototype may only be an Object or null");a.prototype=c;var d=new a;if(a.prototype=null,arguments.length>1){var e=Object(arguments[1]);for(var f in e)b.call(e,f)&&(d[f]=e[f])}return d}}()),Object.keys||(Object.keys=function(){var a=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable("toString"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=c.length;return function(e){if("function"!=typeof e&&("object"!==("undefined"==typeof e?"undefined":_typeof(e))||null===e))throw new TypeError("Object.keys called on non-object");var f,g,h=[];for(f in e)a.call(e,f)&&h.push(f);if(b)for(g=0;d>g;g++)a.call(e,c[g])&&h.push(c[g]);return h}}()),Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d&&a?this:a,b.concat(Array.prototype.slice.call(arguments)))};return d.prototype=this.prototype,e.prototype=new d,e}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){var c;if(null==this)throw new TypeError('"this" is null or not defined');var d=Object(this),e=d.length>>>0;if(0===e)return-1;var f=0|b;if(f>=e)return-1;for(c=Math.max(f>=0?f:e-Math.abs(f),0);e>c;){if(c in d&&d[c]===a)return c;c++}return-1}),Array.prototype.filter||(Array.prototype.filter=function(a){if(void 0===this||null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError;for(var d=[],e=arguments.length>=2?arguments[1]:void 0,f=0;c>f;f++)if(f in b){var g=b[f];a.call(e,g,f,b)&&d.push(g)}return d}),Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)}),Array.prototype.map||(Array.prototype.map=function(a){var b,c,d;if(null==this)throw new TypeError("this is null or not defined");var e=Object(this),f=e.length>>>0;if("function"!=typeof a)throw new TypeError(a+" is not a function");for(arguments.length>1&&(b=arguments[1]),c=new Array(f),d=0;f>d;){var g,h;d in e&&(g=e[d],h=a.call(b,g,d,e),c[d]=h),d++}return c}),String.prototype.includes||(String.prototype.includes=function(){return-1!==String.prototype.indexOf.apply(this,arguments)}),Array.prototype.reduce||(Array.prototype.reduce=function(a){if(null==this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof a)throw new TypeError(a+" is not a function");var b,c=Object(this),d=c.length>>>0,e=0;if(arguments.length>=2)b=arguments[1];else{for(;d>e&&!(e in c);)e++;if(e>=d)throw new TypeError("Reduce of empty array with no initial value");b=c[e++]}for(;d>e;e++)e in c&&(b=a(b,c[e],e,c));return b}),Array.prototype.forEach||(Array.prototype.forEach=function(a){var b,c;if(null==this)throw new TypeError("this is null or not defined");var d=Object(this),e=d.length>>>0;if("function"!=typeof a)throw new TypeError(a+" is not a function");for(arguments.length>1&&(b=arguments[1]),c=0;e>c;){var f;c in d&&(f=d[c],a.call(b,f,c,d)),c++}}),Array.prototype.includes||(Array.prototype.includes=function(a){var b=Object(this),c=parseInt(b.length)||0;if(0===c)return!1;var d,e=parseInt(arguments[1])||0;for(e>=0?d=e:(d=c+e,0>d&&(d=0));c>d;){var f=b[d];if(a===f||a!==a&&f!==f)return!0;d++}return!1})}(),function(){function a(a){var b={isString:function(a){return"string"==typeof a},notEmptyString:function(a){return""!==a&&b.isString(a)},isArray:function(a){return"[object Array]"==={}.toString.call(a)},isHash:function(a){return b.isObject(a)&&!b.isArray(a)&&!b.isFunction(a)},isBoolean:function(a){return"boolean"==typeof a},isObject:function(a){return a===Object(a)},isDate:function(a){return a instanceof Date},isDefined:function(a){return null!==a&&void 0!==a},isEmpty:function(a){var c;if(!b.isDefined(a))return!0;if(b.isFunction(a))return!1;if(b.isString(a))return b.EMPTY_STRING_REGEXP.test(a);if(b.isArray(a))return 0===a.length;if(b.isDate(a))return!1;if(b.isObject(a)){for(c in a)return!1;return!0}return!1},isFunction:function(a){return"function"==typeof a},isInteger:function(a){return b.isNumber(a)&&a%1===0},isNumber:function(a){return"number"==typeof a&&!isNaN(a)},isPositive:function(a){return"number"==typeof a&&a>=0}};a.Utils=a.Utils||{},a.Utils.TypeChecker=b}"undefined"==typeof window&&(module.exports=a),"undefined"!=typeof WEBSPELLCHECKER&&a(WEBSPELLCHECKER)}(),function(){function a(a){"use strict";var b={space:"[\\s\\xA0]",commonSpace:" ",quotes:"'\"",nonWhiteSpaceChar:"\\S",dot:"\\.",anyChar:".",comma:"\\,",EOL:"[\r\n(\r\n)]",digits:"[0-9]",HtmlSpaceSymbol:String.fromCharCode(160),textPunctuation:' ,"^$*+?=!:|\\/\\(\\)\\[\\]\\{\\}\\>\\<\\@\\%\\&\\#\\;\\_\\~\\u061F\\u060C\\u061B\\u0001-\\u001F\\u0080-\\u00B6\\u00B8-\\u00BF\\u2000-\\u200A\\u200C-\\u2018\\u201A-\\u266F\\u2E00-\\u2E7F',situationalSeparators:"\\.\\-\\'\\â€™",sentenceEndChars:"\\.!?",specialCharacters:String.fromCharCode(8203)+String.fromCharCode(65279),ip:"/^((?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?).){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))*$/",twoAndMore:"{2,}",whiteSpace:" \\f\\n\\r\\t\\v\\uFEFF\\u0085\\u00A0\\u1680\\u180E\\u2000-\\u200C\\u2028\\u2029\\u202F\\u205F\\u3000"};a.RegularsSources=b}"undefined"==typeof window&&(module.exports=a),"undefined"!=typeof WEBSPELLCHECKER&&a(WEBSPELLCHECKER)}(),function(){function a(a){"use strict";var b=["log","warn","info","debug"],c=a.Utils.browser;JSON.stringify=JSON.stringify||function(){return arguments};for(var d=0;d<b.length;d++)console[b[d]]=console[b[d]]||function(){};var e=!1,f={isON:function(a){a=a||!1,e=a?!0:/scaytDebug\b/.test(location.hash)},isIE:c?c.ie:!1,log:function(a){var b=a||{},c=void 0;e&&(c="object"===("undefined"==typeof b?"undefined":_typeof(b))?[b.name,":: "+b.msg,b.data]:[b],this.isIE?(c=[b.name,":: "+b.msg,JSON.stringify(b.data,null,"")],c=c.join(" "),console.log(c)):console.log.apply(console,c))},console:console};a.logger=f}"undefined"==typeof window&&(module.exports=a),"undefined"==typeof WEBSPELLCHECKER||"logger"in WEBSPELLCHECKER||a(WEBSPELLCHECKER)}(),function(){function a(a){var b=a.Utils,c=a.logger.console,d=!1,e=[],f={XMLHttpRequest:"undefined"!=typeof XMLHttpRequest?XMLHttpRequest:null,XDomainRequest:"undefined"!=typeof XDomainRequest?XDomainRequest:null,URL:function(a){a=a||{};var b=this.protocol=a.protocol||"http",c=this.host=a.host||"localhost",d=this.port=a.port||"80",e=this.path=a.path||"",f={},g={};this.addParameter=function(a,b){return a&&b&&(f[a]=b),this},this.addParameters=function(a){for(var b in a)this.addParameter(b,a[b]);return this},this.addMetaParameters=function(a){return Object.assign(g,a),this},this.getParameter=function(a){return f[a]},this.joinParams=function(a){var b="";if(a=a||f,Object.keys(a).length){for(var c in a)b+=c+"="+encodeURIComponent(a[c])+"&";return b.slice(0,-1)}return""},this.joinRequestParams=function(){return this.joinParams(f)},this.joinRequestMetaParams=function(){return this.joinParams(g)},this.joinUrl=function(){var a="";return a+=b+"://",a+=c,a+="80"==d?"/":":"+d+"/",a+=e.replace(/^\/*/,"")},this.joinUrlWithParams=function(a){var b=this.joinUrl();return b+=a?"?"+a:""},this.joinUrlWithMetadata=function(){return this.joinUrlWithParams(this.joinRequestMetaParams())},this.build=function(){return this.joinUrlWithParams(this.joinRequestParams())},this.clear=function(){return f={},g={},this}},AJAX:function(a){var g={},h=JSON.parse||function(){return arguments};if(d){for(var i=0;i<e.length;i++)!function(b){e[b].success&&setTimeout(function(){a.onSuccess(e[b].success)},0),e[b].error&&setTimeout(function(){a.onError(e[b].error)},0)}(i);return{finished:!0}}return g.params={url:a.url.joinUrlWithMetadata(),data:a.url.joinRequestParams(),onSuccess:a.onSuccess,onError:a.onError},g.request=new f.XMLHttpRequest,null!==f.XDomainRequest?g.request=new f.XDomainRequest:"withCredentials"in g.request?g.request.withCredentials=!1:c.warn("Cors is not supported by this browser!"),g.request.onload=function(){var a=g.request.responseText,b=g.request.status;g.success=!0;try{a=h(a)}catch(d){return c.warn("CORS response parsing error: "+d),void(g.params.onError&&g.params.onError())}return a=a||{},b&&200!==b||a.error?(a.message&&c.warn(a.message),void(g.params.onError&&g.params.onError(a))):void(g.params.onSuccess&&g.params.onSuccess(a))},g.request.onerror=function(){console.warn("The WebSpellChecker Service is currently unavailable."),g.error=!0,g.params.onError&&g.params.onError({})},g.request.onabort=function(){g.error=!0,g.params.onError&&g.params.onError({})},g.request.open("POST",g.params.url,!0),b.Browser.ie&&9===b.Browser.version?setTimeout(function(){g.request.send(g.params.data)},500):g.request.send(g.params.data),g},JSONP:function(a){var b="callback"+Math.random().toString(20).substr(2,9),c="WEBSPELLCHECKER.IO.";if(d){for(var g=0;g<e.length;g++)e[g].success&&a.onSuccess(e[g].success),e[g].error&&a.onError(e[g].error);return b}return a.url.addParameter("callback",c+b),new f.Script({url:a.url.build(),id:b,callbackName:b,onSuccess:a.onSuccess,onError:a.onError})},NODE:function(a){var b,d=a.url,e=d.joinRequestMetaParams(),f=require("http"===d.protocol?"http":"https"),g={protocol:d.protocol+":",port:d.port,hostname:d.host,path:"/"+d.path+(e?"?"+e:""),method:"POST",headers:{"Content-Type":"text/javascript; charset=UTF-8"}};return b=f.request(g,function(b){(b.statusCode<200||b.statusCode>299)&&a.onError&&a.onError("Failed to load page, status code: "+b.statusCode);var d=[];b.on("data",function(a){d.push(a)}),b.on("end",function(){var b=d.join("");try{b=JSON.parse(b)}catch(e){c.warn("CORS response parsing error: "+e)}b&&b.error?(b.message&&c.warn(b.message),a.onError&&a.onError(b)):a.onSuccess&&a.onSuccess(b)})}),b.on("error",function(){a.onError&&a.onError({})}),b.write(a.url.joinRequestParams()),b.end(),b},Script:function(a){a=a||{};var b,d,e=this,f=function(){WEBSPELLCHECKER.IO[a.callbackName]=function(a){b=a}},g=function(){delete WEBSPELLCHECKER.IO[a.callbackName]},h=function(){g(),e.removeScript()};a.callbackName&&f();var i=document.createElement("script");i.type="text/javascript",i.id=a.id?a.id:"",i.src=a.url?a.url:"",i.charset="UTF-8",i.onload=function(){this.success||(this.success=!0,a.callbackName?(b&&b.error?(b.message&&c.warn(b.message),a.onError&&a.onError(b)):a.onSuccess&&a.onSuccess(b),h()):a.onSuccess&&a.onSuccess())},i.onerror=function(){this.error=!0,a.onError&&a.onError({}),a.callbackName&&h()},i.onreadystatechange=function(){var a=this;("complete"===this.readyState||"loaded"===this.readyState)&&setTimeout(function(){a.onload()},0)},d=document.getElementsByTagName("head")[0],d.appendChild(i),this.getScript=function(){return i},this.removeScript=function(){d.removeChild(i),i=null}},get:function(a,b,c){return f.request({url:a,onSuccess:b,onError:c})},loadScript:function(a,b,c){var d=f.loadScript.cache?f.loadScript.cache:f.loadScript.cache={};if(a=a.build(),!d.hasOwnProperty(a)){d[a]=!0;var e=new f.Script({url:a,onSuccess:b,onError:c});return e}},ioMockStart:function(a){d=!0,e=a?a:e},ioMockEnd:function(){d=!1}};f.requestTypes={AJAX:f.AJAX,JSONP:f.JSONP,NODE:f.NODE},f.setRequestType=function(a){var b=f.requestTypes[a];b&&(f.request=b)},f.request=a.env===a.envTypes.node?f.requestTypes.NODE:f.requestTypes.AJAX,a.IO=f}"undefined"==typeof window&&(module.exports=a),"undefined"==typeof WEBSPELLCHECKER||"IO"in WEBSPELLCHECKER||a(WEBSPELLCHECKER)}(),function(){"use strict";function a(a){function b(a){for(var b=0;b<a.length;b++)"\\"===a[b-1]||"["!==a[b]&&"]"!==a[b]||(a=a.substring(0,b)+a.substring(b+1));return a}function c(a,b,c){this.name=a,this.flags=c||"",this.source=b,this.string="",this.regExp=null}c.prototype={_wrapSymbol:"#",_getRegExp:function(){if(this.regExp){var a=this.regExp.toString().match(/[gimuy]*$/)[0];if(this.regExp.source===this.source&&a===this.flags)return this.regExp}return this.regExp=new RegExp(this.source,this.flags)},_combine:function(a){var b=a.regExpObject;if(b instanceof c==!1)throw new Error(b.name+" should be instance of RegularType constructor.");var d=a.separator||"",e=(a.nameSeparator||"&",this.source+d+b.source),f=a.compositionName||this.name+a.nameSeparator+b.name,g=new c(f,e).init(this.string);return g=g.addFlags(b.flags+this.flags)},_replaceWithAnotherSource:function(a,b){var c=this._updateSource(b).replace(a);return c.source=this.source,c},_updateSource:function(a){var b=this.clone();return b.source=a,b},init:function(a){var b=this.clone();return b.string=a,b},clone:function g(){var g=Object.create(c.prototype);return Object.assign(g,this)},getString:function(){return this.string},getLastIndex:function(){return this._getRegExp().lastIndex},setLastIndex:function(a){var b=this._getRegExp();b.lastIndex=a},addFlags:function(a){var b=this.clone(),c=a.split("");return c.forEach(function(a){-1===b.flags.indexOf(a)&&(b.flags+=a)},this),b},g:function(){return this.addFlags("g")},i:function(){return this.addFlags("i")},set:function(){var a=b(this.source);return this._updateSource("["+a+"]")},group:function(){return this._updateSource("("+this.source+")")},start:function(){return this._updateSource("^"+this.source)},end:function(){return this._updateSource(this.source+"$")},onePlus:function(){return this._updateSource(this.source+"+")},more:function(){return this._updateSource(this.source+"*")},leftWordBoundary:function(){return this._updateSource("\\b"+this.source)},rightWordBoundary:function(){return this._updateSource(this.source+"\\b")},wrapWordBoundary:function(){return this.leftWordBoundary().rightWordBoundary()},lookahead:function(){return this.group(this._updateSource("?="+this.source))},split:function(a){return a=a||this.string,a.split(this._getRegExp())},match:function(a){return a=a||this.string,a.match(this._getRegExp())},search:function(a){return a=a||this.string,a.search(this._getRegExp())},test:function(a){return this._getRegExp().test(a||this.string)},replace:function(a,b){if(void 0!==b)return a.replace(this._getRegExp(),b);var c=this.clone();return b=a,c.string=c.string.replace(this._getRegExp(),b),c},replaceLeftWrapped:function(a,b){return a=a||this._wrapSymbol,this._replaceWithAnotherSource(b,a+this.source)},replaceRightWrapped:function(a,b){return a=a||this._wrapSymbol,this._replaceWithAnotherSource(b,this.source+a)},wrapInclude:function(a){return a=a||this._wrapSymbol,this.group().replace(a+"$1"+a)},composition:function(a,b){return this._combine({regExpObject:a,separator:"",nameSeparator:"&",compositionName:b})},or:function(a,b){return this._combine({compositionName:b,regExpObject:a,separator:"|",nameSeparator:"|"})},compositionGraph:function(a,b){var d=this instanceof c?this:void 0;return a.forEach(function(a){d=d?d.composition(a):a},this),d.name=b||d.name,d},store:function(a){return d.addRegularType(a||this.name,this.source,this.flags),this}};var d={addRegularType:function(a,b,d){var e=new c(a,b,d);return this[a]=e,e},wrap:function(a){return new c("regular",a)}},e=a.RegularsSources;for(var f in e)d.addRegularType(f,e[f]);a.RegularsManager=d}"undefined"==typeof window&&(module.exports=a),"undefined"==typeof WEBSPELLCHECKER||"RegularsManager"in WEBSPELLCHECKER||a(WEBSPELLCHECKER)}(),function(){function a(a){function b(a){this.name=a.name,this.validate=a.validate,this.erroMessageTemplate=a.erroMessageTemplate||"Parameter %optionName% should have a type - "+this.name+"."}function c(){this.critical=!1,this.count=0,this.reports=[],this.addError=function(a){a.critical&&this.critical===!1&&(this.critical=!0),this.reports.push(a),this.count+=1}}function d(){this._validatedFields=[]}function e(a){var b;if(h.isHash(a)){b={};for(var c in a)b[c]=e(a[c])}else if(h.isArray(a)){b=a.slice(0);for(var d=0;d<b.length;d+=1)b[d]=e(b[d])}else b=a;return b}function f(a){Object.assign(this,a)}{var g,h=a.Utils.TypeChecker;a.Utils.ArrayUtils}b.prototype={constructor:b,createErrorMessage:function(a){return this.erroMessageTemplate.replace(/%optionName%/g,a)}},d.prototype={constructor:d,addOption:function(a){var b=a.name;this._validatedFields.includes(b)||(this[b]=this._createOptionValue(a),"undefined"!=typeof this[b]&&this._validatedFields.push(b))},_createOptionValue:function(a){var b,c=a.value,d=a.template,f={},g=a.name,h=a.errorHandler,i=e(d.defaultValue);return void 0!==c||d.required?(b=d.type.validate(c))?c:(f.critical=d.required||!1,f.optionName=g,f.message=d.type.createErrorMessage(g),h(f),i):i}},f.prototype={constructor:f,getDefaultValue:function(a){return this[a].defaultValue},setDefaults:function(a){for(var b in a)this[b].defaultValue=a[b]}};var i={optionTypes:{},optionsTemplate:{},optionsValidators:{array:h.isArray,"boolean":h.isBoolean,date:h.isDate,defined:h.isDefined,empty:h.isEmpty,"function":h.isFunction,hash:h.isHash,integer:h.isInteger,positive:h.isPositive,number:h.isNumber,object:h.isObject,string:h.isString,urlProtocol:function(a){return"http"===a||"https"===a},urlHost:function(a){return h.notEmptyString(a)},urlPort:function(a){return h.isNumber(a)?h.isInteger(a):h.isString?h.isInteger(parseFloat(a)):!1},urlPath:function(a){return h.notEmptyString(a)},defaultValue:function(){return!1}},createOptions:function(a,e,g){var i,j,k=new c;a=a||{},i=a instanceof d==!0?a:new d,h.isString(e)?j=this.importOptionsTemplate(e):h.isObject(e)&&(j=e instanceof f==!0?e:new f(e));for(var l in j)if(j.hasOwnProperty(l)!==!1){if(j[l].type instanceof b==!1)throw new Error(l+' template "type" parameter should be instance of OptionsManager.OptionType constructor.');i.addOption({name:l,value:a[l],template:j[l],errorHandler:function(a){k.addError(a)}})}return g&&k.count>0&&g(k),i},extendOptionTypes:function(a){return h.isArray(a)&&a.forEach(i.extendOptionTypes.bind(this)),a.name&&h.isFunction(a.validate)?void(this.optionTypes[a.name]||(this.optionTypes[a.name]=new b(a))):!1},exportOptionsTemplate:function(a,b){b instanceof f==!1&&(b=new f(b)),this.optionsTemplate[a]=b},importOptionsTemplate:function(a){var b=this.optionsTemplate[a];if(b instanceof f==!1)throw new Error("Templates name: "+a+" is not defined.");return b},mergeOptionsTemplates:function(){var a={};return Array.prototype.forEach.call(arguments,function(b){if(h.isObject(b))for(var c in b)if(b.hasOwnProperty(c)!==!1){if(a[c])throw new Error("Template for "+c+" defined twice.");a[c]=b[c]}}),new f(a)}};g=i.optionsValidators,i.optionTypes={};for(var j in g)i.optionTypes[j]=new b({name:j,validate:g[j]});a.OptionsManager=i}"undefined"==typeof window&&(module.exports=a),"undefined"==typeof WEBSPELLCHECKER||"OptionsManager"in WEBSPELLCHECKER||a(WEBSPELLCHECKER)}(),function(){function a(a){function b(b){var c,d;this._services={},this._options=e.createOptions(b,"WebApiTemplate",function(a){c=a.critical,a.reports.forEach(function(a){f.log(a.message)},this)}),this._dependencies={TextProcessor:a.TextProcessor,Connection:a.Connection};for(var g in this._dependencies)this._services[g]=new this._dependencies[g](g,this);d=this._services.Connection,this._commands=d.getCommands(),this._udActions=d.getUdActions()}function c(a){this.name=a.name,this.wordlist=a.wordlist,this.modificationTime=a.modificationTime,this.makeUdAction=a.makeUdAction}var d,e=a.OptionsManager,f=a.logger,g=e.optionTypes;f.isON(!0),d={lang:{type:g.string,defaultValue:"auto"},autoLangPriorities:{type:g.object,defaultValue:{}},serviceProtocol:{type:g.urlProtocol,defaultValue:"http"},serviceHost:{type:g.urlHost,defaultValue:"svc.webspellchecker.net"},servicePort:{type:g.urlPort,defaultValue:80},servicePath:{type:g.urlPath,defaultValue:"spellcheck31/script/ssrv.cgi"},serviceId:{type:g.string,defaultValue:"1:KpkvQ2-6KNUj-L1W3u2-C9j0K1-Zv2tY1-CfDOx-WfGRg2-qXtci-YyyE34-j09H42-b0aCt3-d9a"},userDictionaryName:{type:g.string,defaultValue:""},customDictionaryIds:{type:g.string,defaultValue:""},minWordLength:{type:g.number,defaultValue:3},communicationFormat:{type:g.string,defaultValue:"json"},customPunctuation:{type:g.string,defaultValue:""},appType:{type:g.string,defaultValue:"web_api"}},e.exportOptionsTemplate("WebApiTemplate",d),b.prototype={constructor:b,_getService:function(a){return this._services[a]||null},_request:function(a,b){return this._getService("Connection").request(a,b.success||function(){},b.error||function(){})},_makeUdAction:function(a,b){"undefined"==typeof b.name&&(b.name=this.getOption("userDictionaryName"));var c={command:this._commands.userDictionary,UDAction:this._udActions[a],UDName:b.name,newUDName:b.newName,wordList:b.wordList,UDWord:b.word};return this._request(c,b)},_udMethodWrapper:function(a,b){var d=this,e=b.success||function(){};return b.success=function(a){var b=new c({wordlist:a.wordlist,name:a.name,modificationTime:a.modificationTime,makeUdAction:d._makeUdAction.bind(d)});e(b)},this._makeUdAction(a,b)},getOption:function(a){return this._options[a]},setOption:function(a,b){var c=!1,f={},g={};return d[a]&&(c=!0,f[a]=d[a],g[a]=b,this._options[a]=e.createOptions(g,f)[a]),c},getInfo:function(a){return this._request({command:this._commands.getInfo,locale:a.locale||this.getOption("localization"),version:a.version||2},a)},getLangList:function(a){return this._request({command:this._commands.getLangList},a)},spellCheck:function(a){function b(a,b){var c;return b.reduce(function(b,d){for(var e=0;e<a.length;e+=1)if(c=a[e],c.word===d.word)return b.push(Object.assign({},c,d)),b;return b},[])}var c=Object.assign({},a),d=this._getService("TextProcessor").getWordsFromString(c.text),e=d.wordsCollection.join(",");return c.success=function(c){var e=b(c,d.wordsOffsets);a.success(e)},this._request({command:this._commands.spellCheck,language:c.lang||this.getOption("lang"),userWordlist:a.userWordlist,customDictionary:this.getOption("customDictionaryIds"),userDictionary:this.getOption("userDictionaryName"),text:e},{success:c.success,error:c.error})},grammarCheck:function(a){return this._request({command:this._commands.grammarCheck,language:a.lang||this.getOption("lang"),sentences:a.sentences,text:a.text},a)},check:function(a){return this._request({command:this._commands.check,language:a.lang||this.getOption("lang"),autoLangPriorities:a.autoLangPriorities,shortAnswer:!0,userWordlist:a.userWordlist,customDictionary:this.getOption("customDictionaryIds"),userDictionary:this.getOption("userDictionaryName"),customPunctuation:this.getOption("customPunctuation"),minWordLength:this.getOption("minWordLength"),disableGrammar:this.getOption("enableGrammar")?!1:!0,tokens:a.tokens,text:a.text},a)},autocorrect:function(a){return this._request({command:this._commands.autocorrect,language:a.lang||this.getOption("lang"),autoLangPriorities:a.autoLangPriorities||"",detectedLang:a.detectedLang,shortAnswer:!0,userWordlist:a.userWordlist,customDictionary:this.getOption("customDictionaryIds"),userDictionary:this.getOption("userDictionaryName"),text:a.text},a)},statistics:function(a){return this._request({command:this._commands.statistics,action:a.action,session:this.getOption("session"),timestamp:(new Date).getTime(),text:a.text,newText:a.newText,language:a.lang||this.getOption("lang"),detectedLang:a.detectedLang,type:a.type,category:a.category,rule:a.rule||"",offset:a.offset,context:a.context},a)},getUserDictionary:function(a){return this._udMethodWrapper("getDict",a)},createUserDictionary:function(a){return this._udMethodWrapper("create",a)},deleteUserDictionary:function(a){return this._udMethodWrapper("delete",a)},renameUserDictionary:function(a){return this._udMethodWrapper("rename",a)},addWordToUserDictionary:function(a){return this._udMethodWrapper("addWord",a)},deleteWordFromUserDictionary:function(a){return this._udMethodWrapper("deleteWord",a)},getDictionariesModifyTime:function(a){return this._request({command:this._commands.getDictionariesModifyTime,UDName:a.userDictionary,customDictionary:a.customDictionary},a)}},c.prototype={constructor:c,_action:function(a,b){this.makeUdAction(a,Object.assign({name:this.name},b))},addWord:function(a){var b=a.success,c=this;a.success=function(){c.wordlist.push(a.word),b(c)},this._action("addWord",a)},deleteWord:function(a){var b=a.success,c=a.word,d=this;a.success=function(){for(var a=[],e=0;e<d.wordlist.length;e+=1)d.wordlist[e]!==c&&a.push(a[e]);d.wordlist=a,b(d)},this._action("deleteWord",a)},"delete":function(a){var b=a.success,c=this;a.success=function(){this.name=void 0,this.wordlist=void 0,b(c)},this._action("delete",a)},rename:function(a){var b=a.success,c=this;a.success=function(){c.name=a.newName,b(c)},this._action("rename",a)},getWordList:function(){return this.wordlist.slice()}},a.initWebApi=function(a){return new b(a)}}"undefined"==typeof window&&(module.exports=a),"undefined"==typeof WEBSPELLCHECKER||"initWebApi"in WEBSPELLCHECKER||a(WEBSPELLCHECKER)}(),function(){"use strict";function a(a){function b(a,b){this.moduleId=a,this.appInstance=b,c.textPunctuation.store("punctuationRegExp")}var c=a.RegularsManager,d=a.Utils.StringUtils;b.prototype={constructor:b,replaceSepatators:function(a){var b,d=c.punctuationRegExp;return a=c.HtmlSpaceSymbol.compositionGraph([d,c.EOL,c.wrap(this.appInstance.getOption("customPunctuation"))]).g().set().replace(a," "),b=c.situationalSeparators.set().g(),a=b.composition(c.twoAndMore).init(a).wrapInclude("#").getString(),a=b.init(a).replaceLeftWrapped("#"," ").replaceRightWrapped("#"," ").getString(),a=b.init(a).replaceRightWrapped(" ","  ").replaceLeftWrapped(" ","  ").start().or(b.end()).replace(" ").getString()},removeSpecialCharacters:function(a){return c.specialCharacters.set().g().replace(a,"")},getWordOffsets:function(a,b){var c=b.indexOf(a),d=c+a.length;return{startOffset:c,endOffset:d}},getWordsFromString:function(a){var b,e=this.appInstance.getOption("minWordLength"),f=[],g=this;return a=this.replaceSepatators(a),a=this.removeSpecialCharacters(a),b=c.space.init(a).split().reduce(function(b,c){var h;return""!==c&&c.length>=e&&(f.includes(c)||f.push(c),h=g.getWordOffsets(c,a),h.word=c,b.push(h),a=d.replaceFromTo(a,h.startOffset,h.endOffset,new Array(c.length+1).join(" "))),b},[]),{wordsOffsets:b,wordsCollection:f}}},a.TextProcessor=b}"undefined"==typeof window&&(module.exports=a),"undefined"==typeof WEBSPELLCHECKER||"Connection"in WEBSPELLCHECKER||a(WEBSPELLCHECKER)}(),function(){"use strict";function a(a){function b(a,b){this.moduleId=a,this.appInstance=b,this.url=new c.URL({protocol:b.getOption("serviceProtocol"),host:b.getOption("serviceHost"),port:b.getOption("servicePort"),path:b.getOption("servicePath")}),this.defaultParameters=this.setDefaults(["serviceId","communicationFormat","appType"],d)}var c=a.IO,d={serviceId:"customerid",command:"cmd",communicationFormat:"format",userDictionary:"user_dictionary",customDictionary:"custom_dictionary",UDAction:"action",UDName:"name",newUDName:"new_name",removeUDCookie:"remove_ud_cookie",UDWord:"word",userWordlist:"user_wordlist",wordList:"wordlist",language:"lang",autoLangPriorities:"auto_lang_priorities",detectedLang:"detected_lang",outType:"out_type",text:"text",sentences:"sentences",tokens:"tokens",appType:"app_type",customPunctuation:"custom_punctuation",minWordLength:"min_word_length",shortAnswer:"short_answer",disableSpelling:"disable_spelling",disableGrammar:"disable_grammar",version:"version",locale:"locale",action:"action",newText:"new_text",type:"type",category:"category",rule:"rule",context:"context",session:"session",offset:"offset",timestamp:"timestamp"},e={spellCheck:"check_spelling",grammarCheck:"grammar_check",check:"check",autocorrect:"autocorrect",userDictionary:"user_dictionary",getLangList:"get_lang_list",getInfo:"get_info",getDictionariesModifyTime:"get_dicts_modify_time",statistics:"statistics"},f={create:"create","delete":"delete",rename:"rename",check:"check",addWord:"addword",deleteWord:"deleteword",getDict:"getdict"};
b.prototype={constructor:b,getCommands:function(){return e},getUdActions:function(){return f},setDefaults:function(a,b){var c={};return a.forEach(function(a){c[b[a]]=this.appInstance.getOption(a)},this),c},getURL:function(){return this.url.clear()},prepareParameters:function(a,b){var c,d={};for(var f in a){if(c=b[f],!c)throw new Error("parameter "+f+" is not specified.");d[c]=a[f]}return d=Object.assign({},this.defaultParameters,d),d[b.command]===e.getLangList&&delete d[b.communicationFormat],d},request:function(a,b,e){return c.get(this.getURL().addParameters(this.prepareParameters(a,d)).addMetaParameters(this.defaultMetaParameters),b,e)}},a.Connection=b}"undefined"==typeof window&&(module.exports=a),"undefined"==typeof WEBSPELLCHECKER||"Connection"in WEBSPELLCHECKER||a(WEBSPELLCHECKER)}(),WEBSPELLCHECKER.signals=function(){!function(a){function b(a,b,c,d,e){this._listener=b,this._isOnce=c,this.context=d,this._signal=a,this._priority=e||0}function c(a,b){if("function"!=typeof a)throw Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",b))}function d(){this._bindings=[],this._prevParams=null;var a=this;this.dispatch=function(){d.prototype.dispatch.apply(a,arguments)}}b.prototype={active:!0,params:null,execute:function(a){var b;if(this.active&&this._listener){a=this.params?this.params.concat(a):a;try{b=this._listener.apply(this.context,a)}catch(c){setTimeout(function(){throw c},0)}finally{this._isOnce&&this.detach()}}return b},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},d.prototype={VERSION:"1.1.1",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(a,c,d,e){var f=this._indexOfListener(a,d);if(-1!==f){if(a=this._bindings[f],a.isOnce()!==c)throw Error("You cannot add"+(c?"":"Once")+"() then add"+(c?"Once":"")+"() the same listener without removing the relationship first.")}else a=new b(this,a,c,d,e),this._addBinding(a);return this.memorize&&this._prevParams&&a.execute(this._prevParams),a},_addBinding:function(a){var b=this._bindings.length;do--b;while(this._bindings[b]&&a._priority<=this._bindings[b]._priority);this._bindings.splice(b+1,0,a)},_indexOfListener:function(a,b){for(var c,d=this._bindings.length;d--;)if(c=this._bindings[d],c._listener===a&&c.context===b)return d;return-1},has:function(a,b){return-1!==this._indexOfListener(a,b)},add:function(a,b,d){return c(a,"add"),this._registerListener(a,!1,b,d)},addOnce:function(a,b,d){return c(a,"addOnce"),this._registerListener(a,!0,b,d)},remove:function(a,b){c(a,"remove");var d=this._indexOfListener(a,b);return-1!==d&&(this._bindings[d]._destroy(),this._bindings.splice(d,1)),a},removeAll:function(){for(var a=this._bindings.length;a--;)this._bindings[a]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(){if(this.active){for(var a=arguments.length,b=Array(a),c=0;a>c;++c)b[c]=arguments[c];if(a=this._bindings.length,this.memorize&&(this._prevParams=b),a){c=this._bindings.slice(),this._shouldPropagate=!0;do a--;while(c[a]&&this._shouldPropagate&&!1!==c[a].execute(b))}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}},d.Signal=d,a.signals=d}(this)},WEBSPELLCHECKER.signals(),WEBSPELLCHECKER.rangy=function(){!function(a){function b(a,b){var c=_typeof(a[b]);return c==v||!(c!=u||!a[b])||"unknown"==c}function c(a,b){return!(_typeof(a[b])!=u||!a[b])}function d(a,b){return _typeof(a[b])!=w}function e(a){return function(b,c){for(var d=c.length;d--;)if(!a(b,c[d]))return!1;return!0}}function f(a){return a&&B(a,A)&&D(a,z)}function g(a){return c(a,"body")?a.body:a.getElementsByTagName("body")[0]}function h(a){("undefined"==typeof console?"undefined":_typeof(console))!=w&&b(console,"log")&&console.log(a)}function i(a,b){G&&b?alert(a):h(a)}function j(a){I.initialized=!0,I.supported=!1,i("Rangy is not supported in this environment. Reason: "+a,I.config.alertOnFail)}function k(a){i("Rangy warning: "+a,I.config.alertOnWarn)}function l(a){return a.message||a.description||String(a)}function m(){if(G&&!I.initialized){var a,c=!1,d=!1;b(document,"createRange")&&(a=document.createRange(),B(a,y)&&D(a,x)&&(c=!0));var e=g(document);if(!e||"body"!=e.nodeName.toLowerCase())return void j("No body element found");if(e&&b(e,"createTextRange")&&(a=e.createTextRange(),f(a)&&(d=!0)),!c&&!d)return void j("Neither Range nor TextRange are available");I.initialized=!0,I.features={implementsDomRange:c,implementsTextRange:d};var i,k;for(var m in F)(i=F[m])instanceof q&&i.init(i,I);for(var n=0,o=L.length;o>n;++n)try{L[n](I)}catch(p){k="Rangy init listener threw an exception. Continuing. Detail: "+l(p),h(k)}}}function n(a,b,c){c&&(a+=" in module "+c.name),I.warn("DEPRECATED: "+a+" is deprecated. Please use "+b+" instead.")}function o(a,b,c,d){a[b]=function(){return n(b,c,d),a[c].apply(a,H.toArray(arguments))}}function p(a){a=a||window,m();for(var b=0,c=M.length;c>b;++b)M[b](a)}function q(a,b,c){this.name=a,this.dependencies=b,this.initialized=!1,this.supported=!1,this.initializer=c}function r(a,b,c){var d=new q(a,b,function(b){if(!b.initialized){b.initialized=!0;try{c(I,b),b.supported=!0}catch(d){var e="Module '"+a+"' failed to load: "+l(d);h(e),d.stack&&h(d.stack)}}});return F[a]=d,d}function s(){}function t(){}var u="object",v="function",w="undefined",x=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],y=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],z=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],A=["collapse","compareEndPoints","duplicate","moveToElementText","parentElement","select","setEndPoint","getBoundingClientRect"],B=e(b),C=e(c),D=e(d),E=[].forEach?function(a,b){a.forEach(b)}:function(a,b){for(var c=0,d=a.length;d>c;++c)b(a[c],c)},F={},G=("undefined"==typeof window?"undefined":_typeof(window))!=w&&("undefined"==typeof document?"undefined":_typeof(document))!=w,H={isHostMethod:b,isHostObject:c,isHostProperty:d,areHostMethods:B,areHostObjects:C,areHostProperties:D,isTextRange:f,getBody:g,forEach:E},I={version:"1.3.0",initialized:!1,isBrowser:G,supported:!0,util:H,features:{},modules:F,config:{alertOnFail:!1,alertOnWarn:!1,preferTextRange:!1,autoInitialize:("undefined"==typeof rangyAutoInitialize?"undefined":_typeof(rangyAutoInitialize))==w?!0:rangyAutoInitialize}};I.fail=j,I.warn=k;var J;({}).hasOwnProperty?(H.extend=J=function(a,b,c){var d,e;for(var f in b)b.hasOwnProperty(f)&&(d=a[f],e=b[f],c&&null!==d&&"object"==("undefined"==typeof d?"undefined":_typeof(d))&&null!==e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&J(d,e,!0),a[f]=e);return b.hasOwnProperty("toString")&&(a.toString=b.toString),a},H.createOptions=function(a,b){var c={};return J(c,b),a&&J(c,a),c}):j("hasOwnProperty not supported"),G||j("Rangy can only run in a browser"),function(){var a;if(G){var b=document.createElement("div");b.appendChild(document.createElement("span"));var c=[].slice;try{1==c.call(b.childNodes,0)[0].nodeType&&(a=function(a){return c.call(a,0)})}catch(d){}}a||(a=function(a){for(var b=[],c=0,d=a.length;d>c;++c)b[c]=a[c];return b}),H.toArray=a}();var K;G&&(b(document,"addEventListener")?K=function(a,b,c){a.addEventListener(b,c,!1)}:b(document,"attachEvent")?K=function(a,b,c){a.attachEvent("on"+b,c)}:j("Document does not have required addEventListener or attachEvent method"),H.addListener=K);var L=[];H.deprecationNotice=n,H.createAliasForDeprecatedMethod=o,I.init=m,I.addInitListener=function(a){I.initialized?a(I):L.push(a)};var M=[];I.addShimListener=function(a){M.push(a)},G&&(I.shim=I.createMissingNativeApi=p,o(I,"createMissingNativeApi","shim")),q.prototype={init:function(){for(var a,b,c=this.dependencies||[],d=0,e=c.length;e>d;++d){if(b=c[d],a=F[b],!(a&&a instanceof q))throw new Error("required module '"+b+"' not found");if(a.init(),!a.supported)throw new Error("required module '"+b+"' not supported")}this.initializer(this)},fail:function(a){throw this.initialized=!0,this.supported=!1,new Error(a)},warn:function(a){I.warn("Module "+this.name+": "+a)},deprecationNotice:function(a,b){I.warn("DEPRECATED: "+a+" in module "+this.name+" is deprecated. Please use "+b+" instead")},createError:function(a){return new Error("Error in Rangy "+this.name+" module: "+a)}},I.createModule=function(a){var b,c;2==arguments.length?(b=arguments[1],c=[]):(b=arguments[2],c=arguments[1]);var d=r(a,c,b);I.initialized&&I.supported&&d.init()},I.createCoreModule=function(a,b,c){r(a,b,c)},I.RangePrototype=s,I.rangePrototype=new s,I.selectionPrototype=new t,I.createCoreModule("DomUtil",[],function(a,b){function c(a){var b;return _typeof(a.namespaceURI)==F||null===(b=a.namespaceURI)||"http://www.w3.org/1999/xhtml"==b}function d(a){var b=a.parentNode;return 1==b.nodeType?b:null}function e(a){for(var b=0;a=a.previousSibling;)++b;return b}function f(a){switch(a.nodeType){case 7:case 10:return 0;case 3:case 8:return a.length;default:return a.childNodes.length}}function g(a,b){var c,d=[];for(c=a;c;c=c.parentNode)d.push(c);for(c=b;c;c=c.parentNode)if(K(d,c))return c;return null}function h(a,b,c){for(var d=c?b:b.parentNode;d;){if(d===a)return!0;d=d.parentNode}return!1}function i(a,b){return h(a,b,!0)}function j(a,b,c){for(var d,e=c?a:a.parentNode;e;){if(d=e.parentNode,d===b)return e;e=d}return null}function k(a){var b=a.nodeType;return 3==b||4==b||8==b}function l(a){if(!a)return!1;var b=a.nodeType;return 3==b||8==b}function m(a,b){var c=b.nextSibling,d=b.parentNode;return c?d.insertBefore(a,c):d.appendChild(a),a}function n(a,b,c){var d=a.cloneNode(!1);if(d.deleteData(0,b),a.deleteData(b,a.length-b),m(d,a),c)for(var f,g=0;f=c[g++];)f.node==a&&f.offset>b?(f.node=d,f.offset-=b):f.node==a.parentNode&&f.offset>e(a)&&++f.offset;return d}function o(a){if(9==a.nodeType)return a;if(_typeof(a.ownerDocument)!=F)return a.ownerDocument;if(_typeof(a.document)!=F)return a.document;if(a.parentNode)return o(a.parentNode);throw b.createError("getDocument: no document found for node")}function p(a){var c=o(a);if(_typeof(c.defaultView)!=F)return c.defaultView;if(_typeof(c.parentWindow)!=F)return c.parentWindow;throw b.createError("Cannot get a window object for node")}function q(a){if(_typeof(a.contentDocument)!=F)return a.contentDocument;if(_typeof(a.contentWindow)!=F)return a.contentWindow.document;throw b.createError("getIframeDocument: No Document object found for iframe element")}function r(a){if(_typeof(a.contentWindow)!=F)return a.contentWindow;if(_typeof(a.contentDocument)!=F)return a.contentDocument.defaultView;throw b.createError("getIframeWindow: No Window object found for iframe element")}function s(a){return a&&G.isHostMethod(a,"setTimeout")&&G.isHostObject(a,"document")}function t(a,b,c){var d;if(a?G.isHostProperty(a,"nodeType")?d=1==a.nodeType&&"iframe"==a.tagName.toLowerCase()?q(a):o(a):s(a)&&(d=a.document):d=document,!d)throw b.createError(c+"(): Parameter must be a Window object or DOM node");return d}function u(a){for(var b;b=a.parentNode;)a=b;return a}function v(a,c,d,f){var h,i,k,l,m;if(a==d)return c===f?0:f>c?-1:1;if(h=j(d,a,!0))return c<=e(h)?-1:1;if(h=j(a,d,!0))return e(h)<f?-1:1;if(i=g(a,d),!i)throw new Error("comparePoints error: nodes have no common ancestor");if(k=a===i?i:j(a,i,!0),l=d===i?i:j(d,i,!0),k===l)throw b.createError("comparePoints got to case 4 and childA and childB are the same!");for(m=i.firstChild;m;){if(m===k)return-1;if(m===l)return 1;m=m.nextSibling}}function w(a){var b;try{return b=a.parentNode,!1}catch(c){return!0}}function x(a){if(!a)return"[No node]";if(L&&w(a))return"[Broken node]";if(k(a))return'"'+a.data+'"';if(1==a.nodeType){var b=a.id?' id="'+a.id+'"':"";return"<"+a.nodeName+b+">[index:"+e(a)+",length:"+a.childNodes.length+"]["+(a.innerHTML||"[innerHTML not supported]").slice(0,25)+"]"}return a.nodeName}function y(a){for(var b,c=o(a).createDocumentFragment();b=a.firstChild;)c.appendChild(b);return c}function z(a,b,c){var d=H(a),e=a.createElement("div");e.contentEditable=""+!!c,b&&(e.innerHTML=b);var f=d.firstChild;return f?d.insertBefore(e,f):d.appendChild(e),e}function A(a){return a.parentNode.removeChild(a)}function B(a){this.root=a,this._next=a}function C(a){return new B(a)}function D(a,b){this.node=a,this.offset=b}function E(a){this.code=this[a],this.codeName=a,this.message="DOMException: "+this.codeName}var F="undefined",G=a.util,H=G.getBody;G.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||b.fail("document missing a Node creation method"),G.isHostMethod(document,"getElementsByTagName")||b.fail("document missing getElementsByTagName method");var I=document.createElement("div");G.areHostMethods(I,["insertBefore","appendChild","cloneNode"]||!G.areHostObjects(I,["previousSibling","nextSibling","childNodes","parentNode"]))||b.fail("Incomplete Element implementation"),G.isHostProperty(I,"innerHTML")||b.fail("Element is missing innerHTML property");var J=document.createTextNode("test");G.areHostMethods(J,["splitText","deleteData","insertData","appendData","cloneNode"]||!G.areHostObjects(I,["previousSibling","nextSibling","childNodes","parentNode"])||!G.areHostProperties(J,["data"]))||b.fail("Incomplete Text Node implementation");var K=function(a,b){for(var c=a.length;c--;)if(a[c]===b)return!0;return!1},L=!1;!function(){var b=document.createElement("b");b.innerHTML="1";var c=b.firstChild;b.innerHTML="<br />",L=w(c),a.features.crashyTextNodes=L}();var M;_typeof(window.getComputedStyle)!=F?M=function(a,b){return p(a).getComputedStyle(a,null)[b]}:_typeof(document.documentElement.currentStyle)!=F?M=function(a,b){return a.currentStyle?a.currentStyle[b]:""}:b.fail("No means of obtaining computed style properties found"),B.prototype={_current:null,hasNext:function(){return!!this._next},next:function N(){var a,N,b=this._current=this._next;if(this._current)if(a=b.firstChild)this._next=a;else{for(N=null;b!==this.root&&!(N=b.nextSibling);)b=b.parentNode;this._next=N}return this._current},detach:function(){this._current=this._next=this.root=null}},D.prototype={equals:function(a){return!!a&&this.node===a.node&&this.offset==a.offset},inspect:function(){return"[DomPosition("+x(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}},E.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24},E.prototype.toString=function(){return this.message},a.dom={arrayContains:K,isHtmlNamespace:c,parentElement:d,getNodeIndex:e,getNodeLength:f,getCommonAncestor:g,isAncestorOf:h,isOrIsAncestorOf:i,getClosestAncestorIn:j,isCharacterDataNode:k,isTextOrCommentNode:l,insertAfter:m,splitDataNode:n,getDocument:o,getWindow:p,getIframeWindow:r,getIframeDocument:q,getBody:H,isWindow:s,getContentDocument:t,getRootContainer:u,comparePoints:v,isBrokenNode:w,inspectNode:x,getComputedStyleProperty:M,createTestElement:z,removeNode:A,fragmentFromNodeChildren:y,createIterator:C,DomPosition:D},a.DOMException=E}),I.createCoreModule("DomRange",["DomUtil"],function(a){function b(a,b){return 3!=a.nodeType&&(O(a,b.startContainer)||O(a,b.endContainer))}function c(a){return a.document||P(a.startContainer)}function d(a){return V(a.startContainer)}function e(a){return new K(a.parentNode,N(a))}function f(a){return new K(a.parentNode,N(a)+1)}function g(a,b,c){var d=11==a.nodeType?a.firstChild:a;return M(b)?c==b.length?I.insertAfter(a,b):b.parentNode.insertBefore(a,0==c?b:R(b,c)):c>=b.childNodes.length?b.appendChild(a):b.insertBefore(a,b.childNodes[c]),d}function h(a,b,d){if(y(a),y(b),c(b)!=c(a))throw new L("WRONG_DOCUMENT_ERR");var e=Q(a.startContainer,a.startOffset,b.endContainer,b.endOffset),f=Q(a.endContainer,a.endOffset,b.startContainer,b.startOffset);return d?0>=e&&f>=0:0>e&&f>0}function i(a){for(var b,d,e,f=c(a.range).createDocumentFragment();d=a.next();){if(b=a.isPartiallySelectedSubtree(),d=d.cloneNode(!b),b&&(e=a.getSubtreeIterator(),d.appendChild(i(e)),e.detach()),10==d.nodeType)throw new L("HIERARCHY_REQUEST_ERR");f.appendChild(d)}return f}function j(a,b,c){var d,e;c=c||{stop:!1};for(var f,g;f=a.next();)if(a.isPartiallySelectedSubtree()){if(b(f)===!1)return void(c.stop=!0);if(g=a.getSubtreeIterator(),j(g,b,c),g.detach(),c.stop)return}else for(d=I.createIterator(f);e=d.next();)if(b(e)===!1)return void(c.stop=!0)}function k(a){for(var b;a.next();)a.isPartiallySelectedSubtree()?(b=a.getSubtreeIterator(),k(b),b.detach()):a.remove()}function l(a){for(var b,d,e=c(a.range).createDocumentFragment();b=a.next();){if(a.isPartiallySelectedSubtree()?(b=b.cloneNode(!1),d=a.getSubtreeIterator(),b.appendChild(l(d)),d.detach()):a.remove(),10==b.nodeType)throw new L("HIERARCHY_REQUEST_ERR");e.appendChild(b)}return e}function m(a,b,c){var d,e=!(!b||!b.length),f=!!c;e&&(d=new RegExp("^("+b.join("|")+")$"));var g=[];return j(new o(a,!1),function(b){if(!(e&&!d.test(b.nodeType)||f&&!c(b))){var h=a.startContainer;if(b!=h||!M(h)||a.startOffset!=h.length){var i=a.endContainer;b==i&&M(i)&&0==a.endOffset||g.push(b)}}}),g}function n(a){var b="undefined"==typeof a.getName?"Range":a.getName();return"["+b+"("+I.inspectNode(a.startContainer)+":"+a.startOffset+", "+I.inspectNode(a.endContainer)+":"+a.endOffset+")]"}function o(a,b){if(this.range=a,this.clonePartiallySelectedTextNodes=b,!a.collapsed){this.sc=a.startContainer,this.so=a.startOffset,this.ec=a.endContainer,this.eo=a.endOffset;var c=a.commonAncestorContainer;this.sc===this.ec&&M(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==c||M(this.sc)?S(this.sc,c,!0):this.sc.childNodes[this.so],this._last=this.ec!==c||M(this.ec)?S(this.ec,c,!0):this.ec.childNodes[this.eo-1])}}function p(a){return function(b,c){for(var d,e=c?b:b.parentNode;e;){if(d=e.nodeType,U(a,d))return e;e=e.parentNode}return null}}function q(a,b){if(db(a,b))throw new L("INVALID_NODE_TYPE_ERR")}function r(a,b){if(!U(b,a.nodeType))throw new L("INVALID_NODE_TYPE_ERR")}function s(a,b){if(0>b||b>(M(a)?a.length:a.childNodes.length))throw new L("INDEX_SIZE_ERR")}function t(a,b){if(bb(a,!0)!==bb(b,!0))throw new L("WRONG_DOCUMENT_ERR")}function u(a){if(cb(a,!0))throw new L("NO_MODIFICATION_ALLOWED_ERR")}function v(a,b){if(!a)throw new L(b)}function w(a,b){return b<=(M(a)?a.length:a.childNodes.length)}function x(a){return!!a.startContainer&&!!a.endContainer&&!(W&&(I.isBrokenNode(a.startContainer)||I.isBrokenNode(a.endContainer)))&&V(a.startContainer)==V(a.endContainer)&&w(a.startContainer,a.startOffset)&&w(a.endContainer,a.endOffset)}function y(a){if(!x(a))throw new Error("Range error: Range is not valid. This usually happens after DOM mutation. Range: ("+a.inspect()+")")}function z(a,b){y(a);var c=a.startContainer,d=a.startOffset,e=a.endContainer,f=a.endOffset,g=c===e;M(e)&&f>0&&f<e.length&&R(e,f,b),M(c)&&d>0&&d<c.length&&(c=R(c,d,b),g?(f-=d,e=c):e==c.parentNode&&f>=N(c)&&f++,d=0),a.setStartAndEnd(c,d,e,f)}function A(a){y(a);var b=a.commonAncestorContainer.parentNode.cloneNode(!1);return b.appendChild(a.cloneContents()),b.innerHTML}function B(a){a.START_TO_START=jb,a.START_TO_END=kb,a.END_TO_END=lb,a.END_TO_START=mb,a.NODE_BEFORE=nb,a.NODE_AFTER=ob,a.NODE_BEFORE_AND_AFTER=pb,a.NODE_INSIDE=qb}function C(a){B(a),B(a.prototype)}function D(a,b){return function(){y(this);var c,d,e=this.startContainer,g=this.startOffset,h=this.commonAncestorContainer,i=new o(this,!0);e!==h&&(c=S(e,h,!0),d=f(c),e=d.node,g=d.offset),j(i,u),i.reset();var k=a(i);return i.detach(),b(this,e,g,e,g),k}}function E(c,d){function g(a,b){return function(c){r(c,Y),r(V(c),Z);var d=(a?e:f)(c);(b?h:i)(this,d.node,d.offset)}}function h(a,b,c){var e=a.endContainer,f=a.endOffset;(b!==a.startContainer||c!==a.startOffset)&&((V(b)!=V(e)||1==Q(b,c,e,f))&&(e=b,f=c),d(a,b,c,e,f))}function i(a,b,c){var e=a.startContainer,f=a.startOffset;(b!==a.endContainer||c!==a.endOffset)&&((V(b)!=V(e)||-1==Q(b,c,e,f))&&(e=b,f=c),d(a,e,f,b,c))}var j=function(){};j.prototype=a.rangePrototype,c.prototype=new j,J.extend(c.prototype,{setStart:function(a,b){q(a,!0),s(a,b),h(this,a,b)},setEnd:function(a,b){q(a,!0),s(a,b),i(this,a,b)},setStartAndEnd:function(){var a=arguments,b=a[0],c=a[1],e=b,f=c;switch(a.length){case 3:f=a[2];break;case 4:e=a[2],f=a[3]}d(this,b,c,e,f)},setBoundary:function(a,b,c){this["set"+(c?"Start":"End")](a,b)},setStartBefore:g(!0,!0),setStartAfter:g(!1,!0),setEndBefore:g(!0,!1),setEndAfter:g(!1,!1),collapse:function(a){y(this),a?d(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):d(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(a){q(a,!0),d(this,a,0,a,T(a))},selectNode:function(a){q(a,!1),r(a,Y);var b=e(a),c=f(a);d(this,b.node,b.offset,c.node,c.offset)},extractContents:D(l,d),deleteContents:D(k,d),canSurroundContents:function(){y(this),u(this.startContainer),u(this.endContainer);var a=new o(this,!0),c=a._first&&b(a._first,this)||a._last&&b(a._last,this);return a.detach(),!c},splitBoundaries:function(){z(this)},splitBoundariesPreservingPositions:function(a){z(this,a)},normalizeBoundaries:function(){y(this);var a,b=this.startContainer,c=this.startOffset,e=this.endContainer,f=this.endOffset,g=function(a){var b=a.nextSibling;b&&b.nodeType==a.nodeType&&(e=a,f=a.length,a.appendData(b.data),X(b))},h=function(a){var d=a.previousSibling;if(d&&d.nodeType==a.nodeType){b=a;var g=a.length;if(c=d.length,a.insertData(0,d.data),X(d),b==e)f+=c,e=b;else if(e==a.parentNode){var h=N(a);f==h?(e=a,f=g):f>h&&f--}}},i=!0;if(M(e))f==e.length?g(e):0==f&&(a=e.previousSibling,a&&a.nodeType==e.nodeType&&(f=a.length,b==e&&(i=!1),a.appendData(e.data),X(e),e=a));else{if(f>0){var j=e.childNodes[f-1];j&&M(j)&&g(j)}i=!this.collapsed}if(i){if(M(b))0==c?h(b):c==b.length&&(a=b.nextSibling,a&&a.nodeType==b.nodeType&&(e==a&&(e=b,f+=b.length),b.appendData(a.data),X(a)));else if(c<b.childNodes.length){var k=b.childNodes[c];k&&M(k)&&h(k)}}else b=e,c=f;d(this,b,c,e,f)},collapseToPoint:function(a,b){q(a,!0),s(a,b),this.setStartAndEnd(a,b)}}),C(c)}function F(a){a.collapsed=a.startContainer===a.endContainer&&a.startOffset===a.endOffset,a.commonAncestorContainer=a.collapsed?a.startContainer:I.getCommonAncestor(a.startContainer,a.endContainer)}function G(a,b,c,d,e){a.startContainer=b,a.startOffset=c,a.endContainer=d,a.endOffset=e,a.document=I.getDocument(b),F(a)}function H(a){this.startContainer=a,this.startOffset=0,this.endContainer=a,this.endOffset=0,this.document=a,F(this)}var I=a.dom,J=a.util,K=I.DomPosition,L=a.DOMException,M=I.isCharacterDataNode,N=I.getNodeIndex,O=I.isOrIsAncestorOf,P=I.getDocument,Q=I.comparePoints,R=I.splitDataNode,S=I.getClosestAncestorIn,T=I.getNodeLength,U=I.arrayContains,V=I.getRootContainer,W=a.features.crashyTextNodes,X=I.removeNode;o.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var a=this._current=this._next;return a&&(this._next=a!==this._last?a.nextSibling:null,M(a)&&this.clonePartiallySelectedTextNodes&&(a===this.ec&&(a=a.cloneNode(!0)).deleteData(this.eo,a.length-this.eo),this._current===this.sc&&(a=a.cloneNode(!0)).deleteData(0,this.so))),a},remove:function(){var a,b,c=this._current;!M(c)||c!==this.sc&&c!==this.ec?c.parentNode&&X(c):(a=c===this.sc?this.so:0,b=c===this.ec?this.eo:c.length,a!=b&&c.deleteData(a,b-a))},isPartiallySelectedSubtree:function(){var a=this._current;return b(a,this.range)},getSubtreeIterator:function(){var a;if(this.isSingleCharacterDataNode)a=this.range.cloneRange(),a.collapse(!1);else{a=new H(c(this.range));var b=this._current,d=b,e=0,f=b,g=T(b);O(b,this.sc)&&(d=this.sc,e=this.so),O(b,this.ec)&&(f=this.ec,g=this.eo),G(a,d,e,f,g)}return new o(a,this.clonePartiallySelectedTextNodes)},detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};var Y=[1,3,4,5,7,8,10],Z=[2,9,11],$=[5,6,10,12],_=[1,3,4,5,7,8,10,11],ab=[1,3,4,5,7,8],bb=p([9,11]),cb=p($),db=p([6,10,12]),eb=document.createElement("style"),fb=!1;try{eb.innerHTML="<b>x</b>",fb=3==eb.firstChild.nodeType}catch(gb){}a.features.htmlParsingConforms=fb;var hb=fb?function(a){var b=this.startContainer,c=P(b);if(!b)throw new L("INVALID_STATE_ERR");var d=null;return 1==b.nodeType?d=b:M(b)&&(d=I.parentElement(b)),d=null===d||"HTML"==d.nodeName&&I.isHtmlNamespace(P(d).documentElement)&&I.isHtmlNamespace(d)?c.createElement("body"):d.cloneNode(!1),d.innerHTML=a,I.fragmentFromNodeChildren(d)}:function(a){var b=c(this),d=b.createElement("body");return d.innerHTML=a,I.fragmentFromNodeChildren(d)},ib=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],jb=0,kb=1,lb=2,mb=3,nb=0,ob=1,pb=2,qb=3;J.extend(a.rangePrototype,{compareBoundaryPoints:function(a,b){y(this),t(this.startContainer,b.startContainer);var c,d,e,f,g=a==mb||a==jb?"start":"end",h=a==kb||a==jb?"start":"end";return c=this[g+"Container"],d=this[g+"Offset"],e=b[h+"Container"],f=b[h+"Offset"],Q(c,d,e,f)},insertNode:function(a){if(y(this),r(a,_),u(this.startContainer),O(a,this.startContainer))throw new L("HIERARCHY_REQUEST_ERR");var b=g(a,this.startContainer,this.startOffset);this.setStartBefore(b)},cloneContents:function(){y(this);var a,b;if(this.collapsed)return c(this).createDocumentFragment();if(this.startContainer===this.endContainer&&M(this.startContainer))return a=this.startContainer.cloneNode(!0),a.data=a.data.slice(this.startOffset,this.endOffset),b=c(this).createDocumentFragment(),b.appendChild(a),b;var d=new o(this,!0);return a=i(d),d.detach(),a},canSurroundContents:function(){y(this),u(this.startContainer),u(this.endContainer);var a=new o(this,!0),c=a._first&&b(a._first,this)||a._last&&b(a._last,this);return a.detach(),!c},surroundContents:function(a){if(r(a,ab),!this.canSurroundContents())throw new L("INVALID_STATE_ERR");var b=this.extractContents();if(a.hasChildNodes())for(;a.lastChild;)a.removeChild(a.lastChild);g(a,this.startContainer,this.startOffset),a.appendChild(b),this.selectNode(a)},cloneRange:function(){y(this);for(var a,b=new H(c(this)),d=ib.length;d--;)a=ib[d],b[a]=this[a];return b},toString:function(){y(this);var a=this.startContainer;if(a===this.endContainer&&M(a))return 3==a.nodeType||4==a.nodeType?a.data.slice(this.startOffset,this.endOffset):"";var b=[],c=new o(this,!0);return j(c,function(a){(3==a.nodeType||4==a.nodeType)&&b.push(a.data)}),c.detach(),b.join("")},compareNode:function(a){y(this);var b=a.parentNode,c=N(a);if(!b)throw new L("NOT_FOUND_ERR");var d=this.comparePoint(b,c),e=this.comparePoint(b,c+1);return 0>d?e>0?pb:nb:e>0?ob:qb},comparePoint:function(a,b){return y(this),v(a,"HIERARCHY_REQUEST_ERR"),t(a,this.startContainer),Q(a,b,this.startContainer,this.startOffset)<0?-1:Q(a,b,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:hb,toHtml:function(){return A(this)},intersectsNode:function(a,b){if(y(this),V(a)!=d(this))return!1;var c=a.parentNode,e=N(a);if(!c)return!0;var f=Q(c,e,this.endContainer,this.endOffset),g=Q(c,e+1,this.startContainer,this.startOffset);return b?0>=f&&g>=0:0>f&&g>0},isPointInRange:function(a,b){return y(this),v(a,"HIERARCHY_REQUEST_ERR"),t(a,this.startContainer),Q(a,b,this.startContainer,this.startOffset)>=0&&Q(a,b,this.endContainer,this.endOffset)<=0},intersectsRange:function(a){return h(this,a,!1)},intersectsOrTouchesRange:function(a){return h(this,a,!0)},intersection:function(a){if(this.intersectsRange(a)){var b=Q(this.startContainer,this.startOffset,a.startContainer,a.startOffset),c=Q(this.endContainer,this.endOffset,a.endContainer,a.endOffset),d=this.cloneRange();return-1==b&&d.setStart(a.startContainer,a.startOffset),1==c&&d.setEnd(a.endContainer,a.endOffset),d}return null},union:function(a){if(this.intersectsOrTouchesRange(a)){var b=this.cloneRange();return-1==Q(a.startContainer,a.startOffset,this.startContainer,this.startOffset)&&b.setStart(a.startContainer,a.startOffset),1==Q(a.endContainer,a.endOffset,this.endContainer,this.endOffset)&&b.setEnd(a.endContainer,a.endOffset),b}throw new L("Ranges do not intersect")},containsNode:function(a,b){return b?this.intersectsNode(a,!1):this.compareNode(a)==qb},containsNodeContents:function(a){return this.comparePoint(a,0)>=0&&this.comparePoint(a,T(a))<=0},containsRange:function(a){var b=this.intersection(a);return null!==b&&a.equals(b)},containsNodeText:function(a){var b=this.cloneRange();b.selectNode(a);var c=b.getNodes([3]);if(c.length>0){b.setStart(c[0],0);var d=c.pop();return b.setEnd(d,d.length),this.containsRange(b)}return this.containsNodeContents(a)},getNodes:function(a,b){return y(this),m(this,a,b)},getDocument:function(){return c(this)},collapseBefore:function(a){this.setEndBefore(a),this.collapse(!1)},collapseAfter:function(a){this.setStartAfter(a),this.collapse(!0)},getBookmark:function(b){var d=c(this),e=a.createRange(d);b=b||I.getBody(d),e.selectNodeContents(b);var f=this.intersection(e),g=0,h=0;return f&&(e.setEnd(f.startContainer,f.startOffset),g=e.toString().length,h=g+f.toString().length),{start:g,end:h,containerNode:b}},moveToBookmark:function(a){var b=a.containerNode,c=0;this.setStart(b,0),this.collapse(!0);for(var d,e,f,g,h=[b],i=!1,j=!1;!j&&(d=h.pop());)if(3==d.nodeType)e=c+d.length,!i&&a.start>=c&&a.start<=e&&(this.setStart(d,a.start-c),i=!0),i&&a.end>=c&&a.end<=e&&(this.setEnd(d,a.end-c),j=!0),c=e;else for(g=d.childNodes,f=g.length;f--;)h.push(g[f])},getName:function(){return"DomRange"},equals:function(a){return H.rangesEqual(this,a)},isValid:function(){return x(this)},inspect:function(){return n(this)},detach:function(){}}),E(H,G),J.extend(H,{rangeProperties:ib,RangeIterator:o,copyComparisonConstants:C,createPrototypeRange:E,inspect:n,toHtml:A,getRangeDocument:c,rangesEqual:function(a,b){return a.startContainer===b.startContainer&&a.startOffset===b.startOffset&&a.endContainer===b.endContainer&&a.endOffset===b.endOffset}}),a.DomRange=H}),I.createCoreModule("WrappedRange",["DomRange"],function(a,b){var c,d,e=a.dom,f=a.util,g=e.DomPosition,h=a.DomRange,i=e.getBody,j=e.getContentDocument,k=e.isCharacterDataNode;if(a.features.implementsDomRange&&!function(){function d(a){for(var b,c=m.length;c--;)b=m[c],a[b]=a.nativeRange[b];a.collapsed=a.startContainer===a.endContainer&&a.startOffset===a.endOffset}function g(a,b,c,d,e){var f=a.startContainer!==b||a.startOffset!=c,g=a.endContainer!==d||a.endOffset!=e,h=!a.equals(a.nativeRange);(f||g||h)&&(a.setEnd(d,e),a.setStart(b,c))}var k,l,m=h.rangeProperties;c=function(a){if(!a)throw b.createError("WrappedRange: Range must be specified");this.nativeRange=a,d(this)},h.createPrototypeRange(c,g),k=c.prototype,k.selectNode=function(a){this.nativeRange.selectNode(a),d(this)},k.cloneContents=function(){return this.nativeRange.cloneContents()},k.surroundContents=function(a){this.nativeRange.surroundContents(a),d(this)},k.collapse=function(a){this.nativeRange.collapse(a),d(this)},k.cloneRange=function(){return new c(this.nativeRange.cloneRange())},k.refresh=function(){d(this)},k.toString=function(){return this.nativeRange.toString()};var n=document.createTextNode("test");i(document).appendChild(n);var o=document.createRange();o.setStart(n,0),o.setEnd(n,0);try{o.setStart(n,1),k.setStart=function(a,b){this.nativeRange.setStart(a,b),d(this)
},k.setEnd=function(a,b){this.nativeRange.setEnd(a,b),d(this)},l=function(a){return function(b){this.nativeRange[a](b),d(this)}}}catch(p){k.setStart=function(a,b){try{this.nativeRange.setStart(a,b)}catch(c){this.nativeRange.setEnd(a,b),this.nativeRange.setStart(a,b)}d(this)},k.setEnd=function(a,b){try{this.nativeRange.setEnd(a,b)}catch(c){this.nativeRange.setStart(a,b),this.nativeRange.setEnd(a,b)}d(this)},l=function(a,b){return function(c){try{this.nativeRange[a](c)}catch(e){this.nativeRange[b](c),this.nativeRange[a](c)}d(this)}}}k.setStartBefore=l("setStartBefore","setEndBefore"),k.setStartAfter=l("setStartAfter","setEndAfter"),k.setEndBefore=l("setEndBefore","setStartBefore"),k.setEndAfter=l("setEndAfter","setStartAfter"),k.selectNodeContents=function(a){this.setStartAndEnd(a,0,e.getNodeLength(a))},o.selectNodeContents(n),o.setEnd(n,3);var q=document.createRange();q.selectNodeContents(n),q.setEnd(n,4),q.setStart(n,2),k.compareBoundaryPoints=-1==o.compareBoundaryPoints(o.START_TO_END,q)&&1==o.compareBoundaryPoints(o.END_TO_START,q)?function(a,b){return b=b.nativeRange||b,a==b.START_TO_END?a=b.END_TO_START:a==b.END_TO_START&&(a=b.START_TO_END),this.nativeRange.compareBoundaryPoints(a,b)}:function(a,b){return this.nativeRange.compareBoundaryPoints(a,b.nativeRange||b)};var r=document.createElement("div");r.innerHTML="123";var s=r.firstChild,t=i(document);t.appendChild(r),o.setStart(s,1),o.setEnd(s,2),o.deleteContents(),"13"==s.data&&(k.deleteContents=function(){this.nativeRange.deleteContents(),d(this)},k.extractContents=function(){var a=this.nativeRange.extractContents();return d(this),a}),t.removeChild(r),t=null,f.isHostMethod(o,"createContextualFragment")&&(k.createContextualFragment=function(a){return this.nativeRange.createContextualFragment(a)}),i(document).removeChild(n),k.getName=function(){return"WrappedRange"},a.WrappedRange=c,a.createNativeRange=function(a){return a=j(a,b,"createNativeRange"),a.createRange()}}(),a.features.implementsTextRange){var l=function(a){var b=a.parentElement(),c=a.duplicate();c.collapse(!0);var d=c.parentElement();c=a.duplicate(),c.collapse(!1);var f=c.parentElement(),g=d==f?d:e.getCommonAncestor(d,f);return g==b?g:e.getCommonAncestor(b,g)},m=function(a){return 0==a.compareEndPoints("StartToEnd",a)},n=function(a,b,c,d,f){var h=a.duplicate();h.collapse(c);var i=h.parentElement();if(e.isOrIsAncestorOf(b,i)||(i=b),!i.canHaveHTML){var j=new g(i.parentNode,e.getNodeIndex(i));return{boundaryPosition:j,nodeInfo:{nodeIndex:j.offset,containerElement:j.node}}}var l=e.getDocument(i).createElement("span");l.parentNode&&e.removeNode(l);for(var m,n,o,p,q,r=c?"StartToStart":"StartToEnd",s=f&&f.containerElement==i?f.nodeIndex:0,t=i.childNodes.length,u=t,v=u;;){if(v==t?i.appendChild(l):i.insertBefore(l,i.childNodes[v]),h.moveToElementText(l),m=h.compareEndPoints(r,a),0==m||s==u)break;if(-1==m){if(u==s+1)break;s=v}else u=u==s+1?s:v;v=Math.floor((s+u)/2),i.removeChild(l)}if(q=l.nextSibling,-1==m&&q&&k(q)){h.setEndPoint(c?"EndToStart":"EndToEnd",a);var w;if(/[\r\n]/.test(q.data)){var x=h.duplicate(),y=x.text.replace(/\r\n/g,"\r").length;for(w=x.moveStart("character",y);-1==(m=x.compareEndPoints("StartToEnd",x));)w++,x.moveStart("character",1)}else w=h.text.length;p=new g(q,w)}else n=(d||!c)&&l.previousSibling,o=(d||c)&&l.nextSibling,p=o&&k(o)?new g(o,0):n&&k(n)?new g(n,n.data.length):new g(i,e.getNodeIndex(l));return e.removeNode(l),{boundaryPosition:p,nodeInfo:{nodeIndex:v,containerElement:i}}},o=function(a,b){var c,d,f,g,h=a.offset,j=e.getDocument(a.node),l=i(j).createTextRange(),m=k(a.node);return m?(c=a.node,d=c.parentNode):(g=a.node.childNodes,c=h<g.length?g[h]:null,d=a.node),f=j.createElement("span"),f.innerHTML="&#feff;",c?d.insertBefore(f,c):d.appendChild(f),l.moveToElementText(f),l.collapse(!b),d.removeChild(f),m&&l[b?"moveStart":"moveEnd"]("character",h),l};d=function(a){this.textRange=a,this.refresh()},d.prototype=new h(document),d.prototype.refresh=function(){var a,b,c,d=l(this.textRange);m(this.textRange)?b=a=n(this.textRange,d,!0,!0).boundaryPosition:(c=n(this.textRange,d,!0,!1),a=c.boundaryPosition,b=n(this.textRange,d,!1,!1,c.nodeInfo).boundaryPosition),this.setStart(a.node,a.offset),this.setEnd(b.node,b.offset)},d.prototype.getName=function(){return"WrappedTextRange"},h.copyComparisonConstants(d);var p=function(a){if(a.collapsed)return o(new g(a.startContainer,a.startOffset),!0);var b=o(new g(a.startContainer,a.startOffset),!0),c=o(new g(a.endContainer,a.endOffset),!1),d=i(h.getRangeDocument(a)).createTextRange();return d.setEndPoint("StartToStart",b),d.setEndPoint("EndToEnd",c),d};if(d.rangeToTextRange=p,d.prototype.toTextRange=function(){return p(this)},a.WrappedTextRange=d,!a.features.implementsDomRange||a.config.preferTextRange){var q=function(a){return a("return this;")()}(Function);"undefined"==typeof q.Range&&(q.Range=d),a.createNativeRange=function(a){return a=j(a,b,"createNativeRange"),i(a).createTextRange()},a.WrappedRange=d}}a.createRange=function(c){return c=j(c,b,"createRange"),new a.WrappedRange(a.createNativeRange(c))},a.createRangyRange=function(a){return a=j(a,b,"createRangyRange"),new h(a)},f.createAliasForDeprecatedMethod(a,"createIframeRange","createRange"),f.createAliasForDeprecatedMethod(a,"createIframeRangyRange","createRangyRange"),a.addShimListener(function(b){var c=b.document;"undefined"==typeof c.createRange&&(c.createRange=function(){return a.createRange(c)}),c=b=null})}),I.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],function(a,b){function c(a){return"string"==typeof a?/^backward(s)?$/i.test(a):!!a}function d(a,c){if(a){if(C.isWindow(a))return a;if(a instanceof r)return a.win;var d=C.getContentDocument(a,b,c);return C.getWindow(d)}return window}function e(a){return d(a,"getWinSelection").getSelection()}function f(a){return d(a,"getDocSelection").document.selection}function g(a){var b=!1;return a.anchorNode&&(b=1==C.comparePoints(a.anchorNode,a.anchorOffset,a.focusNode,a.focusOffset)),b}function h(a,b,c){var d=c?"end":"start",e=c?"start":"end";a.anchorNode=b[d+"Container"],a.anchorOffset=b[d+"Offset"],a.focusNode=b[e+"Container"],a.focusOffset=b[e+"Offset"]}function i(a){var b=a.nativeSelection;a.anchorNode=b.anchorNode,a.anchorOffset=b.anchorOffset,a.focusNode=b.focusNode,a.focusOffset=b.focusOffset}function j(a){a.anchorNode=a.focusNode=null,a.anchorOffset=a.focusOffset=0,a.rangeCount=0,a.isCollapsed=!0,a._ranges.length=0}function k(b){var c;return b instanceof F?(c=a.createNativeRange(b.getDocument()),c.setEnd(b.endContainer,b.endOffset),c.setStart(b.startContainer,b.startOffset)):b instanceof G?c=b.nativeRange:J.implementsDomRange&&b instanceof C.getWindow(b.startContainer).Range&&(c=b),c}function l(a){if(!a.length||1!=a[0].nodeType)return!1;for(var b=1,c=a.length;c>b;++b)if(!C.isAncestorOf(a[0],a[b]))return!1;return!0}function m(a){var c=a.getNodes();if(!l(c))throw b.createError("getSingleElementFromRange: range "+a.inspect()+" did not consist of a single element");return c[0]}function n(a){return!!a&&"undefined"!=typeof a.text}function o(a,b){var c=new G(b);a._ranges=[c],h(a,c,!1),a.rangeCount=1,a.isCollapsed=c.collapsed}function p(b){if(b._ranges.length=0,"None"==b.docSelection.type)j(b);else{var c=b.docSelection.createRange();if(n(c))o(b,c);else{b.rangeCount=c.length;for(var d,e=L(c.item(0)),f=0;f<b.rangeCount;++f)d=a.createRange(e),d.selectNode(c.item(f)),b._ranges.push(d);b.isCollapsed=1==b.rangeCount&&b._ranges[0].collapsed,h(b,b._ranges[b.rangeCount-1],!1)}}}function q(a,c){for(var d=a.docSelection.createRange(),e=m(c),f=L(d.item(0)),g=M(f).createControlRange(),h=0,i=d.length;i>h;++h)g.add(d.item(h));try{g.add(e)}catch(j){throw b.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}g.select(),p(a)}function r(a,b,c){this.nativeSelection=a,this.docSelection=b,this._ranges=[],this.win=c,this.refresh()}function s(a){a.win=a.anchorNode=a.focusNode=a._ranges=null,a.rangeCount=a.anchorOffset=a.focusOffset=0,a.detached=!0}function t(a,b){for(var c,d,e=bb.length;e--;)if(c=bb[e],d=c.selection,"deleteAll"==b)s(d);else if(c.win==a)return"delete"==b?(bb.splice(e,1),!0):d;return"deleteAll"==b&&(bb.length=0),null}function u(a,c){for(var d,e=L(c[0].startContainer),f=M(e).createControlRange(),g=0,h=c.length;h>g;++g){d=m(c[g]);try{f.add(d)}catch(i){throw b.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)")}}f.select(),p(a)}function v(a,b){if(a.win.document!=L(b))throw new H("WRONG_DOCUMENT_ERR")}function w(b){return function(c,d){var e;this.rangeCount?(e=this.getRangeAt(0),e["set"+(b?"Start":"End")](c,d)):(e=a.createRange(this.win.document),e.setStartAndEnd(c,d)),this.setSingleRange(e,this.isBackward())}}function x(a){var b=[],c=new I(a.anchorNode,a.anchorOffset),d=new I(a.focusNode,a.focusOffset),e="function"==typeof a.getName?a.getName():"Selection";if("undefined"!=typeof a.rangeCount)for(var f=0,g=a.rangeCount;g>f;++f)b[f]=F.inspect(a.getRangeAt(f));return"["+e+"(Ranges: "+b.join(", ")+")(anchor: "+c.inspect()+", focus: "+d.inspect()+"]"}a.config.checkSelectionRanges=!0;var y,z,A="boolean",B="number",C=a.dom,D=a.util,E=D.isHostMethod,F=a.DomRange,G=a.WrappedRange,H=a.DOMException,I=C.DomPosition,J=a.features,K="Control",L=C.getDocument,M=C.getBody,N=F.rangesEqual,O=E(window,"getSelection"),P=D.isHostObject(document,"selection");J.implementsWinGetSelection=O,J.implementsDocSelection=P;var Q=P&&(!O||a.config.preferTextRange);if(Q)y=f,a.isSelectionValid=function(a){var b=d(a,"isSelectionValid").document,c=b.selection;return"None"!=c.type||L(c.createRange().parentElement())==b};else{if(!O)return b.fail("Neither document.selection or window.getSelection() detected."),!1;y=e,a.isSelectionValid=function(){return!0}}a.getNativeSelection=y;var R=y();if(!R)return b.fail("Native selection was null (possibly issue 138?)"),!1;var S=a.createNativeRange(document),T=M(document),U=D.areHostProperties(R,["anchorNode","focusNode","anchorOffset","focusOffset"]);J.selectionHasAnchorAndFocus=U;var V=E(R,"extend");J.selectionHasExtend=V;var W=_typeof(R.rangeCount)==B;J.selectionHasRangeCount=W;var X=/firefox/i.test(navigator.userAgent)?!0:!1,Y=!0,Z=V?function(b,c){var d=F.getRangeDocument(c),e=a.createRange(d);e.collapseToPoint(c.endContainer,c.endOffset),b.addRange(k(e)),b.extend(c.startContainer,c.startOffset)}:null;J.selectionSupportsMultipleRanges=X,J.collapsedNonEditableSelectionsSupported=Y;var $,_=!1;T&&E(T,"createControlRange")&&($=T.createControlRange(),D.areHostProperties($,["item","add"])&&(_=!0)),J.implementsControlRange=_,z=U?function(a){return a.anchorNode===a.focusNode&&a.anchorOffset===a.focusOffset}:function(a){return a.rangeCount?a.getRangeAt(a.rangeCount-1).collapsed:!1};var ab;E(R,"getRangeAt")?ab=function(a,b){try{return a.getRangeAt(b)}catch(c){return null}}:U&&(ab=function(b){var c=L(b.anchorNode),d=a.createRange(c);return d.setStartAndEnd(b.anchorNode,b.anchorOffset,b.focusNode,b.focusOffset),d.collapsed!==this.isCollapsed&&d.setStartAndEnd(b.focusNode,b.focusOffset,b.anchorNode,b.anchorOffset),d}),r.prototype=a.selectionPrototype;var bb=[],cb=function(a){if(a&&a instanceof r)return a.refresh(),a;a=d(a,"getNativeSelection");var b=t(a),c=y(a),e=P?f(a):null;return b?(b.nativeSelection=c,b.docSelection=e,b.refresh()):(b=new r(c,e,a),bb.push({win:a,selection:b})),b};a.getSelection=cb,D.createAliasForDeprecatedMethod(a,"getIframeSelection","getSelection");var db=r.prototype;if(!Q&&U&&D.areHostMethods(R,["removeAllRanges","addRange"])){db.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),j(this)};var eb=function(a,b){Z(a.nativeSelection,b),a.refresh()};db.addRange=W?function(b,d){if(_&&P&&this.docSelection.type==K)q(this,b);else if(c(d)&&V)eb(this,b);else{var e;X?e=this.rangeCount:(this.removeAllRanges(),e=0);var f=k(b).cloneRange();try{this.nativeSelection.addRange(f)}catch(g){}if(this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==e+1){if(a.config.checkSelectionRanges){var i=ab(this.nativeSelection,this.rangeCount-1);i&&!N(i,b)&&(b=new G(i))}this._ranges[this.rangeCount-1]=b,h(this,b,hb(this.nativeSelection)),this.isCollapsed=z(this)}else this.refresh()}}:function(a,b){c(b)&&V?eb(this,a):(this.nativeSelection.addRange(k(a)),this.refresh())},db.setRanges=function(a){if(_&&P&&a.length>1)u(this,a);else{this.removeAllRanges();for(var b=0,c=a.length;c>b;++b)this.addRange(a[b])}}}else{if(!(E(R,"empty")&&E(S,"select")&&_&&Q))return b.fail("No means of selecting a Range or TextRange was found"),!1;db.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=this.docSelection.type){var a;if(this.anchorNode)a=L(this.anchorNode);else if(this.docSelection.type==K){var b=this.docSelection.createRange();b.length&&(a=L(b.item(0)))}if(a){var c=M(a).createTextRange();c.select(),this.docSelection.empty()}}}catch(d){}j(this)},db.addRange=function(b){this.docSelection.type==K?q(this,b):(a.WrappedTextRange.rangeToTextRange(b).select(),this._ranges[0]=b,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,h(this,b,!1))},db.setRanges=function(a){this.removeAllRanges();var b=a.length;b>1?u(this,a):b&&this.addRange(a[0])}}db.getRangeAt=function(a){if(0>a||a>=this.rangeCount)throw new H("INDEX_SIZE_ERR");return this._ranges[a].cloneRange()};var fb;if(Q)fb=function(b){var c;a.isSelectionValid(b.win)?c=b.docSelection.createRange():(c=M(b.win.document).createTextRange(),c.collapse(!0)),b.docSelection.type==K?p(b):n(c)?o(b,c):j(b)};else if(E(R,"getRangeAt")&&_typeof(R.rangeCount)==B)fb=function(b){if(_&&P&&b.docSelection.type==K)p(b);else if(b._ranges.length=b.rangeCount=b.nativeSelection.rangeCount,b.rangeCount){for(var c=0,d=b.rangeCount;d>c;++c)b._ranges[c]=new a.WrappedRange(b.nativeSelection.getRangeAt(c));h(b,b._ranges[b.rangeCount-1],hb(b.nativeSelection)),b.isCollapsed=z(b)}else j(b)};else{if(!U||_typeof(R.isCollapsed)!=A||_typeof(S.collapsed)!=A||!J.implementsDomRange)return b.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;fb=function(a){var b,c=a.nativeSelection;c.anchorNode?(b=ab(c,0),a._ranges=[b],a.rangeCount=1,i(a),a.isCollapsed=z(a)):j(a)}}db.refresh=function(a){var b=a?this._ranges.slice(0):null,c=this.anchorNode,d=this.anchorOffset;if(fb(this),a){var e=b.length;if(e!=this._ranges.length)return!0;if(this.anchorNode!=c||this.anchorOffset!=d)return!0;for(;e--;)if(!N(b[e],this._ranges[e]))return!0;return!1}};var gb=function(a,b){var c=a.getAllRanges();a.removeAllRanges();for(var d=0,e=c.length;e>d;++d)N(b,c[d])||a.addRange(c[d]);a.rangeCount||j(a)};db.removeRange=_&&P?function(a){if(this.docSelection.type==K){for(var b,c=this.docSelection.createRange(),d=m(a),e=L(c.item(0)),f=M(e).createControlRange(),g=!1,h=0,i=c.length;i>h;++h)b=c.item(h),b!==d||g?f.add(c.item(h)):g=!0;f.select(),p(this)}else gb(this,a)}:function(a){gb(this,a)};var hb;!Q&&U&&J.implementsDomRange?(hb=g,db.isBackward=function(){return hb(this)}):hb=db.isBackward=function(){return!1},db.isBackwards=db.isBackward,db.toString=function(){for(var a=[],b=0,c=this.rangeCount;c>b;++b)a[b]=""+this._ranges[b];return a.join("")},db.collapse=function(b,c){v(this,b);var d=a.createRange(b);d.collapseToPoint(b,c),this.setSingleRange(d),this.isCollapsed=!0},db.collapseToStart=function(){if(!this.rangeCount)throw new H("INVALID_STATE_ERR");var a=this._ranges[0];this.collapse(a.startContainer,a.startOffset)},db.collapseToEnd=function(){if(!this.rangeCount)throw new H("INVALID_STATE_ERR");var a=this._ranges[this.rangeCount-1];this.collapse(a.endContainer,a.endOffset)},db.selectAllChildren=function(b){v(this,b);var c=a.createRange(b);c.selectNodeContents(b),this.setSingleRange(c)},db.deleteFromDocument=function(){if(_&&P&&this.docSelection.type==K){for(var a,b=this.docSelection.createRange();b.length;)a=b.item(0),b.remove(a),C.removeNode(a);this.refresh()}else if(this.rangeCount){var c=this.getAllRanges();if(c.length){this.removeAllRanges();for(var d=0,e=c.length;e>d;++d)c[d].deleteContents();this.addRange(c[e-1])}}},db.eachRange=function(a,b){for(var c=0,d=this._ranges.length;d>c;++c)if(a(this.getRangeAt(c)))return b},db.getAllRanges=function(){var a=[];return this.eachRange(function(b){a.push(b)}),a},db.setSingleRange=function(a,b){this.removeAllRanges(),this.addRange(a,b)},db.callMethodOnEachRange=function(a,b){var c=[];return this.eachRange(function(d){c.push(d[a].apply(d,b||[]))}),c},db.setStart=w(!0),db.setEnd=w(!1),a.rangePrototype.select=function(a){cb(this.getDocument()).setSingleRange(this,a)},db.changeEachRange=function(a){var b=[],c=this.isBackward();this.eachRange(function(c){a(c),b.push(c)}),this.removeAllRanges(),c&&1==b.length?this.addRange(b[0],"backward"):this.setRanges(b)},db.containsNode=function(a,b){return this.eachRange(function(c){return c.containsNode(a,b)},!0)||!1},db.getBookmark=function(a){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[a])}},db.moveToBookmark=function(b){for(var c,d,e=[],f=0;c=b.rangeBookmarks[f++];)d=a.createRange(this.win),d.moveToBookmark(c),e.push(d);b.backward?this.setSingleRange(e[0],"backward"):this.setRanges(e)},db.saveRanges=function(){return{backward:this.isBackward(),ranges:this.callMethodOnEachRange("cloneRange")}},db.restoreRanges=function(a){this.removeAllRanges();for(var b,c=0;b=a.ranges[c];++c)this.addRange(b,a.backward&&0==c)},db.toHtml=function(){var a=[];return this.eachRange(function(b){a.push(F.toHtml(b))}),a.join("")},J.implementsTextRange&&(db.getNativeTextRange=function(){var c;if(c=this.docSelection){var d=c.createRange();if(n(d))return d;throw b.createError("getNativeTextRange: selection is a control selection")}if(this.rangeCount>0)return a.WrappedTextRange.rangeToTextRange(this.getRangeAt(0));throw b.createError("getNativeTextRange: selection contains no range")}),db.getName=function(){return"WrappedSelection"},db.inspect=function(){return x(this)},db.detach=function(){t(this.win,"delete"),s(this)},r.detachAll=function(){t(null,"deleteAll")},r.inspect=x,r.isDirectionBackward=c,a.Selection=r,a.selectionPrototype=db,a.addShimListener(function(a){"undefined"==typeof a.getSelection&&(a.getSelection=function(){return cb(a)}),a=null})});var N=!1,O=function(){N||(N=!0,!I.initialized&&I.config.autoInitialize&&m())};G&&("complete"==document.readyState?O():(b(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",O,!1),K(window,"load",O))),a.rangy=I}(this),function(a){return a.createModule("SaveRestore",["WrappedRange"],function(a,b){function c(a,b){return(b||document).getElementById(a)}function d(a,b){var c,d="selectionBoundary_"+ +new Date+"_"+(""+Math.random()).slice(2),e=o.getDocument(a.startContainer),f=a.cloneRange();return f.collapse(b),c=e.createElement("span"),c.id=d,c.style.lineHeight="0",c.style.display="none",c.className="rangySelectionBoundary",c.appendChild(e.createTextNode(r)),f.insertNode(c),c}function e(a,d,e,f){var g=c(e,a);g?(d[f?"setStartBefore":"setEndBefore"](g),p(g)):b.warn("Marker element has been removed. Cannot restore selection.")}function f(a,b){return b.compareBoundaryPoints(a.START_TO_START,a)}function g(b,c){var e,f,g=a.DomRange.getRangeDocument(b),h=b.toString(),i=q(c);return b.collapsed?(f=d(b,!1),{document:g,markerId:f.id,collapsed:!0}):(f=d(b,!1),e=d(b,!0),{document:g,startMarkerId:e.id,endMarkerId:f.id,collapsed:!1,backward:i,toString:function(){return"original text: '"+h+"', new text: '"+b.toString()+"'"}})}function h(d,f){var g=d.document;"undefined"==typeof f&&(f=!0);var h=a.createRange(g);if(d.collapsed){var i=c(d.markerId,g);if(i){i.style.display="inline";var j=i.previousSibling;j&&3==j.nodeType?(p(i),h.collapseToPoint(j,j.length)):(h.collapseBefore(i),p(i))}else b.warn("Marker element has been removed. Cannot restore selection.")}else e(g,h,d.startMarkerId,!0),e(g,h,d.endMarkerId,!1);return f&&h.normalizeBoundaries(),h}function i(b,d){var e,h,i=[],j=q(d);b=b.slice(0),b.sort(f);for(var k=0,l=b.length;l>k;++k)i[k]=g(b[k],j);for(k=l-1;k>=0;--k)e=b[k],h=a.DomRange.getRangeDocument(e),e.collapsed?e.collapseAfter(c(i[k].markerId,h)):(e.setEndBefore(c(i[k].endMarkerId,h)),e.setStartAfter(c(i[k].startMarkerId,h)));return i}function j(c){if(!a.isSelectionValid(c))return b.warn("Cannot save selection. This usually happens when the selection is collapsed and the selection document has lost focus."),null;var d=a.getSelection(c),e=d.getAllRanges(),f=1==e.length&&d.isBackward(),g=i(e,f);return f?d.setSingleRange(e[0],f):d.setRanges(e),{win:c,rangeInfos:g,restored:!1}}function k(a){for(var b=[],c=a.length,d=c-1;d>=0;d--)b[d]=h(a[d],!0);return b}function l(b,c){if(!b.restored){var d=b.rangeInfos,e=a.getSelection(b.win),f=k(d),g=d.length;1==g&&c&&a.features.selectionHasExtend&&d[0].backward?(e.removeAllRanges(),e.addRange(f[0],!0)):e.setRanges(f),b.restored=!0}}function m(a,b){var d=c(b,a);d&&p(d)}function n(a){for(var b,c=a.rangeInfos,d=0,e=c.length;e>d;++d)b=c[d],b.collapsed?m(a.doc,b.markerId):(m(a.doc,b.startMarkerId),m(a.doc,b.endMarkerId))}var o=a.dom,p=o.removeNode,q=a.Selection.isDirectionBackward,r="ï»¿";a.util.extend(a,{saveRange:g,restoreRange:h,saveRanges:i,restoreRanges:k,saveSelection:j,restoreSelection:l,removeMarkerElement:m,removeMarkers:n})}),a}(this.rangy),function(a){return a.createModule("TextRange",["WrappedSelection"],function(a,b){function c(a,b){function c(a,b,c){h.push({start:a,end:b,isWord:c})}for(var d,e,f,g=a.join(""),h=[],i=0;d=b.wordRegex.exec(g);){if(e=d.index,f=e+d[0].length,e>i&&c(i,e,!1),b.includeTrailingSpace)for(;_.test(a[f]);)++f;c(e,f,!0),i=f}return i<a.length&&c(i,a.length,!1),h}function d(a,b){for(var c=a.slice(b.start,b.end),d={isWord:b.isWord,chars:c,toString:function(){return c.join("")}},e=0,f=c.length;f>e;++e)c[e].token=d;return d}function e(a,b,c){for(var e,f=c(a,b),g=[],h=0;e=f[h++];)g.push(d(a,e));return g}function f(a){var b=a||"",c="string"==typeof b?b.split(""):b;return c.sort(function(a,b){return a.charCodeAt(0)-b.charCodeAt(0)}),c.join("").replace(/(.)\1+/g,"$1")}function g(a){var b,c;return a?(b=a.language||ab,c={},V(c,hb[b]||hb[ab]),V(c,a),c):hb[ab]}function h(a,b){var c=W(a,b);return b.hasOwnProperty("wordOptions")&&(c.wordOptions=g(c.wordOptions)),b.hasOwnProperty("characterOptions")&&(c.characterOptions=W(c.characterOptions,fb)),c}function i(a,b){var c=mb(a,"display",b),d=a.tagName.toLowerCase();return"block"==c&&P&&nb.hasOwnProperty(d)?nb[d]:c}function j(a){for(var b=o(a),c=0,d=b.length;d>c;++c)if(1==b[c].nodeType&&"none"==i(b[c]))return!0;return!1}function k(a){var b;return 3==a.nodeType&&(b=a.parentNode)&&"hidden"==mb(b,"visibility")}function l(a){return a&&(1==a.nodeType&&!/^(inline(-block|-table)?|none)$/.test(i(a))||9==a.nodeType||11==a.nodeType)}function m(a){return T.isCharacterDataNode(a)||!/^(area|base|basefont|br|col|frame|hr|img|input|isindex|link|meta|param)$/i.test(a.nodeName)}function n(a){for(var b=[];a.parentNode;)b.unshift(a.parentNode),a=a.parentNode;return b}function o(a){return n(a).concat([a])}function p(a){for(;a&&!a.nextSibling;)a=a.parentNode;return a?a.nextSibling:null}function q(a,b){return!b&&a.hasChildNodes()?a.firstChild:p(a)}function r(a){var b=a.previousSibling;if(b){for(a=b;a.hasChildNodes();)a=a.lastChild;return a}var c=a.parentNode;return c&&1==c.nodeType?c:null}function s(a){if(!a||3!=a.nodeType)return!1;var b=a.data;if(""===b)return!0;var c=a.parentNode;if(!c||1!=c.nodeType)return!1;var d=mb(a.parentNode,"whiteSpace");return/^[\t\n\r ]+$/.test(b)&&/^(normal|nowrap)$/.test(d)||/^[\t\r ]+$/.test(b)&&"pre-line"==d}function t(a){if(""===a.data)return!0;if(!s(a))return!1;var b=a.parentNode;return b?j(a)?!0:!1:!0}function u(a){var b=a.nodeType;return 7==b||8==b||j(a)||/^(script|style)$/i.test(a.nodeName)||k(a)||t(a)}function v(a,b){var c=a.nodeType;return 7==c||8==c||1==c&&"none"==i(a,b)}function w(){this.store={}}function x(a,b,c){return function(d){var e=this.cache;if(e.hasOwnProperty(a))return ob++,e[a];pb++;var f=b.call(this,c?this[c]:this,d);return e[a]=f,f}}function y(a,b){this.node=a,this.session=b,this.cache=new w,this.positions=new w}function z(a,b){this.offset=b,this.nodeWrapper=a,this.node=a.node,this.session=a.session,this.cache=new w}function A(){return"[Position("+T.inspectNode(this.node)+":"+this.offset+")]"}function B(){return D(),Cb=new Db}function C(){return Cb||B()}function D(){Cb&&Cb.detach(),Cb=null}function E(a,c,d,e){function f(){var a=null;return c?(a=h,i||(h=h.previousVisible(),i=!h||d&&h.equals(d))):i||(a=h=h.nextVisible(),i=!h||d&&h.equals(d)),i&&(h=null),a}d&&(c?u(d.node)&&(d=a.previousVisible()):u(d.node)&&(d=d.nextVisible()));var g,h=a,i=!1,j=!1;return{next:function(){if(j)return j=!1,g;for(var a,b;a=f();)if(b=a.getCharacter(e))return g=a,a;return null},rewind:function(){if(!g)throw b.createError("createCharacterIterator: cannot rewind. Only one position can be rewound.");j=!0},dispose:function(){a=d=null}}}function F(a,b,c){function d(a){for(var b,c,d=[],e=a?f:g,h=!1,i=!1;b=e.next();){if(c=b.character,$.test(c))i&&(i=!1,h=!0);else{if(h){e.rewind();break}i=!0}d.push(b)}return d}var f=E(a,!1,null,b),g=E(a,!0,null,b),h=c.tokenizer,i=d(!0),j=d(!1).reverse(),k=e(j.concat(i),c,h),l=i.length?k.slice(Eb(k,i[0].token)):[],m=j.length?k.slice(0,Eb(k,j.pop().token)+1):[];return{nextEndToken:function(){for(var a,b;1==l.length&&!(a=l[0]).isWord&&(b=d(!0)).length>0;)l=e(a.chars.concat(b),c,h);return l.shift()},previousStartToken:function(){for(var a,b;1==m.length&&!(a=m[0]).isWord&&(b=d(!1)).length>0;)m=e(b.reverse().concat(a.chars),c,h);return m.pop()},dispose:function(){f.dispose(),g.dispose(),l=m=null}}}function G(a,b,c,d,e){var f,g,h,i,j=0,k=a,l=Math.abs(c);if(0!==c){var m=0>c;switch(b){case R:for(g=E(a,m,null,d);(f=g.next())&&l>j;)++j,k=f;h=f,g.dispose();break;case S:for(var n=F(a,d,e),o=m?n.previousStartToken:n.nextEndToken;(i=o())&&l>j;)i.isWord&&(++j,k=m?i.chars[0]:i.chars[i.chars.length-1]);break;default:throw new Error("movePositionBy: unit '"+b+"' not implemented")}m?(k=k.previousVisible(),j=-j):k&&k.isLeadingSpace&&!k.isTrailingSpace&&(b==S&&(g=E(a,!1,null,d),h=g.next(),g.dispose()),h&&(k=h.previousVisible()))}return{position:k,unitsMoved:j}}function H(a,b,c,d){var e=a.getRangeBoundaryPosition(b,!0),f=a.getRangeBoundaryPosition(b,!1),g=d?f:e,h=d?e:f;return E(g,!!d,h,c)}function I(a,b,c){for(var d,e=[],f=H(a,b,c);d=f.next();)e.push(d);return f.dispose(),e}function J(b,c,d){var e=a.createRange(b.node);return e.setStartAndEnd(b.node,b.offset,c.node,c.offset),!e.expand("word",{wordOptions:d})}function K(a,b,c,d,e){function f(a,b){var c=p[a].previousVisible(),d=p[b-1],f=!e.wholeWordsOnly||J(c,d,e.wordOptions);return{startPos:c,endPos:d,valid:f}}for(var g,h,i,j,k,l,m=bb(e.direction),n=E(a,m,a.session.getRangeBoundaryPosition(d,m),e.characterOptions),o="",p=[],q=null;g=n.next();)if(h=g.character,c||e.caseSensitive||(h=h.toLowerCase()),m?(p.unshift(g),o=h+o):(p.push(g),o+=h),c){if(k=b.exec(o))if(i=k.index,j=i+k[0].length,l){if(!m&&j<o.length||m&&i>0){q=f(i,j);break}}else l=!0}else if(-1!=(i=o.indexOf(b))){q=f(i,i+b.length);break}return l&&(q=f(i,j)),n.dispose(),q}function L(a){return function(){var b=!!Cb,c=C(),d=[c].concat(U.toArray(arguments)),e=a.apply(this,d);return b||D(),e}}function M(a,b){return L(function(c,d,e,f){("undefined"==typeof e?"undefined":_typeof(e))==Q&&(e=d,d=R),f=h(f,jb);var g=a;b&&(g=e>=0,this.collapse(!g));var i=G(c.getRangeBoundaryPosition(this,g),d,e,f.characterOptions,f.wordOptions),j=i.position;return this[g?"setStart":"setEnd"](j.node,j.offset),i.unitsMoved})}function N(a){return L(function(b,c){c=W(c,fb);for(var d,e=H(b,this,c,!a),f=0;(d=e.next())&&$.test(d.character);)++f;e.dispose();var g=f>0;return g&&this[a?"moveStart":"moveEnd"]("character",a?f:-f,{characterOptions:c}),g})}function O(a){return L(function(b,c){var d=!1;return this.changeEachRange(function(b){d=b[a](c)||d}),d})}var P,Q="undefined",R="character",S="word",T=a.dom,U=a.util,V=U.extend,W=U.createOptions,X=T.getBody,Y=/^[ \t\f\r\n]+$/,Z=/^[ \t\f\r]+$/,$=/^[\t-\r \u0085\u00A0\u1680\u180E\u2000-\u200B\u2028\u2029\u202F\u205F\u3000]+$/,_=/^[\t \u00A0\u1680\u180E\u2000-\u200B\u202F\u205F\u3000]+$/,ab="en",bb=a.Selection.isDirectionBackward,cb=(/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor)?!0:!1,!1),db=!1,eb=!0,fb={includeBlockContentTrailingSpace:!0,includeSpaceBeforeBr:!0,includeSpaceBeforeBlock:!0,includePreLineTrailingSpace:!0,ignoreCharacters:""},gb={includeBlockContentTrailingSpace:!eb,includeSpaceBeforeBr:!cb,includeSpaceBeforeBlock:!db,includePreLineTrailingSpace:!0},hb={en:{wordRegex:/[a-z0-9]+('[a-z0-9]+)*/gi,includeTrailingSpace:!1,tokenizer:c}},ib={caseSensitive:!1,withinRange:null,wholeWordsOnly:!1,wrap:!1,direction:"forward",wordOptions:null,characterOptions:null},jb={wordOptions:null,characterOptions:null},kb={wordOptions:null,characterOptions:null,trim:!1,trimStart:!0,trimEnd:!0},lb={wordOptions:null,characterOptions:null,direction:"forward"},mb=T.getComputedStyleProperty;!function(){var a=document.createElement("table"),b=X(document);b.appendChild(a),P="block"==mb(a,"display"),b.removeChild(a)}();var nb={table:"table",caption:"table-caption",colgroup:"table-column-group",col:"table-column",thead:"table-header-group",tbody:"table-row-group",tfoot:"table-footer-group",tr:"table-row",td:"table-cell",th:"table-cell"};w.prototype={get:function(a){return this.store.hasOwnProperty(a)?this.store[a]:null},set:function(a,b){return this.store[a]=b}};var ob=0,pb=0,qb={getPosition:function(a){var b=this.positions;return b.get(a)||b.set(a,new z(this,a))},toString:function(){return"[NodeWrapper("+T.inspectNode(this.node)+")]"}};y.prototype=qb;var rb="EMPTY",sb="NON_SPACE",tb="UNCOLLAPSIBLE_SPACE",ub="COLLAPSIBLE_SPACE",vb="TRAILING_SPACE_BEFORE_BLOCK",wb="TRAILING_SPACE_IN_BLOCK",xb="TRAILING_SPACE_BEFORE_BR",yb="PRE_LINE_TRAILING_SPACE_BEFORE_LINE_BREAK",zb="TRAILING_LINE_BREAK_AFTER_BR",Ab="INCLUDED_TRAILING_LINE_BREAK_AFTER_BR";V(qb,{isCharacterDataNode:x("isCharacterDataNode",T.isCharacterDataNode,"node"),getNodeIndex:x("nodeIndex",T.getNodeIndex,"node"),getLength:x("nodeLength",T.getNodeLength,"node"),containsPositions:x("containsPositions",m,"node"),isWhitespace:x("isWhitespace",s,"node"),isCollapsedWhitespace:x("isCollapsedWhitespace",t,"node"),getComputedDisplay:x("computedDisplay",i,"node"),isCollapsed:x("collapsed",u,"node"),isIgnored:x("ignored",v,"node"),next:x("nextPos",q,"node"),previous:x("previous",r,"node"),getTextNodeInfo:x("textNodeInfo",function(a){var b=null,c=!1,d=mb(a.parentNode,"whiteSpace"),e="pre-line"==d;return e?(b=Z,c=!0):("normal"==d||"nowrap"==d)&&(b=Y,c=!0),{node:a,text:a.data,spaceRegex:b,collapseSpaces:c,preLine:e}},"node"),hasInnerText:x("hasInnerText",function(a,b){for(var c=this.session,d=c.getPosition(a.parentNode,this.getNodeIndex()+1),e=c.getPosition(a,0),f=b?d:e,g=b?e:d;f!==g;){if(f.prepopulateChar(),f.isDefinitelyNonEmpty())return!0;f=b?f.previousVisible():f.nextVisible()}return!1},"node"),isRenderedBlock:x("isRenderedBlock",function(a){for(var b=a.getElementsByTagName("br"),c=0,d=b.length;d>c;++c)if(!u(b[c]))return!0;return this.hasInnerText()},"node"),getTrailingSpace:x("trailingSpace",function(a){if("br"==a.tagName.toLowerCase())return"";switch(this.getComputedDisplay()){case"inline":for(var b=a.lastChild;b;){if(!v(b))return 1==b.nodeType?this.session.getNodeWrapper(b).getTrailingSpace():"";b=b.previousSibling}break;case"inline-block":case"inline-table":case"none":case"table-column":case"table-column-group":break;case"table-cell":return"	";default:return this.isRenderedBlock(!0)?"\n":""}return""},"node"),getLeadingSpace:x("leadingSpace",function(){switch(this.getComputedDisplay()){case"inline":case"inline-block":case"inline-table":case"none":case"table-column":case"table-column-group":case"table-cell":break;default:return this.isRenderedBlock(!1)?"\n":""}return""},"node")});var Bb={character:"",characterType:rb,isBr:!1,prepopulateChar:function(){var a=this;if(!a.prepopulatedChar){var b=a.node,c=a.offset,d="",e=rb,f=!1;
if(c>0)if(3==b.nodeType){var g=b.data,h=g.charAt(c-1),i=a.nodeWrapper.getTextNodeInfo(),j=i.spaceRegex;i.collapseSpaces?j.test(h)?c>1&&j.test(g.charAt(c-2))||(i.preLine&&"\n"===g.charAt(c)?(d=" ",e=yb):(d=" ",e=ub)):(d=h,e=sb,f=!0):(d=h,e=tb,f=!0)}else{var k=b.childNodes[c-1];if(k&&1==k.nodeType&&!u(k)&&("br"==k.tagName.toLowerCase()?(d="\n",a.isBr=!0,e=ub,f=!1):a.checkForTrailingSpace=!0),!d){var l=b.childNodes[c];l&&1==l.nodeType&&!u(l)&&(a.checkForLeadingSpace=!0)}}a.prepopulatedChar=!0,a.character=d,a.characterType=e,a.isCharInvariant=f}},isDefinitelyNonEmpty:function(){var a=this.characterType;return a==sb||a==tb},resolveLeadingAndTrailingSpaces:function(){if(this.prepopulatedChar||this.prepopulateChar(),this.checkForTrailingSpace){var a=this.session.getNodeWrapper(this.node.childNodes[this.offset-1]).getTrailingSpace();a&&(this.isTrailingSpace=!0,this.character=a,this.characterType=ub),this.checkForTrailingSpace=!1}if(this.checkForLeadingSpace){var b=this.session.getNodeWrapper(this.node.childNodes[this.offset]).getLeadingSpace();b&&(this.isLeadingSpace=!0,this.character=b,this.characterType=ub),this.checkForLeadingSpace=!1}},getPrecedingUncollapsedPosition:function(a){for(var b,c=this;c=c.previousVisible();)if(b=c.getCharacter(a),""!==b)return c;return null},getCharacter:function(a){function b(){return n||(k=o.getPrecedingUncollapsedPosition(a),n=!0),k}this.resolveLeadingAndTrailingSpaces();var c,d=this.character,e=f(a.ignoreCharacters),g=""!==d&&e.indexOf(d)>-1;if(this.isCharInvariant)return c=g?"":d;var h=["character",a.includeSpaceBeforeBr,a.includeBlockContentTrailingSpace,a.includePreLineTrailingSpace,e].join("_"),i=this.cache.get(h);if(null!==i)return i;var j,k,l="",m=this.characterType==ub,n=!1,o=this;return m&&(this.type==Ab?l="\n":" "==d&&(!b()||k.isTrailingSpace||"\n"==k.character||" "==k.character&&k.characterType==ub)||("\n"==d&&this.isLeadingSpace?b()&&"\n"!=k.character&&(l="\n"):(j=this.nextUncollapsed(),j&&(j.isBr?this.type=xb:j.isTrailingSpace&&"\n"==j.character?this.type=wb:j.isLeadingSpace&&"\n"==j.character&&(this.type=vb),"\n"==j.character?(this.type!=xb||a.includeSpaceBeforeBr)&&(this.type!=vb||a.includeSpaceBeforeBlock)&&(this.type==wb&&j.isTrailingSpace&&!a.includeBlockContentTrailingSpace||(this.type!=yb||j.type!=sb||a.includePreLineTrailingSpace)&&("\n"==d?j.isTrailingSpace?this.isTrailingSpace||this.isBr&&(j.type=zb,b()&&k.isLeadingSpace&&!k.isTrailingSpace&&"\n"==k.character?j.character="":j.type=Ab):l="\n":" "==d&&(l=" "))):l=d)))),e.indexOf(l)>-1&&(l=""),this.cache.set(h,l),l},equals:function(a){return!!a&&this.node===a.node&&this.offset===a.offset},inspect:A,toString:function(){return this.character}};z.prototype=Bb,V(Bb,{next:x("nextPos",function(a){var b=a.nodeWrapper,c=a.node,d=a.offset,e=b.session;if(!c)return null;var f,g,h;return d==b.getLength()?(f=c.parentNode,g=f?b.getNodeIndex()+1:0):b.isCharacterDataNode()?(f=c,g=d+1):(h=c.childNodes[d],e.getNodeWrapper(h).containsPositions()?(f=h,g=0):(f=c,g=d+1)),f?e.getPosition(f,g):null}),previous:x("previous",function(a){var b,c,d,e=a.nodeWrapper,f=a.node,g=a.offset,h=e.session;return 0==g?(b=f.parentNode,c=b?e.getNodeIndex():0):e.isCharacterDataNode()?(b=f,c=g-1):(d=f.childNodes[g-1],h.getNodeWrapper(d).containsPositions()?(b=d,c=T.getNodeLength(d)):(b=f,c=g-1)),b?h.getPosition(b,c):null}),nextVisible:x("nextVisible",function(a){var b=a.next();if(!b)return null;var c=b.nodeWrapper,d=b.node,e=b;return c.isCollapsed()&&(e=c.session.getPosition(d.parentNode,c.getNodeIndex()+1)),e}),nextUncollapsed:x("nextUncollapsed",function(a){for(var b=a;b=b.nextVisible();)if(b.resolveLeadingAndTrailingSpaces(),""!==b.character)return b;return null}),previousVisible:x("previousVisible",function(a){var b=a.previous();if(!b)return null;var c=b.nodeWrapper,d=b.node,e=b;return c.isCollapsed()&&(e=c.session.getPosition(d.parentNode,c.getNodeIndex())),e})});var Cb=null,Db=function(){function a(a){var b=new w;return{get:function(c){var d=b.get(c[a]);if(d)for(var e,f=0;e=d[f++];)if(e.node===c)return e;return null},set:function(c){var d=c.node[a],e=b.get(d)||b.set(d,[]);e.push(c)}}}function b(){this.initCaches()}var c=U.isHostProperty(document.documentElement,"uniqueID");return b.prototype={initCaches:function(){this.elementCache=c?function(){var a=new w;return{get:function(b){return a.get(b.uniqueID)},set:function(b){a.set(b.node.uniqueID,b)}}}():a("tagName"),this.textNodeCache=a("data"),this.otherNodeCache=a("nodeName")},getNodeWrapper:function(a){var b;switch(a.nodeType){case 1:b=this.elementCache;break;case 3:b=this.textNodeCache;break;default:b=this.otherNodeCache}var c=b.get(a);return c||(c=new y(a,this),b.set(c)),c},getPosition:function(a,b){return this.getNodeWrapper(a).getPosition(b)},getRangeBoundaryPosition:function(a,b){var c=b?"start":"end";return this.getPosition(a[c+"Container"],a[c+"Offset"])},detach:function(){this.elementCache=this.textNodeCache=this.otherNodeCache=null}},b}();V(T,{nextNode:q,previousNode:r});var Eb=Array.prototype.indexOf?function(a,b){return a.indexOf(b)}:function(a,b){for(var c=0,d=a.length;d>c;++c)if(a[c]===b)return c;return-1};V(a.rangePrototype,{moveStart:M(!0,!1),moveEnd:M(!1,!1),move:M(!0,!0),trimStart:N(!0),trimEnd:N(!1),trim:L(function(a,b){var c=this.trimStart(b),d=this.trimEnd(b);return c||d}),expand:L(function(a,b,c){var d=!1;c=h(c,kb);var e=c.characterOptions;if(b||(b=R),b==S){var f,g,i=c.wordOptions,j=a.getRangeBoundaryPosition(this,!0),k=a.getRangeBoundaryPosition(this,!1),l=F(j,e,i),m=l.nextEndToken(),n=m.chars[0].previousVisible();if(this.collapsed)f=m;else{var o=F(k,e,i);f=o.previousStartToken()}return g=f.chars[f.chars.length-1],n.equals(j)||(this.setStart(n.node,n.offset),d=!0),g&&!g.equals(k)&&(this.setEnd(g.node,g.offset),d=!0),c.trim&&(c.trimStart&&(d=this.trimStart(e)||d),c.trimEnd&&(d=this.trimEnd(e)||d)),d}return this.moveEnd(R,1,c)}),text:L(function(a,b){return this.collapsed?"":I(a,this,W(b,fb)).join("")}),selectCharacters:L(function(a,b,c,d,e){var f={characterOptions:e};b||(b=X(this.getDocument())),this.selectNodeContents(b),this.collapse(!0),this.moveStart("character",c,f),this.collapse(!0),this.moveEnd("character",d-c,f)}),toCharacterRange:L(function(a,b,c){b||(b=X(this.getDocument()));var d,e,f=b.parentNode,g=T.getNodeIndex(b),h=-1==T.comparePoints(this.startContainer,this.endContainer,f,g),i=this.cloneRange();return h?(i.setStartAndEnd(this.startContainer,this.startOffset,f,g),d=-i.text(c).length):(i.setStartAndEnd(f,g,this.startContainer,this.startOffset),d=i.text(c).length),e=d+this.text(c).length,{start:d,end:e}}),findText:L(function(b,c,d){d=h(d,ib),d.wholeWordsOnly&&(d.wordOptions.includeTrailingSpace=!1);var e=bb(d.direction),f=d.withinRange;f||(f=a.createRange(),f.selectNodeContents(this.getDocument()));var g=c,i=!1;"string"==typeof g?d.caseSensitive||(g=g.toLowerCase()):i=!0;var j=b.getRangeBoundaryPosition(this,!e),k=f.comparePoint(j.node,j.offset);-1===k?j=b.getRangeBoundaryPosition(f,!0):1===k&&(j=b.getRangeBoundaryPosition(f,!1));for(var l,m=j,n=!1;;)if(l=K(m,g,i,f,d)){if(l.valid)return this.setStartAndEnd(l.startPos.node,l.startPos.offset,l.endPos.node,l.endPos.offset),!0;m=e?l.startPos:l.endPos}else{if(!d.wrap||n)return!1;f=f.cloneRange(),m=b.getRangeBoundaryPosition(f,!e),f.setBoundary(j.node,j.offset,e),n=!0}}),pasteHtml:function(a){if(this.deleteContents(),a){var b=this.createContextualFragment(a),c=b.lastChild;this.insertNode(b),this.collapseAfter(c)}}}),V(a.selectionPrototype,{expand:L(function(a,b,c){this.changeEachRange(function(a){a.expand(b,c)})}),move:L(function(a,b,c,d){var e=0;if(this.focusNode){this.collapse(this.focusNode,this.focusOffset);var f=this.getRangeAt(0);d||(d={}),d.characterOptions=W(d.characterOptions,gb),e=f.move(b,c,d),this.setSingleRange(f)}return e}),trimStart:O("trimStart"),trimEnd:O("trimEnd"),trim:O("trim"),selectCharacters:L(function(b,c,d,e,f,g){var h=a.createRange(c);h.selectCharacters(c,d,e,g),this.setSingleRange(h,f)}),saveCharacterRanges:L(function(a,b,c){for(var d=this.getAllRanges(),e=d.length,f=[],g=1==e&&this.isBackward(),h=0,i=d.length;i>h;++h)f[h]={characterRange:d[h].toCharacterRange(b,c),backward:g,characterOptions:c};return f}),restoreCharacterRanges:L(function(b,c,d){this.removeAllRanges();for(var e,f,g,h=0,i=d.length;i>h;++h)f=d[h],g=f.characterRange,e=a.createRange(c),e.selectCharacters(c,g.start,g.end,f.characterOptions),this.addRange(e,f.backward)}),text:L(function(a,b){for(var c=[],d=0,e=this.rangeCount;e>d;++d)c[d]=this.getRangeAt(d).text(b);return c.join("")})}),a.innerText=function(b,c){var d=a.createRange(b);d.selectNodeContents(b);var e=d.text(c);return e},a.createWordIterator=function(a,b,c){var d=C();c=h(c,lb);var e=d.getPosition(a,b),f=F(e,c.characterOptions,c.wordOptions),g=bb(c.direction);return{next:function(){return g?f.previousStartToken():f.nextEndToken()},dispose:function(){f.dispose(),this.next=function(){}}}},a.noMutation=function(a){var b=C();a(b),D()},a.noMutation.createEntryPointFunction=L,a.textRange={isBlockNode:l,isCollapsedWhitespaceNode:t,createPosition:L(function(a,b,c){return a.getPosition(b,c)})}}),a}(this.rangy)},WEBSPELLCHECKER.rangy(),function(global){var _$=window.$,_jquip=window.jquip;window.$=window.jquip=function(){function a(a,b){for(var c,d=0,e=Pb.length;e>d;d++)if(Pb[d].apply(this,arguments))return this;return a?E(a)?(U?a():bb.push(a),this):F(a)?this.make(a):a.nodeType||H(a)?this.make([a]):"body"==a&&!b&&_.body?(this.context=a.context,this[0]=_.body,this.length=1,this.selector=a,this):void 0!==a.selector?(this.context=a.context,this.selector=a.selector,this.make(a)):(a=C(a)&&"<"===a.charAt(0)?(c=pb.exec(a))?[_.createElement(c[1])]:N(a).childNodes:k(this.selector=a,b),this.make(a),J(b)&&this.attr(b),this):this}function b(b,c){return new a(b,c)}function c(a){return!a||!a.parentNode||11==a.parentNode.nodeType}function d(a,c,d){if(c=c||0,E(c))return v(a,function(a,b){return!!c.call(a,b,a)===d});if(c.nodeType)return v(a,function(a){return a===c===d});if(C(c)){var e=":"==c.charAt(0)&&b.Expr[c.substring(1)];return v(a,function(a){var b,d=a.parentNode,f=!d;return f&&(d=Nb,d.appendChild(a)),b=e?e(a):a.parentNode&&q(k(c,a.parentNode),a)>=0,f&&d.removeChild(a),b})}return v(a,function(a){return q(c,a)>=0===d})}function e(a,b,c){var d=a[Mb];return B(c)?(d||(d=a[Mb]=Rb++),(Sb[d]||(Sb[d]={}))[b]=c):d&&Sb[d]&&(b?Sb[d][b]:Sb[d])}function f(a){if(!Tb[a]){var c=b("<"+a+">").appendTo(_.body),d=b.css&&b.css(c[0],"display")||c[0].style.display;c.remove(),Tb[a]=d}return Tb[a]}function g(a,b){if(a.length=b&&b.length||0,0===a.length)return a;for(var c=0,d=b.length;d>c;c++)a[c]=b[c];return a}function h(a,b){b=" "+b+" ";for(var c=0,d=a.length;d>c;c++)if(i(a[c],b))return!0;return!1}function i(a,b){return 1===a.nodeType&&(" "+a.className+" ").replace(hb," ").indexOf(b)>-1}function j(a,b,c){b=b||_,c=c||[],1==b.nodeType&&a(b)&&c.push(b);for(var d=b.childNodes,e=0,f=d.length;f>e;e++){var g=d[e];1==g.nodeType&&j(a,g,c)}return c}function k(a,c,d){if(a&&C(a)){c instanceof b&&(c=c[0]),c=c||_,d=d||b.query;var e,f=a.substring(1);return jb.test(a)&&c===_?(e=_.getElementById(f))?[e]:[]:M(kb.test(a)&&c.getElementsByClassName?c.getElementsByClassName(f):ib.test(a)?c.getElementsByTagName(a):d(a,c))}return 1==a.nodeType||9==a.nodeType?[a]:[]}function l(a,b,c){var d,e=_.head||_.getElementsByTagName("head")[0]||ab,f=_.createElement("script");c&&(f.async="async"),f.onreadystatechange=function(){(d=f.readyState)&&"loaded"!=d&&"complete"!=d||(f.onload=f.onreadystatechange=null,e&&f.parentNode&&e.removeChild(f),f=void 0,b&&b())},f.onload=b,f.src=a,e.insertBefore(f,e.firstChild)}function m(){Y.console&&Y.console.warn(arguments)}function n(a,b,c){if(null!=a)if(Jb&&a.forEach===Jb)a.forEach(b,c);else if(a.length===+a.length){for(var d=0,e=a.length;e>d;d++)if(d in a&&b.call(c,a[d],d,a)===Cb)return}else for(var f in a)if(Fb.call(a,f)&&b.call(c,a[f],f,a)===Cb)return}function o(a,b){if(a&&a.getAttribute&&b){var c=a.hasAttribute&&a.hasAttribute(b)?a.getAttribute(b):a[b];return null===c?void 0:c}}function p(a,c){return B(a)?b(c).filter(a):b(c)}function q(a,b){if(null==a)return-1;var c,d;if(Lb&&a.indexOf===Lb)return a.indexOf(b);for(c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1}function r(a,b,c){var d=[];return null==a?d:Kb&&a.filter===Kb?a.filter(b,c):(n(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)}),d)}function s(a,c,d){for(var e=[],f=a[c];f&&9!==f.nodeType&&(void 0===d||1!==f.nodeType||!b(f).is(d));)1===f.nodeType&&e.push(f),f=f[c];return e}function t(a,b,c){b=b||1;for(var d=0;a&&(1!==a.nodeType||++d!==b);a=a[c]);return a}function u(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}function v(a,b,c){var d,e=[];c=!!c;for(var f=0,g=a.length;g>f;f++)d=!!b(a[f],f),c!==d&&e.push(a[f]);return e}function w(a,c,d){var e,f,g=[],h=0,i=a.length,j=a instanceof b||"number"==typeof i&&(i>0&&a[0]&&a[i-1]||0===i||F(a));if(j)for(;i>h;h++)e=c(a[h],h,d),null!=e&&(g[g.length]=e);else for(f in a)e=c(a[f],f,d),null!=e&&(g[g.length]=e);return g.concat.apply([],g)}function x(a,b,c){if(!a)return{};var d=e(a,b,c);return d||y(a)["data-"+b]}function y(a){var b={};if(1==a.nodeType)for(var c=0,d=a.attributes,e=d.length;e>c;c++)b[d.item(c).nodeName]=d.item(c).nodeValue;return b}function z(a,b){return a&&b?a.toLowerCase()===b.toLowerCase():a==b}function A(a){return null==a?String(a):yb[xb.call(a)]||"object"}function B(a){return void 0!==a}function C(a){return"string"==typeof a}function D(a){return"object"==("undefined"==typeof a?"undefined":_typeof(a))}function E(a){return"function"==typeof a||"function"===A(a)}function F(a){return"array"===A(a)}function G(a){return!C(a)&&"number"==typeof a.length}function H(a){return a&&"object"==("undefined"==typeof a?"undefined":_typeof(a))&&"setInterval"in a}function I(a){return null==a||!mb.test(a)||isNaN(a)}function J(a){if(!a||"object"!==A(a)||a.nodeType||H(a))return!1;try{if(a.constructor&&!Fb.call(a,"constructor")&&!Fb.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(b){return!1}var c;for(c in a);return void 0===c||Fb.call(a,c)}function K(a,b){var c=a.length,d=0;if("number"==typeof b.length)for(var e=b.length;e>d;d++)a[c++]=b[d];else for(;void 0!==b[d];)a[c++]=b[d++];return a.length=c,a}function L(){var a,b,c,d,e,f,g=arguments,h=g[0]||{},i=1,j=g.length,k=!1;for("boolean"==typeof h&&(k=h,h=g[1]||{},i=2),"object"==("undefined"==typeof h?"undefined":_typeof(h))||E(h)||(h={}),j===i&&(h=this,--i);j>i;i++)if(null!=(a=g[i]))for(b in a)c=h[b],d=a[b],h!==d&&(k&&d&&(J(d)||(e=F(d)))?(e?(e=!1,f=c&&F(c)?c:[]):f=c&&J(c)?c:{},h[b]=L(k,f,d)):void 0!==d&&(h[b]=d));return h}function M(a,b){var c=b||[];if(null!=a){var d=A(a);null==a.length||"string"==d||"function"==d||"regexp"===d||H(a)?Hb.call(c,a):K(c,a)}return c}function N(a,b,c){if(b=b||_||b.ownerDocument||b[0]&&b[0].ownerDocument||_,c=c||b.createDocumentFragment(),G(a))return P(a,b,c)&&c;for(var d=O(a);d.firstChild;)c.appendChild(d.firstChild);return c}function O(a,b){var c=(b||_).createElement("div"),d=(gb.exec(a)||["",""])[1].toLowerCase(),e=Bb[d]||Bb._default,f=e[0];for(c.innerHTML=e[1]+a+e[2];f--;)c=c.lastChild;return c}function P(a,b,c){var d,e,f=[];for(d=0;null!=(e=a[d]);d++)C(e)&&(e=O(e,b)),e.nodeType?f.push(e):f=K(f,e);if(c)for(d=0;d<f.length;d++)f[d].nodeType&&c.appendChild(f[d]);return f}function Q(a){if(X&&(zb=Ab,a.sort(X),zb))for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1);return a}function R(){if(!_.body)return null;var a=_.createElement("div");_.body.appendChild(a),a.style.width="20px",a.style.padding="10px";var b=a.offsetWidth;return _.body.removeChild(a),40==b}function S(a,b){cb.push({url:a,cb:b})}function T(){n(bb,function(a){a()}),U=!0}var U,V,W,X,Y=window,Z="http://cdnjs.cloudflare.com/ajax/libs/sizzle/1.4.4/sizzle.min.js",$=function(){return Y.Sizzle||Y.qwery},_=document,ab=_.documentElement,bb=[],cb=[],db=/Until$/,eb=/,/,fb=/^(?:parents|prevUntil|prevAll)/,gb=/<([\w:]+)/,hb=/[\n\t\r]/g,ib=/^[\w-]+$/,jb=/^#[\w-]+$/,kb=/^\.[\w-]+$/,lb=/\s+/,mb=/\d/,nb=/\S/,ob=/\r\n/g,pb=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,qb=/\r?\n/g,rb=/^(?:select|textarea)/i,sb=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,tb=String.prototype.trim,ub=/^\s+/,vb=/\s+$/,wb={children:!0,contents:!0,next:!0,prev:!0},xb=Object.prototype.toString,yb={},zb=!1,Ab=!0,Bb={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},Cb={},Db=Array.prototype,Eb=Object.prototype,Fb=Eb.hasOwnProperty,Gb=Db.slice,Hb=Db.push,Ib=Db.indexOf,Jb=Db.forEach,Kb=Db.filter,Lb=Db.indexOf,Mb="jq-"+ +new Date,Nb=_.createElement("p");nb.test("Â ")&&(ub=/^[\s\xA0]+/,vb=/[\s\xA0]+$/);var Ob,Pb=[],Qb={},Rb=1,Sb={_id:0},Tb={};Ob=a.prototype=b.prototype=b.fn={constructor:b,selector:"",length:0,dm:function(a,b,c){var d,e,f,g,h,i=a[0];if(i&&this[0]){if(!(e=(1===i.nodeType||3===i.nodeType)&&i)&&(d=i&&i.parentNode,e=d&&11===d.nodeType&&d.childNodes.length===this.length?d:N(i),f=e.firstChild,1===e.childNodes.length&&(e=f),!f))return this;for(h=0,g=this.length;g>h;h++)c.call(this[h],0==h?e:e.cloneNode(!0))}return this},ps:function(a,b,c){var d=this.constructor();return F(a)?Hb.apply(d,a):K(d,a),d.prevObject=this,d.context=this.context,"find"===b?d.selector=this.selector+(this.selector?" ":"")+c:b&&(d.selector=this.selector+"."+b+"("+c+")"),d}},Ob.make=function(a){return g(this,a),this},Ob.toArray=function(){return Gb.call(this,0)},Ob.get=function(a){return B(a)?0>a?this[this.length+a]:this[a]:this.toArray()},Ob.add=function(a,d){var e="string"==typeof a?b(a,d):M(a&&a.nodeType?[a]:a),f=K(this.get(),e);return this.ps(c(e[0])||c(f[0])?f:Q(f))},Ob.each=function(a){if(!E(a))return this;for(var b=0,c=this.length;c>b&&a.call(this[b],b,this[b])!==!1;b++);return this},Ob.attr=function(a,b){var c=this[0];return C(a)&&void 0===b?o(c,a):this.each(function(c){var d=this.nodeType;if(3!==d&&8!==d&&2!==d)if(D(a))for(var e in a)null===b?this.removeAttribute(a):this.setAttribute(e,a[e]);else this.setAttribute(a,E(b)?b.call(this,c,this.getAttribute(a)):b)})},Ob.removeAttr=function(a){return this.each(function(){1==this.nodeType&&this.removeAttribute(a)})},Ob.data=function(a,b){return void 0===b?x(this[0],a):this.each(function(){x(this,a,b)})},Ob.append=function(){return this.dm(arguments,!0,function(a){1===this.nodeType&&this.appendChild(a)})},Ob.prepend=function(){return this.dm(arguments,!0,function(a){1===this.nodeType&&this.insertBefore(a,this.firstChild)})},Ob.before=function(){return this[0]&&this[0].parentNode?this.dm(arguments,!1,function(a){this.parentNode.insertBefore(a,this)}):this},Ob.after=function(){return this[0]&&this[0].parentNode?this.dm(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)}):this},Ob.replaceWith=function(a){var c=this,d=E(a);return this.each(function(e){var f=this.nextSibling,g=this.parentNode,h=d?a.call(this,e,this):a;g&&11!=g.nodeType?(g.removeChild(this),f?b(f).before(h):b(g).append(h)):c[e]=b(h).clone()[0]})},Ob.hide=function(){return this.each(function(){"none"!=this.style.display&&(e(this,"display",this.style.display),this.style.display="none")})},Ob.show=function(){return this.each(function(){this.style.display=e(this,"display")||f(this.tagName)})},Ob.toggle=function(){return this.each(function(){var a=b(this);b.Expr.hidden(this)?a.show():a.hide()})},Ob.eq=function(a){return-1===a?this.slice(a):this.slice(a,+a+1)},Ob.first=function(){return this.eq(0)},Ob.last=function(){return this.eq(-1)},Ob.slice=function(){return this.ps(Gb.apply(this,arguments),"slice",Gb.call(arguments).join(","))},Ob.map=function(a){return this.ps(w(this,function(b,c){return a.call(b,c,b)}))},Ob.find=function(a){var c,d,e=this;if(!C(a))return b(a).filter(function(){for(c=0,d=e.length;d>c;c++)if(W(e[c],this))return!0});var f,g,h,i=this.ps("","find",a);for(c=0,d=this.length;d>c;c++)if(f=i.length,K(i,b(a,this[c])),0===c)for(g=f;g<i.length;g++)for(h=0;f>h;h++)if(i[h]===i[g]){i.splice(g--,1);break}return i},Ob.not=function(a){return this.ps(d(this,a,!1),"not",a)},Ob.filter=function(a){return this.ps(d(this,a,!0),"filter",a)},Ob.indexOf=function(a){return q(this,a)},Ob.is=function(a){return this.length>0&&b(this[0]).filter(a).length>0},Ob.remove=function(){for(var a,b=0;B(a=this[b]);b++)a.parentNode&&a.parentNode.removeChild(a);return this},Ob.closest=function(a,b){var c,d,e,f=[];for(c=0,d=this.length;d>c;c++)for(e=this[c];e;){if(p(a,[e]).length>0){f.push(e);break}if(e=e.parentNode,!e||!e.ownerDocument||e===b||11===e.nodeType)break}return f=f.length>1?Q(f):f,this.ps(f,"closest",a)},Ob.val=function(a){return B(a)?this.each(function(){this.value=a}):this[0]&&this[0].value||""},Ob.html=function(a){return B(a)?C(a)?this.each(function(){this.innerHTML=a}):this.empty().append(a):this[0]&&this[0].innerHTML||""},Ob.text=function(a){var b,c=this[0];return B(a)?this.empty().append((c&&c.ownerDocument||_).createTextNode(a)):c&&(b=c.nodeType)?1===b||9===b?C(c.textContent)?c.textContent:c.innerText.replace(ob,""):3===b||4===b?c.nodeValue:null:null},Ob.empty=function(){var a,b;for(a=0;B(b=this[a]);a++)for(;b.firstChild;)b.removeChild(b.firstChild);return this},Ob.addClass=function(a){var c,d,e,f,g,h,i;if(E(a))return this.each(function(c){b(this).addClass(a.call(this,c,this.className))});if(a&&C(a))for(c=a.split(lb),d=0,e=this.length;e>d;d++)if(f=this[d],f&&1===f.nodeType)if(f.className||1!==c.length){for(g=" "+f.className+" ",h=0,i=c.length;i>h;h++)~g.indexOf(" "+c[h]+" ")||(g+=c[h]+" ");f.className=V(g)}else f.className=a;return this},Ob.removeClass=function(a){var c,d,e,f,g,h,i;if(E(a))return this.each(function(c){b(this).removeClass(a.call(this,c,this.className))});if(a&&C(a)||void 0===a)for(c=(a||"").split(lb),d=0,e=this.length;e>d;d++)if(f=this[d],1===f.nodeType&&f.className)if(a){for(g=(" "+f.className+" ").replace(hb," "),h=0,i=c.length;i>h;h++)g=g.replace(" "+c[h]+" "," ");f.className=V(g)}else f.className="";return this},Ob.hasClass=function(a){return h(this,a)},Ob.fadeIn=function(){this.each(function(){b(this).show()})},Ob.fadeOut=function(){this.each(function(){b(this).hide()})},Ob.serializeArray=function(){return this.map(function(){return this.elements?M(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||rb.test(this.nodeName)||sb.test(this.type))}).map(function(a,c){var d=b(this).val();return null==d||F(d)?w(d,function(a){return{name:c.name,value:a.replace(qb,"\r\n")}}):{name:c.name,value:d.replace(qb,"\r\n")}}).get()},Ob.wrap=function(a){return this.each(function(){var c=b(b(a)[0].cloneNode(!1));b(this).before(c),c.append(b(this))})},Ob.prop=function(a,b){return B(b)?this.each(function(){this[a]=b}):this[0]&&this[0][a]},Ob.clone=function(){return b(this.map(function(){return this.cloneNode(!0)}))},Ob.toggleClass=function(a,c){return this.each(function(){var d=b(this);(B(c)?c:!d.hasClass(a))?d.addClass(a):d.removeClass(a)})},b.Expr={hidden:function(a){return"none"===(b.css&&b.css(a,"display")||a.style.display)},visible:function(a){return!b.Expr.hidden(a)}},b.hasClass=h,b.walk=j,b.$$=k,b.setQuery=function(a){b.query=function(b,c){return k(b,c,a||function(a,b){return b.querySelectorAll(a)})}};var Ub=$();b.setQuery(Ub||function(a,b){return(b=b||_).querySelectorAll?M(b.querySelectorAll(a)):[]}),b.loadScript=l,b.each=function(a,b,c){var d,e=0,f=a.length,g=void 0===f||E(a);if(c)if(g){for(d in a)if(b.apply(a[d],c)===!1)break}else for(;f>e&&b.apply(a[e++],c)!==!1;);else if(g){for(d in a)if(b.call(a[d],d,a[d])===!1)break}else for(;f>e&&b.call(a[e],e,a[e++])!==!1;);return a},b._each=n,b.filter=p,b._indexOf=q,b._defaults=function(a){return n(Gb.call(arguments,1),function(b){for(var c in b)null==a[c]&&(a[c]=b[c])}),a},b._filter=r,b.proxy=function(a,b){if("string"==typeof b){var c=a[b];b=a,a=c}if(E(a)){var d=Gb.call(arguments,2),e=function(){return a.apply(b,d.concat(Gb.call(arguments)))};return e.guid=a.guid=a.guid||e.guid||Rb++,e}},b.dir=s,b.nth=t,b.sibling=u,b.grep=v,b.map=w,b.data=x,b.attrs=y,b.eqSI=z,V=tb?function(a){return null==a?"":tb.call(a)}:function(a){return null==a?"":a.toString().replace(ub,"").replace(vb,"")},b.trim=V,b.indexOf=b.inArray=function(a,b){if(!b)return-1;if(Ib)return Ib.call(b,a);for(var c=0,d=b.length;d>c;c++)if(b[c]===a)return c;return-1},n("Boolean Number String Function Array Date RegExp Object".split(" "),function(a){return yb["[object "+a+"]"]=a.toLowerCase(),this}),b.type=A,b.isFunction=E,b.isArray=Array.isArray||F,b.isWindow=H,b.isNaN=I,b.merge=K,b.extend=b.fn.extend=L,b.makeArray=M,b.htmlFrag=N;var Vb=function(a,b,c){if(a===b)return c;for(var d=a.nextSibling;d;){if(d===b)return-1;d=d.nextSibling}return 1};return W=b.contains=ab.contains?function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:function(){return!1},X=ab.compareDocumentPosition?(W=function(a,b){return!!(16&a.compareDocumentPosition(b))})&&function(a,b){return a===b?(zb=!0,0):a.compareDocumentPosition&&b.compareDocumentPosition?4&a.compareDocumentPosition(b)?-1:1:a.compareDocumentPosition?-1:1}:function(a,b){if(a===b)return zb=!0,0;if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,e=[],f=[],g=a.parentNode,h=b.parentNode,i=g;if(g===h)return Vb(a,b);if(!g)return-1;if(!h)return 1;for(;i;)e.unshift(i),i=i.parentNode;for(i=h;i;)f.unshift(i),i=i.parentNode;c=e.length,d=f.length;for(var j=0;c>j&&d>j;j++)if(e[j]!==f[j])return Vb(e[j],f[j]);return j===c?Vb(a,f[j],-1):Vb(e[j],b,1)},b.unique=Q,n({parent:function Wb(a){var Wb=a.parentNode;return Wb&&11!==Wb.nodeType?Wb:null},parents:function(a){return s(a,"parentNode")},parentsUntil:function(a,b,c){return s(a,"parentNode",c)},next:function(a){return t(a,2,"nextSibling")},prev:function(a){return t(a,2,"previousSibling")},nextAll:function(a){return s(a,"nextSibling")},prevAll:function(a){return s(a,"previousSibling")},nextUntil:function(a,b,c){return s(a,"nextSibling",c)},prevUntil:function(a,b,c){return s(a,"previousSibling",c)},siblings:function(a){return u(a.parentNode.firstChild,a)},children:function(a){return u(a.firstChild)},contents:function(a){return"iframe"===a.nodeName?a.contentDocument||a.contentWindow["document "]:M(a.childNodes)}},function(a,c){b.fn[c]=function(b,d){var e=w(this,a,b),f=Gb.call(arguments);return db.test(c)||(d=b),C(d)&&(e=M(p(d,e))),e=this.length>1&&!wb[c]?Q(e):e,(this.length>1||eb.test(d))&&fb.test(c)&&(e=e.reverse()),this.ps(e,c,f.join(","))}}),n({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after"},function(a,c){b.fn[c]=function(d){var e,f,g,h=[],i=b(d),j=1===this.length&&this[0].parentNode;if(j&&11===j.nodeType&&1===j.childNodes.length&&1===i.length)return i[a](this[0]),this;for(e=0,g=i.length;g>e;e++)f=(e>0?this.clone(!0):this).get(),b(i[e])[a](f),h=h.concat(f);return this.ps(h,c,i.selector)}}),function(){var a=document.createElement("div");a.style.display="none",a.innerHTML="   <link/><table></table><a href='/a' style='color:red;float:left;opacity:.55;'>a</a><input type='checkbox'/>";var c=a.getElementsByTagName("a")[0];b.support={boxModel:null,opacity:/^0.55$/.test(c.style.opacity),cssFloat:!!c.style.cssFloat};var d,e=/(webkit)[ \/]([\w.]+)/,f=/(opera)(?:.*version)?[ \/]([\w.]+)/,g=/(msie) ([\w.]+)/,h=/(mozilla)(?:.*? rv:([\w.]+))?/,i=navigator.userAgent.toLowerCase(),j=e.exec(i)||f.exec(i)||g.exec(i)||i.indexOf("compatible")<0&&h.exec(i)||[];d=b.browser={version:j[2]||"0"},d[j[1]||""]=!0}(),b.scriptsLoaded=function(a){E(a)&&bb.push(a)},b.loadAsync=S,Ub||_.querySelectorAll||S(Z,function(){b.setQuery($())}),b.init=!1,b.onload=function(){if(!b.init)try{b.support.boxModel=R();var a=0;n(cb,function(b){a++,l(b.url,function(){try{b.cb&&b.cb()}catch(c){}--a||T()})}),b.init=!0,a||T()}catch(c){m(c)}},_.body&&!b.init&&setTimeout(b.onload,1),b.hook=function(a){Pb.push(a)},b.plug=function(a,c){var d=C(a)?a:a.name;if(c=E(a)?a:c,!E(c))throw"Plugin fn required";d&&c&&(Qb[d]=c),c(b)},b}(),$.plug("ajax",function($){function _xhr(){if(null!=_xhrf)return _xhrf();for(var a=0,b=xhrs.length;b>a;a++)try{var c=xhrs[a],d=c();if(null!=d)return _xhrf=c,d}catch(e){}return function(){}}function _xhrResp(xhr,dataType){if(dataType=(dataType||xhr.getResponseHeader("Content-Type").split(";")[0]).toLowerCase(),dataType.indexOf("json")>=0){var j=!1;return j=window.JSON?window.JSON.parse(xhr.responseText):eval(xhr.responseText)}return dataType.indexOf("script")>=0?eval(xhr.responseText):dataType.indexOf("xml")>=0?xhr.responseXML:xhr.responseText}function ajax(a,b){var c,d=_xhr(),e=0;"object"===("undefined"==typeof a?"undefined":_typeof(a))?b=a:b.url=a,b=$._defaults(b,{userAgent:"XMLHttpRequest",lang:"en",type:"GET",data:null,contentType:"application/x-www-form-urlencoded",dataType:null,processData:!0,headers:{"X-Requested-With":"XMLHttpRequest"},cache:!0}),b.timeout&&(c=setTimeout(function(){d.abort(),b.timeoutFn&&b.timeoutFn(b.url)},b.timeout));var f=$(b.context||document),g=f;d.onreadystatechange=function(){if(4==d.readyState){if(c&&clearTimeout(c),d.status<300){var a,h=!0,i=b.dataType||"";try{a=_xhrResp(d,i,b)}catch(j){h=!1,b.error&&b.error(d,d.status,d.statusText),g.trigger(f,"ajaxError",[d,d.statusText,b])}b.success&&h&&(i.indexOf("json")>=0||a)&&b.success(a),g.trigger(f,"ajaxSuccess",[d,a,b])}else b.error&&b.error(d,d.status,d.statusText),g.trigger(f,"ajaxError",[d,d.statusText,b]);b.complete&&b.complete(d,d.statusText),g.trigger(f,"ajaxComplete",[d,b])}else b.progress&&b.progress(++e)};var a=b.url,h=null,i=1==b.cache,j="POST"==b.type||"PUT"==b.type;b.data&&b.processData&&"object"==_typeof(b.data)&&(h=$.formData(b.data)),!j&&h&&(a+="?"+h,h=null,i||(a=a+"&_="+(new Date).getTime())),a=a+"?_="+(new Date).getTime(),i=null,d.open(b.type,a);try{for(var k in b.headers)d.setRequestHeader(k,b.headers[k])}catch(l){console.log(l)}j&&(b.contentType.indexOf("json")>=0&&(h=b.data),d.setRequestHeader("Content-Type",b.contentType)),d.send(h)}var xhrs=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Microsoft.XMLHTTP")},function(){return new ActiveXObject("MSXML2.XMLHTTP.3.0")},function(){return new ActiveXObject("MSXML2.XMLHTTP")}],_xhrf=null;$.xhr=_xhr,$._xhrResp=_xhrResp,$.formData=function(a){var b=[],c=/%20/g;for(var d in a)b.push(encodeURIComponent(d).replace(c,"+")+"="+encodeURIComponent(a[d].toString()).replace(c,"+"));return b.join("&")},$.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){$.fn[b]=function(a){return this.bind(b,a)}}),$.ajax=ajax,$.getJSON=function(a,b,c,d){$.isFunction(b)&&(d=c,c=b,b=null),ajax({url:a,data:b,success:c,dataType:"json"})},$.get=function(a,b,c,d){$.isFunction(b)&&(d=c,c=b,b=null),ajax({url:a,type:"GET",data:b,success:c,dataType:d||"text/plain"})},$.post=function(a,b,c,d){$.isFunction(b)&&(d=c,c=b,b=null),ajax({url:a,type:"POST",data:b,success:c,dataType:d||"text/plain"})},$.getScript=function(a,b){return $.get(a,void 0,b,"script")},window.JSON||$.loadAsync("http://ajax.cdnjs.com/ajax/libs/json2/20110223/json2.js")}),$.plug("css",function(a){function b(b,c,e){var f="width"===c?b.offsetWidth:b.offsetHeight,g="width"===c?v:w;return f>0?("border"!==e&&a.each(g,function(){e||(f-=parseFloat(d(b,"padding"+this))||0),"margin"===e?f+=parseFloat(d(b,e+this))||0:f-=parseFloat(d(b,"border"+this+"Width"))||0}),f+"px"):""}function c(b,c,d,e){if(b&&3!==b.nodeType&&8!==b.nodeType&&b.style){var g,h=f(c),i=b.style,j=a.cssHooks[h];if(c=a.cssProps[h]||h,void 0===d)return j&&"get"in j&&void 0!==(g=j.get(b,!1,e))?g:i[c];if(!("number"==typeof d&&isNaN(d)||null==d||("number"!=typeof d||a.cssNumber[h]||(d+="px"),j&&"set"in j&&void 0===(d=j.set(b,d)))))try{i[c]=d}catch(k){}}}function d(b,c,d){var e,g=f(c),h=a.cssHooks[g];return c=a.cssProps[g]||g,h&&"get"in h&&void 0!==(e=h.get(b,!0,d))?e:i?i(b,c,g):void 0}function e(a,b,c){var d,e={};for(var d in b)e[d]=a.style[d],a.style[d]=b[d];c.call(a);for(d in b)a.style[d]=e[d]}function f(a){return a.replace(p,x)
}function g(b,c,d,e,f,h){var i=b.length;if("object"===("undefined"==typeof c?"undefined":_typeof(c))){for(var j in c)g(b,j,c[j],e,f,d);return b}if(void 0!==d){e=!h&&e&&a.isFunction(d);for(var k=0;i>k;k++)f(b[k],c,e?d.call(b[k],k,f(b[k],c)):d,h);return b}return i?f(b[0],c):void 0}function h(b){return a.isWindow(b)?b:9===b.nodeType?b.defaultView||b.parentWindow:!1}var i,j,k,l=document,m=l.documentElement,n=/alpha\([^)]*\)/i,o=/opacity=([^)]*)/,p=/-([a-z])/gi,q=/([A-Z])/g,r=/^-?\d+(?:px)?$/i,s=/^-?\d/,t=/^(?:body|html)$/i,u={position:"absolute",visibility:"hidden",display:"block"},v=["Left","Right"],w=["Top","Bottom"],x=function(a,b){return b.toUpperCase()};a.cssHooks={opacity:{get:function(a,b){if(!b)return a.style.opacity;var c=i(a,"opacity","opacity");return""===c?"1":c}}},a._each(["height","width"],function(c){a.cssHooks[c]={get:function(a,d,f){var g;return d?0!==a.offsetWidth?b(a,c,f):(e(a,u,function(){g=b(a,c,f)}),g):void 0},set:function(a,b){return r.test(b)?(b=parseFloat(b),b>=0?b+"px":void 0):b}}}),a.support.opacity||(a.support.opacity={get:function(a,b){return o.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100+"":b?"1":""},set:function(b,c){var d=b.style;d.zoom=1;var e=a.isNaN(c)?"":"alpha(opacity="+100*c+")",f=d.filter||"";d.filter=n.test(f)?f.replace(n,e):d.filter+" "+e}}),l.defaultView&&l.defaultView.getComputedStyle&&(j=function(b,c,d){var e,f,g;return d=d.replace(q,"-$1").toLowerCase(),(f=b.ownerDocument.defaultView)?((g=f.getComputedStyle(b,null))&&(e=g.getPropertyValue(d),""!==e||a.contains(b.ownerDocument.documentElement,b)||(e=a.style(b,d))),e):void 0}),l.documentElement.currentStyle&&(k=function(a,b){var c,d=a.currentStyle&&a.currentStyle[b],e=a.runtimeStyle&&a.runtimeStyle[b],f=a.style;return!r.test(d)&&s.test(d)&&(c=f.left,e&&(a.runtimeStyle.left=a.currentStyle.left),f.left="fontSize"===b?"1em":d||0,d=f.pixelLeft+"px",f.left=c,e&&(a.runtimeStyle.left=e)),""===d?"auto":d}),i=j||k,a.fn.css=function(a,b){return 2===arguments.length&&void 0===b?this:g(this,a,b,!0,function(a,b,e){return void 0!==e?c(a,b,e):d(a,b)})},a.cssNumber={zIndex:!0,fontWeight:!0,opacity:!0,zoom:!0,lineHeight:!0},a.cssProps={"float":a.support.cssFloat?"cssFloat":"styleFloat"},a.style=c,a.css=d,a.swap=e,a.camelCase=f;var y,z,A,B,C,D,E=function(){if(!y){var b,c,e,f=l.body,g=l.createElement("div"),h=parseFloat(d(f,"marginTop"))||0,i="<div style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;'><div></div></div><table style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>";a.extend(g.style,{position:"absolute",top:0,left:0,margin:0,border:0,width:"1px",height:"1px",visibility:"hidden"}),g.innerHTML=i,f.insertBefore(g,f.firstChild),b=g.firstChild,c=b.firstChild,e=b.nextSibling.firstChild.firstChild,C=5!==c.offsetTop,D=5===e.offsetTop,c.style.position="fixed",c.style.top="20px",B=20===c.offsetTop||15===c.offsetTop,c.style.position=c.style.top="",b.style.overflow="hidden",b.style.position="relative",A=-5===c.offsetTop,z=f.offsetTop!==h,f.removeChild(g),y=!0}},F=function(a){var b=a.offsetTop,c=a.offsetLeft;return E(),z&&(b+=parseFloat(d(a,"marginTop"))||0,c+=parseFloat(d(a,"marginLeft"))||0),{top:b,left:c}};a.fn.offset=function(){var b,c=this[0];if(!c||!c.ownerDocument)return null;if(c===c.ownerDocument.body)return F(c);try{b=c.getBoundingClientRect()}catch(d){}if(!b||!a.contains(m,c))return b?{top:b.top,left:b.left}:{top:0,left:0};var e=l.body,f=h(l),g=m.clientTop||e.clientTop||0,i=m.clientLeft||e.clientLeft||0,j=f.pageYOffset||a.support.boxModel&&m.scrollTop||e.scrollTop,k=f.pageXOffset||a.support.boxModel&&m.scrollLeft||e.scrollLeft,n=b.top+j-g,o=b.left+k-i;return{top:n,left:o}},a.fn.position=function(){if(!this[0])return null;var a=this[0],b=this.offsetParent(),c=this.offset(),e=t.test(b[0].nodeName)?{top:0,left:0}:b.offset();return c.top-=parseFloat(d(a,"marginTop"))||0,c.left-=parseFloat(d(a,"marginLeft"))||0,e.top+=parseFloat(d(b[0],"borderTopWidth"))||0,e.left+=parseFloat(d(b[0],"borderLeftWidth"))||0,{top:c.top-e.top,left:c.left-e.left}},a.fn.offsetParent=function(){return this.map(function(){for(var a=this.offsetParent||l.body;a&&!t.test(a.nodeName)&&"static"===d(a,"position");)a=a.offsetParent;return a})},a._each(["Height","Width"],function(b){var c=b.toLowerCase();a.fn["inner"+b]=function(){var a=this[0];return a&&a.style?parseFloat(d(a,c,"padding")):null},a.fn["outer"+b]=function(a){var b=this[0];return b&&b.style?parseFloat(d(b,c,a?"margin":"border")):null},a.fn[c]=function(e){var f=this[0];if(!f)return null==e?null:this;if(a.isFunction(e))return this.each(function(b){var d=a(this);d[c](e.call(this,b,d[c]()))});if(a.isWindow(f)){var g=f.document.documentElement["client"+b],h=f.document.body;return"CSS1Compat"===f.document.compatMode&&g||h&&h["client"+b]||g}if(9===f.nodeType)return Math.max(f.documentElement["client"+b],f.body["scroll"+b],f.documentElement["scroll"+b],f.body["offset"+b],f.documentElement["offset"+b]);if(void 0===e){var i=d(f,c),j=parseFloat(i);return a.isNaN(j)?i:j}return this.css(c,"string"==typeof e?e:e+"px")}}),a._each(["Left","Top"],function(b,c){var d="scroll"+b;a.fn[d]=function(b){var e,f;return void 0===b?(e=this[0])?(f=h(e),f?"pageXOffset"in f?f[c?"pageYOffset":"pageXOffset"]:a.support.boxModel&&f.document.documentElement[d]||f.document.body[d]:e[d]):null:this.each(function(){f=h(this),f?f.scrollTo(c?a(f).scrollLeft():b,c?b:a(f).scrollTop()):this[d]=b})}})}),$.plug("custom",function(a){for(var b=window,c={},d=b.location.search.substring(1).split("&"),e=a.Key=function(a){this.keyCode=a},f=0;f<d.length;f++){var g=d[f].split("=");c[g[0]]=unescape(g[1])}a.queryString=function(a){return c[a]},e.namedKeys={Backspace:8,Tab:9,Enter:13,Shift:16,Ctrl:17,Alt:18,Pause:19,Capslock:20,Escape:27,PageUp:33,PageDown:34,End:35,Home:36,LeftArrow:37,UpArrow:38,RightArrow:39,DownArrow:40,Insert:45,Delete:46},a._each(e.namedKeys,function(a,b){var c=a;e.prototype["is"+b]=function(){return this.keyCode===c}}),a.key=function(a){return a=a||window.event,new e(a.keyCode||a.which)},a.cancelEvent=function(a){return a||(a=window.event),a.cancelBubble=!0,a.returnValue=!1,a.stopPropagation&&(a.stopPropagation(),a.preventDefault()),!1},a.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},a._template=function(b,c){var d=a.templateSettings,e="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+b.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(d.escape,function(a,b){return"',_.escape("+b.replace(/\\'/g,"'")+"),'"}).replace(d.interpolate,function(a,b){return"',"+b.replace(/\\'/g,"'")+",'"}).replace(d.evaluate||null,function(a,b){return"');"+b.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",f=new Function("obj","$",e);return c?f(c,a):function(b){return f(b,a)}}}),$.plug("docready",function(a){function b(){if(!i){try{g.documentElement.doScroll("left")}catch(a){return void setTimeout(b,1)}c()}}function c(b){if(b===!0&&j--,!j||b!==!0&&!i){if(!g.body)return setTimeout(e,1);if(i=!0,b!==!0&&--j>0)return;if(h){var c,d=0,e=h;for(h=null;c=e[d++];)c.call(g,a);a.fn.trigger&&a(g).trigger("ready").unbind("ready")}}}var d,e,f=window,g=document,h=[],i=!1,j=1;a.hook(function(a){return"function"==typeof a?(this.ready(a),!0):void 0}),a.ready=c,d=g.addEventListener?function(){g.removeEventListener("DOMContentLoaded",d,!1),c()}:function(){"complete"===g.readyState&&(g.detachEvent("onreadystatechange",d),c())},a.bindReady=function(){if(!e){if(e=!0,"complete"===g.readyState)return setTimeout(c,1);if(g.addEventListener)g.addEventListener("DOMContentLoaded",d,!1),f.addEventListener("load",c,!1);else if(g.attachEvent){g.attachEvent("onreadystatechange",d),f.attachEvent("onload",c);var a=!1;try{a=null==window.frameElement}catch(h){}g.documentElement.doScroll&&a&&b()}}},a.fn.ready=function(b){return a.bindReady(),i?b.call(g,a):h&&h.push(b),this},a.init||a(document).ready(a.onload)}),$.plug("events",function(a){function b(a){return a._jquid||(a._jquid=m++)}function c(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):(n[b+c]=function(){c(window.event)},a.attachEvent("on"+b,n[b+c]))}function d(a,b,c){a.removeEventListener?a.removeEventListener(b,c,!1):(a.detachEvent("on"+b,n[b+c]),n[b+c]=null)}function e(a){var b=(""+a).split(".");return{e:b[0],ns:b.slice(1).sort().join(" ")}}function f(a){return new RegExp("(?:^| )"+a.replace(" "," .* ?")+"(?: |$)")}function g(c,d,g,h){if(d=e(d),d.ns)var i=f(d.ns);return a._filter(l[b(c)]||[],function(a){return!(!a||d.e&&a.e!=d.e||d.ns&&!i.test(a.ns)||g&&a.fn!=g||h&&a.sel!=h)})}function h(d,f,g,h,i){var j=b(d),k=l[j]||(l[j]=[]);a._each(f.split(/\s/),function(b){var f=a.extend(e(b),{fn:g,sel:h,del:i,i:k.length});k.push(f),c(d,f.e,i||g)}),d=null}function i(c,e,f,h){var i=b(c);a._each((e||"").split(/\s/),function(b){a._each(g(c,b,f,h),function(a){delete l[i][a.i],d(c,a.e,a.del||a.fn)})})}function j(b){var c=a.extend({originalEvent:b},b);return a._each(o,function(a){b[a]&&(c[a]=function(){return b[a].apply(b,arguments)})}),c}var k=document,l={},m=1,n={};a.bind=c,a.unbind=d;var o=["preventDefault","stopImmediatePropagation","stopPropagation"],p=a.fn;a._each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a){p[a]=function(b,c){return arguments.length>0?this.bind(a,b,c):this.trigger(a)}}),p.bind=function(a,b){return this.each(function(){h(this,a,b)})},p.unbind=function(a,b){return this.each(function(){i(this,a,b)})},p.one=function(a,b){return this.each(function(){var c=this;h(this,a,function(){b.apply(c,arguments),i(c,a,arguments.callee)})})},p.delegate=function(b,c,d){return this.each(function(e,f){h(f,c,d,b,function(c){for(var e=c.target||c.srcElement,g=a.$$(b,f);e&&a._indexOf(g,e)<0;)e=e.parentNode;e&&e!==f&&e!==document&&d.call(e,a.extend(j(c||window.event),{currentTarget:e,liveFired:f}))})})},p.undelegate=function(a,b,c){return this.each(function(){i(this,b,c,a)})},p.live=function(b,c){return a(k.body).delegate(this.selector,b,c),this},p.die=function(b,c){return a(k.body).undelegate(this.selector,b,c),this},p.on=function(a,b,c){return"function"==typeof b?this.bind(a,b):this.delegate(b,a,c)},p.off=function(a,b,c){return"string"==typeof b?this.undelegate(b,a,c):this.unbind(a,c)},p.trigger=function(a){return this.each(function(){if("click"==a&&this[a])return this[a]();if(k.createEvent){var b=k.createEvent("Events");this.dispatchEvent(b,b.initEvent(a,!0,!0))}else if(this.fireEvent)try{"ready"!==a&&this.fireEvent("on"+a)}catch(b){}})},a.init||a(window).bind("load",a.onload)}),global.jquip=window.jquip||jquip,window.$=_$,window.jquip=_jquip}(WEBSPELLCHECKER),window.WEBSPELLCHECKER=window.WEBSPELLCHECKER||{},function(a){if(!a.CORE){var b,c=a.OptionsManager,d=c.optionTypes,e=c.importOptionsTemplate("WebApiTemplate"),f=["af","ar","bg","bn","bs","ca","cs","cy","da","de-ch","de","el","en-us","en-au","en-ca","en-gb","en","eo","es","et","eu","fa","fi","fo","fr-ca","fr","gl","gu","he","hi","hr","hu","is","it","ja","ka","km","ko","lb","lt","lv","mk","mn","ms","nb","nl","no","pl","pt-br","pt","ro","ru","sk","sl","sr-latn","sr","sv","th","tr","ug","uk","ku","vi","zh-cn","zh"];c.extendOptionTypes([{name:"htmlContainer",validate:function(a){var b=["email","password","submit","reset","radio","checkbox","button","color","date","datetime","datetime-local","month","number","range","tel","time","week","file","image","hidden"],c=!1;return a?(a.type&&(c=b.includes(a.type)),a.nodeType&&1===a.nodeType&&!c):!1}},{name:"localization",validate:function(a){return f.includes(a)}},{name:"proofreadOptions",erroMessageTemplate:"Your options list contains unaccepted option type.",validate:function(a){for(var b=["ignoreAllCapsWords","ignoreDomainNames","ignoreWordsWithMixedCases","ignoreWordsWithNumbers"],c=0;c<a.length;c++)if(!b.includes(a[c]))return!1;return!0}},{name:"generalOptions",erroMessageTemplate:"Your general options list contains unaccepted option type.",validate:function(a){for(var b=["autocorrect"],c=0;c<a.length;c++)if(!b.includes(a[c]))return!1;return!0}}]),b={debug:{defaultValue:!1,type:d.boolean},focused:{defaultValue:!1,type:d.boolean},suggestionsCount:{defaultValue:3,type:d.positive},moreSuggestionsCount:{defaultValue:0,type:d.positive},localization:{defaultValue:"en",type:d.localization},localizationList:{defaultValue:f,type:d.defaultValue},detectLocalizationLanguage:{defaultValue:!1,type:d.boolean},localizationPath:{defaultValue:"local/",type:d.defaultValue},loadLocalization:{defaultValue:!0,type:d.boolean},data_attribute_name:{defaultValue:"data-spelling-word",type:d.string},data_attribute_name_backward:{defaultValue:"data-scayt-word",type:d.defaultValue},data_attribute_rule_name:{defaultValue:"data-spelling-rule",type:d.string},data_lang_attribute:{defaultValue:"data-wsc-lang",type:d.string},data_id_attribute:{defaultValue:"data-wsc-id",type:d.string},misspelled_word_class:{defaultValue:"wsc-spelling-problem",type:d.string},ignored_problem_class:{defaultValue:"wsc-ignored-problem",type:d.string},instance_attribute:{defaultValue:"data-wsc-instance",type:d.defaultValue},ignore_by_default__attribute:{defaultValue:"data-wsc",type:d.defaultValue},iframe_quirks_class:{defaultValue:"wsc-iframe-quirks",type:d.string},problem_text_active:{defaultValue:"wsc-problem-text--active",type:d.string},problem_text_from_dialog_active:{defaultValue:"wsc-problem-text__dialog--active",type:d.string},problem_grammar_node:{defaultValue:"span",type:d.string},misspelled_word_node:{defaultValue:"span",type:d.string},problem_grammar_data_attribute:{defaultValue:"data-grammar-phrase",type:d.string},problem_grammar_data_attribute_backward:{defaultValue:"data-grayt-phrase",type:d.defaultValue},problem_grammar_data_attribute_rule:{defaultValue:"data-grammar-rule",type:d.string},problem_grammar_class:{defaultValue:"wsc-grammar-problem",type:d.string},problem_id_data_attribute:{defaultValue:"data-problem-id",type:d.string},autocorrect_data_attribute:{defaultValue:"data-autocorrect-word",type:d.string},autocorrect_data_attribute_backward:{defaultValue:"data-autocorrect-word",type:d.string},autocorrect_data_attribute_rule:{defaultValue:"data-autocorrect-rule",type:d.string},autocorrect_node:{defaultValue:"span",type:d.string},autocorrect_class:{defaultValue:"wsc-autocorrect",type:d.string},originalContainer:{defaultValue:null,type:d.defaultValue},documentContainer:{defaultValue:null,type:d.defaultValue},focusContainer:{defaultValue:null,type:d.defaultValue},mirrorContainer:{defaultValue:null,type:d.defaultValue},mirrorTextContainer:{defaultValue:null,type:d.defaultValue},contenteditableMirrorContainer:{defaultValue:null,type:d.defaultValue},currentDocument:{defaultValue:null,type:d.defaultValue},leftMouseButtonPressed:{defaultValue:!1,type:d.defaultValue},deleteKeyButtonPressed:{defaultValue:!1,type:d.defaultValue},backspaceKeyButtonPressed:{defaultValue:!1,type:d.defaultValue},spaceKeyButtonPressed:{defaultValue:!1,type:d.defaultValue},enterKeyButtonPressed:{defaultValue:!1,type:d.defaultValue},isTextBasedContainer:{defaultValue:!1,type:d.defaultValue},isTouchDevice:{defaultValue:!1,type:d.defaultValue},isIframe:{defaultValue:!1,type:d.defaultValue},banner:{defaultValue:!1,type:d.defaultValue},bannerInfo:{defaultValue:{text:"You are using the Trial version of WebSpellChecker Proofreader. Click Upgrade to get the Paid version now.",linkHref:"https://www.webspellchecker.net/signup/hosted-signup.html#webspellchecker-proofreader-paid",linkText:"Upgrade"},type:d.defaultValue},supportLocale:{defaultValue:!0,type:d.defaultValue},isServiceHostDefault:{defaultValue:!0,type:d.defaultValue},isMutationObserver:{defaultValue:"MutationObserver"in window?!0:!1,type:d.boolean},paused:{defaultValue:!1,type:d.defaultValue},appStarted:{defaultValue:!1,type:d.defaultValue},maxLength:{defaultValue:-1,type:d.defaultValue},numberOfFailedRequest:{defaultValue:0,type:d.defaultValue},mainWSCdomain:{defaultValue:"webspellchecker.net",type:d.defaultValue},userDictionaryKey:{defaultValue:"wsc_user_dictionary",type:d.defaultValue},userDictionaryNameKey:{defaultValue:"wsc_user_dictionary_name",type:d.defaultValue},wscLogo:{defaultValue:"css/logo.png",type:d.defaultValue},cssPath:{defaultValue:"css/wsc.css",type:d.defaultValue},productName:{defaultValue:"WProofreader",type:d.defaultValue},wscVersion:{defaultValue:"3.4.4600",type:d.defaultValue},wscSupportUrl:{defaultValue:"https://webspellchecker.com/contact-us/",type:d.defaultValue},moreLangUrl:{defaultValue:"https://webspellchecker.com/additional-dictionaries/",type:d.defaultValue},ECUserManual:{defaultValue:"https://webspellchecker.com/app/user-manual/scayt_for_editable_controls_user_manual.pdf",type:d.defaultValue},CKUserManual:{defaultValue:"https://webspellchecker.com/app/user-manual/scayt_plugin_for_ckeditor4_user_manual.pdf",type:d.defaultValue},uid:{defaultValue:"",type:d.defaultValue},styles:{defaultValue:"",type:d.defaultValue},eventsBlockedState:{defaultValue:{},type:d.defaultValue},langList:{defaultValue:{},type:d.defaultValue},modifierKeys:{defaultValue:{},type:d.defaultValue},shortcutsList:{defaultValue:[],type:d.array},container:{required:!0,type:d.htmlContainer},proofreadOptions:{defaultValue:["ignoreAllCapsWords","ignoreDomainNames","ignoreWordsWithMixedCases","ignoreWordsWithNumbers"],type:d.proofreadOptions},ignoreAllCapsWords:{defaultValue:!1,type:d.boolean},ignoreDomainNames:{defaultValue:!0,type:d.boolean},ignoreWordsWithMixedCases:{defaultValue:!1,type:d.boolean},ignoreWordsWithNumbers:{defaultValue:!0,type:d.boolean},ignoreElements:{defaultValue:"a|pre|code",type:d.string},ignoreGrammarElements:{defaultValue:"",type:d.boolean},"options-to-restore":{defaultValue:["lang","ignoreAllCapsWords","ignoreDomainNames","ignoreWordsWithMixedCases","ignoreWordsWithNumbers","autocorrect"],type:d.array},undoDataSize:{defaultValue:20,type:d.number},enableBadgeButton:{defaultValue:!0,type:d.boolean},enableLanguagesInBadgeButton:{defaultValue:!1,type:d.boolean},disableProblemDescription:{defaultValue:!1,type:d.boolean},actionItems:{defaultValue:["ignoreAll","addWord","disableRule","settings","toggle","proofreadDialog"],type:d.array},controlActions:{defaultValue:["addWord","ignore","ignoreAll","disableRule"],type:d.defaultValue},staticActions:{defaultValue:["proofreadDialog","settings","toggle"],type:d.defaultValue},settingsSections:{defaultValue:["dictionaries","languages","general","options"],type:d.array},defaultSettingsSections:{defaultValue:["about"],type:d.defaultValue},hideStaticActions:{defaultValue:!1,type:d.boolean},enableDisableRule:{defaultValue:!1,type:d.boolean},isProofreadInDialogActive:{defaultValue:!1,type:d.boolean},proofreadAsYouType:{defaultValue:!0,type:d.defaultValue},markupStrategy:{defaultValue:"Basic",type:d.string},disableDictionariesPreferences:{defaultValue:!1,type:d.boolean},removeBranding:{defaultValue:!1,type:d.boolean},canRemoveBranding:{defaultValue:!1,type:d.defaultValue},sendStatistics:{defaultValue:!1,type:d.defaultValue},session:{defaultValue:"",type:d.defaultValue},disableBadgePulsing:{defaultValue:!1,type:d.boolean},parentBlockPrefix:{defaultValue:"wscParentBlock",type:d.defaultValue},markPrefixStart:{defaultValue:"wscMarkStart",type:d.defaultValue},markPrefixEnd:{defaultValue:"wscMarkEnd",type:d.defaultValue},requestTokensCount:{defaultValue:10,type:d.positive},autoDestroy:{defaultValue:!1,type:d.boolean},ignoreClasses:{defaultValue:[],type:d.array},ignoreClassesByDefault:{defaultValue:["ck-user__marker","ck-suggestion-marker-deletion","gmail_quote"],type:d.defaultValue},ignoreAttributes:{defaultValue:[],type:d.array},ignoreAttributesByDefault:{defaultValue:["data-cke-hidden-sel"],type:d.defaultValue},removeFromDialogByAttributes:{defaultValue:["data-cke-hidden-sel"],type:d.defaultValue},disableDialog:{defaultValue:!1,type:d.boolean},theme:{defaultValue:"default",type:d.string},themes:{defaultValue:["default","custom","gray","ckeditor5","dark"],type:d.defaultValue},themePrefix:{defaultValue:"wsc-theme",type:d.defaultValue},themeClass:{defaultValue:"",type:d.defaultValue},disabledRules:{defaultValue:[],type:d.array},nativeSpellCheck:{defaultValue:!1,type:d.boolean},restoreNativeSpellCheck:{defaultValue:!1,type:d.boolean},commonPrefix:{defaultValue:"wsc",type:d.defaultValue},syncOptions:{defaultValue:!0,type:d.boolean},globalProofreadDialog:{defaultValue:!0,type:d.boolean},generalOptions:{defaultValue:["autocorrect"],type:d.generalOptions},autocorrect:{defaultValue:!0,type:d.boolean},detectedLang:{defaultValue:"",type:d.string}},b=c.mergeOptionsTemplates(b,e),c.exportOptionsTemplate("CoreTemplate",b);var g=function h(a){this._clientOptions=a,this.options={},this._modules={},this._criticalMessage="",this._dependencies=[{name:"Communication",module:h.Communication},{name:"DOMCommunication",module:h.DOMCommunication},{name:"WebApiAdapter",module:h.WebApiAdapter},{name:"RegExpressions",module:h.RegExpressions},{name:"RangeCreator",module:h.RangeCreator},{name:"Deferred",module:h.Deferred},{name:"StateController",module:h.StateController},{name:"ActionManager",module:h.ActionManager},{name:"ProblemManager",module:h.ProblemManager},{name:"WordTokenizer",module:h.WordTokenizer},{name:"SentenceTokenizer",module:h.SentenceTokenizer},{name:"NodeInfoCollector",module:h.NodeInfoCollector}],this._externalDependencies={sync:[],async:[]},this.allModulesReady=!1,this._init()};g.prototype={constructor:g,_init:function(){return this._setMainContainerIfNeedSo(),this._setOptions(),this._isIncorrectOptions()?new Error(this._criticalMessage):(this._updateOptions(),this._buildModules(this._dependencies),void this._subscribeOnModuleReady())},_setMainContainerIfNeedSo:function(){"string"==typeof this._clientOptions.container&&(this._clientOptions.container=document.getElementById(this._clientOptions.container))},_setOptions:function(){var a=this;this.options=c.createOptions(this._clientOptions,"CoreTemplate",function(b){b.reports.forEach(function(b){b.critical&&(a._criticalMessage+=b.message)})})},_isIncorrectOptions:function(){return""!==this._criticalMessage},_updateOptions:function(){this._setModifierKeys(),this._setContainers(),this._setCssPath(),this._setIsServiceHostDefault(),this._setUid(),this._setOptionsToRestore(),this._setIgnoredByDefaultOptions()},_setModifierKeys:function(){this.options.modifierKeys={ALT:g.ALT,CTRL:g.CTRL,SHIFT:g.SHIFT}},_setContainers:function(){this.options.documentContainer=this.options.container,this.options.isIframe="iframe"===this.options.documentContainer.nodeName.toLowerCase()?!0:!1,this.options.currentDocument=this.options.isIframe?this.options.documentContainer.contentWindow.document:document,this.options.isIframe&&(this.options.container=this.options.documentContainer.contentDocument?this.options.documentContainer.contentDocument.getElementsByTagName("body")[0]:this.options.documentContainer.contentWindow.document.getElementsByTagName("body")[0]),this.options.originalContainer=this.options.container,this.options.focusContainer=this.options.documentContainer.contentWindow||this.options.container},_setCssPath:function(){this.options.cssPath=this.Utils.getUrl(this.options.cssPath,this.options.basePath)},_setIsServiceHostDefault:function(){this.options.isServiceHostDefault=this.options.serviceHost.includes(this.options.mainWSCdomain)},_setUid:function(){this.options.uid=this.instanceManager.getUniqueId(this.options.documentContainer)},_setOptionsToRestore:function(){for(var a,b,c=this.options.syncOptions,d=c?this.options.commonPrefix:this.options.uid,e=0;e<this.options["options-to-restore"].length;e++)a=this.options["options-to-restore"][e],"undefined"!=typeof this.options[a]&&(b=this.DataStorage.getData(d+"_"+a),"undefined"!=typeof b&&null!==b?this.options[a]=b:this.DataStorage.setData(d+"_"+a,this.options[a]));if(!c)for(var f in this.options)this.options["options-to-restore"].includes(f)||this.DataStorage.deleteData(d+"_"+f)},_setIgnoredByDefaultOptions:function(){this.options.ignoreClasses=this.options.ignoreClasses.concat(this.options.ignoreClassesByDefault),this.options.ignoreAttributes=this.options.ignoreAttributes.concat(this.options.ignoreAttributesByDefault)},_buildModules:function(a){for(var b=0;b<a.length;b++){var c,d,e=a[b],f=e.name,g=e.module;if(this._register(f,g),this._start(f),c=this._modules[f].instance,d=this._modules[f].creator,c.initialized)return;c.init&&c.init(),c.ready=!d.async,c.initialized=!0,this._decorateModule(c)}},_register:function(a,b){this._modules[a]=this._modules[a]||{creator:b,instance:null}},_start:function(a){var b,c="";c=this._startModule(a)?a+" started.":a+" already started.",b=this.getService("Communication"),b.initialized&&b.fire({moduleID:"CORE",eventType:"moduleStarted",data:{statusMessage:c}})},_startModule:function(a){return this._modules[a].instance?!1:(this._createModuleInstance(a),!0)},_createModuleInstance:function(a){try{this._modules[a].instance=new this._modules[a].creator(a,new g.Sandbox(a,this))}catch(b){throw new Error("Could not create Module instance with id: "+a+" : "+b.message)}},getService:function(a){return this._modules[a]?this._modules[a].instance:void 0},_decorateModule:function(a){var b,c=a;if(c.decorator){if(b=this._modules[c.decoratorFor],void 0===b)throw new Error(moduleID+" try to decorate undefined module "+c.decoratorFor+".");if(void 0===c.decorate)throw new Error(moduleID+" should define decorate method.");this._modules[c.decoratorFor].instance=c.decorate(b.instance)}},_subscribeOnModuleReady:function(){this.getService("Communication").subscribe({moduleID:"CORE",eventType:"moduleReady",handler:function(a){this._modules[a.moduleID].instance.ready=!0,this._checkAsyncModulesState()},context:this})},_checkAsyncModulesState:function(){var a,b;for(var c in this._modules){if(a=this._modules[c].instance,b=this._modules[c].creator,!a)return;if(b.async&&!a.ready)return}this.getService("Communication").fire({moduleID:"CORE",eventType:"asyncModulesReady"})},initModules:function(a){this._initModules(a),this._checkAsyncModulesState()},_initModules:function(a){this._sortModules(a),0!==this._externalDependencies.async.length?(this._subscribeOnAsyncModulesReady(),this._buildModules(this._externalDependencies.async)):(this._buildModules(this._externalDependencies.sync),this._handleAllModulesReady())},_sortModules:function(a){for(var b,c=0;c<a.length;c++)b=a[c],b.module.async?this._externalDependencies.async.push(b):this._externalDependencies.sync.push(b)},_subscribeOnAsyncModulesReady:function(){this.getService("Communication").subscribe({moduleID:"CORE",eventType:"asyncModulesReady",handler:this._asyncModulesReadyHandler,context:this})},_asyncModulesReadyHandler:function(){this._unsubscribeFromAsyncModulesReady(),this._buildModules(this._externalDependencies.sync),this._handleAllModulesReady()},_unsubscribeFromAsyncModulesReady:function(){this.getService("Communication").unsubscribe({moduleID:"CORE",eventType:"asyncModulesReady",handler:this._asyncModulesReadyHandler,context:this})},_handleAllModulesReady:function(){this.allModulesReady=!0,this._clearExternalDependencies(),this.getService("Communication").fire({moduleID:"CORE",eventType:"allModulesReady"})},_clearExternalDependencies:function(){this._externalDependencies={sync:[],async:[]}},destroyModules:function(a){a=a||this._modules;for(var b in a)this._modules[b].instance.destroy&&this._modules[b].instance.destroy();for(var b in a)this._modules[b].instance=null}},g.prototype.Utils=a.Utils,g.prototype.OptionsManager=a.OptionsManager,g.prototype.RegularsManager=a.RegularsManager,g.prototype.IO=a.IO,g.prototype.initWebApi=a.initWebApi,g.prototype.logger=a.logger,g.signals=a.signals,g.jquip=a.jquip,g.rangy=a.rangy,a.CORE=g}}(WEBSPELLCHECKER||{}),WEBSPELLCHECKER.CORE.Sandbox=function(a,b){function c(a,b){var c={};for(var d in a)a.hasOwnProperty(d)&&-1===b.indexOf(d)&&(c[d]=a[d].bind(a));return c}function d(a,c){var d={};return c=b.Utils.ArrayUtils.argumentsToArray(c),d=b.Utils.is(c[0],"Object")?c[0]:b.Utils.ArrayUtils.zipArraysToObject(a,c)}function e(){var a,b=this.getOption("leftMouseButtonPressed"),c=this.Utils.Browser.ie;return a=c&&b?!1:!0}this.getCommunication=function(){return b.getService("Communication")},this.getContextMenu=function(){var a=b.getService("ContextMenu"),c={addItems:a.addItems,getItem:a.getItem,addItem:a.addItem,addGroup:a.addGroup,getDOMElement:a.getDOMElement};for(var d in c)c.hasOwnProperty(d)&&(c[d]=c[d].bind(a));return c},this.getBadge=function(){return b.getService("Badge")},this.createRange=function(){var c=b.getService("RangeCreator").createRange();return b.logger.log({name:a,msg:"Create the range",data:c,type:"range"}),c},this.getSelection=function(c){var d=b.getService("RangeCreator").getSelection(c);return b.logger.log({name:a,msg:"Get the selection",data:d,type:"selection"}),d},this.saveSelection=function(){var c;return e.apply(this)?(this.fireInAllApps("lockMutationsListener",{lock:!0}),c=b.getService("RangeCreator").getSelectionManager().saveSelection(),b.logger.log({name:a,msg:"Save the selection",data:c,type:"selection"}),this.fireInAllApps("lockMutationsListener",{lock:!1}),c):void 0},this.isSelectionCollapsed=function(){var a=this.getSelection(),b=a.rangeCount()?a.getRangeAt(0).collapsed():!0;return b},this.restoreSelection=function(c){var d;return c&&e.apply(this)?(this.fireInAllApps("lockMutationsListener",{lock:!0}),d=b.getService("RangeCreator").getSelectionManager().restoreSelection(c),b.logger.log({name:a,msg:"Restore the selection",data:d,type:"selection"}),this.fire("selectionIsChanged",{action:"restoreSelection"}),this.fireInAllApps("lockMutationsListener",{lock:!1}),d):void 0},this.deleteStoredSelection=function(a){var b,c=!1;return a&&(b=this.saveSelection(),this.restoreSelection(a),this.restoreSelection(b),c=!0),c},this.removeMarkers=function(c){var d=b.getService("RangeCreator").getSelectionManager().removeMarkers(c);return b.logger.log({name:a,msg:"Removes the hidden marker",data:d,type:"selection"}),d},this.getBookmark=function(){var c,d,e;return e=b.getService("RangeCreator").getSelection(),e.rangeCount()?(d=e.getRangeAt(0),c=d.getBookmark(this.getOption("container")),b.logger.log({name:a,msg:"Save the bookmark",data:c,type:"range"}),c):void 0},this.moveToBookmark=function(c){var d;return c?(d=b.getService("RangeCreator").createRange(),d=d.moveToBookmark(c),b.logger.log({name:a,msg:"Move to bookmark",data:d,type:"range"}),d):void 0},this.getCaretRangeFromEvent=function(a){var b,c,d,e=a.clientX,f=a.clientY,g="wsc-caret-"+(new Date).getTime(),h=this.createRange(),i=this.getSelection(),j=(i.rangeCount()>0?i.getRangeAt(0):void 0,this.Utils.getCurrentDocument(this.getOption("documentContainer"))),k=this.getOption("container");if(j.caretPositionFromPoint)d=j.caretPositionFromPoint(e,f),h.setStart(d.offsetNode,d.offset),h.collapse(!0);else if(j.caretRangeFromPoint)d=j.caretRangeFromPoint(e,f),h.setStart(d.startContainer,d.startOffset),h.collapse(!0);else if(j.body.createTextRange){this.fire({element:k,eventType:"focus"}),b=j.body.createTextRange();try{b.moveToPoint(e,f),b.pasteHTML('<span id="'+g+'">â€‹</span>'),c=this.UILib.find("#"+g,k)[0],h.setStartBefore(c),h.collapse(!0),this.UILib.remove(c)}catch(l){return null}}return h},this.getCaretRangeFromPoint=function(a,b){var c,d,e=this.Utils.getCurrentDocument(this.getOption("documentContainer"));return e.caretPositionFromPoint?(c=e.caretPositionFromPoint(a,b))?(d=e.createRange(),d.setStart(c.offsetNode,c.offset),d.collapse(!0),d):null:e.caretRangeFromPoint?e.caretRangeFromPoint(a,b):null},this.getTextBasedClientRects=function(){var a,b=this.Utils.getCurrentDocument(this.getOption("documentContainer"));return this.getOption("isTextBasedContainer")?(a=b.createRange(),a.selectNodeContents(this.getOption("mirrorTextContainer")),a.getClientRects()):[]
},this.IO=Object.assign({},b.IO),this.OptionsManager=b.OptionsManager,this.RegularsManager=b.RegularsManager,this.initWebApi=b.initWebApi,this.Utils=b.Utils,this.Walker=b.Walker,this.logger=b.logger.log,b.logger.isON(b.options.debug),this.console=b.logger.console,this.Localization=b.Localization,this.Template=b.Template,this.clipboardManager=b.clipboardManager,this.DataStorage=b.DataStorage,this.FullUILib=b.UILib;var f=["cancelEvent","preventDefault","stopPropagation","stopImmediatePropagation","focus","blur","contextmenu","on","one","off","trigger"];this.UILib=c(this.FullUILib,f),this.DataProcessor=b.DataProcessor,this.UIMetrics=b.UIMetrics,this.CharCodeUtils=b.CharCodeUtils,this.getHtmlWithoutSpellingNodes=function(a){return this.DataProcessor.getHtmlWithoutSpellingNodes(a,this.getOption("misspelled_word_node"),this.getOption("misspelled_word_class"))},this.getHtmlWithoutGrammarNodes=function(a){return this.DataProcessor.getHtmlWithoutGrammarNodes(a,this.getOption("problem_grammar_node"),this.getOption("problem_grammar_class"))},this.getHtmlWithoutProblemNodes=function(a){return a=this.getHtmlWithoutSpellingNodes(a),a=this.getHtmlWithoutGrammarNodes(a)},this.getWordsFromString=function(a){return b.getService("WebApiAdapter").getWordsFromString(a)},this.replaceSepatators=function(a){return b.getService("WebApiAdapter").replaceSepatators(a)},this.removeSpecialCharacters=function(a){return b.getService("WebApiAdapter").removeSpecialCharacters(a)},this.cleanSpecialAndHtmlSpaceCharacters=function(a){var b=this.getRegExp("ieSeparator");return a=this.removeSpecialCharacters(a),a=b.replace(a," ")},this.blockEvents=function(a){for(var b=this.getOption("eventsBlockedState"),c=0;c<a.length;c++)b[a[c]]=!0;this.setOption("eventsBlockedState",b)},this.unblockEvents=function(a){for(var b=this.getOption("eventsBlockedState"),c=0;c<a.length;c++)b[a[c]]=!1;this.setOption("eventsBlockedState",b)},this.getInstance=function(){var a=this.getOption("uid"),c=b.instanceManager.getInstance(a);return c?c.instance:null},this.startProblemCheck=function(a){a=a||{},b.allModulesReady&&this.fire("startProblemCheck",a)},this.setMarkupPaused=function(a){var a=!!a,b=this.getPaused();b!==a&&(this.setPaused(a),a?this.removeAllDeferredFunctions():this.startProblemCheck())},this.getPaused=function(){return b.options.paused},this.setPaused=function(a){return b.options.paused=a},this.startApp=function(){this.getOption("proofreadAsYouType")&&this.startMarkup(),this.setOption("appStarted",!0)},this.stopApp=function(){this.stopMarkup(),this.setOption("appStarted",!1)},this.startMarkup=function(){this.setProblemMarkupPaused(!1),this.startProblemCheck()},this.stopMarkup=function(){this.fire("removeMarkupInDocument",{}),this.setProblemMarkupPaused(!0),this.removeAllDeferredFunctions()},this.setProblemMarkupPaused=function(a){var b=["startProblemCheck","tokensCollected","problemsFound","markupProblems","removeMarkup","removeMarkupInSelectionNode","removeMarkupInDocument","removeMarkupFromProblems","replaceProblem","ignoreProblem","ignoreAllProblems","startSpellCheck","startGrammarCheck"];this[a?"blockEvents":"unblockEvents"](b)},this.setMarkupStrategy=function(a){var c,d,e=["ChangeController","TokenCollector","ProblemFinder","ProblemMarkuper","ProblemProcessor"];this.setOption("markupStrategy",a);for(var f=0;f<e.length;f++)c=b.getService(e[f]),c&&(d=b.getService(a+c.type),c.setStrategy(d))},this.removeSentencesFromCache=function(a){for(var c=b.getService("SentencesDictionary"),d=0;d<a.length;d++){var e=a[d];c.handleCacheUpdate({sentence:e})}},this.getDictionary=function(){var a=b.getService("DictionaryManager"),c=a?a.dictionary:{};return c},this.getProblemDescriptionText=function(a,b){var c=this.getDictionary(),d=c.getProblemDescription?c.getProblemDescription(a,b):"";return d},this.fire=function(){var c=this.getOption("eventsBlockedState"),e=d(["eventType","data","instance","DOMElement"],arguments);return e.moduleID=a,b.logger.log({name:a,msg:"Fired event: "+e.eventType+" with such data -> ",data:e.data,type:"signals"}),b.options.paused===!0||c[e.eventType]?void 0:this.getCommunication().fire(e)},this.subscribe=function(){var c=d(["eventType","handler","context","priority","instance","element"],arguments);c.context=c.context||b.getService(a),c.moduleID=a;return this.getCommunication().subscribe(c)},this.unsubscribe=function(){var c=d(["eventType","context","context","instance","DOMElement"],arguments);return c.context=c.context||b.getService(a),c.moduleID=a,b.logger.log({name:a,msg:"Unsubscribe to the event: "+c.eventType,type:"signals"}),this.getCommunication().unsubscribe(c)},this.addEventProxy=function(c){return b.logger.log({name:a,msg:"Set event proxy between elements",data:c,type:"signals"}),b.getService("DOMCommunication").EventProxy.addEventProxy(c)},this.removeEventProxy=function(c){return b.logger.log({name:a,msg:"Remove event proxy between elements",data:c,type:"signals"}),b.getService("DOMCommunication").EventProxy.removeEventProxy(c)},this.fireInAllApps=function(a,c){b.instanceManager.notifyAll(a,c)},this.getAllApps=function(){return b.instanceManager.getAll()},this._getCoreOptionObject=function(){return b.options},this.getOption=function(c){for(var d="[object String]"==Object.prototype.toString.call(c)?[c]:c,e={},f=0;f<d.length;f++)e[d[f]]=b.options[d[f]];var g=1==d.length?e[d[0]]:e;return b.logger.log({name:a,msg:'Get the "'+d+'" option with value -> ',data:g,type:"options"}),g},this.getActions=function(a,c){return b.getService("ActionManager").getActions(a,c)},this.getProblemActions=function(a){return b.getService("ActionManager").getProblemActions(a)},this.getStaticActions=function(a){return b.getService("ActionManager").getStaticActions(a)},this.getProblemInfo=function(a){return b.getService("ProblemManager").getProblemInfo(a)},this.getNodeInfo=function(a){return b.getService("ProblemManager").getNodeInfo(a)},this.getFullNodeInfo=function(a){return b.getService("ProblemManager").getFullNodeInfo(a)},this.getChildProblemNodes=function(a){return b.getService("ProblemManager").getChildProblemNodes(a)},this.getParentProblemNodes=function(a){return b.getService("ProblemManager").getParentProblemNodes(a)},this.getProblemNodeFromMouseEvent=function(a){var c={Basic:function(){return b.getService("ProblemManager").getProblemNodeFromMouseEvent(a)},Virtual:function(){return e.getVirtualProblemManager().getProblemNodeFromMouseEvent(a)}},d=this.getOption("markupStrategy")||"Basic",e=this;return c[d]()},this.getProblemNodesFromPoint=function(a,c){return b.getService("ProblemManager").getProblemNodesFromPoint(a,c)},this.getProblemTypes=function(){return b.getService("ProblemManager").getProblemTypes()},this.tokenizeWords=function(a){return b.getService("WordTokenizer").tokenize(a)},this.prepareCustomPunctuation=function(){return b.getService("WordTokenizer").prepareCustomPunctuation()},this.tokenizeSentences=function(a){return b.getService("SentenceTokenizer").tokenize(a)},this.getRegExp=function(a){return b.getService("RegExpressions").getRegExp(a)},this.collectInfoFromNode=function(a,c){return b.getService("NodeInfoCollector").collect(a,c)},this.splitNode=function(a){return b.getService("NodeInfoCollector").split(a)},this.openDialog=function(){var a=this.getActions(["proofreadDialog"],[])[0];a.call()},this.openSettings=function(){var a=this.getActions(["settings"],[])[0];a.call()},this.markTextNodes=function(a){var b=this.getVirtualProblemManager();b&&b.markTextNodes&&b.markTextNodes(a)},this.updateProblemsRanges=function(a,b){var c=this.getVirtualProblemManager();c&&c.updateProblemsRanges&&c.updateProblemsRanges(a,b)},this.isIgnoredByClass=function(a){for(var b=this.getOption("ignoreClasses"),c=0;c<b.length;c++)if(this.UILib.hasClass(a,b[c]))return!0;return!1},this.isIgnoredByAttribute=function(a){for(var b=this.getOption("ignoreAttributes"),c=0;c<b.length;c++)if(this.UILib.attr(a,b[c]))return!0;return!1},this.isIgnoredElement=function(a){var b=this.getRegExp("ignoreElementsRegex");return b.match(a.nodeName)},this.hasIgnoredParent=function(a){for(var b=this.getOption("container");a&&a!==b;){if(this.isIgnoredElement(a))return!0;a=a.parentNode}return!1},this.canBeIgnored=function(){var a=this.getOption("isTextBasedContainer");return!a},this.getVirtualProblemManager=function(){var a=b.getService("ContenteditableMirror")||{};return a.virtualProblemManager||{}},this.isOriginalContainerTextBased=function(){return this.getOption("isTextBasedContainer")},this.getDefaultOption=function(a){for(var c="[object String]"==Object.prototype.toString.call(a)?[a]:a,d={},e=0;e<c.length;e++)d[c[e]]=b.options[c[e]].defaultValue;return 1==c.length?d[c[0]]:d},this.getLocal=function(a){return this.Localization.getLocal(a,this.getOption("localization"))},this.setOption=function(c,d){var e=this.getOption(this.getOption("syncOptions")?"commonPrefix":"uid");c in b.options&&(b.options[c]=d,this.getOption("options-to-restore").includes(c)!==!1&&(b.logger.log({name:a,msg:'Set the "'+c+'" option with value -> ',data:d,type:"options"}),this.DataStorage.setData(e+"_"+c,d)))},this.addDeferredFunction=function(a,c){b.getService("Deferred").register(a,c)},this.removeDeferredFunction=function(a,c){b.getService("Deferred").unregister(a,c)},this.removeAllDeferredFunctions=function(){var a=b.getService("Deferred");a&&a.unregisterAll()},this.setFocused=function(a){return b.options.focused=a},this.getFocused=function(){return b.options.focused},this.isFocused=function(){var a=this.getFocused(),b=this.getOption("documentContainer"),c=b===document.activeElement,d=b.contains(document.activeElement);return a||c||d},this.setContainer=function(a){return b.options.container=a},this.getProblemContainer=function(){return b.options.contenteditableMirrorContainer||b.options.container},this.getTextContainer=function(){return b.options.mirrorContainer||b.options.container},this.removeMarkupFromString=function(a){var b=this,c=document.createElement("div"),d=b.getOption("misspelled_word_node"),e=b.getOption("data_attribute_name"),f=b.getOption("problem_grammar_node"),g=b.getOption("problem_grammar_data_attribute");c.innerHTML=a;for(var h=b.UILib.findNodeChildren(c,d,e),i=b.UILib.findNodeChildren(c,f,g);h.length>0;){for(var j=h.shift(),k=document.createDocumentFragment();j.childNodes.length>0;)k.appendChild(j.childNodes.item(0));j.parentNode.insertBefore(k,j),j.parentNode.removeChild(j)}for(;i.length>0;){for(var l=i.shift(),k=document.createDocumentFragment();l.childNodes.length>0;)k.appendChild(l.childNodes.item(0));l.parentNode.insertBefore(k,l),l.parentNode.removeChild(l)}return c.innerHTML},this.getProblemNodeFromSelection=function(a){var b,c,d,e,f,g,h,i,j,k,l=this.getSelection(),m=l.isBackwards(),n=l.rangeCount()?l.getRangeAt(0):null,o=n?n.collapsed():!0,p=l.anchorNode(),q=this.getOption("ignored_problem_class");switch(a){case"spelling":i=this.getOption("misspelled_word_node"),j=this.getOption("data_attribute_name"),k=this.getOption("misspelled_word_class");break;case"grammar":i=this.getOption("problem_grammar_node"),j=this.getOption("problem_grammar_data_attribute"),k=this.getOption("problem_grammar_class")}if(h=this.Utils.isEqualNode(p,j)?p:this.UILib.findNodeParents(p,i,j)[0],!h&&!o){b=this.removeSpecialCharacters(n.toString()),b=m?b.split("").reverse().join(""):b,c=n.getNodes(),c=m?c.reverse():c;for(var r=0,s=c.length;s>r;r++)if(d=c[r],1===d.nodeType&&this.UILib.hasClass(d,k)){e=this.UILib.attr(d,j),e=m?e.split("").reverse().join(""):e,f=e.length>=b.length&&0===e.indexOf(b),g=e.length<b.length&&0===b.indexOf(e),(f||g)&&(h=d);break}}return h&&this.UILib.hasClass(h,q)&&(h=null),h},this.getSpellingNodeFromSelection=function(){return this.getProblemNodeFromSelection("spelling")},this.getGrammarNodeFromSelection=function(){return this.getProblemNodeFromSelection("grammar")},this.getSpellingNodesInElement=function(a){var b=a?a:this.getProblemContainer(),c=this.getOption("data_attribute_name");return this.UILib.find("["+c+"]",b)},this.getGrammarNodesInElement=function(a){var b=a?a:this.getProblemContainer(),c=this.getOption("problem_grammar_data_attribute");return this.UILib.find("["+c+"]",b)},this.getParentBlockElement=function(a,b){var c=b||this.getOption("container");if(!a)return c;if(!a.nodeType)return c;if(a=3===a.nodeType?a.parentNode:a,!c.contains(a))return c;for(;a!==c;){if(this.isBlockElement(a))return a;a=a.parentNode}return a},this.getOffsetData=function(a){var b,c=this.Utils.getCurrentDocument(this.getOption("documentContainer")),d=a.offsetParent||c.documentElement,e=d.getBoundingClientRect(),f=e.top,g=e.left;return d===c.body&&this.Utils.isStaticPositioned(d)&&(d=c.documentElement,e=d.getBoundingClientRect(),f=e.top,g=e.left,this.Utils.isStaticPositioned(d)&&(b=this.Utils.getComputedStyle(d),f-=parseFloat(b.marginTop),g-=parseFloat(b.marginLeft))),{offsetParent:d,top:f,left:g}},this.getPrevSymbol=function(a,b){var c,d,e=this.createRange(),f=document.createElement("div");return e.setStart(a,0),e.setEndBefore(b),c=e.cloneContents(),f.appendChild(c),d=f.textContent||f.innerText,d=this.removeSpecialCharacters(d),d[d.length-1]},this.getNextSymbol=function(a,b){var c,d,e=this.createRange(),f=document.createElement("div");return e.setStartAfter(b),e.setEnd(a,a.childNodes.length),c=e.cloneContents(),f.appendChild(c),d=f.textContent||f.innerText,d=this.removeSpecialCharacters(d),d[0]},this.getTextBeforeRange=function(a,b){var c,d,e=this.Utils.getCurrentDocument(this.getOption("documentContainer")),f=e.createRange(),g=document.createElement("div");return f.setStart(b,0),f.setEnd(a.startContainer,a.startOffset),c=f.cloneContents(),g.appendChild(c),d=g.textContent||g.innerText,d=this.removeSpecialCharacters(d)},this.getRangeText=function(a){return this.removeSpecialCharacters(a.toString())},this.getRangeTextInfo=function(a){var b=this.getOption("mirrorTextContainer"),c=this.getTextBeforeRange(a,b),d=this.getRangeText(a);return{textBeforeRange:c,rangeText:d}},this.isNodeContentBroken=function(a,b){var c=a.getAttribute(b),d=a.textContent||a.innerText;return d=this.removeSpecialCharacters(d),c!==d},this.getBrokenProblemNodes=function(a,b){var c,d,e,f,g=this.getOption("focused"),h=this.getSelection(),i=this.getRegExp("wordBoundaryRegex"),j=this;switch(a){case"spelling":f=this.getOption("data_attribute_name"),d="getSpellingNodesInElement";break;case"grammar":f=this.getOption("problem_grammar_data_attribute"),d="getGrammarNodesInElement"}return b?c=b:g&&(c=h.anchorNode()),c?(c=this.getParentBlockElement(c),e=this[d](c),e=e.filter(function(a){if(j.isNodeContentBroken(a,f))return!0;var b=j.getPrevSymbol(c,a);if(b&&!i.test(b))return!0;var d=j.getNextSymbol(c,a);return d&&!i.test(d)?!0:void 0})):void 0},this.getBrokenSpellingNodes=function(a){return this.getBrokenProblemNodes("spelling",a)},this.getBrokenGrammarNodes=function(a){return this.getBrokenProblemNodes("spelling",a)},this.getProblemsCount=function(){var a={Basic:function(){for(var a=c.getSpellingNodesInElement(),b=c.getGrammarNodesInElement(),d=a.concat(b),e=c.getOption("ignored_problem_class"),f=0,g=0,h=d.length;h>g;g++)c.UILib.hasClass(d[g],e)||(d[g].innerHTML||d[g].clientWidth)&&f++;return f},Virtual:function(){return c.getVirtualProblemManager().getProblemsCount()}},b=this.getOption("markupStrategy")||"Basic",c=this;return a[b]()},this.getTotalProblemsCount=function(){var a,b=0;if(!this.isGlobalProofreadDialog())return this.getProblemsCount();a=this.getAllApps();for(var c=0;c<a.length;c++)a[c].isGlobalProofreadDialog()&&(b+=a[c].getProblemsCount());return b},this.isCaretInStartOfMisspelledWord=function(){var a,b,c,d=this.getSelection(),e=d.rangeCount()?d.getRangeAt(0):null,f=this.getOption("data_attribute_name"),g=this.getOption("container"),h=this.getRegExp("wordBoundaryRegex");if(!e||!e.collapsed())return!1;if(a=this.getSpellingNodeFromSelection())return 0===e.startOffset()?a:!1;b=new this.Walker(e.startContainer(),e.startOffset(),!0,g);do{if(b.siblingNode&&this.isBlockElement(b.siblingNode))break;if(this.Utils.isEqualNode(b.currentNode,f)){a=b.currentNode;break}if(c=this.replaceSepatators(b.textWalkedThrough),h.test(c))break}while(b.getNext());return a},this.isCaretInEndOfMisspelledWord=function(){var a,b,c,d,e,f=this.getSelection(),g=f.rangeCount()?f.getRangeAt(0):null,h=this.getOption("data_attribute_name"),i=this.getOption("container");if(!g||!g.collapsed())return!1;if(a=this.getSpellingNodeFromSelection()){if(b=g.startContainer(),g.startOffset()===b.length&&a.childNodes[a.childNodes.length-1]===b)return!0}else{if(c=g.startContainer(),c.childNodes&&c.childNodes.length>0){if(c=c.childNodes[g.startOffset()],!c)return!0}else if(0!==g.startOffset())return!1;d=new this.Walker(c,0,!1,i);do if(this.Utils.isEqualNode(d.currentNode,h)&&d.textWalkedThrough.length>0){a=d.currentNode,a=this.getLatestTextNodeFromSpellingNode(a);break}while(d.getNext());if(!a)return!1;if(e=this.createRange(),e.setStart(a,a.nodeValue.length),e.setEnd(c,0),0===e.toString().length)return!0}return!1},this.getLatestTextNodeFromSpellingNode=function(a){for(;a.childNodes.length;)a=a.childNodes[a.childNodes.length-1];return a},this.saveRange=function(c,d){var e;return e=b.getService("RangeCreator").getRangeManager().saveRange(c,d),b.logger.log({name:a,msg:"Save the range",data:e,type:"range"}),e},this.restoreRange=function(c,d){var e;return c?(e=b.getService("RangeCreator").getRangeManager().restoreRange(c,d),b.logger.log({name:a,msg:"Restore the range",data:e,type:"range"}),e):void 0},this.getMainProblemContainer=function(){return this.getOption("isIframe")?this.getOption("documentContainer"):this.getProblemContainer()},this.getCkeditorInstance=function(){return this.getOption("container").ckeditorInstance},this.getContainerInstance=function(){var a=b.getService("Wrapper"),c=b.getService("Mirror"),d=this.getCkeditorInstance();return d&&d.getData&&d.setData?d:a?a:c?c:null},this.getDataFromContainer=function(){var a=this.getContainerInstance();return a?a.getData():this.getHtmlWithoutProblemNodes(this.getOption("originalContainer").innerHTML)},this.setDataToContainer=function(a){var b=this.getContainerInstance();if("string"==typeof a){if(b)return void b.setData(a);a=this.getHtmlWithoutProblemNodes(a),this.getOption("originalContainer").innerHTML=a}},this.getNeighbourProblemNodes=function(a){function b(a,b,c,d){var j,k,l,m,n,o=e.getOption("container"),p=e.getRegExp("nonWhiteSpaceExtended"),q=p.g(),r=e.getRegExp("punctuationRegExp").set(),s=e.getRegExp("wordBoundaryRegex"),t=e.getOption("backspaceKeyButtonPressed"),u=e.getOption("deleteKeyButtonPressed"),v=e.getOption("spaceKeyButtonPressed"),w=e.getOption("enterKeyButtonPressed"),x=e.getOption("isTouchDevice");if(c){n=new e.Walker(c,d,a,o);do{if(n.siblingNode&&e.isBlockElement(n.siblingNode)&&n.textWalkedThrough.length>0&&p.test(n.textWalkedThrough))break;if(f.isEqualNode(n.currentNode,h)&&n.textWalkedThrough.length>0){j=n.currentNode;break}if(k=n.textWalkedThrough,l=r.g().replace(n.textWalkedThrough," "),m=-1!==r.search(k),a||(k=k.split("").reverse().join(""),l=l.split("").reverse().join("")),b){if((v||w)&&!a&&s.test(k)){j=g.findNodeParents(n.currentNode,i,h)[0];break}if(u&&!a&&0===k.search(/\s/))break;if(t&&a&&0===k.search(/\s/))break;if(m&&!u&&!t&&!x){j=g.findNodeParents(n.currentNode,i,h)[0];break}}if(q.setLastIndex(0),q.test(b?l:k)&&q.getLastIndex()+1<=k.length){j=g.findNodeParents(n.currentNode,i,h)[0];break}}while(n.getNext())}return{problemNode:j,text:k}}var c,d,e=this,f=this.Utils,g=this.UILib,h=this.getOption(a.attrName),i=this.getOption(a.nodeName),j=this.getOption("backspaceKeyButtonPressed"),k=this.getOption("deleteKeyButtonPressed"),l=[];return c=b(!1,a.wordBased,a.leftStartNode,a.leftStartOffset),d=b(!0,a.wordBased,a.rightStartNode,a.rightStartOffset),a.wordBased&&(j&&/^\s{2,}/.test(c.text)&&(c.problemNode=null,d.problemNode=null),k&&/^\s{2,}/.test(d.text)&&(c.problemNode=null,d.problemNode=null),(j||k)&&/^\s+/.test(c.text)&&/^\s+/.test(d.text)&&(c.problemNode=null,d.problemNode=null)),l=l.concat(c.problemNode,d.problemNode)},this.getNearestNotEmptyTextNode=function(a){var b,c,d=this.getRegExp("nonWhiteSpaceExtended"),e={node:null,parentBlock:null,offset:0};b=new this.Walker(a.startContainer,a.startOffset,a.direction,a.stopContainer);do{if(b.siblingNode&&this.isBlockElement(b.siblingNode))break;if(c=this.cleanSpecialAndHtmlSpaceCharacters(b.textWalkedThrough),d.test(c)){e.node=b.currentNode;break}}while(b.getNext());return e.node?(e.offset=a.startContainer===e.node?a.startOffset:a.direction?0:e.node.nodeValue.length,e.parentBlock=this.getParentBlockElement(e.node,a.stopContainer),e):e},this.getLogo=function(){return this.getOption("basePath")+this.getOption("wscLogo")},this.isRemoveBranding=function(){return this.getOption("removeBranding")&&this.getOption("canRemoveBranding")},this.getSettingsSections=function(){var a=this.getOption("settingsSections"),b=this.isRemoveBranding()?[]:this.getOption("defaultSettingsSections");return a=this.Utils.ArrayUtils.arrayUnique(a.concat(b))},this.isBlockElement=function(a){var b=this.getRegExp("blockElementsRegex");return a&&1===a.nodeType?"block"===this.Utils.getComputedStyle(a).display?!0:b.match(a.nodeName)?!0:!1:!1},this.getWindow=function(){var a=this.Utils.getCurrentDocument(this.getOption("documentContainer")),b=this.Utils.getWindowByDocument(a);return b},this.getProblemsIds=function(){var a={Basic:function(){var a,b=c.getOption("container"),d=c.getOption("data_id_attribute"),e=[],f={};e=c.UILib.query(b,"["+d+"]");for(var g=0;g<e.length;g++)a=c.UILib.attr(e[g],d),f[a]=!0;return f},Virtual:function(){var a=c.getVirtualProblemManager(),b={};return a.each(function(a){b[a.id]=!0}),b}},b=this.getOption("markupStrategy")||"Basic",c=this;return a[b]()},this.getActionItemsForContextMenu=function(a){var b=this.getOption("enableBadgeButton"),c=this.getOption("hideStaticActions"),d=this.getOption("autocorrect_data_attribute"),e=this.Utils.isEqualNode(a,d);return{control:this.getProblemActions(a).control,"static":b||e||c?[]:this.getStaticActions()}},this.getTextLength=function(){var a,b=this.getOption("container"),c=this.getOption("isTextBasedContainer");return a=c&&"value"in b?b.value:b.textContent||b.innerText||"",a.trim().length},this.getTotalTextLength=function(){var a,b=0;if(!this.isGlobalProofreadDialog())return this.getTextLength();a=this.getAllApps();for(var c=0;c<a.length;c++)a[c].isGlobalProofreadDialog()&&(b+=a[c].getTextLength());return b},this.isSyncOptions=function(){return this.getOption("syncOptions")},this.isGlobalProofreadDialog=function(){return this.getOption("globalProofreadDialog")&&"Virtual"===this.getOption("markupStrategy")},this.isIframeInQuirksModeInEdge=function(){var a=this.Utils.Browser.edge,b=this.getOption("isIframe"),c=this.getOption("documentContainer"),d=c.contentDocument;return a&&b&&d&&!d.doctype},this.getWordDataBeforeCursor=function(){return this.isOriginalContainerTextBased()?this.getTextBasedWordDataBeforeCursor():this.getContenteditableWordDataBeforeCursor()},this.getTextBasedWordDataBeforeCursor=function(){var a,b,c=this.getOption("container"),d=c.selectionStart,e={word:"",start:0,end:d,textBased:!0};if(0===d)return e;for(var f=d-1;f>=0;f--){if(a=c.value[f],b=a.charCodeAt(0),this.CharCodeUtils.isWhiteSpace(b)){e.start=f+1;break}if(this.CharCodeUtils.isPunctuation(b)||this.CharCodeUtils.isSituationalSeparator(b))return{word:"",start:0,end:0,textBased:!0};e.word=a+e.word}return e},this.getContenteditableWordDataBeforeCursor=function(){var a,b,c,d,e,f,g,h,i=this.getOption("container"),j=this.getWindow().getSelection(),k=this.Utils.getCurrentDocument(this.getOption("documentContainer")),l=!1,m=!1,n={range:null,word:""};if(!j.rangeCount)return n;a=j.getRangeAt(0),b=new this.Walker(a.startContainer,a.startOffset,l,i);do{if(b.currentNode&&3===b.currentNode.nodeType){g||(g=b.currentNode,h=b.textWalkedThrough.length);for(var o=b.textWalkedThrough.length-1;o>=0;o--){if(c=b.textWalkedThrough[o],d=c.charCodeAt(0),this.CharCodeUtils.isWhiteSpace(d)){b.currentNode.nodeValue.length-1>o&&(e=b.currentNode,f=o+1),m=!0;break}if(0===o){e=b.currentNode,f=0;break}if(this.CharCodeUtils.isPunctuation(d)||this.CharCodeUtils.isSituationalSeparator(d))return n}}if(m)break;if(b.siblingNode&&this.isBlockElement(b.siblingNode))break}while(b.getNext());return e&&3===e.nodeType&&g&&3===g.nodeType&&(n.range=k.createRange(),n.range.setStart(e,f),n.range.setEnd(g,h),n.word=n.range.toString()),n},this.getTextBasedRange=function(a,b){var c=this.getOption("mirrorTextContainer"),d=this.collectInfoFromNode(c,{fullInfo:!0}),e=this.Utils.getRangeBoundaryPoints(d.customModel,a,b-1),f=this.Utils.getCurrentDocument(this.getOption("documentContainer")),g=f.createRange();return g.setStart(e.startContainer,e.startOffset),g.setEnd(e.endContainer,e.endOffset),g},this.createTemporaryProblem=function(a,b){return{range:a,text:b,id:this.Utils.getUniqueId(),parentBlock:this.getParentBlockElement(a.startContainer,this.getTextContainer())}},this.markTextNode=function(a){var b=a.range.startContainer,c=a.range.endContainer,d=this.getOption("markPrefixStart"),e=this.getOption("markPrefixEnd"),f={text:a.text||"",type:a.type||"",lang:a.lang||"",rule:a.rule||"",id:a.id||"",label:a.label||!1,offset:a.range.startOffset},g={offset:a.range.endOffset,startMark:f};b[d]=b[d]||[],c[e]=c[e]||[],b[d].push(f),c[e].push(g)},this.getRangePosition=function(a){var b,c=this.Utils.getCurrentDocument(this.getOption("documentContainer")),d=c.createRange(),e=this.getOption("container");return d.setStart(e,0),d.setEnd(a.startContainer,a.startOffset),b=d.toString().length,{start:b,end:b+a.toString().length}},this.getSelectionRange=function(){var a=this.getWindow().getSelection();return a.rangeCount?a.getRangeAt(0):null},this.getRangeByPosition=function(a,b,c){var d=0,e=this.Utils.getCurrentDocument(this.getOption("documentContainer")),f=e.createRange(),g=[a],h=g.shift(),i=!1,j=!1;for(f.setStart(a,0),f.collapse(!0);h;){switch(h.nodeType){case 3:var k=d+h.length;!i&&b>=d&&k>=b&&(f.setStart(h,b-d),i=!0),i&&c>=d&&k>=c&&(f.setEnd(h,c-d),j=!0),d=k;break;case 1:for(var l=0;l<h.childNodes.length;l++)g.splice(l,0,h.childNodes[l])}if(j)break;h=g.shift()}return f}},function(a){"use strict";function b(){function a(a){return function(){return e||(e=WEBSPELLCHECKER.CORE.jquip),a.apply(f,arguments)}}for(var b in f)f.hasOwnProperty(b)&&"function"==typeof f[b]&&(f[b]=a(f[b]))}var c,d,e;d=function(){function a(a){var b=a,c=Object.prototype.toString.call(a).slice(8,-1).toLowerCase();return a&&"object"===c&&"undefined"!=typeof a.toArray&&(b=a.toArray()),b}function b(a){var b=[],c=Object.prototype.toString.call(a).slice(8,-1).toLowerCase();if(a&&("htmlcollection"===c||"nodelist"===c||"object"===c&&"undefined"!=typeof a.length&&"undefined"!=typeof a[0]&&"undefined"==typeof a.nodeType)){for(var d=0;d<a.length;b.push(a[d]),d++);a=b}return e(a)}this.find=function(c,d){var e;return e="undefined"==typeof d?b(c):b(d).find(c),a(e)},this.parent=function(c,d){var e=b(c).parent(d);return a(e)},this.parents=function(c,d){var e=b(c).parents(d);return a(e)},this.is=function(c,d){var e=b(c).is(d);return a(e)},this.each=function(a,c){b(a).each(c)},this.filter=function(c,d){var e=b(c).filter(d);return a(e)},this.create=function(b){return a(e(b))},this.remove=function(b){return a(e(b).remove())},this.appendTo=function(b,c){return a(e(b).appendTo(e(c)))},this.prependTo=function(b,c){return a(e(b).prependTo(e(c)))},this.append=function(b,c){return a(e(b).append(e(c)))},this.prepend=function(b,c){return a(e(b).prepend(e(c)))},this.insertAfter=function(b,c){return a(e(b).insertAfter(e(c)))},this.insertBefore=function(b,c){return a(e(b).insertBefore(e(c)))},this.attr=function(b,c,d){return a(e(b).attr(c,d))},this.removeAttr=function(b,c){return a(e(b).removeAttr(c))},this.addClass=function(b,c){return a(e(b).addClass(c))},this.removeClass=function(b,c){return a(e(b).removeClass(c))},this.hasClass=function(b,c){return a(e(b).hasClass(c))},this.css=function(b,c){return a(e(b).css(c))},this.show=function(b){return a(e(b).show())},this.hide=function(b){return a(e(b).hide())},this.html=function(b,c){return a(e(b).html(c))},this.val=function(b,c){return a(e(b).val(c))},this.text=function(b,c){return a(e(b).text(c))},this.empty=function(b){return a(e(b).empty())},this.domReady=function(a){e(a)},this.on=function(a,b,c,d){e(b).on(a,c,d)},this.off=function(a,b,c,d){e(b).off(a,c,d)},this.trigger=function(a,b){return e(b).trigger(a)},this.getEventTarget=function(a){var b=a.target;return b||(b=a.srcElement||document),3===b.nodeType&&(b=b.parentNode),b},this.cancelEvent=function(a){return e.cancelEvent(a)},this.preventDefault=function(a){a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},this.defaultPrevented=function(a){return a?void 0!==a.defaultPrevented?a.defaultPrevented:a.returnValue===!1?!0:!1:a.defaultPrevented},this.stopPropagation=function(a){a&&(a.cancelBubble=!0,a.stopPropagation&&a.stopPropagation())},this.stopImmediatePropagation=function(a){a&&(a.isImmediatePropagationStopped=function(){return!0},this.stopPropagation(a),a.stopImmediatePropagation&&a.stopImmediatePropagation())},this.focus=function(){var b,c=[];return Array.prototype.push.apply(c,arguments),b=e(c.shift()),a(b.focus.apply(b,c))},this.blur=function(){var b,c=[];return Array.prototype.push.apply(c,arguments),b=e(c.shift()),a(b.blur.apply(b,c))},this.contextmenu=function(){var b,c=[];return Array.prototype.push.apply(c,arguments),b=e(c.shift()),a(b.contextmenu.apply(b,c))},this.proxy=function(a,b){return e.proxy(a,b)},this.width=function(a){return e(a).width()},this.height=function(a){return e(a).height()},this.outerWidth=function(a,b){return e(a).outerWidth(b)},this.outerHeight=function(a,b){return e(a).outerHeight(b)},this.scrollLeft=function(a,b){return e(a).scrollLeft(b)},this.scrollTop=function(a,b){return e(a).scrollTop(b)},this.offset=function(a){return e(a).offset()},this.extend=function(){return e.extend.apply(e,arguments)}},c=new d;var f={find:function(){return c.find.apply(c,arguments)},parent:function(){return c.parent.apply(c,arguments)},parents:function(){return c.parents.apply(c,arguments)},is:function(){return c.is.apply(c,arguments)},each:function(){c.each.apply(c,arguments)},filter:function(){return c.filter.apply(c,arguments)},create:function(){return c.create.apply(c,arguments)},remove:function(){return c.remove.apply(c,arguments)},appendTo:function(){return c.appendTo.apply(c,arguments)},prependTo:function(){return c.prependTo.apply(c,arguments)},append:function(){return c.append.apply(c,arguments)},prepend:function(){return c.prepend.apply(c,arguments)},insertAfter:function(){return c.insertAfter.apply(c,arguments)},insertBefore:function(){return c.insertBefore.apply(c,arguments)},replace:function(a,b){return c.insertBefore.apply(c,arguments),c.remove.apply(c,b)},attr:function(){return c.attr.apply(c,arguments)},removeAttr:function(){return c.removeAttr.apply(c,arguments)},addClass:function(a,b){return this.hasClass(a,b)?void 0:c.addClass.apply(c,arguments)},removeClass:function(a,b){return this.hasClass(a,b)?c.removeClass.apply(c,arguments):void 0},hasClass:function(){return c.hasClass.apply(c,arguments)},css:function(){return c.css.apply(c,arguments)},show:function(){return c.show.apply(c,arguments)},hide:function(){return c.hide.apply(c,arguments)},html:function(){return c.html.apply(c,arguments)},val:function(){return c.val.apply(c,arguments)},text:function(){return c.text.apply(c,arguments)},empty:function(){return c.empty.apply(c,arguments)},domReady:function(a){c.domReady(a)},on:function(a,b,d,e){void 0===e&&(e=d,d=void 0),c.on.apply(c,[a,b,d||e,e])},off:function(a,b,d,e){void 0===e&&"function"==typeof d&&(e=d,d=void 0),c.off.apply(c,[a,b,d,e])},trigger:function(a,b,d){return d?(b=this.find(b)[0],b.dispatchEvent?b.dispatchEvent(d):b.fireEvent?b.fireEvent("on"+a,d):void 0):c.trigger.apply(c,arguments)},getEventTarget:function(){return c.getEventTarget.apply(c,arguments)},cancelEvent:function(){return c.cancelEvent.apply(c,arguments)},createEvent:function(){var a;
return document.createEvent?a=document.createEvent("Event"):document.createEventObject&&(a=document.createEventObject()),a},preventDefault:function(a){c.preventDefault(a)},stopPropagation:function(a){c.stopPropagation(a)},stopImmediatePropagation:function(a){c.stopImmediatePropagation(a)},isDefaultPrevented:function(a){return c.defaultPrevented(a)},focus:function(){return c.focus.apply(c,arguments)},blur:function(){return c.blur.apply(c,arguments)},contextmenu:function(){return c.contextmenu.apply(c,arguments)},proxy:function(){return c.proxy.apply(c,arguments)},width:function(){return c.width.apply(c,arguments)},height:function(){return c.height.apply(c,arguments)},outerWidth:function(){return c.outerWidth.apply(c,arguments)},outerHeight:function(){return c.outerHeight.apply(c,arguments)},scrollLeft:function(){return c.scrollLeft.apply(c,arguments)},scrollTop:function(){return c.scrollTop.apply(c,arguments)},offset:function(){return c.offset.apply(c,arguments)},extend:function(){return c.extend.apply(c,arguments)},setPosition:function(a,b,c){"number"==typeof b&&"number"==typeof c&&this.css(a,{left:b,top:c})},query:function(a,b){return this.find(b,a)},findNodeChildren:function(a,b,c){return this.find(b+"["+c+"]",a)},findNodeParents:function(a,b,c){return this.parents(a,b+"["+c+"]")}};b(),a.UILib=f}(WEBSPELLCHECKER.CORE.prototype),function(a){"use strict";if(!a.instanceManager){var b=[],c=0,d={add:function(a){b.push(a),c++},remove:function(a){for(var c=0;c<b.length;c++)b[c].getOption("uid")===a&&b.splice(c,1)},notifyAll:function(a,c){for(var d=0;d<b.length;d++)b[d].fire(a,c)},getAll:function(){for(var a=[],c=0;c<b.length;c++)a.push(b[c]);return a},getUniqueId:function(b){var d=a.Utils.hashCode(location.href);return b.id?b.id+"_"+d:"wsc_"+c+"_"+d},getInstance:function(a){for(var c=null,d=0;d<b.length;d++)b[d].getOption("uid")===a&&(c=b[d]);return c},getInstances:function(){for(var a=[],c=0;c<b.length;c++)a.push(b[c].instance);return a},getControlById:function(a){for(var c=null,d=0;d<b.length;d++)if(b[d].originalElementId&&b[d].originalElementId===a){c=b[d].instance;break}return c},getInstanceByElement:function(a){for(var c=null,d=0;d<b.length;d++){var e=b[d],f=e.getOption("container"),g=e.getOption("originalContainer"),h=e.getOption("documentContainer");if(a===f||a===g||a===h){c=e.instance;break}}return c},destroyAll:function(){for(var a=b.length-1;a>=0;a--){var d=b[a].instance;d&&d.destroy&&d.destroy()}b=[],c=0}};a.instanceManager=d}}(WEBSPELLCHECKER.CORE.prototype),function(a){"use strict";var b={isSpecialCharacter:function(a){return 8203===a||65279===a},isSituationalSeparator:function(a){return 39===a||45===a||46===a||8217===a},isWordBoundary:function(a,b){return this.isWhiteSpace(a)||this.isPunctuation(a)||this.isCustomPunctuation(a,b)},isWordBoundaryExtended:function(a,b){return this.isWordBoundary(a,b)||this.isExtraWhiteSpace(a)||this.isSituationalSeparator(a)},isWhiteSpace:function(a){return a>=9&&13>=a||32===a||133===a||160===a||5760===a||6158===a||a>=8192&&8202>=a||8232===a||8233===a||8239===a||8287===a||65279===a},isExtraWhiteSpace:function(a){return 8203===a||8204===a},isWhiteSpaceExtended:function(a){return this.isWhiteSpace(a)||this.isExtraWhiteSpace(a)},isPunctuation:function(a){return a>=32&&38>=a||a>=40&&44>=a||47===a||a>=58&&64>=a||a>=91&&95>=a||a>=123&&126>=a||1548===a||1563===a||1567===a||a>=1&&31>=a||a>=128&&182>=a||a>=184&&191>=a||a>=8192&&8202>=a||a>=8204&&8216>=a||a>=8218&&9839>=a||a>=11776&&11903>=a},isCustomPunctuation:function(a,b){return b.includes(a)},isNewLine:function(a){return 10===a||13===a||8233===a},isSentenceEnd:function(a){return 46===a||33===a||63===a}};a.CharCodeUtils=b}(WEBSPELLCHECKER.CORE.prototype),function(a){"use strict";var b=a.CharCodeUtils,c=Object.assign({isEmptyObject:function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},findFirstNodeWithString:function(a,b){for(var c=[a],d=c.shift();d;){switch(d.nodeType){case 3:if(-1!==d.nodeValue.indexOf(b))return d;break;case 1:for(var e=0;e<d.childNodes.length;e++)c.splice(e,0,d.childNodes[e]);c.length>d.childNodes.length&&c.splice(e,0,document.createTextNode(" "))}d=c.shift()}return null},isEqualNode:function(a,b){return a&&a.getAttribute&&a.getAttribute(b)?!0:!1},isLocalStorageSupported:function(){try{return window.localStorage.setItem("_localStorageSupported",1),window.localStorage.removeItem("_localStorageSupported"),!0}catch(a){return!1}},removeFillingCharacter:function(a){return a=a.replace(new RegExp(String.fromCharCode(8204),"g"),"")},removeGlobal:function(a,b){b=b||window;try{delete b[a]}catch(c){b[a]=void 0}},getCurrentDocument:function(a){return"iframe"===a.nodeName.toLowerCase()&&a.contentWindow&&a.contentWindow.document?a.contentWindow.document:document},getComputedStyle:function(a){return window.getComputedStyle?window.getComputedStyle(a):a.currentStyle},getScrollLeftForInput:function(a){var b,c,d,e,f,g,h;return a.createTextRange?(b=a.createTextRange(),c=b.getBoundingClientRect(),d=a.getBoundingClientRect(),e=this.getComputedStyle(a),f=parseFloat(e.paddingLeft),g=a.clientLeft,h=d.left+g+f-c.left):h=a.scrollLeft,h},getScrollWidthForInput:function(a){var b,c,d;return a.createTextRange?(b=a.createTextRange(),c=b.getBoundingClientRect(),d=c.width+30):d=a.scrollWidth,d},reduceCoordinates:function(a){for(var b,c,d,e=a[0],f=0;f<a.length;f++)b=a[f]||{top:0,left:0},c=parseInt(b.top),d=parseInt(b.left),c=isNaN(c)?0:c,d=isNaN(d)?0:d,0===f?(e.top=c,e.left=d):(e.top+=c,e.left+=d);return e},isStaticPositioned:function(a){return"static"===this.getComputedStyle(a).position},getCoordinates:function(a){var b=this.isStaticPositioned(document.body)?document.documentElement:document.body,c=b.getBoundingClientRect(),d=a.getBoundingClientRect(),e=d.top-c.top,f=d.left-c.left,g=this.getComputedStyle(b);return"html"===b.tagName.toLowerCase()&&this.isStaticPositioned(b)&&(e+=parseFloat(g.marginTop),f+=parseFloat(g.marginLeft)),"body"===b.tagName.toLowerCase()&&(e-=parseFloat(g.borderTopWidth),f-=parseFloat(g.borderLeftWidth)),{top:e,left:f}},scrollToNodeInContainer:function(a){var b,c=a.measureContainer.getBoundingClientRect(),d=a.node.getBoundingClientRect();c=a.isIframe?{top:0,bottom:c.bottom-c.top}:c,d.top>c.top&&d.bottom<c.bottom||(a.scrollContainer.scrollTop=0,a.nodeContainer.scrollTop=0,d=a.node.getBoundingClientRect(),b=d.top-c.top,a.scrollContainer.scrollTop=b)},scrollToNodeInDocument:function(a){var b,c,d,e,f=50;this.isPageScrollable()&&(b=a.measureContainer.getBoundingClientRect(),c=a.node.getBoundingClientRect(),d=document.documentElement.clientHeight,c=a.isIframe?{top:b.top+c.top,bottom:b.top+c.bottom}:c,c.top>=0&&c.bottom<=d||(e=document.documentElement.scrollTop+(c.top<0?c.top-f:c.bottom-d+f),document.documentElement.scrollTop=e))},elementsFromPoint:function(a,b,c){var d,e=[],f=[];if(c.elementsFromPoint||c.msElementsFromPoint)return c.elementsFromPoint?c.elementsFromPoint(a,b):c.msElementsFromPoint(a,b);for(;(d=c.elementFromPoint(a,b))&&-1===e.indexOf(d)&&"HTML"!==d.tagName;)e.push(d),f.push(d.style.pointerEvents),d.style.pointerEvents="none";for(var g=0;g<e.length;g++)e[g].style.pointerEvents=f[g]?f[g]:"";return e},escapeHTML:function(a){return a=a.replace(/&/g,"&amp;"),a=a.replace(/</g,"&lt;"),a=a.replace(/>/g,"&gt;"),a=a.replace(/"/g,"&quot;")},getVisibilityApiData:function(){var a={};return"undefined"!=typeof document.hidden?(a.hidden="hidden",a.visibilityChangeEvent="visibilitychange"):"undefined"!=typeof document.webkitHidden&&(a.hidden="webkitHidden",a.visibilityChangeEvent="webkitvisibilitychange"),a},getWindowByDocument:function(a){return"defaultView"in a?a.defaultView:a.parentWindow},getUrl:function(a,b){return-1===a.indexOf(":/")&&0!==a.indexOf("/")&&(a=b+a),a},is:function(a,b){var c=Object.prototype.toString.call(a).slice(8,-1);return void 0!==a&&null!==a&&c===b},getLocationInfo:function(a){var b=document.createElement("a");return b.href=a,{protocol:b.protocol.replace(/:/,""),host:b.host.split(":")[0],port:"0"===b.port||""===b.port?"80":b.port,pathname:b.pathname.replace(/^\//,"")}},hashCode:function(a){var b,c=0;if(0===a.length)return c;for(var d=0,e=a.length;e>d;d++)b=a.charCodeAt(d),c=(c<<5)-c+b,c&=c;return c},getUniqueId:function(){return(new Date).getTime().toString(36)+Math.random().toString(36).substr(2,9)},trunc:function(a,b){return a.length>b?a.substr(0,b)+"&hellip;":a},getBaseData:function(a){var b,c,d,e,f,g,h="/",i=".js";if(document.currentScript&&(b=document.currentScript,c=b.src,d=c.substring(c.lastIndexOf(h)+h.length,c.lastIndexOf(i)+i.length),a||(a=d),d===a&&(e=b,f=c)),g=new RegExp("(^|.*[\\\\/])"+a+"(?:\\?.*)?$","i"),f)f=f.match(g)[1];else for(var j=document.getElementsByTagName("script"),k=0;k<j.length;k++){var l;if(0!==j[k].src.indexOf("data:")&&(l=j[k].src.match(g))){e=j[k],f=l[1];break}}return f&&-1===f.indexOf(":/")&&(f=0===f.indexOf("/")?window.location.href.match(/^.*?:\/\/[^\/]*/)[0]+f:window.location.href.match(/^[^\?]*\/(?:)/)[0]+f),{path:f,script:e}},getOptionsFromDataAttrs:function(a,b){for(var c=a.attributes,d=["autocreate"],e={},f="",g="",h="",i=0;i<c.length;i++)if(f=c[i].name,0===f.indexOf(b)){if(h=f.substring(b.length,f.length),d.includes(h))continue;g=a.getAttribute(b+h),g="true"===g?!0:g,g="false"===g?!1:g,e[h]=g}return e},isTextBased:function(a){var b=["textarea","text","search","url"];return a?b.indexOf(a.type)>=0:!1},isInputBased:function(a){var b=["text","search","url"];return a?b.indexOf(a.type)>=0:!1},isHidden:function(a){return!a.offsetWidth&&!a.offsetHeight},isInPage:function(a){return document.getElementsByTagName("body")[0].contains(a)},isNodeAvailable:function(a){return this.isInPage(a)&&!this.isHidden(a)},isTouchDevice:function(){var a="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch;return a?!0:!1},isMutationObserver:function(){return"MutationObserver"in window?!0:!1},pushOrConcat:function(a,b){return Array.isArray(b)?a=a.concat(b):a.push(b),a},HTMLCollectionToArray:function(a){for(var b=a.length,c=new Array(b),d=b-1;d>=0;d--)c[d]=a[d];return c},isUppercaseLetter:function(a){var b=a.charAt(0);return b===b.toUpperCase()&&b!==b.toLowerCase()?!0:!1},isLowercaseLetter:function(a){var b=a.charAt(0);return b!==b.toUpperCase()&&b===b.toLowerCase()?!0:!1},startsWithSpaceAndUppercaseLetter:function(a){var b,c=/^[\s\xA0]+(?=\S{1})/g.exec(a);return c?(b=a.charAt(c[0].length),this.isUppercaseLetter(b)):!1},hasUppercaseLetter:function(a){for(var b=0;b<a.length;b++)if(this.isUppercaseLetter(a[b]))return!0;return!1},capitalizeFirstLetter:function(a){return a.charAt(0).toUpperCase()+a.slice(1)},isAllCapsLetters:function(a){return a.toUpperCase()===a.toLowerCase()?!1:a===a.toUpperCase()?!0:!1},isMixedCapsLetters:function(a){return a===a.toLowerCase()?!1:a===a.toUpperCase()?!1:this.hasUppercaseLetter(a.split("").slice(1).join(""))?!0:!1},isLettersWithNumbers:function(a){return a.replace(/[0-9]/g,"")!==a?!0:!1},isDomainName:function(a){return a.replace(/\./g,"")!==a?!0:!1},getCoordinatesFromRange:function(a){var b,c=a.getClientRects(),d=[],e=function(a){b={top:a.top,right:a.right,bottom:a.bottom,left:a.left}};if(!c.length)return[a.getBoundingClientRect()];if(1===c.length)return[c[0]];e(c[0]);for(var f=1;f<c.length;f++)c[f].left>=b.left?(b.top=Math.min(b.top,c[f].top),b.bottom=Math.max(b.bottom,c[f].bottom)):(d.push({top:b.top,right:c[f-1].right,bottom:b.bottom,left:b.left}),e(c[f]));return d.push({top:b.top,right:c[f-1].right,bottom:b.bottom,left:b.left}),d},isEqualRanges:function(a,b){return a.startContainer===b.startContainer&&a.startOffset===b.startOffset&&a.endContainer===b.endContainer&&a.endOffset===b.endOffset},inRect:function(a,b){return a.left>=b.left&&a.left<=b.left+b.width&&a.top>=b.top&&a.top<=b.top+b.height},getRangeOffsetInText:function(a,b){for(var c={},d=0;d<b.length;d++)if(b[d].node===a.startContainer){c.start=b[d].start+a.startOffset;break}for(var d=0;d<b.length;d++)if(b[d].node===a.endContainer){c.end=b[d].start+a.endOffset-1;break}return c},getRangeBoundaryPoints:function(a,b,c){var d=function(a,b){for(;!a[b];)b--;return a[b]},e=d(a,b),f=d(a,c);return{startContainer:e.node,startOffset:b-e.start,endContainer:f.node,endOffset:c-f.start+1}},isPrintableKeydown:function(a){var b,c,d,e=[65,67,89,90],f=[0,8,13,32,46,59,61,173,229];return b=a.keyCode,c=(a.ctrlKey||a.metaKey)&&e.includes(b),d=b>47&&58>b||b>64&&91>b||b>95&&112>b||b>185&&193>b||b>218&&223>b||f.includes(b),c||!d?!1:!0},isWhiteSpaceKeydown:function(a){var b=[13,32];return b.includes(a.keyCode)?!0:!1},isPunctuationKeydown:function(a){var c=a.hasOwnProperty("key")&&1===a.key.length?a.key.charCodeAt(0):-1;return c>-1&&b.isPunctuation(c)?!0:!1},isSlateEditor:function(a){return a&&a.getAttribute&&a.getAttribute("data-slate-editor")?!0:!1},isDraftEditor:function(a){return a&&(" "+a.className+" ").indexOf(" public-DraftEditor-content ")>-1?!0:!1},sortLanguages:function(a){var b,c=[],a=a||{};a=Object.assign({},a.ltr,a.rtl);for(var d in a)a.hasOwnProperty(d)&&c.push([d,a[d]]);c.sort(function(a,b){return a[1].toLowerCase()<b[1].toLowerCase()?-1:1});for(var e=0;e<c.length;e++)if("auto"===c[e][0]){b=c.splice(e,1),c.unshift(b[0]);break}return c},arrayToObject:function(a){for(var b={},a=a||[],c=0;c<a.length;c++)b[a[c]]=!0;return b},createDeferredName:function(a,b,c,d){var e=a+"_"+b;return d?e+="_forSplittedMainContainer":c&&(e=e+"_"+this.getUniqueId()),e},setZIndex:function(a,b){var c=parseInt(this.getComputedStyle(a).zIndex)||0,d=parseInt(b.style.zIndex)||0;d!==c+1&&(b.style.zIndex=c+1)},isPageScrollable:function(){var a=this.getComputedStyle(document.body),b=this.getComputedStyle(document.documentElement);return 0===parseFloat(document.body.style.width)&&0===parseFloat(document.body.style.height)?!1:0===parseFloat(a.width)&&0===parseFloat(a.height)?!1:"hidden"===a.overflow||"hidden"===a.overflowY?!1:"hidden"===b.overflow||"hidden"===b.overflowY?!1:!0}},a.Utils);a.Utils=c}(WEBSPELLCHECKER.CORE.prototype),function(a){"use strict";var b=function(a,b,c,d){this._startNode=a,this._startOffset=b,this._direction=c,this._stopNode=d,this._getNextNodeMethod=c?"nextSibling":"previousSibling",this._startTextChunk=3===a.nodeType?c?a.nodeValue.substr(b,a.nodeValue.length):a.nodeValue.substr(0,b):"",this.textWalkedThrough=this._startTextChunk,this.currentNode=a,this.previousNode=null,this.siblingNode=null};b.prototype={constructor:b,getNext:function(){if(this.currentNode.childNodes.length>0&&this.previousNode&&this.currentNode.childNodes[this._direction*(this.currentNode.childNodes.length-1)]!==this.previousNode?(this.previousNode=this.currentNode,this.currentNode=this.currentNode.childNodes[!this._direction*(this.currentNode.childNodes.length-1)],this.siblingNode=null):this.currentNode.childNodes.length>0&&!this.previousNode&&this.currentNode.childNodes[this._startOffset-!this._direction]?(this.previousNode=this.currentNode,this.currentNode=this.currentNode.childNodes[this._startOffset-!this._direction],this.siblingNode=null):this.currentNode[this._getNextNodeMethod]?(this.previousNode=this.currentNode,this.currentNode=this.currentNode[this._getNextNodeMethod],this.siblingNode=this.currentNode):(this.previousNode=this.currentNode,this.currentNode=this.currentNode.parentNode,this.siblingNode=null),this.currentNode)switch(this.currentNode.nodeType){case 1:this.currentNode===this._stopNode&&(this.currentNode=null);break;case 3:if(/\n+\s*/.test(this.currentNode.nodeValue))break;this._direction?this.textWalkedThrough+=this.currentNode.nodeValue:this.textWalkedThrough=this.currentNode.nodeValue+this.textWalkedThrough}return this.currentNode},reset:function(){this.textWalkedThrough=this._startTextChunk,this.currentNode=this._startNode,this.previousNode=null,this.siblingNode=null}},a.Walker=b}(WEBSPELLCHECKER.CORE.prototype),function(a){"use strict";var b=a.UILib,c={getScrollLeft:function(){return b.scrollLeft(window)},getScrollTop:function(){return b.scrollTop(window)},getScrollInfo:function(){return{left:this.getScrollLeft(),top:this.getScrollTop()}},getWindowWidth:function(){return b.width(window)},getWindowHeight:function(){return b.height(window)},getWindowSize:function(){return{width:this.getWindowWidth(),height:this.getWindowHeight()}},getWindowInnerWidth:function(){return"number"==typeof window.innerWidth?window.innerWidth:document.documentElement.clientWidth},getWindowInnerHeight:function(){return"number"==typeof window.innerHeight?window.innerHeight:document.documentElement.clientHeight},getBodyMinWidth:function(){var a=0;return a=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(document.body,null).minWidth:document.body.currentStyle?document.body.currentStyle.minWidth:document.body.style.minWidth,parseInt(a,10)||0},getPageWidth:function(){return Math.max(Math.max(document.documentElement.offsetWidth,document.documentElement.scrollWidth),Math.max(document.body.offsetWidth,document.body.scrollWidth))},getPageHeight:function(){return Math.max(Math.max(document.documentElement.offsetHeight,document.documentElement.scrollHeight),Math.max(document.body.offsetHeight,document.body.scrollHeight))},getDocumentWidth:function(){return Math.max(this.getPageWidth(),this.getBodyMinWidth(),this.getWindowWidth())},getDocumentHeight:function(){return Math.max(this.getPageHeight(),this.getWindowHeight())}};a.UIMetrics=c}(WEBSPELLCHECKER.CORE.prototype),function(a){"use strict";var b=a.UILib,c={},d=function f(a,b){var d=/\W/.test(a)?function(b){var c,d=/<%=([^%>]+)?%>/g;return c=a.replace(d,function(a,c){return c=c?c.trim():"",b.hasOwnProperty(c)?b[c]:a})}:c[a]=c[a]||f(document.getElementById(a).innerHTML.replace(/\r\n/,""));return b?d(b):d},e={create:function(a,c){var d;document.getElementById(a)||(d=document.createElement("script"),d.type="text/html",d.id=a,d.text=c,b.appendTo(d,"body"))},remove:function(a){b.remove("body #"+a),delete c[a]},render:function(a,b){return d(a,b)}};a.Template=e}(WEBSPELLCHECKER.CORE.prototype),function(a){"use strict";var b={separator:"<$>",getDataType:function(a){var b;return b="undefined"==typeof a?"undefined":null===a?"null":Object.prototype.toString.call(a).slice(8,-1)},convertDataToString:function(a){var b,c=this.getDataType(a).toLowerCase();return b=c+this.separator+a},restoreDataFromString:function(a){var b,c,d=a;if(a=this.backCompatibility(a),"string"==typeof a)switch(c=a.indexOf(this.separator),b=a.substring(0,c),d=a.substring(c+this.separator.length),b){case"boolean":d="true"===d;break;case"number":d=parseFloat(d);break;case"array":d=""===d?[]:d.split(",");break;case"null":d=null;break;case"undefined":d=void 0}return d},backCompatibility:function(a){var b,c,d=a;return"string"==typeof a&&(c=a.indexOf(this.separator),0>c&&(b=parseFloat(a),isNaN(b)&&("["===a[0]&&"]"===a[a.length-1]?(a=a.replace("[",""),a=a.replace("]",""),b=""===a?[]:a.split(",")):b="true"===a||"false"===a?"true"===a:a),d=this.convertDataToString(b))),d}},c={get:function(a){var c=b.restoreDataFromString(window.localStorage.getItem(a));return c},set:function(a,c){try{var d=b.convertDataToString(c);window.localStorage.setItem(a,d)}catch(e){}},del:function(a){window.localStorage.removeItem(a)},clear:function(){window.localStorage.clear()}},d={expiration:function(){return 31622400}(),get:function(a){var c=b.restoreDataFromString(this.getCookie(a));return c},set:function(a,c){var d=b.convertDataToString(c);this.setCookie(a,d,{expires:this.expiration})},del:function(a){this.deleteCookie(a)},getCookie:function(a){"string"!=typeof a&&(a="");var b=document.cookie.match(new RegExp("(?:^|; )"+a.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return b?decodeURIComponent(b[1]):void 0},setCookie:function(a,b,c){c=c||{};var d=c.expires;if("number"==typeof d&&d){var e=new Date;e.setTime(e.getTime()+1e3*d),d=c.expires=e}d&&d.toUTCString&&(c.expires=d.toUTCString()),b=encodeURIComponent(b);var f=a+"="+b;for(var g in c){var h=c[g];f+="; "+g,h!==!0&&(f+="="+h)}document.cookie=f},deleteCookie:function(a){this.setCookie(a,null,{expires:-1})},clear:function(){for(var a=document.cookie.split(";"),b=0;b<a.length;b++){var c=a[b],d=c.indexOf("="),e=d>-1?c.substr(0,d):c;this.deleteCookie(e)}}},e=function(){try{var a="localStorage"in window&&null!==window.localStorage;return a?(window.localStorage.setItem("_localStorageSupported",1),window.localStorage.removeItem("_localStorageSupported"),!0):!1}catch(b){return!1}},f=e()?c:d,g={getData:function(a){return f.get(a)},setData:function(a,b){f.set(a,b)},deleteData:function(a){f.del(a)},clear:function(){f.clear()}};a.DataStorage=g}(WEBSPELLCHECKER.CORE.prototype),function(a){"use strict";var b,c,d=function(a,d){this.name=a,this.sandbox=d,b=d.Utils,c=d.UILib};d.prototype={init:function(){var a=this;this.sandbox.subscribe({eventType:"allModulesReady",handler:function(){a.documentContainer=a.sandbox.getOption("documentContainer")}}),this.documentContainer=this.sandbox.getOption("documentContainer"),this.isBlockElement=this.sandbox.isBlockElement.bind(this.sandbox),this.ignoreElementsRegex=this.sandbox.getRegExp("ignoreElementsRegex"),this.libAdapter=d.RangyAdapter,this.rangyOptions={nonWhiteSpaceExtendedGlobal:this.sandbox.getRegExp("nonWhiteSpaceExtended").g(),tokenizer:function(b,c){function d(a,c,d){for(var e=b.slice(a,c),f={isWord:d,chars:e,toString:function(){return e.join("")}},g=0,h=e.length;h>g;++g)e[g].token=f;j.push(f)}var e,f,g,h=b.join(""),i=0,j=[];for(h=a.sandbox.replaceSepatators(h);g=c.nonWhiteSpaceExtendedGlobal.exec(h);)e=g.index,f=e+g[0].length,e>i&&d(i,e,!1),d(e,f,!0),i=f;return i<b.length&&d(i,b.length,!1),j}}},getDocumentContainer:function(){return b.isInPage(this.documentContainer)?this.documentContainer:null},createRange:function(){return new d.Range(new this.libAdapter(this.getDocumentContainer(),this.isBlockElement,this.ignoreElementsRegex,this.rangyOptions))},getSelection:function(a){return new d.Selection(new this.libAdapter(this.getDocumentContainer(),this.isBlockElement,this.ignoreElementsRegex,this.rangyOptions),a)},getSelectionManager:function(){return new d.SelectionManager(new this.libAdapter(this.getDocumentContainer(),this.isBlockElement,this.ignoreElementsRegex,this.rangyOptions))},getRangeManager:function(){return new d.RangeManager(new this.libAdapter(this.getDocumentContainer(),this.isBlockElement,this.ignoreElementsRegex,this.rangyOptions))},comparisonType:{START_TO_START:0,START_TO_END:1,END_TO_START:3,END_TO_END:2}},d.Range=function(a){var b=a.range;b.createRange(),this.collapsed=function(){return b.collapsed()},this.commonAncestorContainer=function(){return b.commonAncestorContainer()},this.endContainer=function(){return b.endContainer()},this.endOffset=function(){return b.endOffset()},this.startContainer=function(){return b.startContainer()},this.startOffset=function(){return b.startOffset()},this.setStart=function(a,c){return b.setStart(a,c)},this.setEnd=function(a,c){return b.setEnd(a,c)},this.setStartBefore=function(a){return b.setStartBefore(a)},this.setStartAfter=function(a){return b.setStartAfter(a)},this.setEndBefore=function(a){return b.setEndBefore(a)},this.setEndAfter=function(a){return b.setEndAfter(a)},this.selectNode=function(a){return b.selectNode(a)},this.selectNodeContents=function(a){return b.selectNodeContents(a)},this.collapse=function(a){return b.collapse(a)},this.cloneContents=function(){return b.cloneContents()},this.deleteContents=function(){return b.deleteContents()},this.extractContents=function(){return b.extractContents()},this.insertNode=function(a){return b.insertNode(a)},this.surroundContents=function(a){return b.surroundContents(a)},this.compareBoundaryPoints=function(a,b){return b.compareBoundaryPoints(a,b)},this.cloneRange=function(){return b.cloneRange()},this.detach=function(){return b.detach()},this.toString=function(a){return b.toString(a)},this.createContextualFragment=function(a){return b.createContextualFragment(a)},this.move=function(a,c,d){return b.move(a,c,d)},this.expand=function(a,c){return b.expand(a,c)},this.getNodes=function(){return b.getNodes()},this.moveEnd=function(a,c,d){return b.moveEnd(a,c,d)},this.moveStart=function(a,c,d){return b.moveStart(a,c,d)},this.getBookmark=function(a){return b.getBookmark(a)},this.moveToBookmark=function(a){return b.moveToBookmark(a)},this.containsRange=function(a){return b.containsRange(a._getRangyRange())},this._getRangyRange=function(){return b._getRangyRange()}},d.RangeManager=function(a){var b=a.rangeManager;return{saveRange:function(a,c){return b.saveRange(a,c)},restoreRange:function(a,c){return b.restoreRange(a,c)}}},d.RangeManager.prototype={},d.Selection=function(a,b){var c=a.selection;c.getSelection(b),this.rangeCount=function(){return c.rangeCount()},this.getRangeAt=function(a){return c.getRangeAt(a)},this.removeAllRanges=function(){return c.removeAllRanges()},this.addRange=function(a){return c.addRange(a)},this.anchorNode=function(){return c.anchorNode()},this.anchorOffset=function(){return c.anchorOffset()},this.focusNode=function(){return c.focusNode()},this.focusOffset=function(){return c.focusOffset()},this.move=function(a,b,d){return c.move(a,b,d)},this.expand=function(a,b){return c.expand(a,b)},this.isBackwards=function(){return c.isBackwards()}},d.SelectionManager=function(a){var b=a.selectionManager;return{saveSelection:function(){return b.saveSelection()},restoreSelection:function(a){return b.restoreSelection(a)},removeMarkers:function(a){return b.removeMarkers(a)}}},d.SelectionManager.prototype={},d.RangyAdapter=function(e,f,g,h){d.Lib=d.Lib||a.rangy||window.rangy,d.Lib.initialized===!1&&d.Lib.init();var i,j=null,k={range:{createRange:function(){return i=d.Lib.createRange(e)},collapsed:function(){return i.collapsed},commonAncestorContainer:function(){return i.commonAncestorContainer},endContainer:function(){return i.endContainer},endOffset:function(){return i.endOffset},startContainer:function(){return i.startContainer},startOffset:function(){return i.startOffset},setStart:function(a,b){return i.setStart(a,b)},setEnd:function(a,b){return i.setEnd(a,b)},setStartBefore:function(a){return i.setStartBefore(a)},setStartAfter:function(a){return i.setStartAfter(a)},setEndBefore:function(a){return i.setEndBefore(a)},setEndAfter:function(a){return i.setEndAfter(a)},selectNode:function(a){return i.selectNode(a)},selectNodeContents:function(a){return i.selectNodeContents(a)},collapse:function(a){return i.collapse(a)},cloneContents:function(){return i.cloneContents()},deleteContents:function(){return i.deleteContents()},extractContents:function(){return i.extractContents()},insertNode:function(a){return i.insertNode(a)},surroundContents:function(a){return i.surroundContents(a)},compareBoundaryPoints:function(a,b){var c=d.Lib.createRange(e);return c.setStart(b.startContainer(),b.startOffset()),c.setEnd(b.endContainer(),b.endOffset()),i.compareBoundaryPoints(a,c)},cloneRange:function(){var a=new d.Range(new d.RangyAdapter(e,f,g,h));return a.setStart(this.startContainer(),this.startOffset()),a.setEnd(this.endContainer(),this.endOffset()),a},detach:function(){return i.detach()},toString:function(a){var b,c,d,a=a||{},e="";if(a.native)return i.toString();for(b=i.cloneContents(),c=[b],d=c.shift();d;){switch(d.nodeType){case 3:e+=d.nodeValue;break;case 1:case 11:if(g.match(d.nodeName))e+=" ";else{for(var h=0;h<d.childNodes.length;h++)c.splice(h,0,d.childNodes[h]);f(d)&&(c.length>d.childNodes.length&&c.splice(h,0,document.createTextNode(" ")),e.length>0&&" "!=e[e.length-1]&&c.splice(0,0,document.createTextNode(" ")))}}d=c.shift()}return e},createContextualFragment:function(a){return i.createContextualFragment(a)},move:function(a,b,c){return i.move(a,b,"word"!==a||c?c:h)},expand:function(a,b){return i.expand(a,"word"!==a||b?b:h)},getNodes:function(){return i.getNodes()},moveEnd:function(a,b,c){return i.moveEnd(a,b,"word"!==a||c?c:h)},moveStart:function(a,b,c){return i.moveStart(a,b,"word"!==a||c?c:h)},getBookmark:function(a){return i.getBookmark(a)},moveToBookmark:function(a){var b=!1;return a&&(i.moveToBookmark(a),b=new d.Range(new d.RangyAdapter(e,f,g,h)),b.setStart(i.startContainer,i.startOffset),b.setEnd(i.endContainer,i.endOffset)),b},containsRange:function(a){return i.containsRange(a)},_getRangyRange:function(){return i}},selection:{getSelection:function(a){var b=function(){j="boolean"==typeof a&&a||"iframe"!==e.nodeName.toLowerCase()?d.Lib.getSelection():d.Lib.getSelection(e)};null!==j&&this.detach();try{b()}catch(c){this.detach(),b()}return j},rangeCount:function(){return j.rangeCount},getRangeAt:function(a){var b=j.getRangeAt(a),c=new d.Range(new d.RangyAdapter(e,f,g,h));return c.setStart(b.startContainer,b.startOffset),c.setEnd(b.endContainer,b.endOffset),c},removeAllRanges:function(){return j.removeAllRanges()},addRange:function(a){var b=d.Lib.createRange(e);return b.setStart(a.startContainer(),a.startOffset()),b.setEnd(a.endContainer(),a.endOffset()),j.addRange(b)},anchorNode:function(){return j.anchorNode},anchorOffset:function(){return j.anchorOffset},focusNode:function(){return j.focusNode},focusOffset:function(){return j.focusOffset},move:function(a,b,c){return j.move(a,b,c)},expand:function(a,b){return j.expand(a,b)},detach:function(){d.Lib.Selection.detachAll()},isBackwards:function(){return j.isBackwards()}},selectionManager:{saveSelection:function(){var a;try{c.is(e,":visible")&&(a="iframe"==e.nodeName.toLowerCase()?d.Lib.saveSelection(e):d.Lib.saveSelection(),a.doc=b.getCurrentDocument(e))}catch(f){}return a},restoreSelection:function(a){function b(a){for(var b=[],c=a.length,e=c-1;e>=0;e--)b[e]=d.Lib.restoreRange(a[e],!1);return b}if(!a.restored){var c=a.rangeInfos,e=k.selection.getSelection(a.win),f=b(c),g=c.length;1==g&&d.Lib.features.selectionHasExtend&&c[0].backward?(e.removeAllRanges(),e.addRange(f[0],!0)):e.setRanges(f),a.restored=!0}return a.restored},removeMarkers:function(a){d.Lib.removeMarkers(a)}},rangeManager:{saveRange:function(a,b){var c,f;return f=d.Lib.createRange(e),f.setStart(a.startContainer(),a.startOffset()),a.collapsed()||f.setEnd(a.endContainer(),a.endOffset()),c=d.Lib.saveRange(f,b)},restoreRange:function(a,b){var c,i=!1;return a&&(c=d.Lib.restoreRange(a,b),i=new d.Range(new d.RangyAdapter(e,f,g,h)),i.setStart(c.startContainer,c.startOffset),i.setEnd(c.endContainer,c.endOffset)),i}}};return k},d.TestAdapter=function(){d.Lib=d.Lib||window.TestLib,b.removeGlobal("TestLib");return{createRange:function(){return d.Lib.createRange()},selectNodeContents:function(a){return d.Lib.selectNodeContents(a)},collapse:function(a){return d.Lib.collapse(a)},createContextualFragment:function(a){return d.Lib.createContextualFragment(a)},insertNode:function(a){return d.Lib.insertNode(a)}}},a.RangeCreator=d}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=function(a,b){this.name=a,this.sandbox=b,this.container=this.sandbox.getOption("container"),this.documentContainer=this.sandbox.getOption("focusContainer")};b.prototype={init:function(){var a=this;this.sandbox.subscribe({eventType:"allModulesReady",handler:function(){a.removeBindings(),a.documentContainer=a.sandbox.getOption("focusContainer"),a.container=a.sandbox.getOption("container"),a.addBindings()}}),this.addBindings()},destroy:function(){this.removeBindings()},addBindings:function(){this.sandbox.subscribe({eventType:"focus",element:this.documentContainer,handler:this.focusHandler}),this.sandbox.subscribe({eventType:"blur",element:this.documentContainer,handler:this.blurHandler}),this.sandbox.subscribe({eventType:"mousedown",element:this.container,handler:this.mouseDownHandler}),this.sandbox.subscribe({eventType:"mouseup",element:this.container,handler:this.mouseUpHandler}),this.sandbox.subscribe({eventType:"keydown",element:this.container,handler:this.keydownHandler,priority:2e3,context:this}),this.sandbox.subscribe({eventType:"keyup",element:this.container,handler:this.keyupHandler,priority:2e3,context:this})},removeBindings:function(){this.sandbox.unsubscribe({eventType:"focus",element:this.documentContainer,handler:this.focusHandler}),this.sandbox.unsubscribe({eventType:"blur",element:this.documentContainer,handler:this.blurHandler}),this.sandbox.unsubscribe({eventType:"mousedown",element:this.container,handler:this.mouseDownHandler}),this.sandbox.unsubscribe({eventType:"mouseup",element:this.container,handler:this.mouseUpHandler}),this.sandbox.unsubscribe({eventType:"keydown",element:this.container,handler:this.keydownHandler,context:this}),this.sandbox.unsubscribe({eventType:"keyup",element:this.container,handler:this.keyupHandler,context:this})
},focusHandler:function(){this.sandbox.setFocused(!0)},blurHandler:function(){this.sandbox.setFocused(!1)},mouseDownHandler:function(){this.sandbox.setOption("leftMouseButtonPressed",!0)},mouseUpHandler:function(){this.sandbox.setOption("leftMouseButtonPressed",!1)},keydownHandler:function(a){switch(a.keyCode){case 46:this.sandbox.setOption("deleteKeyButtonPressed",!0);break;case 8:this.sandbox.setOption("backspaceKeyButtonPressed",!0);break;case 32:this.sandbox.setOption("spaceKeyButtonPressed",!0);break;case 13:this.sandbox.setOption("enterKeyButtonPressed",!0)}},keyupHandler:function(a){switch(a.keyCode){case 46:this.sandbox.setOption("deleteKeyButtonPressed",!1);break;case 8:this.sandbox.setOption("backspaceKeyButtonPressed",!1);break;case 32:this.sandbox.setOption("spaceKeyButtonPressed",!1);break;case 13:this.sandbox.setOption("enterKeyButtonPressed",!1)}}},a.StateController=b}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b,c,d=function e(c,d){this.name=c,this.sandbox=d,b=d.Utils,this.events={},e.Signal=e.Signal||a.signals};d.prototype={init:function(){c=["asyncModulesReady","allModulesReady","moduleStarted","moduleReady","taskEnded","problemCheckStarted","problemCheckEnded","sentenceFinished","wordBoundaryPressed","printableKeydownPressed","wordForAutocorrectFound","autocorrect","startProblemCheck","tokensCollected","tokensCollectedForCleaning","problemsFound","clearDictionary","getSuggestionsList","bindProblemWithToken","resetDisabledRuleStatusForProblems","markupProblems","removeMarkupFromProblems","removeMarkupInDocument","removeMarkupInSelectionNode","markupedNode","removedMarkupInContainer","removeMarkup","removeMarkupAfterKeydown","removeMarkupForRules","replaceProblem","ignoreProblem","ignoreAllProblems","changeStateForIgnoredProblems","disableRule","changeStateForProblemsWithDisabledRules","changeStateForProblemsWithEnabledRules","replaceText","remoteAction","getUserDictionaryName","getUserDictionary","createUserDictionary","renameUserDictionary","restoreUserDictionary","removeUserDictionary","disconnectFromUserDictionary","setUserDictionaryName","addWordToUserDictionary","changeStateForAddedWordToUserDictionary","deleteWordFromUserDictionary","changeStateForDeletedWordFromUserDictionary","userDictionaryChanged","userDictionaryStateChanged","userDictionaryStateRestored","resetUserDictionaryStatusForWords","commitOptions","optionsCommited","syncOptions","containerMutated","periodicalChecking","toggleApp","localizationLoaded","userDictionaryAction","showMessage","hideMessage","showUiElement","hideUiElement","updateUi","updateUiGlobally","startProofreadInDialog","finishProofreadInDialog","activeProblemChanged","createProblemItem","setNextProblemActive","setPrevProblemActive","closeDialog","showBanner","hideBanner","sendStatistics","scrollInMirrorContainer","saveStateBeforeReplace","saveSelection","restoreSelection","beforemanualcontrolblur","setShortcuts","removeShortcuts","keydownCharLengthOnFakeElement","cutProcessed","copyProcessed","pasteProcessed","afterPaste","undo","redo","executeUndo","executeRedo","checkUndoRedoPosibility","undoRedoPosibility","dropProcessed","crossContainerDrop","afterDrop","fixBrokenNodes","lockMutationsListener","garbageCollected","startSpellCheck","startGrammarCheck","getGrammarSuggestionsList","enableGrammarChanged","suggestionListSend","selectionIsChanged"],this.addEvents(c)},destroy:function(){this.unsubscribe({eventType:c.join(", ")})},addEvents:function(a){for(var b=0;b<a.length;b+=1){var c=a[b];this.events[c]=this.createSignal()}},createSignal:function(){return new d.Signal},fire:function(a){a=a||{};for(var b,c,e=(a.moduleID,a.data||{}),f=a.eventType.split(","),g="",h=[],i=0;i<f.length;i++)g=f[i].trim(),b=this.events[g],c=new d.Event(g,e,b),b.dispatch(c),h.push(c.aggregateEventData());return h.length>1?h:h[0]},subscribe:function(a){a=a||{};for(var b=(a.moduleID,a.eventType,a.handler),c=a.context,d=a.priority||0,e=a.eventType.split(","),f="",g=0;g<e.length;g++)f=e[g].trim(),this.events[f].add(b,c,d)},unsubscribe:function(a){a=a||{};for(var b,c,d=(a.moduleID,a.eventType,a.context),e=a.eventType.split(","),f=0,g=0;g<e.length;g++)if(c=e[g].trim(),b=this.events[c],d)for(;b._bindings[f];)b._bindings[f].context===d?b.remove(b._bindings[f]._listener,d):f++;else b.removeAll()}},d.Event=function(a,b,c){Object.assign(this,b),this._type=a,this._eventData=[],this._signal=c,this._propagationStopped=!1,this._defaultPrevented=!1,this._immediatePropagationStopped=!1},d.Event.prototype={constructor:d.Event,setReturnedData:function(a){if(!b.is(a,"Object"))throw new TypeError("data is not a object");this._eventData.push(a)},preventDefault:function(){this._defaultPrevented=!0},isDefaultPrevented:function(){return this._defaultPrevented},stopPropagation:function(){this._propagationStopped=!0},stopImmediatePropagation:function(){this._immediatePropagationStopped=!0,this._signal.halt()},isEventDataEmpty:function(){return this._eventData.length>0?!1:!0},isPropagationStopped:function(){return this._propagationStopped},aggregateEventData:function(a){var b=this._eventData,c={};a=a||Object.assign;for(var d=0;d<b.length;d+=1)a(c,b[d]);return c}},a.Communication=d}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b,c,d,e=function(a,e){this.name=a,this.sandbox=e,this.decorator=!0,this.decoratorFor="Communication",b=this.UILib=this.sandbox.FullUILib,c=this.Utils=this.sandbox.Utils,d=this.logger=this.sandbox.console,this.events={}};e.prototype={constructor:e,init:function(){this.eventsNames=["click","dblclick","contextmenu","mousedown","mouseup","mouseout","mousemove","mouseover","mouseenter","mouseleave","pointerdown","pointerup","focus","blur","focusin","focusout","keydown","keypress","keyup","cut","copy","beforepaste","paste","drop","drag","dragover","dragstart","dragend","dragenter","dragleave","change","resize","orientationchange","select","compositionstart","compositionend","selectionchange","scroll","mousewheel","input","visibilitychange","webkitvisibilitychange","unload","submit","touchstart","touchmove","touchend"],this.EventProxy=new e.EventProxy(this)},destroy:function(){this.wrapMethod("unsubscribe")({eventType:this.eventsNames.join(", ")}),this.EventProxy.removeAllEventProxy()},decorate:function(a){this.communication=a,this.addEvents(this.eventsNames),this.communication.addEvents(this.eventsNames);var b={fire:this.wrapMethod("fire"),subscribe:this.wrapMethod("subscribe"),unsubscribe:this.wrapMethod("unsubscribe")};for(var c in this.communication)b[c]=b[c]?b[c]:this.communication[c];return b},addEvents:function(a){for(var b=0;b<a.length;b+=1){var c=a[b];this.events[c]=new e.UISignal(c,this.communication,this.name)}},checkOnEventSupport:function(a){return!(!a||!a.addEventListener&&!a.attachEvent)},validateListener:function(a,b){if("function"!=typeof a)throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",b));return a},setEventData:function(a,b){var c=["target","srcElement","currentTarget"];a.initEvent&&a.initEvent(b.type,!0,!0);for(var d in b)if(-1===c.indexOf(d)&&"_"!==d[0]&&"function"!=typeof b[d])try{a[d]=b[d]}catch(e){}return a},checkEventTypes:function(a){for(var b,c=0;c<a.length;c+=1)if(b=a[c].trim(),-1===this.eventsNames.indexOf(b))return!1;return!0},dispatchEvent:function(a,c,d){var e=this.setEventData(b.createEvent(c),d);return!this.UILib.trigger(c,a,e)},fireBeforeEventsForContainer:function(a,b){var c=this.sandbox.getOption("container"),d=this.sandbox.getOption("documentContainer"),e=(this.Utils.getCurrentDocument(d),"beforemanualcontrol");("focus"===a&&b.element!==c&&document.activeElement===d||"blur"===a&&b.element===c)&&this.communication.fire({eventType:e+"blur"})},fire:function(a,c){var d,e,f=c.element,g=this.events[a],h=["click","focus","blur"],i={};return-1!==h.indexOf(a)?(e=function(a){d=b.isDefaultPrevented(a)},b.on(a,f,e),this.fireBeforeEventsForContainer(a,c),f[a](),b.off(a,f,e)):(c.data=c.data||{},c.data.type||(c.data.type=a),d=this.dispatchEvent(f,a,c.data)),null===g.lastSystemFireResult?i.defaultPrevented=d:(i=g.lastSystemFireResult,g.lastSystemFireResult=null),i},subscribe:function(a,b){var c=this,d=c.events[a],f={element:b.element,userContext:b.context,userHandler:c.validateListener(b.handler,"subscribe")};d.addSubscription(f),b.userContext=b.context,b.context=f,b.handler=function(a){if(a.constructor!==e.UIEventDecorator){if(void 0===a.nativeEvent)return;a=new e.UIEventDecorator(a)}a.currentTarget===this.element&&this.userHandler.call(this.userContext,a)},c.communication.subscribe(b)},unsubscribe:function(a,b){function c(a,c){f.removeSubscription(a,c),e.communication.unsubscribe(b)}for(var d,e=this,f=e.events[a],g=b.handler,h=b.element,i=f.subscribers.length-1;i>=0;i-=1)d=f.subscribers[i],b.userContext=b.userContext||b.context,b.context=d,b.userContext&&b.userContext!==d.userContext||(h?d.element===h&&(g?(g=e.validateListener(b.handler,"unsubscribe"),g===d.userHandler&&c(d,i)):c(d,i)):c(d,i),b.context=b.userContext)},prepareOption:function(a,b){return b.element===this.sandbox.getOption("container")&&"focus"===a&&this.Utils.Browser.gecko&&this.sandbox.getOption("isIframe")===!0&&(b.element=this.sandbox.getOption("focusContainer"),b.eventType.split(",").length>1&&d.warn("You can't call focus event with another events in one fire/subscribe method with another events. For this case focus event should be one in 'eventType'")),b},wrapMethod:function(a){var b=this;return function(c){var e,f,g,h=c.eventType.split(","),i=[];if(b.checkEventTypes(h)){if(b.checkOnEventSupport(c.element)===!1&&"unsubscribe"!==a)return d.warn(c.eventType+" event/s defined in "+b.name+" module. For "+a+" DOM events you should set (HTMLElement | document) in method params"),null;for(var j=0;j<h.length;j+=1)e=h[j].trim(),c=b.prepareOption(e,c),g=c,h.length>1&&(g=Object.assign({},c)),f=b[a].call(b,e,g),f&&i.push(f);return i.length>1?i:i[0]}return b.communication[a](c)}}},e.EventProxy=function(a){this.DOMCommunication=a,this.proxyElements=[]},e.EventProxy.prototype={constructor:e.EventProxy,addEventProxy:function(a){var c=this.DOMCommunication;c.checkOnEventSupport(a.from)&&c.checkOnEventSupport(a.to)||d.warn("for eventProxy you should provide 2 elements: 'from' and 'to'");var e=Object.assign({},a);e.eventsNames=a.eventsNames||c.eventsNames,e.handler=function(a){c.dispatchEvent(this.to,a.type,a)},e.handler=e.handler.bind(e),this.proxyElements.push(e);for(var f=0;f<e.eventsNames.length;f+=1)b.on(e.eventsNames[f],e.from,e.handler)},removeAllEventProxy:function(){for(var a=0;a<this.proxyElements.length;a+=1)this.removeEventProxy(this.proxyElements[a])},removeEventProxy:function(a){for(var c,d=0;d<this.proxyElements.length;d+=1)if(a.from===this.proxyElements[d].from&&a.to===this.proxyElements[d].to){c=this.proxyElements[d];break}for(d=0;d<a.eventsNames.length;d+=1)b.off(c.eventsNames[d],c.from,c.handler)}},e.UIEventDecorator=function(a){this.eventPrototype=a.constructor.prototype,this.event=a,this.nativeEvent=a.nativeEvent;var c=b.isDefaultPrevented(this.nativeEvent);c&&this.event.preventDefault(),a.setReturnedData({defaultPrevented:c});for(var d in this.nativeEvent)void 0!==this.nativeEvent[d]&&"function"!=typeof this.nativeEvent[d]&&(a[d]=this.nativeEvent[d]);for(d in this.constructor.prototype)a[d]=this.constructor.prototype[d].bind(this);return a.constructor=this.constructor,a.target=b.getEventTarget(this.nativeEvent),delete a.nativeEvent,a},e.UIEventDecorator.prototype={constructor:e.UIEventDecorator,preventDefault:function(){this.eventPrototype.isDefaultPrevented.call(this.event)===!1&&(b.preventDefault(this.nativeEvent),this.eventPrototype.setReturnedData.call(this.event,{defaultPrevented:!0}),this.eventPrototype.preventDefault.call(this.event))},stopPropagation:function(){b.stopPropagation(this.nativeEvent),this.eventPrototype.stopPropagation.call(this.event)},stopImmediatePropagation:function(){b.stopImmediatePropagation(this.nativeEvent),this.eventPrototype.stopImmediatePropagation.call(this.event)}},e.UISignal=function(a,b,c){var d=this;this.subscribers=[],this.registredElements=[],this.eventType=a,this.emmiter=b,this.moduleID=c,this.lastSystemFireResult=null,this.handler=function(a){d.lastSystemFireResult=d.emmiter.fire({moduleID:d.moduleID,eventType:d.eventType,data:{nativeEvent:a}})}},e.UISignal.prototype={constructor:e.UISignal,addSubscription:function(a){this.subscribers.push(a),-1===this.findElementIndex(a.element,this.registredElements)&&this.registerElement(a.element)},removeSubscription:function(a,b){var c=this.subscribers;if("undefined"==typeof b)for(var d=0;d<c.length;d+=1)if(c[d]===a){b=d;break}c.splice(b,1),-1===this.findElementIndex(a.element,c)&&this.unregisterElement(a.element)},registerElement:function(a){var d,e=this;d=c.Browser.ie&&c.Browser.version<9?function(b){null===b&&(b=c.getWindowByDocument(a.document).event),b.currentTarget=a,e.handler(b)}:this.handler,this.registredElements.push({element:a,handler:d}),b.on(this.eventType,a,d)},unregisterElement:function(a){var c=this.findElementIndex(a,this.registredElements),d=this.registredElements[c];this.registredElements.splice(c,1),b.off(this.eventType,a,d.handler)},findElementIndex:function(a,b){for(var c=0;c<b.length;c+=1)if(b[c].element===a)return c;return-1}},a.DOMCommunication=e}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=function(a,b){this.name=a,this.sandbox=b,this.parametersMap={onSuccess:"success",onError:"error"}};b.prototype={constructor:b,init:function(){this.createWebApi(),this.sandbox.subscribe("remoteAction",function(a){this.handleRemoteAction(a)},this)},createWebApi:function(){var a=this.sandbox._getCoreOptionObject();this.webApi=new this.sandbox.initWebApi(a)},handleRemoteAction:function(a){var b,c=this.adapter[a.actionMethod];if(!c)throw new Error("Web API action method "+c+" is not supported.");b=this.createWebApiParameters(a),c.call(this,b)},createWebApiParameters:function(a){var b,c,d={};for(var e in a)a.hasOwnProperty(e)&&(b=this.getParameterName(e),c=this.decorateParameter(b,a[e]),d[b]=c);return d},getParameterName:function(a){var b=this.parametersMap[a];return void 0!==b?b:a},decorateParameter:function(a,b){var c=this.callbacks[a],d=this;return c?function(a){c.call(d,a),b(a)}:b},callbacks:{error:function(a){var b=this.sandbox.getOption("onErrorRequest"),c=this.sandbox.getInstance();b(a,c)}},getWordsFromString:function(a){return this.webApi._getService("TextProcessor").getWordsFromString(a)},replaceSepatators:function(a){return this.webApi._getService("TextProcessor").replaceSepatators(a)},removeSpecialCharacters:function(a){return this.webApi._getService("TextProcessor").removeSpecialCharacters(a)},adapter:{spellCheck:function(a){return this.webApi.spellCheck(a)},grammarCheck:function(a){return this.webApi.grammarCheck(a)},check:function(a){return this.webApi.check(a)},autocorrect:function(a){return this.webApi.autocorrect(a)},getLangList:function(a){return this.webApi.getLangList(a)},getInfo:function(a){return this.webApi.getInfo(a)},statistics:function(a){return this.webApi.statistics(a)},getUserDictionary:function(a){return this.webApi.getUserDictionary(a)},createUserDictionary:function(a){return this.webApi.createUserDictionary(a)},deleteUserDictionary:function(a){return this.webApi.deleteUserDictionary(a)},addWordToUserDictionary:function(a){return this.webApi.addWordToUserDictionary(a)},deleteWordFromUserDictionary:function(a){return this.webApi.deleteWordFromUserDictionary(a)},renameUserDictionary:function(a){return this.webApi.renameUserDictionary(a)},getDictionariesModifyTime:function(a){return this.webApi.getDictionariesModifyTime(a)}}},a.WebApiAdapter=b}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b,c=function(a,c){this.name=a,this.sandbox=c,this.regExps={},b=c.RegularsManager};c.prototype={constructor:c,init:function(){this.regExps.ignoreElementsRegex=this.createIgnoreElementsRegex("ignoreElements"),this.regExps.ignoreGrammarElementsRegex=this.createIgnoreElementsRegex("ignoreGrammarElements"),this.regExps.blockElementsRegex=b.wrap("aside|br|img|caption|button|address|blockquote|body|center|dir|div|dl|fieldset|form|h[1-6]|hr|isindex|menu|noframes|noscript|ol|p|pre|table|ul|dd|dt|frameset|li|tbody|td|tfoot|th|thead|tr|html|select|option|input").group().start().end().i(),this.regExps.wordBoundaryRegex=b.anyChar.compositionGraph([b.space,b.punctuationRegExp,b.wrap(this.sandbox.getOption("customPunctuation"))]).set(),this.regExps.wordBoundaryRegexAndQuotes=b.anyChar.compositionGraph([b.space,b.punctuationRegExp,b.wrap(this.sandbox.getOption("customPunctuation")),b.quotes]).set(),this.regExps.nonWhiteSpaceExtended=b.whiteSpace.start().set().onePlus(),this.regExps.sentenceEndCharsGrammar=b.sentenceEndChars.composition(b.wrap("\\u2029")).set().composition(b.space).more().end().g(),this.regExps.ieSeparator=b.wrap(String.fromCharCode(160)).g()},getRegExp:function(a){return this.regExps[a]||b[a]},createIgnoreElementsRegex:function(a){var c,d=this.sandbox.getOption(a),e=["style","script"];if(""!==d){d=b.space.g().replace(d,""),c=b.comma.g().replace(d,"|");for(var f=0;f<e.length;f++){var g=b.wrap(e[f]).wrapWordBoundary().g();g.match(d)||(d=d+"|"+e[f])}}else d=e.join("|");return b.wrap(d).group().start().end().i()}},a.RegExpressions=c}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=function(a,b){this.name=a,this.sandbox=b,this.tasks={},this.taskCount=0};b.prototype={init:function(){this.sandbox.subscribe("taskEnded",function(a){this.taskEndedHandler(a.taskName)},this)},destroy:function(){this.unregisterAll()},taskEndedHandler:function(a){this.unregister(a,!0),0===this.taskCount&&this.sandbox.fire("problemCheckEnded",{})},register:function(a,c){return 0===this.taskCount&&this.sandbox.fire("problemCheckStarted",{}),c.single&&(this.unregister(a,!0),c.collection=["single"]),this.tasks[a]?this.tasks[a].extendCollection(c.collection,c.inQueue):(this.tasks[a]=new b.Task(a,c,this.sandbox),this.taskCount++,this.tasks[a].startTask()),this.tasks[a]},unregister:function(a,b){this.tasks[a]&&(this.tasks[a].timeout&&(clearTimeout(this.tasks[a].timeout),this.tasks[a].timeout=null),this.taskCount--,!b&&this.tasks[a].onUnregister&&this.tasks[a].onUnregister.apply(this.tasks[a]),delete this.tasks[a])},unregisterAll:function(){for(var a in this.tasks)this.tasks.hasOwnProperty(a)&&this.unregister(a)}},b.Task=function(a,b,c){function d(a){return function(){a&&a.apply(this,arguments),this.endTask()}}var e=this;b=b||{},this.name=a,this.single=b.single||!1,this.collection=[].concat(b.collection||[]),this.delay=b.delay||0,this.partialItemsCount=b.partialItemsCount||1,this.deferredFunction=d(b.deferredFunction),this.defferedFunctionArgs=b.defferedFunctionArgs||[],this.timeout=void 0,this.onUnregister=b.onUnregister,this.getPartialItems=function(){return this.collection.splice(0,this.partialItemsCount||1)},this.runDeferredFunction=function(a){var b=this.deferredFunction.apply(this,[].concat([a],this.defferedFunctionArgs));return b},this.extendCollection=function(a,b){var c=[0,0];b?this.collection.push.apply(this.collection,a):(c.push.apply(c,a),this.collection.splice.apply(this.collection,c))},this.startTask=function(){this.timeout=setTimeout(function(){var a=e.getPartialItems();e.runDeferredFunction(a)},this.delay)},this.endTask=function(){this.timeout=null,this.collection.length>0?this.startTask():c.fire("taskEnded",{taskName:this.name})}},a.Deferred=b}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b,c,d=function(a,d){this.name=a,this.sandbox=d,b=d.Utils,c=d.UILib};d.prototype={constructor:d,init:function(){},getProblemActions:function(a){var b=this,c=this.sandbox.getOption("controlActions").slice(0),d=this.sandbox.getProblemInfo(a),e={};return"spelling"!==d.type&&c.splice(c.indexOf("addWord"),1),"grammar"!==d.type&&c.splice(c.indexOf("disableRule"),1),"autocorrect"===d.type&&(c=[]),c=this.filterBySystemActions(c),c=this.sortByUserOrder(c),e.control=this.getActions(c,[]).map(function(c){return c.call=c.call.bind(b,{node:a}),c}),e.suggestions=d.suggestions.map(function(c){var d=b.getAction("replace");return d.text=c,d.call=d.call.bind(b,{node:a,suggestion:c}),d}),e},getStaticActions:function(){var a=this.filterBySystemActions(this.sandbox.getOption("staticActions"));return this.getActions(a,[])},filterBySystemActions:function(a){var b=this.sandbox.getOption("actionItems").map(function(a){return a.toLowerCase()});return a.filter(function(a){return b.includes(a.toLowerCase())})},sortByUserOrder:function(a){var b=this.sandbox.getOption("actionItems"),c=a.map(function(a){return a.toLowerCase()}),d=[];return b.forEach(function(b){var e=c.indexOf(b.toLowerCase());-1===e||d.includes(a[e])||d.push(a[e])}),d},getActions:function(a,b){var c=this;return Array.isArray(b)?a.map(this.getAction,this):"object"===("undefined"==typeof b?"undefined":_typeof(b))?(a.forEach(function(a){b[a]=c.getAction(a)}),b):this.getAction(a)},getAction:function(a){var b=this.actions[a];if(!b)throw new Error("action - "+a+" not found.");return b=Object.assign({},b),b.getName=b.getName&&b.getName.bind(this)||function(){return a},b.getTitle=b.getTitle&&b.getTitle.bind(this)||function(){return a},b.isDisabled=b.isDisabled&&b.isDisabled.bind(this)||function(){return!1},b.call=b.call.bind(this),b},actions:{replace:{call:function(a){var b=a.suggestion,c=a.node,d=this.sandbox.getNodeInfo(c),e={};if(e.text=b,e.node=c,e.problemType=d.type,this.sandbox.fire("replaceProblem",e),"grammar"===d.type){var f=this.sandbox.UILib.findNodeParents(c,d.nodeName,this.sandbox.getOption(d.attrName))[0];this.sandbox.fire("removeMarkupInSelectionNode",{grammarOnly:!0,selectionNode:f})}}},ignore:{call:function(a){var b=a.node;this._fireEventWithNode("ignoreProblem",b)}},ignoreAll:{call:function(a){var b=a.node;this._fireEventWithNode("ignoreAllProblems",b)}},disableRule:{call:function(a){var b=a.node;this._fireEventWithNode("disableRule",b)}},addWord:{call:function(a){var b=this,c=a.node;setTimeout(function(){b._fireEventWithNode("addWordToUserDictionary",c)},10)}},settings:{call:function(){this.sandbox.fireInAllApps("closeDialog",{except:this.sandbox.getOption("uid")}),this.sandbox.fire("showUiElement",{elementName:"settings"})}},proofreadDialog:{call:function(){this.sandbox.fireInAllApps("closeDialog",{except:this.sandbox.getOption("uid")}),this.sandbox.fire("showUiElement",{elementName:"proofreadDialog"})}},contextMenu:{call:function(a){var b=a.node;this.sandbox.fire("showUiElement",{elementName:"contextMenu",parameters:{node:b}})}},toggle:{call:function(){this.sandbox.fire("toggleApp",{flag:!this.sandbox.getOption("appStarted")})},getTitle:function(){return this.sandbox.getOption("appStarted")?"disable":"enable"}},help:{call:function(){window.open(this.sandbox.getOption("wscSupportUrl"),"_blank")}}},_fireEventWithNode:function(a,b,c){var d=this.sandbox.getNodeInfo(b),c=c||{};c.node=b,c.problemType=d.type,this.sandbox.fire(a,c)}},a.ActionManager=d}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b,c,d=function(a,d){this.name=a,b=d.UILib,c=d.Utils,this.sandbox=d};d.prototype={constructor:d,init:function(){},problemTypes:{spelling:{type:"spelling",attrName:"data_attribute_name",attrNameBackward:"data_attribute_name_backward",attrRuleName:"data_attribute_rule_name",attrLang:"data_lang_attribute",attrId:"data_id_attribute",nodeName:"misspelled_word_node",addWord:"addWordToUserDictionary",classOption:"misspelled_word_class",ignoredClass:"ignored_problem_class",wordBased:!0},grammar:{type:"grammar",attrName:"problem_grammar_data_attribute",attrNameBackward:"problem_grammar_data_attribute_backward",attrRuleName:"problem_grammar_data_attribute_rule",attrLang:"data_lang_attribute",attrId:"data_id_attribute",nodeName:"problem_grammar_node",classOption:"problem_grammar_class",ignoredClass:"ignored_problem_class",wordBased:!1},autocorrect:{type:"autocorrect",attrName:"autocorrect_data_attribute",attrNameBackward:"autocorrect_data_attribute_backward",attrRuleName:"autocorrect_data_attribute_rule",attrLang:"data_lang_attribute",attrId:"data_id_attribute",nodeName:"autocorrect_node",classOption:"autocorrect_class",ignoredClass:"ignored_problem_class",wordBased:!0}},getProblemInfo:function(a){var c,d={},e=this.getNodeInfo(a),f=b.attr(a,this.sandbox.getOption(e.attrName)),g=b.attr(a,this.sandbox.getOption(e.attrRuleName)),h=b.attr(a,this.sandbox.getOption(e.attrLang)),i=b.attr(a,this.sandbox.getOption(e.attrId));return c=this.sandbox.fire("getSuggestionsList",{value:f,type:e.type,rule:g,lang:h,id:i}),d.suggestions=c.suggestionList,d.type=e.type,d.text=f,c.problemDescription&&!this.sandbox.getOption("disableProblemDescription")&&(d.problemDescription=c.problemDescription),c.context&&(d.context=c.context),c.category&&(d.category=c.category),c.rule&&(d.rule=c.rule),c.description&&(d.description=c.description),c.hasOwnProperty("offset")&&void 0!==c.offset&&(d.offset=c.offset),d},getNodeInfo:function(a){var b;for(var d in this.problemTypes)if(b=this.problemTypes[d],c.isEqualNode(a,this.sandbox.getOption(b.attrName)))return b},getFullNodeInfo:function(a){var d,e,f,g,h,i;for(var j in this.problemTypes){if(d=this.problemTypes[j],e=this.sandbox.getOption(d.attrName),f=this.sandbox.getOption(d.attrNameBackward),g=this.sandbox.getOption(d.classOption),h=c.isEqualNode(a,e),i=b.hasClass(a,g),e!==f&&c.isEqualNode(a,f))return Object.assign({broken:!0},d);if(!h&&i)return Object.assign({broken:!0},d);if(h&&!i)return Object.assign({broken:!0},d);if(h&&i)return Object.assign({},d)}},getChildProblemNodes:function(a){var c,d,e=[];for(var f in this.problemTypes)d=this.problemTypes[f],c=b.findNodeChildren(a,this.sandbox.getOption(d.nodeName),this.sandbox.getOption(d.attrName)),e=e.concat(c);return e},getParentProblemNodes:function(a){for(var d,e,f=b.parents(a),g=this.sandbox.getProblemContainer(),h=[],i=0;i<f.length&&(e=f[i],e!==g);i++)for(var j in this.problemTypes)d=this.problemTypes[j],c.isEqualNode(e,this.sandbox.getOption(d.attrName))&&h.push(e);return h},getProblemNodeFromMouseEvent:function(a){var d,e,f,g,h,i,j=c.getCurrentDocument(this.sandbox.getOption("documentContainer")),k={node:null};if(d=c.elementsFromPoint(a.clientX,a.clientY,j),!d)return k;for(var l in this.problemTypes)if(e=this.sandbox.getOption(this.problemTypes[l].classOption),f=this.sandbox.getOption(this.problemTypes[l].ignoredClass),g=Array.prototype.filter.call(d,function(a){return b.hasClass(a,e)})[0],i=i?i:e,g)return h=b.parent(g),b.hasClass(h,i)&&(g=h[0]),b.hasClass(g,f)&&(g=null),k.node=g,k;return k},getProblemNodesFromPoint:function(a,d){var e,f,g=c.getCurrentDocument(this.sandbox.getOption("documentContainer")),h=c.elementsFromPoint(a,d,g),i=[];if(h){for(var j=0;j<h.length;j++)for(var k in this.problemTypes)f=h[j],e=this.sandbox.getOption(this.problemTypes[k].classOption),b.hasClass(f,e)&&i.push(f);return i}},getProblemTypes:function(){var a={};for(var b in this.problemTypes)a[b]=Object.assign({},this.problemTypes[b]);return a}},a.ProblemManager=d}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=a.prototype.CharCodeUtils,c=function(a,b){this.name=a,this.sandbox=b};c.prototype={constructor:c,tokenize:function(a){for(var c,d,e,f,g,h,i=this.sandbox.getOption("minWordLength"),j=this.prepareCustomPunctuation(),k="value_",l=function(){o&&o.length>=i&&(c||(c={}),c[k+o]||(c[k+o]={value:o,positions:[]}),c[k+o].positions.push({start:n,end:m-1})),n=-1,o=""},m=0,n=-1,o="";m<a.length;)if(d=a[m],e=d.charCodeAt(0),b.isSpecialCharacter(e))m++;else if(b.isWordBoundary(e,j))-1!==n&&l(),m++;else if(b.isSituationalSeparator(e)){if(-1!==n){for(h=m+1,f=a[h],g=f?f.charCodeAt(0):-1;b.isSpecialCharacter(g);)h+=1,f=a[h],g=f?f.charCodeAt(0):-1;!f||b.isSituationalSeparator(g)||b.isWordBoundary(g,j)?l():o+=d}m++}else b.isWhiteSpaceExtended(e)||(-1===n&&(n=m),o+=d,m++);return l(),c},prepareCustomPunctuation:function(){for(var a=this.sandbox.getOption("customPunctuation").split(""),b=[],c=0;c<a.length;c++)b.push(a[c].charCodeAt(0));return b}},a.WordTokenizer=c}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=a.prototype.Utils,c=a.prototype.CharCodeUtils,d=function(a,b){this.name=a,this.sandbox=b};d.prototype={constructor:d,tokenize:function(a){for(var d,e,f,g,h,i,j,k,l="value_",m=function(a){if(r){var b=a?r+d:r;b=b.trim(),o||(o={}),o[l+b]||(o[l+b]={value:b,positions:[]}),o[l+b].positions.push({start:q,end:a?p:p-1})}q=-1,r=""},n=function(){r+=160===d.charCodeAt(0)?" ":d},o=[],p=0,q=-1,r="";p<a.length;)if(d=a[p],e=d.charCodeAt(0),c.isSpecialCharacter(e))p++;else if(c.isNewLine(e)&&-1!==q)m(),p++;else if(c.isSentenceEnd(e)){if(-1!==q){if(46===d.charCodeAt(0)){for(h=p-1,f=a[h],g=f?f.charCodeAt(0):-1;c.isSpecialCharacter(g);)h-=1,f=a[h],g=f?f.charCodeAt(0):-1;if(f&&b.isUppercaseLetter(f)){n(),p++;continue}}for(k=p+1,i=a[k],j=i?i.charCodeAt(0):-1;c.isSpecialCharacter(j);)k+=1,i=a[k],j=i?i.charCodeAt(0):-1;if(!i){m(!0),p++;continue}if(!c.isWhiteSpace(j)){n(),p++;continue}for(k+=1,i=a[k],j=i?i.charCodeAt(0):-1;(c.isWhiteSpace(j)||c.isSpecialCharacter(j))&&!c.isNewLine(j);)k+=1,i=a[k],j=i?i.charCodeAt(0):-1;if(!i||b.isUppercaseLetter(i)||c.isNewLine(j)){m(!0),p=k;continue}n(),p++;continue}p++}else c.isWhiteSpace(e)&&-1===q?p++:(c.isWhiteSpaceExtended(e)||-1===q&&(q=p),n(),p++);return m(),o}},a.SentenceTokenizer=d}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=function(a,b){this.name=a,this.sandbox=b,this.info={}};b.prototype={constructor:b,collect:function(a,b){return b=b||{},b.markTextNodes&&this.sandbox.markTextNodes(a),this.cleanInfo(),this.traverse(a,b),this.info},cleanInfo:function(){this.info={resultText:"",maskText:"",customModel:{},textNodes:[],foundedProblems:{}}},traverse:function(a,b){var c=[{el:a,editable:a.isContentEditable}],d=c.shift(),e=this.sandbox.canBeIgnored();if(!e||!this.sandbox.hasIgnoredParent(a))for(;d;){switch(d.el.nodeType){case 3:this.createInfo(d,b);break;case 1:if(e){if(this.sandbox.isIgnoredElement(d.el))break;if(this.sandbox.isIgnoredByClass(d.el))break;if(this.sandbox.isIgnoredByAttribute(d.el))break}for(var f=0;f<d.el.childNodes.length;f++)c.splice(f,0,{el:d.el.childNodes[f],editable:d.el.isContentEditable});this.sandbox.isBlockElement(d.el)&&(c.splice(f,0,{el:document.createTextNode("\u2029"),editable:!0}),c.splice(0,0,{el:document.createTextNode("\u2029"),editable:!0}))}d=c.shift()}},createInfo:function(a,b){a.el.length&&(this.createFullInfo(a,b),this.createFoundedProblems(a,b),this.createTextStrings(a))},createFullInfo:function(a,b){if(b.fullInfo){var c={node:a.el,start:this.info.resultText.length,end:this.info.resultText.length+a.el.nodeValue.length-1};this.info.customModel[c.start]=c,this.info.customModel[c.end]=c,this.info.textNodes.push(c)}},createFoundedProblems:function(a,b){var c,d=this.sandbox.getOption("markPrefixStart"),e=this.sandbox.getOption("markPrefixEnd");if(b.markTextNodes){if(a.el[d]){for(var f=0;f<a.el[d].length;f++)c=this.info.resultText.length+a.el[d][f].offset,a.el[d][f].start=c,this.info.foundedProblems[c]=a.el[d][f];delete a.el[d]}if(a.el[e]){for(var f=0;f<a.el[e].length;f++)c=this.info.resultText.length+a.el[e][f].offset-1,a.el[e][f].startMark.end=c;delete a.el[e]}}},createTextStrings:function(a){var b=a.editable===!1?"0":"1";this.info.resultText+=a.el.nodeValue,this.info.maskText+=a.el.nodeValue.replace(/./g,b)},split:function(a){for(var b,c=[a],d=c.shift(),e=[];d;){switch(d.nodeType){case 3:if(0===d.nodeValue.trim().length)break;if(b=this.sandbox.getParentBlockElement(d,a),a===b)return[a];e[e.length-1]!==b&&e.push(b);break;case 1:for(var f=0;f<d.childNodes.length;f++)c.splice(f,0,d.childNodes[f])}d=c.shift()}return e}},a.NodeInfoCollector=b}(WEBSPELLCHECKER.CORE),WEBSPELLCHECKER._createApp=function(a,b,c){return b="function"==typeof b?b:function(){},c="function"==typeof c?c:function(a){throw a},new WEBSPELLCHECKER._AppCreator(a,b,c).getInstance()},function(){var a,b,c,d=WEBSPELLCHECKER.OptionsManager,e=d.importOptionsTemplate("CoreTemplate"),f=d.optionTypes,g=WEBSPELLCHECKER.CORE.prototype.Utils,h=WEBSPELLCHECKER.CORE.prototype.UILib;a={enableGrammar:{defaultValue:!0,type:f.boolean},autoStartup:{defaultValue:!1,type:f.boolean},charsToObserve:{defaultValue:[],type:f.array},basePath:{defaultValue:void 0,type:f.string},units:{defaultValue:["editableControls","ui"],type:f.array},onLoad:{defaultValue:function(){},type:f.function},onCommitOptions:{defaultValue:function(){},type:f.function},onAddWordToUserDictionary:{defaultValue:function(){},type:f.function},onDeleteWordFromUserDictionary:{defaultValue:function(){},type:f.function},onStatistics:{defaultValue:function(){},type:f.function},onErrorRequest:{defaultValue:function(){},type:f.function},onToggle:{defaultValue:function(){},type:f.function}},a=d.mergeOptionsTemplates(a,e),a.setDefaults({appType:"application"}),d.exportOptionsTemplate("AppTemplate",a),b=g.getBaseData("wscbundle.js").path,b&&(a.setDefaults({basePath:b}),c=g.getLocationInfo(b),"file"!==c.protocol&&a.setDefaults({serviceProtocol:c.protocol,serviceHost:c.host,servicePort:c.port,servicePath:c.pathname+"./../script/ssrv.cgi",serviceId:""})),WEBSPELLCHECKER._AppCreator=function(a,b,c){this.options={},this.userOptions=a?a:{},this.callbackSuccess=b,this.callbackError=c,this.criticalMessage="",this.error=null,this.core=null,this.sandbox=null,this.modulesList={},this.units={},this.priorityModules=["Wrapper","ContenteditableMirror","Mirror"],this.modules=[],this.instance={},this.markupHandlerCallback=function(){},this.create()
},WEBSPELLCHECKER._AppCreator.prototype={constructor:WEBSPELLCHECKER._AppCreator,create:function(){return this.parseOptions(),this.isIncorrectOptions()?(this.createError(),void this.callbackError(this.error)):(this.addCommonUnit(),this.createCoreModules(),this.setAdditionalOptions(),this.createModulesList(),this.createUnitsList(),this.createModules(),this.initModules(),this.attachEvents(),this.setAdditionalAttributes(),this.createInstance(),this.extendInstance(),this.extendSandbox(),void(this.isAllModulesReady()&&this.runSuccessCallback()))},parseOptions:function(){this.parseDisableOptionsStorage(),this.setContainer(),this.setOptions(),this.checkBasePath(),this.removeSpacesInCustomDictionatyIds()},parseDisableOptionsStorage:function(){var a=["lang","ignoreWordsWithMixedCases","ignoreDomainNames","ignoreAllCapsWords","ignoreWordsWithNumbers","autocorrect"];if(this.isDisableOptionsStoragePassed()){this.isDisableAll()&&(a=[],this.userOptions.disableOptionsStorage=[]),this.isOptionsDisabled()&&(a=["lang","autocorrect"]);for(var b=0;b<this.userOptions.disableOptionsStorage.length;b++){var c=this.userOptions.disableOptionsStorage[b];this.isAvailableDisableOption(c)&&a.splice(a.indexOf(c),1)}this.userOptions["options-to-restore"]=a,delete this.userOptions.disableOptionsStorage}},isDisableOptionsStoragePassed:function(){return this.userOptions.disableOptionsStorage&&Array.isArray(this.userOptions.disableOptionsStorage)},isDisableAll:function(){return this.userOptions.disableOptionsStorage.includes("all")},isOptionsDisabled:function(){return this.userOptions.disableOptionsStorage.includes("options")},isAvailableDisableOption:function(a){var b=["lang","ignoreWordsWithMixedCases","ignoreDomainNames","ignoreAllCapsWords","ignoreWordsWithNumbers","autocorrect"];return b.includes(a)},setContainer:function(){this.userOptions.container="string"==typeof this.userOptions.container?document.getElementById(this.userOptions.container):this.userOptions.container},setOptions:function(){var a=this;this.options=d.createOptions(this.userOptions,"AppTemplate",function(b){b.reports.forEach(function(b){b.critical&&(a.criticalMessage+=b.message)})})},checkBasePath:function(){this.options.basePath||(this.criticalMessage+="Parameter 'basePath' is undefined. Script 'wscbundle.js' should be added to the page.")},removeSpacesInCustomDictionatyIds:function(){this.options.customDictionaryIds&&(this.options.customDictionaryIds=this.options.customDictionaryIds.replace(/\s/g,""))},isIncorrectOptions:function(){return""!==this.criticalMessage},createError:function(){this.error=new Error(this.criticalMessage)},addCommonUnit:function(){this.options.units.includes("common")||this.options.units.unshift("common")},createCoreModules:function(){this.core=new WEBSPELLCHECKER.CORE(this.options),this.sandbox=new WEBSPELLCHECKER.CORE.Sandbox("APP",this.core),this.core.instanceManager.add(this.sandbox)},setAdditionalOptions:function(){this.sandbox.setOption("appStarted",this.options.autoStartup),this.userOptions.appType&&this.sandbox.setOption("appType",this.userOptions.appType),g.isTouchDevice()&&this.sandbox.setOption("isTouchDevice",!0),this.setThemeClass(),this.setNativeSpellCheck()},setThemeClass:function(){var a=this.sandbox.getOption("theme"),b=this.sandbox.getOption("themePrefix"),c=this.sandbox.getOption("themes");"default"!==a&&c.includes(a)&&this.sandbox.setOption("themeClass",b+"-"+a)},setNativeSpellCheck:function(){var a=this.sandbox.getOption("container"),b=h.attr(a,"spellcheck");("true"===b||b===!0)&&this.sandbox.setOption("nativeSpellCheck",!0)},createModulesList:function(){for(var a,b=0;b<WEBSPELLCHECKER._appModules.length;b++)a=WEBSPELLCHECKER._appModules[b],this.modulesList[a]=WEBSPELLCHECKER.CORE[a];this.extendModulesList()},extendModulesList:function(){WEBSPELLCHECKER.CORE.UI&&(this.modulesList.UIBuilder=WEBSPELLCHECKER.CORE.UIBuilder)},createUnitsList:function(){this.units=JSON.parse(JSON.stringify(WEBSPELLCHECKER._appUnits)),this.extendUnitsList()},extendUnitsList:function(){this.options.units.includes("editableControls")||(this.units.ui.push("FocusManager"),this.units.common.push("IME"))},createModules:function(){this.createMainModules(),this.createExtraModules(),this.setModulesOrder()},createMainModules:function(){for(var a,b=0;b<this.options.units.length;b++)a=this.options.units[b],this.modules=this.modules.concat(this.getModules(this.units[a]))},getModules:function(a){for(var b,c=[],d=0;d<a.length;d++)b=a[d],c.push({name:b,module:this.modulesList[b]});return c},createExtraModules:function(){Array.isArray(this.userOptions.extraModules)&&(this.modules=this.modules.concat(this.getModules(this.userOptions.extraModules)))},setModulesOrder:function(){for(var a,b,c,d=0;d<this.priorityModules.length;d++)a=this.priorityModules[d],b=this.getModuleIndexByName(a),-1!==b&&(c=this.modules[b],this.modules.splice(b,1),this.modules.unshift(c))},getModuleIndexByName:function(a){for(var b=0;b<this.modules.length;b++)if(this.modules[b].name===a)return b;return-1},initModules:function(){this.core.initModules(this.modules)},attachEvents:function(){this.sandbox.subscribe("afterDrop, allModulesReady",function(){this.startAppWhenModulesReady()},this),this.sandbox.subscribe("allModulesReady",function(){this.handleAllModulesReady()},this),this.sandbox.subscribe("removedMarkupInContainer, markupedNode",function(a){this.checkNodeWithSpecialChars(a)},this),this.sandbox.subscribe("commitOptions",function(a){this.handleCommitOptions(a)},this),this.sandbox.subscribe("syncOptions",function(a){this.handleSyncOptions(a)},this),this.sandbox.subscribe("toggleApp",function(a){this.handleToggle(a)},this)},startAppWhenModulesReady:function(){this.sandbox.setMarkupStrategy(this.sandbox.getOption("markupStrategy")),this.sandbox.getOption("appStarted")&&this.sandbox.getOption("proofreadAsYouType")?this.sandbox.startMarkup():this.sandbox.stopMarkup(),this.options.onLoad.call(this.instance,this.instance)},handleAllModulesReady:function(){this.addSandboxToClipboardManager(),this.executeActionsForUi(),this.executeActionsForDoubleClick(),this.executeActionsForInstance()},addSandboxToClipboardManager:function(){this.options.units.includes("editableControlsVersion1")&&this.core.clipboardManager.add(this.sandbox,this.sandbox.getOption("container"),this.sandbox.isOriginalContainerTextBased())},executeActionsForUi:function(){this.options.units.includes("ui")&&(this.setAdditionalClasses(),this.attachExtraEvents())},setAdditionalClasses:function(){g.Browser.ie&&(h.addClass("html","wsc-ie"+g.Browser.version),g.Browser.version<9&&h.addClass("html","wsc-lt-ie9")),g.Browser.safari&&h.addClass("html","wsc-safari"),g.isTouchDevice()&&h.addClass("html","wsc-touch")},attachExtraEvents:function(){var a=this.sandbox.getOption("isIframe"),b=this.sandbox.getOption("documentContainer"),c=this.sandbox.getOption("container"),d=this.sandbox.getOption("autoDestroy"),e=a?b:c;this.sandbox.subscribe({eventType:"cutProcessed",handler:function(){var a=this;this.sandbox.fire("removeMarkupInSelectionNode",{}),setTimeout(function(){a.sandbox.startProblemCheck()},0)},context:this}),this.sandbox.subscribe("removedMarkupInContainer",function(a){a.textChanged&&this.sandbox.startProblemCheck()},this),this.sandbox.subscribe("pasteProcessed",function(){this.sandbox.fire("removeMarkupInSelectionNode",{})},this),this.sandbox.subscribe("afterPaste, garbageCollected",function(){this.sandbox.startProblemCheck()},this),d&&this.sandbox.subscribe("periodicalChecking",function(){var b=!1;this.instance&&this.instance.destroy&&(g.isNodeAvailable(e)||(b=!0),a&&!b&&c!==e.contentWindow.document.getElementsByTagName("body")[0]&&(b=!0),b&&this.instance.destroy())},this)},executeActionsForDoubleClick:function(){"Basic"===this.sandbox.getOption("markupStrategy")&&this.sandbox.subscribe({eventType:"dblclick",element:this.sandbox.getOption("container"),handler:this.handleDoubleClick,context:this})},handleDoubleClick:function(){var a,b,c=this.sandbox.getSelection();if(c.rangeCount()>0&&(a=c.getRangeAt(0),b=a.toString(),!b&&0===a.getNodes().length))try{c.expand("word"),this.sandbox.fire("selectionIsChanged",{})}catch(d){}},executeActionsForInstance:function(){this.instance&&(this.runSuccessCallback(),this.instance&&(this.sandbox.isIframeInQuirksModeInEdge()&&this.sandbox.UILib.addClass(this.sandbox.getOption("container"),this.sandbox.getOption("iframe_quirks_class")),this.sandbox.UILib.attr(this.sandbox.getOption("container"),this.sandbox.getOption("instance_attribute"),!0)))},runSuccessCallback:function(){this.callbackSuccess(this.instance)},checkNodeWithSpecialChars:function(a){for(var b,c=this.sandbox.getOption("charsToObserve"),d=0;d<c.length;d++)b=g.findFirstNodeWithString(a.node,c[d].charCode),b&&this.markupHandlerCallback({charName:c[d].charName,node:b})},setAdditionalAttributes:function(){this.isNeedToDisableNativeSpellCheck()&&this.disableNativeSpellCheck()},isNeedToDisableNativeSpellCheck:function(){var a=this.sandbox.getOption("appStarted"),b=this.sandbox.getOption("restoreNativeSpellCheck");return a?!0:b?!1:!0},disableNativeSpellCheck:function(){var a=this.sandbox.getOption("container");h.attr(a,"spellcheck",!1)},handleCommitOptions:function(a){var b=this.getChangedOptions(a.changedOptions),c=this.sandbox.isSyncOptions()&&!a.skipSync;if(!g.isEmptyObject(b)){b.lang&&(this.sandbox.fire("clearDictionary",{}),this.sandbox.fire("removeMarkupInDocument",{}),this.sandbox.setOption("detectedLang",""),this.sandbox.removeAllDeferredFunctions()),this.sandbox.setPaused(!0);for(var d in b)b.hasOwnProperty(d)&&this.sandbox.setOption(d,b[d]);this.sandbox.setPaused(!1),this.sandbox.fire("optionsCommited",b),c&&this.sandbox.fireInAllApps("syncOptions",{changedOptions:b}),!a.ignoreCallback&&this.options.onCommitOptions(b,this.instance),this.sandbox.startProblemCheck()}},getChangedOptions:function(a){var b={};for(var c in a)a.hasOwnProperty(c)&&a[c]!==this.sandbox.getOption(c)&&(b[c]=a[c]);return b},handleSyncOptions:function(a){var b=this.sandbox.isSyncOptions();b&&(a.ignoreCallback=!0,a.skipSync=!0,this.handleCommitOptions(a))},handleToggle:function(a){a.flag?this.handleEnable(a):this.handleDisable(a)},handleEnable:function(a){this.sandbox.startApp(),this.disableNativeSpellCheck(),!a.ignoreCallback&&this.options.onToggle(this.instance)},handleDisable:function(a){this.sandbox.stopApp(),this.restoreNativeSpellCheck(),!a.ignoreCallback&&this.options.onToggle(this.instance)},restoreNativeSpellCheck:function i(){var a=this.sandbox.getOption("nativeSpellCheck"),i=this.sandbox.getOption("restoreNativeSpellCheck");a&&i&&this.enableNativeSpellCheck()},enableNativeSpellCheck:function(){var a=this.sandbox.getOption("container");h.attr(a,"spellcheck",!0)},createInstance:function(){Object.assign(this.instance,WEBSPELLCHECKER._AppInstance)},extendInstance:function(){var a=this;this.instance._core=this.core,this.instance._sandbox=this.sandbox,this.instance._getService=function(a){return this._core.getService(a)},this.instance.addMarkupHandler=function(b){a.markupHandlerCallback=b},this.instance._destroy=function(){a.sandbox.unsubscribe({eventType:"dblclick",element:a.sandbox.getOption("container"),handler:a.handleDoubleClick,context:a}),a.destroy()}},destroy:function(){this.options=null,this.userOptions=null,this.callbackSuccess=null,this.callbackError=null,this.core=null,this.sandbox=null,this.modulesList=null,this.units=null,this.modules=null,this.instance=null},extendSandbox:function(){var a=this.sandbox.getOption(this.sandbox.getOption("isIframe")?"documentContainer":"originalContainer");this.sandbox.originalElementId=h.attr(a,"id"),this.sandbox.instance=this.instance,this.sandbox.getLocal=function(a){return this.sandbox.Localization.getLocal(a,this.sandbox.getOption("localization"))}},isAllModulesReady:function(){return this.core.allModulesReady},getInstance:function(){return this.instance}}}(),WEBSPELLCHECKER._AppInstance={destroy:function(){this._sandbox.getOption("paused")&&this._sandbox.setPaused(!1),this._sandbox.Utils.isInPage(this._sandbox.getMainProblemContainer())&&this._sandbox.fire("removeMarkupInDocument",{}),this._sandbox.getOption("units").includes("editableControlsVersion1")&&this._core.clipboardManager.remove(this._sandbox.getOption("uid")),this._core.instanceManager.remove(this._sandbox.getOption("uid")),this._destroy(),this._core.destroyModules(),this._sandbox.setPaused(!0),this._sandbox.isIframeInQuirksModeInEdge()&&this._sandbox.UILib.removeClass(this._sandbox.getOption("container"),this._sandbox.getOption("iframe_quirks_class")),this._sandbox.UILib.removeAttr(this._sandbox.getOption("container"),this._sandbox.getOption("instance_attribute"));for(var a in this)this.hasOwnProperty(a)&&delete this[a]},isAllModulesReady:function(){return this._core.allModulesReady},reloadMarkup:function(){this._sandbox.startProblemCheck()},addWordToUserDictionary:function(a,b,c){this._sandbox.fire("addWordToUserDictionary",{word:a,onSuccess:b,onError:c})},deleteWordFromUserDictionary:function(a,b,c){this._sandbox.fire("deleteWordFromUserDictionary",{word:a,onSuccess:b,onError:c})},getUserDictionary:function(a,b){this._sandbox.fire("getUserDictionary",{name:a,callback:b})},getUserDictionaryName:function(){return this._sandbox.getOption("userDictionaryName")},createUserDictionary:function(a,b,c){this._sandbox.fire("createUserDictionary",{name:a,onSuccess:b,onError:c})},restoreUserDictionary:function(a,b,c){this._sandbox.fire("restoreUserDictionary",{name:a,onSuccess:b,onError:c})},disconnectFromUserDictionary:function(a,b,c){this._sandbox.fire("disconnectFromUserDictionary",{name:a,onSuccess:b,onError:c})},renameUserDictionary:function(a,b,c){this._sandbox.fire("renameUserDictionary",{newName:a,onSuccess:b,onError:c})},removeUserDictionary:function(a,b,c){this._sandbox.fire("removeUserDictionary",{name:a,onSuccess:b,onError:c})},setUserDictionaryName:function(a){this._sandbox.fire("setUserDictionaryName",{name:a})},isUserDictionaryExist:function(){return"string"==typeof this._sandbox.getOption("userDictionaryName")},getCustomDictionary:function(){return this._sandbox.getOption("customDictionaryIds")},getLangList:function(){return this._sandbox.getOption("langList")},getLang:function(){return this._sandbox.getOption("lang")},setLang:function(a,b){b=b||{},this._sandbox.fire("commitOptions",{changedOptions:{lang:a},ignoreCallback:b.ignoreCallback})},commitOption:function(a,b){b=b||{},this._sandbox.fire("commitOptions",{changedOptions:a.changedOptions?a.changedOptions:a,ignoreCallback:b.ignoreCallback})},getOption:function(a){return this._sandbox.getOption(a)},getApplicationConfig:function(){return this._sandbox.getOption(["ignoreWordsWithMixedCases","ignoreDomainNames","ignoreAllCapsWords","ignoreWordsWithNumbers"])},getLangAttribute:function(){return this._sandbox.getOption("data_lang_attribute")},removeMarkupFromString:function(a){return this._sandbox.removeMarkupFromString(a)},getLogo:function(){return this._sandbox.getLogo()},getVersion:function(){return this._sandbox.getOption("wscVersion")},getBrandingInfo:function(){return{wscSupportUrl:this._sandbox.getOption("wscSupportUrl")}},getAttributeInfo:function(){return{data_attribute_name:this._sandbox.getOption("data_attribute_name"),misspelled_word_class:this._sandbox.getOption("misspelled_word_class"),problem_grammar_data_attribute:this._sandbox.getOption("problem_grammar_data_attribute"),problem_grammar_class:this._sandbox.getOption("problem_grammar_class")}},setMarkupPaused:function(a){this._sandbox.setMarkupPaused(a)},getContainerNode:function(){return this._sandbox.getOption("container")},isDisabled:function(){return!this._sandbox.getOption("appStarted")},enable:function(a){a=a||{},this._sandbox.getOption("appStarted")||this.fire("toggleApp",{flag:!0,ignoreCallback:a.ignoreCallback})},disable:function(a){a=a||{},this._sandbox.getOption("appStarted")&&this.fire("toggleApp",{flag:!1,ignoreCallback:a.ignoreCallback})},getProblemsCount:function(){return this._sandbox.getProblemsCount()},reloadMarkupInAllInstances:function(){this._sandbox.fireInAllApps("startProblemCheck")},changeStateForAddedWordToUserDictionary:function(a){this._sandbox.fire("changeStateForAddedWordToUserDictionary",{word:a})},changeStateForDeletedWordFromUserDictionary:function(a){this._sandbox.fire("changeStateForDeletedWordFromUserDictionary",{word:a})},changeStateForProblemsWithDisabledRules:function(a){this._sandbox.fireInAllApps("changeStateForProblemsWithDisabledRules",{rules:a})},changeStateForProblemsWithEnabledRules:function(a){this._sandbox.fireInAllApps("changeStateForProblemsWithEnabledRules",{rules:a})},replaceSelectionNode:function(a){a=a||{},a.word&&(a.problemType="spelling",a.text=a.word),a.phrase&&(a.problemType="grammar",a.text=a.phrase),this._sandbox.fire("replaceProblem",a)},getSuggestions:function(a){var b=this._sandbox.getDictionary(),c=b.getProblem({value:a.word||a.phrase,rule:a.rule||"",type:a.word?"spelling":"grammar"},a.lang),d=c&&c.getSuggestions?c.getSuggestions():null;return d},ignoreWord:function(){this._sandbox.fire("ignoreProblem",{problemType:"spelling"})},ignoreAllWords:function(){this._sandbox.fire("ignoreAllProblems",{problemType:"spelling"})},ignorePhrase:function(){this._sandbox.fire("ignoreProblem",{problemType:"grammar"})},ignoreAllPhrases:function(a){a=a||{},a.problemType="grammar",this._sandbox.fire("ignoreAllProblems",a)},removeMarkupInSelectionNode:function(a){this._sandbox.fire("removeMarkupInSelectionNode",a)},getProblemNodeFromSelection:function(){var a;return a=this._sandbox.getSpellingNodeFromSelection(),a||(a=this._sandbox.getGrammarNodeFromSelection()),a},getSpellingLangList:function(){return this._sandbox.getOption("langList")},getGrammarLangList:function(){return{ltr:{},rtl:{}}},isSpellingNode:function(a){var b=this._sandbox.getOption("data_attribute_name");return this._sandbox.Utils.isEqualNode(a,b)},isGrammarNode:function(a){var b=this._sandbox.getOption("problem_grammar_data_attribute");return this._sandbox.Utils.isEqualNode(a,b)},findSpellingNode:function(a){for(var b=0;b<a.length;b++)if(this.isSpellingNode(a[b]))return a[b];return null},findGrammarNode:function(a){for(var b=0;b<a.length;b++)if(this.isGrammarNode(a[b]))return a[b];return null},subscribe:function(a,b){this._sandbox.subscribe(a,b)},fire:function(a,b){this._sandbox.fire(a,b)},showBanner:function(a){this._sandbox.fire("showBanner",{contextMenuContainerSelector:a})},hideBanner:function(){this._sandbox.fire("hideBanner",{})},isBannerEnable:function(){return this._sandbox.getOption("banner")},getProblemDescriptionText:function(a,b,c,d){return this._sandbox.getProblemDescriptionText({value:a,rule:b,type:"grammar",id:d},c)},findNodeWithChar:function(a,b){return this._sandbox.Utils.findFirstNodeWithString(a,b.charCode)},getSpellingNodeAttributeName:function(){return this._sandbox.getOption("data_attribute_name")},getNodeAttribute:function(){return this.getSpellingNodeAttributeName()},getGrammarNodeAttributeName:function(){return this._sandbox.getOption("problem_grammar_data_attribute")},getGrammarNodeRuleAttributeName:function(){return this._sandbox.getOption("problem_grammar_data_attribute_rule")},getStaticActions:function(){for(var a,b,c=this._sandbox.getStaticActions(),d=[],e=0;e<c.length;e++)a=c[e].getName(),b={name:a,localization:{"default":this.getLocal("btn_"+a)}},"toggle"===a&&(b.localization.enable=this.getLocal("btn_enable"),b.localization.disable=this.getLocal("btn_disable")),d.push(b);return d.reverse()},isSyncOptions:function(){return this._sandbox.isSyncOptions()},getLocal:function(a){return this._sandbox.Localization.getLocal(a,this._sandbox.getOption("localization"))},setDisabled:function(a,b){b=b||{},this._sandbox.getOption("appStarted")===a&&this.fire("toggleApp",{flag:!a,ignoreCallback:b.ignoreCallback})},fixBrokenNodes:function(a){this._sandbox.fire("fixBrokenNodes",{container:a})},fixProblemNodesInElement:function(a){var b=this._sandbox.getBrokenSpellingNodes(a),c=this._sandbox.getBrokenGrammarNodes(a);b&&(this._sandbox.fire("removeMarkup",{nodes:b}),this.reloadMarkup()),c&&(this._sandbox.fire("removeMarkup",{nodes:c}),this.reloadMarkup())}},WEBSPELLCHECKER._appModules=["Banner","InfoGetter","Statistics","StyleManager","LocalizationManager","ProofreadDialogManager","ChangeController","BasicController","VirtualController","TokenCollector","BasicCollector","VirtualCollector","ProblemFinder","BasicFinder","VirtualFinder","ProblemMarkuper","BasicMarkuper","VirtualMarkuper","ProblemProcessor","BasicProcessor","VirtualProcessor","Autocorrect","DictionaryManager","DOMChangesListener","Mirror","ContenteditableMirror","MutationObserver","Wrapper","UndoManager","DragAndDropManager","MaxLength","KeyboardManager","GarbageCollector","FocusManager","IME"],WEBSPELLCHECKER._appUnits={common:["Banner","InfoGetter","Statistics","StyleManager","LocalizationManager","ProofreadDialogManager","ChangeController","BasicController","VirtualController","TokenCollector","BasicCollector","VirtualCollector","ProblemFinder","BasicFinder","VirtualFinder","ProblemMarkuper","BasicMarkuper","VirtualMarkuper","ProblemProcessor","BasicProcessor","VirtualProcessor","Autocorrect","DictionaryManager"],ui:["UIBuilder","DOMChangesListener"],editableControls:["Mirror","ContenteditableMirror","MutationObserver"],editableControlsVersion1:["Wrapper","UndoManager","DragAndDropManager","MaxLength","KeyboardManager","GarbageCollector"]},function(a){"use strict";var b=a.prototype.Utils,c=function d(a,c){this.name=a,this.sandbox=c,this.dictionary=new d.Dictionary(this.sandbox,b.arrayToObject(this.sandbox.getOption("disabledRules"))),this.userDictionaryManager=new d.UserDictionaryManager(this.sandbox),this.shortAnswer=!0};c.prototype={constructor:c,init:function(){this.sandbox.subscribe("tokensCollected",function(a){this.tokensCollectedHandler(a.tokens,a.container,a.splittedMainContainer)},this),this.sandbox.subscribe("tokensCollectedForCleaning",function(a){this.tokensCollectedForCleaningHandler(a.tokens,a.container)},this),this.sandbox.subscribe("wordForAutocorrectFound",function(a){this.wordForAutocorrectFoundHandler(a)},this),this.sandbox.subscribe("getSuggestionsList",function(a){this.getSuggestionsListHandler(a)},this),this.sandbox.subscribe("optionsCommited",function(a){this.optionsCommitedHandler(a)},this),this.sandbox.subscribe("clearDictionary",function(a){this.clearDictionaryHandler(a)},this),this.sandbox.subscribe("bindProblemWithToken",function(a){this.bindProblemWithTokenHandler(a)},this),this.sandbox.subscribe("getUserDictionary",function(a){this.userDictionaryManager.getUserDictionary(a)},this),this.sandbox.subscribe("setUserDictionaryName",function(a){this.userDictionaryManager.setUserDictionaryName(a.name)},this),this.sandbox.subscribe("createUserDictionary",function(a){this.userDictionaryManager.createUserDictionary(a)},this),this.sandbox.subscribe("restoreUserDictionary",function(a){var b=a.onSuccess||function(){},c=this;a.onSuccess=function(a){b(a),c.userDictionaryStateChangedHandler(a.wordlist)},this.userDictionaryManager.restoreUserDictionary(a)},this),this.sandbox.subscribe("renameUserDictionary",function(a){this.userDictionaryManager.renameUserDictionary(a)},this),this.sandbox.subscribe("removeUserDictionary",function(a){this.userDictionaryManager.removeUserDictionary(a)},this),this.sandbox.subscribe("disconnectFromUserDictionary",function(a){this.userDictionaryManager.disconnectFromUserDictionary(a)},this),this.sandbox.subscribe("addWordToUserDictionary",function(a){this.addWordToUserDictionaryHandler(a)},this),this.sandbox.subscribe("changeStateForAddedWordToUserDictionary",function(a){this.changeStateForAddedWordToUserDictionaryHandler(a)},this),this.sandbox.subscribe("deleteWordFromUserDictionary",function(a){this.deleteWordFromUserDictionaryHandler(a)},this),this.sandbox.subscribe("changeStateForDeletedWordFromUserDictionary",function(a){this.changeStateForDeletedWordFromUserDictionaryHandler(a)},this),this.sandbox.subscribe("userDictionaryChanged",function(a){this.userDictionaryManager.syncUserDictionaryName(a)},this),this.sandbox.subscribe("userDictionaryStateChanged",function(){this.userDictionaryStateChangedHandler()},this),this.sandbox.subscribe("resetUserDictionaryStatusForWords",function(a){this.resetUserDictionaryStatusForWordsHandler(a)},this),this.sandbox.subscribe("resetDisabledRuleStatusForProblems",function(a){this.resetDisabledRuleStatusForProblemsHandler(a)},this),this.sandbox.subscribe("sendStatistics",function(a){this.sendStatisticsHandler(a)},this)},tokensCollectedHandler:function(a,b,c){var d,e=this.sandbox.getOption("lang");a.length&&(d=this.addTokensToDictionary(a,e,b),this.getTokensInfo(d.unknown,e,b,c),this.processInProcessTokens(d.inProcess,b),this.processProcessedTokens(d.processed,e,b,c),this.cleanDictionaryStorages(e,b))},addTokensToDictionary:function(a,b,c){for(var d,e,f,g={unknown:[],inProcess:[],processed:[]},h=0;h<a.length;h++)d=a[h].value,e=a[h].markuped,f=this.dictionary.getToken(d,b),f||(f=this.dictionary.addToken(d,b)),f.isUnknownStatus()&&g.unknown.push(f),f.isInProcessStatus()&&g.inProcess.push(f),f.isProcessedStatus()&&this.isNeedReProcessToken(f,b,e)&&g.processed.push(f),this.isNeedCleanDictionaryStorages(c)&&f.setStayAlive();return g},isNeedCleanDictionaryStorages:function(a){return a?!1:!0},isNeedReProcessToken:function(a,b,c){var d=this.dictionary.getTokenMatchesForMarkup(a,b);if(0===d.length)return!0;if(d.length!==c.length)return!0;for(var e=0;e<d.length;e++)if(d[e].type!==c[e].type||d[e].rule!==c[e].rule||d[e].value!==c[e].value)return!0;return!1},getTokensInfo:function(a,c,d,e){var f=this,a=a||[],g=this.sandbox.getOption("requestTokensCount"),h=b.createDeferredName("getTokensInfoForLang",c,d,e),i=this.sandbox.getOption("autoLangPriorities");this.isLanguageAvailable(c)&&0!==a.length&&(a=this.getUniqueTokens(a),i=b.isEmptyObject(i)||"auto"!==c?"":JSON.stringify(i),this.setTokensToInProcess(a,d),this.sandbox.addDeferredFunction(h,{delay:500,collection:a,partialItemsCount:g,inQueue:e?!0:!1,defferedFunctionArgs:[c,i,e],onUnregister:function(){var a=this;f.setTokensToUnknown(a.collection)},deferredFunction:function(a,b,c,d){for(var e=[],g=0;g<a.length;g++)e.push(a[g].getValue());return f.sandbox.fire("remoteAction",{actionMethod:"check",userWordlist:f.userDictionaryManager.getWordsFromUserDictionary(),lang:b,autoLangPriorities:c,tokens:JSON.stringify(e),onSuccess:function(c){for(var e=f.updateTokensWithResponseData(a,c,b),g=0;g<e.length;g++)f.sandbox.fire("problemsFound",{tokens:e[g].tokens,lang:b,container:e[g].container,splittedMainContainer:d});f.sandbox.setOption("numberOfFailedRequest",0)},onError:function(){var c=f.sandbox.getOption("numberOfFailedRequest");f.sandbox.setOption("numberOfFailedRequest",++c),c>4?(f.sandbox.fire("toggleApp",{flag:!1}),f.sandbox.setOption("numberOfFailedRequest",0),f.setTokensToUnknown(a)):f.getTokensInfo(a,b)}}),!0}}))},isLanguageAvailable:function(a){var b=this.sandbox.getOption("langList");return b?a in b.ltr||a in b.rtl?!0:(this.sandbox.console.warn('Specified "'+a+"\" language code is not available for your Service ID or doesn't exist. Contact support@webspellchecker.net for more details."),!1):(this.sandbox.console.warn("The language list is not defined. Contact support@webspellchecker.net for more details."),!1)},getUniqueTokens:function(a){return a=b.ArrayUtils.arrayUnique(a,function(a,b){return a.getValue()===b.getValue()})},setTokensToInProcess:function(a,b){for(var c=0;c<a.length;c++)a[c].setInProcessStatus(),a[c].addContainerForSearch(b)},setTokensToUnknown:function(a){for(var b=0;b<a.length;b++)a[b].setUnknownStatus(),a[b].cleanContainersForSearch()},updateTokensWithResponseData:function(a,b,c){var d,e,f,g=[];this.shortAnswer=b.r?!0:!1;for(var h=0;h<a.length;h++){d=a[h],e=d.getContainersForSearch(),this.setDetectedLang(this.shortAnswer?b.r[h].l:b.result[h].lang),this.updateToken(d,this.shortAnswer?b.r[h].m:b.result[h].matches,c);for(var i=0;i<e.length;i++){f=!1;for(var j=0;j<g.length;j++)if(g[j].container===e[i]){g[j].tokens.push(d),f=!0;break}f||g.push({container:e[i],tokens:[d]})}}return g},setDetectedLang:function(a){a&&this.sandbox.setOption("detectedLang",a)},updateToken:function(a,b,c){b=this.processMatches(b,a,c),a.setMatches(b),a.setProcessedStatus(),a.cleanContainersForSearch()},processMatches:function(a,b,c){for(var d,e,f=[],g=0;g<a.length;g++)d=a[g],this.shortAnswer&&(d=this.mapMatchFields(d)),d.value=b.value.substring(d.offset,d.offset+d.length),d.hash=this.createHashForMatch(d),f.push(d),e=this.dictionary.getProblem(d,c),e||(e=this.dictionary.addProblem(d,c),this.setIgnoredStateIfRequired(e));return f},mapMatchFields:function(a){var b={t:"type",o:"offset",l:"length",s:"suggestions",r:"rule",m:"message",d:"description",u:"ud",c:"category"},c={};for(var d in b)a.hasOwnProperty(d)&&(c[b[d]]=a[d]);return c},createHashForMatch:function(a){var c=a.type||"",d=a.rule||"",e=a.value||"",f=a.suggestions?a.suggestions.join(""):"",g=a.message||"",h=a.category||"";return b.hashCode(c+d+e+f+g+h)},setIgnoredStateIfRequired:function(a){var c;if(a.canBeIgnored())return a.isIgnoredStatus()&&a.unsetIgnoredStatus(),c=a.getValue(),this.sandbox.getOption("ignoreAllCapsWords")&&b.isAllCapsLetters(c)?void a.setIgnoredStatus():this.sandbox.getOption("ignoreWordsWithMixedCases")&&b.isMixedCapsLetters(c)?void a.setIgnoredStatus():this.sandbox.getOption("ignoreWordsWithNumbers")&&b.isLettersWithNumbers(c)?void a.setIgnoredStatus():this.sandbox.getOption("ignoreDomainNames")&&b.isDomainName(c)?void a.setIgnoredStatus():void 0},processInProcessTokens:function(a,b){if(b&&a.length){a=this.getUniqueTokens(a);for(var c=0;c<a.length;c++)a[c].addContainerForSearch(b)}},processProcessedTokens:function(a,b,c,d){a.length&&(a=this.getUniqueTokens(a),this.sandbox.fire("problemsFound",{tokens:a,lang:b,container:c,splittedMainContainer:d}))},cleanDictionaryStorages:function(a,b){var c,d=this;this.isNeedCleanDictionaryStorages(b)&&(this.dictionary.eachTokens(a,function(b){b.isStayAlive()?b.unsetStayAlive():d.dictionary.deleteToken(b.getValue(),a)}),c=this.sandbox.getProblemsIds(),this.dictionary.eachProblemsBindings(a,function(a,b){c.hasOwnProperty(b)||a.deleteBinding(b)}))},tokensCollectedForCleaningHandler:function(a,b){var c=this.sandbox.getOption("lang");a.length&&(this.setStayAliveStateForTokens(a,c),this.cleanDictionaryStorages(c,b))},setStayAliveStateForTokens:function(a,b){for(var c,d=0;d<a.length;d++)c=this.dictionary.getToken(a[d].value,b),c&&c.setStayAlive()},wordForAutocorrectFoundHandler:function(a){var b=this.dictionary.getAutocorrectionWord(a.word);return b||(b=this.dictionary.addAutocorrectionWord(a.word)),b.isUnknown()?void this.getAutocorrectionWordInfo(b,a):void this.processAutocorrectionWord(b,a)},getAutocorrectionWordInfo:function(a,c){var d=this.sandbox.getOption("lang"),e=this.sandbox.getOption("autoLangPriorities"),f=this.sandbox.getOption("detectedLang"),g=this;this.isLanguageAvailable(d)&&(e=b.isEmptyObject(e)||"auto"!==d?"":JSON.stringify(e),this.sandbox.fire("remoteAction",{actionMethod:"autocorrect",userWordlist:this.userDictionaryManager.getWordsFromUserDictionary(),text:c.word,lang:d,autoLangPriorities:e,detectedLang:f,onSuccess:function(b){var d=g.updateAutocorrectionWordWithResponseData(a,b);g.processAutocorrectionWord(d,c)},onError:function(){var b=g.updateAutocorrectionWordWithResponseData(a,{r:{}});g.processAutocorrectionWord(b,c)}}))},updateAutocorrectionWordWithResponseData:function(a,b){var c=b.r?!0:!1,d=c?this.mapMatchFields(b.r):b.result;return a.setData(d),a.setProcessed(),this.addProblemForAutocorrectionWord(a),a},addProblemForAutocorrectionWord:function(a){var b,c=this.sandbox.getOption("lang"),d=a.getValue(),e=a.getSuggestion(),f=a.getMessage(),g={value:e,type:"autocorrect",suggestions:[d],message:f};e&&(b=this.dictionary.getProblem(g,c),b||this.dictionary.addProblem(g,c))},processAutocorrectionWord:function(a,b){var c=a.getSuggestion(),d=a.getMessage(),e=a.getValue(),f=this.sandbox.getOption("lang"),g=this.dictionary.getProblem({value:e,type:"spelling"},f);
a.isIgnored()||c&&(g&&g.isUserDictionaryStatus()||(b.suggestion=c,b.message=d,this.sandbox.fire("autocorrect",b)))},getSuggestionsListHandler:function(a){var b=a.lang||this.sandbox.getOption("lang"),c=this.dictionary.getProblemData(a,b);this.sandbox.fire("suggestionListSend",{suggestionList:c.suggestionList}),a.setReturnedData({suggestionList:c.suggestionList,problemDescription:c.problemDescription,context:c.context,category:c.category,rule:c.rule,description:c.description,offset:c.offset})},optionsCommitedHandler:function(){var a=this,b=this.sandbox.getOption("lang");this.dictionary.eachProblemsByType(b,"spelling",function(b){a.setIgnoredStateIfRequired(b)})},clearDictionaryHandler:function(){this.dictionary.clear()},bindProblemWithTokenHandler:function(a){var b=this.dictionary.getProblem(a.match,a.lang);b&&a.id&&b.addBinding(a.id,a.context,a.match)},userDictionaryStateChangedHandler:function(a){a=a||[],this.sandbox.fireInAllApps("resetUserDictionaryStatusForWords",{resetAll:!0,newWords:a}),this.sandbox.fireInAllApps("removeMarkupInDocument"),this.sandbox.fireInAllApps("startProblemCheck")},addWordToUserDictionaryHandler:function(a){var b;b=this.getExtraDataForAddingToUserDictionary(a.word,a.node),a.word=b.word,a.node=b.node,a.word&&(this.userDictionaryManager.addWordToUserDictionary(a),this.sandbox.fire("sendStatistics",{action:"add",node:a.node,text:a.word}),this.sandbox.fire("changeStateForAddedWordToUserDictionary",{word:a.word}))},getExtraDataForAddingToUserDictionary:function(a,b){return a?{word:a}:(b=b||this.sandbox.getSpellingNodeFromSelection(),b&&this.sandbox.getProblemContainer().contains(b)&&(a=b.getAttribute(this.sandbox.getOption("data_attribute_name"))),{word:a,node:b})},changeStateForAddedWordToUserDictionaryHandler:function(a){var b=this.getAllWordsWithCapitalizedFormToo(a.word);this.sandbox.fireInAllApps("resetUserDictionaryStatusForWords",{newWords:b}),this.sandbox.fireInAllApps("removeMarkupFromProblems",{problems:b,problemType:"spelling"})},getAllWordsWithCapitalizedFormToo:function(a){var c=[{value:a}];return b.isLowercaseLetter(a[0])&&c.push({value:b.capitalizeFirstLetter(a)}),c},deleteWordFromUserDictionaryHandler:function(a){this.userDictionaryManager.deleteWordFromUserDictionary(a),this.sandbox.fire("sendStatistics",{action:"delete",text:a.word}),this.sandbox.fire("changeStateForDeletedWordFromUserDictionary",{word:a.word})},changeStateForDeletedWordFromUserDictionaryHandler:function(a){var b=this.getAllWordsWithCapitalizedFormToo(a.word);this.sandbox.fireInAllApps("resetUserDictionaryStatusForWords",{oldWords:b})},resetUserDictionaryStatusForWordsHandler:function(a){var b=a.resetAll,c=a.newWords,d=a.oldWords;b&&this.unsetUserDictionaryStatusForAllWords(),c&&this.changeUserDictionaryStatusForWords(c,"setUserDictionaryStatus"),d&&this.changeUserDictionaryStatusForWords(d,"unsetUserDictionaryStatus")},unsetUserDictionaryStatusForAllWords:function(){this.dictionary.eachAllProblemsByType("spelling",function(a){a.unsetUserDictionaryStatus()})},changeUserDictionaryStatusForWords:function(a,b){for(var c,d,e=0;e<a.length;e++){c="string"==typeof a[e]?a[e]:a[e].value,d=this.dictionary.getAllProblems({value:c,type:"spelling"});for(var f=0;f<d.length;f++)d[f][b]()}},resetDisabledRuleStatusForProblemsHandler:function(a){var b=a.disabledRules,c=a.enabledRules;b&&(this.dictionary.addDisabledRules(b),this.changeDisabledRuleStatusForProblems(b,"setDisabledRuleStatus")),c&&(this.dictionary.deleteDisabledRules(c),this.changeDisabledRuleStatusForProblems(c,"unsetDisabledRuleStatus"))},changeDisabledRuleStatusForProblems:function(a,b){var c="grammar";for(var d in a)a.hasOwnProperty(d)&&this.dictionary.eachAllProblemsByTypeAndRule(c,d,function(a){a[b]()})},sendStatisticsHandler:function(a){"replace"===a.action&&this.handleAutocorrectedWordReplace(a)},handleAutocorrectedWordReplace:function(a){var b;"autocorrect"===a.problemType&&(b=this.dictionary.getAutocorrectionWord(a.newText),b&&b.setIgnored())},destroy:function(){this.dictionary.clear()}},a.DictionaryManager=c}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=a,c=function(a,b){this.sandbox=a,this.disabledRules=b,this.tokenStorage={},this.problemStorage={},this.autocorrectionWordStorage={},this.tokenPrefix="token_",this.problemPrefix="problem_",this.autocorrectionWordPrefix="autocorrect_",this.emptyRule="EMPTY_RULE_FOR_PROBLEM"};c.prototype={constructor:c,addToken:function(a,c){var d=new b.Token(a);return this.tokenStorage[c]=this.tokenStorage[c]||{},this.tokenStorage[c][this.tokenPrefix+a]=d,d},getToken:function(a,b){return this.tokenStorage[b]?this.tokenStorage[b][this.tokenPrefix+a]:void 0},deleteToken:function(a,b){this.tokenStorage[b]&&this.tokenStorage[b][this.tokenPrefix+a]&&delete this.tokenStorage[b][this.tokenPrefix+a]},eachTokens:function(a,b){if("function"==typeof b&&this.tokenStorage[a])for(var c in this.tokenStorage[a])b(this.tokenStorage[a][c])},getTokenMatchesForMarkup:function(a,b){for(var c,d,e=[],f=a.getMatches(),g=0;g<f.length;g++)c=f[g],d=this.getProblem(c,b),d.isNeedToMarkup()&&e.push(c);return e},addProblem:function(a,c){var d=new b.Problem(a),e=a.type,f=a.rule||this.emptyRule,g=a.value;return this.isDisabledRule(f)&&d.setDisabledRuleStatus(),this.problemStorage[c]=this.problemStorage[c]||{},this.problemStorage[c][e]=this.problemStorage[c][e]||{},this.problemStorage[c][e][f]=this.problemStorage[c][e][f]||{},this.problemStorage[c][e][f][this.problemPrefix+g]=d,d},getProblem:function(a,b){var c=a.value,d=a.type,e=a.rule||this.emptyRule;if(this.problemStorage[b]&&this.problemStorage[b][d]&&this.problemStorage[b][d][e])return this.problemStorage[b][d][e][this.problemPrefix+c]},getAllProblems:function(a){var b,c=[];for(var d in this.problemStorage)b=this.getProblem(a,d),b&&c.push(b);return c},getProblemData:function(a,b){var c=this.getProblem(a,b);return c?this.getProblemDataById(c,a.id):this.getEmptyProblemData()},getEmptyProblemData:function(){return{suggestionList:[],problemDescription:""}},getProblemDataById:function(a,b){var c=a.getData(b);return{suggestionList:c.suggestions,problemDescription:c.message,category:c.category,rule:c.rule,description:c.description,offset:c.offset,context:c.context}},getProblemDescription:function(a,b){var c=this.getProblemData(a,b);return c.problemDescription},deleteProblem:function(a,b){var c=a.value,d=a.type,e=a.rule||this.emptyRule;this.problemStorage[b]&&this.problemStorage[b][d]&&this.problemStorage[b][d][e]&&this.problemStorage[b][d][e][this.problemPrefix+c]&&delete this.problemStorage[b][d][e][this.problemPrefix+c]},eachProblems:function(a,b){if("function"==typeof b&&this.problemStorage[a])for(var c in this.problemStorage[a])for(var d in this.problemStorage[a][c])for(var e in this.problemStorage[a][c][d])b(this.problemStorage[a][c][d][e])},eachProblemsByType:function(a,b,c){if("function"==typeof c&&this.problemStorage[a]&&this.problemStorage[a][b])for(var d in this.problemStorage[a][b])for(var e in this.problemStorage[a][b][d])c(this.problemStorage[a][b][d][e])},eachAllProblemsByType:function(a,b){for(var c in this.problemStorage)this.eachProblemsByType(c,a,b)},eachProblemsByTypeAndRule:function(a,b,c,d){if("function"==typeof d&&this.problemStorage[a]&&this.problemStorage[a][b]&&this.problemStorage[a][b][c])for(var e in this.problemStorage[a][b][c])d(this.problemStorage[a][b][c][e])},eachAllProblemsByTypeAndRule:function(a,b,c){for(var d in this.problemStorage)this.eachProblemsByTypeAndRule(d,a,b,c)},eachProblemsBindings:function(a,b){"function"==typeof b&&this.eachProblems(a,function(a){a.eachBindings(function(c){b(a,c)})})},addDisabledRules:function(a){Object.assign(this.disabledRules,a)},deleteDisabledRules:function(a){for(var b in a)a.hasOwnProperty(b)&&this.isDisabledRule(b)&&delete this.disabledRules[b]},isDisabledRule:function(a){return this.disabledRules.hasOwnProperty(a)},addAutocorrectionWord:function(a){var c=new b.AutocorrectionWord(a);return this.autocorrectionWordStorage[this.autocorrectionWordPrefix+a]=c,c},getAutocorrectionWord:function(a){return this.autocorrectionWordStorage[this.autocorrectionWordPrefix+a]},clear:function(){this.tokenStorage={},this.problemStorage={},this.autocorrectionWordStorage={}}},a.Dictionary=c}(WEBSPELLCHECKER.CORE.DictionaryManager),function(a){"use strict";var b=function c(a){this.value=a,this.matches=[],this.status=c.statuses.unknown,this.containers=[],this.stayAlive=!1};b.prototype={constructor:b,getValue:function(){return this.value},getMatches:function(){return this.matches},setMatches:function(a){this.matches=this.sortMatches(a)},sortMatches:function(a){return a.sort(function(a,b){return a.offset-b.offset}),a},getStatus:function(){return this.status},setStatus:function(a){b.statuses[a]&&(this.status=b.statuses[a])},setUnknownStatus:function(){this.status=b.statuses.unknown,this.matches=[],this.fullSearch=!1,this.stayAlive=!1},setInProcessStatus:function(){this.status=b.statuses.inProcess},setProcessedStatus:function(){this.status=b.statuses.processed},isUnknownStatus:function(){return this.status===b.statuses.unknown},isInProcessStatus:function(){return this.status===b.statuses.inProcess},isProcessedStatus:function(){return this.status===b.statuses.processed},addContainerForSearch:function(a){this.containers.includes(a)||this.containers.push(a)},getContainersForSearch:function(){return this.containers},cleanContainersForSearch:function(){this.containers=[]},setStayAlive:function(){this.stayAlive=!0},unsetStayAlive:function(){this.stayAlive=!1},isStayAlive:function(){return this.stayAlive}},b.statuses={unknown:0,inProcess:1,processed:2},a.Token=b}(WEBSPELLCHECKER.CORE.DictionaryManager),function(a){"use strict";var b=function(a){this.value=a.value,this.type=a.type,this.category=a.category||"",this.rule=a.rule||"",this.description=a.description||"",this.message=a.message||"",this.suggestions=a.suggestions||[],this.hash=a.hash,this.userDictionaryStatus=a.ud||!1,this.ignoredStatus=!1,this.userIgnoreStatus=!1,this.disabledRuleStatus=!1,this.bindings={}};b.prototype={constructor:b,getValue:function(){return this.value},getType:function(){return this.type},getCategory:function(a){return this.isGetFieldFromProblem(a)?this.category:this.bindings[a].category},getRule:function(a){return this.isGetFieldFromProblem(a)?this.rule:this.bindings[a].rule},getDescription:function(a){return this.isGetFieldFromProblem(a)?this.description:this.bindings[a].description},getMessage:function(a){return this.isGetFieldFromProblem(a)?this.message:this.bindings[a].message},getSuggestions:function(a){return this.isGetFieldFromProblem(a)?this.suggestions:this.bindings[a].suggestions},getContext:function(a){return this.isNoBinding(a)?"":this.bindings[a].context},getOffset:function(a){return this.isNoBinding(a)?void 0:this.bindings[a].offset},getHash:function(a){return this.isGetFieldFromProblem(a)?this.hash:this.bindings[a].hash},getData:function(a){return{value:this.getValue(),type:this.getType(),category:this.getCategory(a),rule:this.getRule(a),description:this.getDescription(a),message:this.getMessage(a),suggestions:this.getSuggestions(a),context:this.getContext(a),offset:this.getOffset(a),hash:this.getHash(a)}},isGetFieldFromProblem:function(a){return this.isNoBinding(a)||this.bindings[a].hash===this.hash?!0:!1},isNoBinding:function(a){return a&&this.bindings[a]?!1:!0},setIgnoredStatus:function(){this.ignoredStatus=!0},unsetIgnoredStatus:function(){this.ignoredStatus=!1},isIgnoredStatus:function(){return this.ignoredStatus},setUserIgnoreStatus:function(){this.userIgnoreStatus=!0},unsetUserIgnoreStatus:function(){this.userIgnoreStatus=!1},isUserIgnoreStatus:function(){return this.userIgnoreStatus},setUserDictionaryStatus:function(){this.userDictionaryStatus=!0},unsetUserDictionaryStatus:function(){this.userDictionaryStatus=!1},isUserDictionaryStatus:function(){return this.userDictionaryStatus},setDisabledRuleStatus:function(){this.disabledRuleStatus=!0},unsetDisabledRuleStatus:function(){this.disabledRuleStatus=!1},isDisabledRuleStatus:function(){return this.disabledRuleStatus},canBeIgnored:function(){return"spelling"===this.type},isNeedToMarkup:function(){return!(this.isIgnoredStatus()||this.isUserIgnoreStatus()||this.isUserDictionaryStatus()||this.isDisabledRuleStatus())},addBinding:function(a,b,c){var d={context:b,offset:c.offset,hash:c.hash};this.hash!==c.hash&&(d.category=c.category||"",d.rule=c.rule||"",d.message=c.message||"",d.description=c.description||"",d.suggestions=c.suggestions||[]),this.bindings[a]=d},getBinding:function(a){return this.bindings[a]},deleteBinding:function(a){this.bindings[a]&&delete this.bindings[a]},eachBindings:function(a){if("function"==typeof a)for(var b in this.bindings)a(b)}},a.Problem=b}(WEBSPELLCHECKER.CORE.DictionaryManager),function(a){"use strict";var b=function c(a){this.value=a,this.message="",this.suggestions=[],this.status=c.statuses.unknown,this.ignored=!1};b.prototype={constructor:b,getValue:function(){return this.value},getMessage:function(){return this.message},getSuggestion:function(){return this.suggestions.length>0?this.suggestions[0]:""},setData:function(a){this.message=a.message||"",this.suggestions=a.suggestions||[]},isUnknown:function(){return this.status===b.statuses.unknown},setProcessed:function(){this.status=b.statuses.processed},isIgnored:function(){return this.ignored},setIgnored:function(){this.ignored=!0}},b.statuses={unknown:0,processed:1},a.AutocorrectionWord=b}(WEBSPELLCHECKER.CORE.DictionaryManager),function(a,b){"use strict";var c=b.Utils,d=b.DataStorage,e=function(a){this.sandbox=a,this.userDictionaryName=this.sandbox.getOption("userDictionaryName"),this.userDictionaryKey=this.sandbox.getOption("userDictionaryKey"),this.userDictionaryNameKey=this.sandbox.getOption("userDictionaryNameKey"),this.init()};e.prototype={constructor:e,init:function(){var a;this.isValidUserDictionaryName(this.userDictionaryName)||(a=d.getData(this.userDictionaryNameKey),this.isValidUserDictionaryName(a)&&(this.userDictionaryName=a,this.sandbox.setOption("userDictionaryName",this.userDictionaryName)))},getUserDictionary:function(a){var b=d.getData(this.userDictionaryKey)||[],c=a.name||this.sandbox.getOption("userDictionaryName");return this.isValidUserDictionaryName(c)?void this.getUserDictionaryFromServer({name:c,onSuccess:a.callback}):void("function"==typeof a.callback&&a.callback({wordlist:b}))},isValidUserDictionaryName:function(a){return"string"==typeof a&&a.length>0?!0:!1},getUserDictionaryFromServer:function(a){this.remoteAction("getUserDictionary",a)},remoteAction:function(a,b){var c=this.createEventObject(a,b);this.sandbox.fire("remoteAction",c)},createEventObject:function(a,b){var b=b||{},d=b.name||b.newName||b.word,e=this,f={actionMethod:a,name:b.name||this.sandbox.getOption("userDictionaryName")};for(var g in b)c.TypeChecker.isFunction(b[g])||(f[g]=b[g]);return f.onSuccess=function(c){e.onSuccessCallback(a,b,c),e.sandbox.fire("userDictionaryAction",{request:b,response:c,action:b.action||"",status:"success",replaceText:d,messagePostfix:"Dic"})},f.onError=function(a){b.onError?b.onError(a):e.onErrorCallback(b,a),e.sandbox.fire("userDictionaryAction",{request:b,response:a,action:b.action||"",status:"error",replaceText:d,messagePostfix:"Dic"})},f},onSuccessCallback:function(a,b,c){switch("function"==typeof b.onSuccess&&b.onSuccess(c),a){case"createUserDictionary":this.processSuccessfullyUserDictionaryChange(c.name);break;case"deleteUserDictionary":this.processSuccessfullyUserDictionaryChange(""),this.sandbox.fire("userDictionaryStateChanged");break;case"renameUserDictionary":this.processSuccessfullyUserDictionaryChange(c.name);break;case"getUserDictionary":this.processSuccessfullyUserDictionaryChange(c.name)}this.clearUserDictionary()},onErrorCallback:function(a,b){"function"==typeof a.onError&&a.onError(b)},processSuccessfullyUserDictionaryChange:function(a){this.setUserDictionaryName(a),this.sandbox.fireInAllApps("userDictionaryChanged",{name:a})},setUserDictionaryName:function(a){d.setData(this.userDictionaryNameKey,a),this.sandbox.setOption("userDictionaryName",a)},clearUserDictionary:function(){d.setData(this.userDictionaryKey,[])},createUserDictionary:function(a){a.action=e.actions.createUserDictionary,a.wordList=this.getWordsFromUserDictionary(),this.remoteAction("createUserDictionary",a)},getWordsFromUserDictionary:function(){var a=d.getData(this.userDictionaryKey)||[];return a.join()},restoreUserDictionary:function(a){a.action=e.actions.restoreUserDictionary,this.getUserDictionaryFromServer(a)},renameUserDictionary:function(a){a.action=e.actions.renameUserDictionary,this.remoteAction("renameUserDictionary",a)},removeUserDictionary:function(a){a.action=e.actions.removeUserDictionary,this.remoteAction("deleteUserDictionary",a)},disconnectFromUserDictionary:function(a){a.action=e.actions.disconnectFromUserDictionary,this.processSuccessfullyUserDictionaryChange(""),d.setData(this.userDictionaryKey,[]),this.sandbox.fire("userDictionaryStateChanged"),this.sandbox.fire("userDictionaryAction",{request:a,response:{},action:a.action||"",status:"success",replaceText:a.name,messagePostfix:"Dic"})},addWordToUserDictionary:function(a){var b;return a.action=e.actions.addWordToUserDictionary,this.isValidUserDictionaryName(this.sandbox.getOption("userDictionaryName"))?void this.addWordToUserDictionaryServer(a):(b=d.getData(this.userDictionaryKey)||[],void(b.includes(a.word)||(b.push(a.word),d.setData(this.userDictionaryKey,b),"function"==typeof a.onSuccess&&a.onSuccess({}),this.sandbox.fire("userDictionaryAction",{request:a,response:{},action:a.action||"",status:"success",replaceText:a.word,messagePostfix:"Dic"}))))},addWordToUserDictionaryServer:function(a){var b=this;this.remoteAction("addWordToUserDictionary",{word:a.word,action:a.action,onSuccess:function(c){"function"==typeof a.onSuccess&&a.onSuccess(c),b.clearUserDictionary()},onError:a.onError})},deleteWordFromUserDictionary:function(a){var b,c;return a.action=e.actions.deleteWordFromUserDictionary,this.isValidUserDictionaryName(this.sandbox.getOption("userDictionaryName"))?void this.deleteWordFromUserDictionaryServer(a):(b=d.getData(this.userDictionaryKey)||[],c=b.indexOf(a.word),void(-1!==c&&(b.splice(c,1),d.setData(this.userDictionaryKey,b),"function"==typeof a.onSuccess&&a.onSuccess({}),this.sandbox.fireInAllApps("startProblemCheck"),this.sandbox.fire("userDictionaryAction",{request:a,response:{},action:a.action||"",status:"success",replaceText:a.word,messagePostfix:"Dic"}))))},deleteWordFromUserDictionaryServer:function(a){var b=this;this.remoteAction("deleteWordFromUserDictionary",{word:a.word,action:a.action,onSuccess:function(c){"function"==typeof a.onSuccess&&a.onSuccess(c),b.sandbox.fireInAllApps("startProblemCheck")},onError:a.onError})},syncUserDictionaryName:function(a){this.sandbox.setOption("userDictionaryName",a.name)}},e.actions={createUserDictionary:"create",restoreUserDictionary:"restore",renameUserDictionary:"rename",removeUserDictionary:"remove",disconnectFromUserDictionary:"disconnect",addWordToUserDictionary:"addWord",deleteWordFromUserDictionary:"deleteWord"},a.UserDictionaryManager=e}(WEBSPELLCHECKER.CORE.DictionaryManager,WEBSPELLCHECKER.CORE.prototype),function(a){"use strict";var b=a.prototype.Utils,c=function(a,c){this.name=a,this.sandbox=c,this.basePath=c.getOption("basePath"),this.cssPath=c.getOption("cssPath"),this.themePath=this.basePath+"themes/all.css",this.doc=b.getCurrentDocument(c.getOption("documentContainer"))};c.prototype={constructor:c,init:function(){this.loadStyle(this.cssPath,this.doc),this.loadStyle(this.cssPath),this.loadStyle(this.themePath)},loadStyle:function(a,b){var b=b||document;this.isStyleLoaded(a,b)||this.appendStyle(a,b)},isStyleLoaded:function(a,b){for(var c=b.getElementsByTagName("link"),d=0;d<c.length;d++)if(c[d].href===a)return!0;return!1},appendStyle:function(a,b){var c;b.createStyleSheet?"complete"===b.readyState?b.createStyleSheet(a):b.onreadystatechange=function(){"complete"===b.readyState&&b.createStyleSheet(a)}:(c=b.createElement("link"),c.setAttribute("rel","stylesheet"),c.setAttribute("type","text/css"),c.setAttribute("href",a),b.getElementsByTagName("head")[0].appendChild(c))}},a.StyleManager=c}(WEBSPELLCHECKER.CORE),function(a){"use strict";if(!a.LocalizationManager){var b=function(a,b){this.name=a,this.sandbox=b,this.localizationLoaded=!1};b.prototype={constructor:b,init:function(){this.load(),this.sandbox.subscribe("localizationLoaded",function(a){this.handleLocalizationLoaded(a)},this)},load:function(){var b=this.sandbox.getOption("loadLocalization"),c=this.sandbox.getOption("detectLocalizationLanguage"),d=this.sandbox.getOption("localization"),e=this.sandbox.Utils.getLocationInfo(this.sandbox.getOption("basePath")),f=this.sandbox.getOption("localizationPath"),g=a.prototype.Localization,h=this;return c&&(d=this.detect(d),this.sandbox.setOption("localization",d)),g.lang[d]||!b?void this.fireModuleReady():void this.sandbox.IO.loadScript(new this.sandbox.IO.URL({protocol:e.protocol,host:e.host,port:e.port,path:e.pathname+f+d+"/local.js"}),function(){h.fireModuleReady(),h.sandbox.fireInAllApps("localizationLoaded",{lang:d})},function(){h.fireModuleReady(),h.sandbox.fireInAllApps("localizationLoaded",{lang:d})})},fireModuleReady:function(){var a=this;setTimeout(function(){!a.localizationLoaded&&a.sandbox.fire("moduleReady",{moduleID:a.name}),a.localizationLoaded=!0},0)},detect:function(a){var b=this.sandbox.getOption("localizationList"),c=navigator.userLanguage||navigator.language||a,d=this.sandbox.getOption("supportLocale"),e=c.toLowerCase().match(/([a-z]+)(?:-([a-z]+))?/),f=e[1],g=e[2];return d&&b.indexOf(f+"-"+g)>0?f+"-"+g:b.indexOf(f)<0?a:f},handleLocalizationLoaded:function(a){var b=this.sandbox.getOption("localization");b===a.lang&&this.fireModuleReady()}},a.prototype.Localization=a.prototype.Localization||{lang:{},getLocal:function(a,b){return this.lang[b]&&this.lang[b][a]?this.lang[b][a]:a}},b.async=!0,a.LocalizationManager=b}}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=function(a,b){this.name=a,this.sandbox=b,this.type="Controller",this.strategy=null};b.prototype={constructor:b,init:function(){this.sandbox.subscribe("allModulesReady",function(){this.attachEvents()},this)},attachEvents:function(){return this.sandbox.getOption("isTextBasedContainer")?void this.strategy.attachCommonEvents():void this.strategy.attachEvents()},setStrategy:function(a){this.strategy=a}},a.ChangeController=b}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=a.prototype.Utils,c=function(a,b){this.name=a,this.sandbox=b};c.prototype={constructor:c,attachEvents:function(){this.sandbox.subscribe({eventType:"keydown",element:this.sandbox.getOption("container"),handler:this.handleKeydown})},attachCommonEvents:function(){},handleKeydown:function(a){this.handleChangesInContainer(),this.handleRemoveMarkupAfterKeydown(a)},handleChangesInContainer:function(){this.sandbox.startProblemCheck({afterDelay:!0})},handleRemoveMarkupAfterKeydown:function(a){this.sandbox.getOption("appStarted")&&b.isPrintableKeydown(a)&&this.sandbox.fire("removeMarkupAfterKeydown",{event:a})}},a.BasicController=c}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=a.prototype.Utils,c=function(a,b){this.name=a,this.sandbox=b,this.isStartProblemCheckForMainContainer=!1,this.blockForStartProblemCheck=null,this.isSentenceEndKeyPressed=!1,this.isSentenceFinished=!1,this.sentenceEndKeys=[190,49,191],this.spaceKeys=[32],this.minimalDelay=0,this.shortDelay=500,this.longDelay=2e3};c.prototype={constructor:c,attachEvents:function(){this.sandbox.subscribe("containerMutated",function(a){a.isDataChanged&&this.handleMutations(a)},this),this.attachCommonEvents()},attachCommonEvents:function(){this.sandbox.subscribe({eventType:"keydown",element:this.sandbox.getOption("container"),handler:this.handleKeydown})},handleMutations:function(a){var b,c=this;this.shouldStartProblemCheckForMainContainer(a)?this.isStartProblemCheckForMainContainer=!0:this.blockForStartProblemCheck=a.mutatedParentBlocks[0],b=this.getDelay(),this.sandbox.addDeferredFunction("reactOnContainerMutations",{single:!0,delay:b,deferredFunction:function(){c.handleChangesInContainer()}})},shouldStartProblemCheckForMainContainer:function(a){return this.isStartProblemCheckForMainContainer?!0:a.mutatedParentBlocks.length>1?!0:a.isDataChangedInContainer?!0:this.blockForStartProblemCheck&&this.blockForStartProblemCheck!==a.mutatedParentBlocks[0]?!0:!1},getDelay:function(){var a;return a=this.isSentenceFinished?this.minimalDelay:this.isStartProblemCheckForMainContainer?this.longDelay:this.shortDelay},handleChangesInContainer:function(){var a=this.createEventObject();this.sandbox.startProblemCheck(a),this.clearTempData()},createEventObject:function(){var a={};return this.isStartProblemCheckForMainContainer||(a.container=this.blockForStartProblemCheck),a},clearTempData:function(){this.isStartProblemCheckForMainContainer=!1,this.blockForStartProblemCheck=null,this.isSentenceEndKeyPressed=!1,this.isSentenceFinished=!1},handleKeydown:function(a){this.sandbox.getOption("appStarted")&&(this.handlePrintableKeydown(a),this.handleSentenceFinished(a.keyCode),this.handleWordBoundaryKeydown(a))},handlePrintableKeydown:function(a){b.isPrintableKeydown(a)&&(this.removeMarkupAfterKeydown(a),this.firePrintableKeydownEvent(a))},removeMarkupAfterKeydown:function(a){this.sandbox.getOption("container").isContentEditable&&this.sandbox.fire("removeMarkupAfterKeydown",{event:a})},firePrintableKeydownEvent:function(a){this.sandbox.getOption("autocorrect")&&this.sandbox.fire("printableKeydownPressed",{event:a})},handleSentenceFinished:function(a){var b=this.sentenceEndKeys.includes(a),c=this.spaceKeys.includes(a);return b||c?b?void(this.isSentenceEndKeyPressed=!0):void(c&&this.isSentenceEndKeyPressed&&(this.isSentenceFinished=!0,this.sandbox.fire("sentenceFinished",{}))):(this.isSentenceEndKeyPressed=!1,void(this.isSentenceFinished=!1))},handleWordBoundaryKeydown:function(a){this.sandbox.getOption("autocorrect")&&(b.isWhiteSpaceKeydown(a)||b.isPunctuationKeydown(a))&&this.sandbox.fire("wordBoundaryPressed",{event:a})}},a.VirtualController=c}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=function(a,b){this.name=a,this.sandbox=b,this.type="Collector",this.collectTokensForCleaning=!1,this.strategy=null};b.prototype={constructor:b,init:function(){this.sandbox.subscribe("startProblemCheck, startSpellCheck, startGrammarCheck",function(a){a=a||{},this.startProblemCheckAfterDelay(a)},this),this.sandbox.subscribe("problemCheckEnded",function(){this.handleProblemCheckEnded()},this)},startProblemCheckAfterDelay:function(a){var b=this;this.sandbox.addDeferredFunction("startProblemCheckAfterDelay",{single:!0,delay:a.afterDelay?2e3:0,deferredFunction:function(){b.startProblemCheck(a)}})},startProblemCheck:function(a){var b,c=this.sandbox.getOption("container"),d=this.sandbox.getOption("mirrorContainer"),e=this;return this.sandbox.removeDeferredFunction("collectTokensForCleaning"),!this.strategy.splitMainContainer||a.container||d?void this.processContainer(a.container,"tokensCollected"):(b=this.sandbox.splitNode(c),1===b.length&&b[0]===c?void this.processContainer(void 0,"tokensCollected"):(this.collectTokensForCleaning=!0,this.sandbox.removeDeferredFunction("startProblemCheckForMainContainer"),void this.sandbox.addDeferredFunction("startProblemCheckForMainContainer",{delay:10,collection:b,partialItemsCount:1,deferredFunction:function(a){for(var b=0;b<a.length;b++)c.contains(a[b])&&e.processContainer(a[b],"tokensCollected",e.strategy.splitMainContainer)}})))},processContainer:function(a,b,c){var d=this.strategy.getTokens(a);this.sandbox.fire(b,{tokens:d,container:a,splittedMainContainer:c})},handleProblemCheckEnded:function(){var a=this;this.collectTokensForCleaning&&this.sandbox.addDeferredFunction("collectTokensForCleaning",{single:!0,delay:1e3,deferredFunction:function(){a.collectTokensForCleaning=!1,a.processContainer(void 0,"tokensCollectedForCleaning")}})},setStrategy:function(a){this.strategy=a}},a.TokenCollector=b}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=a.prototype.UILib,c=a.prototype.Utils,d=function(a,b){this.name=a,this.sandbox=b,this.splitMainContainer=!1};d.prototype={constructor:d,getTokens:function(a){var b,c,a=this.sandbox.getOption("container");return b=this.collectInfoFromNode(a),c=this.collectTokens(b)},collectInfoFromNode:function(a){for(var c,d=[a],e=d.shift(),f=this.sandbox.getRegExp("ignoreElementsRegex"),g=new RegExp("(^|\\s)rangySelectionBoundary(\\s|$)"),h=this.sandbox.getRegExp("sentenceEndCharsGrammar"),i=this.sandbox.getRegExp("nonWhiteSpaceExtended"),j={resultText:"",problemsStartIndexes:{}};e;){switch(e.nodeType){case 3:j.resultText+=e.nodeValue;break;case 1:if(g.test(b.attr(e,"className")))break;if(f.match(e.nodeName))break;if(this.sandbox.isIgnoredByClass(e))break;if(this.sandbox.isIgnoredByAttribute(e))break;c=this.sandbox.getNodeInfo(e),c&&e.innerHTML&&(j.problemsStartIndexes[j.resultText.length]=j.problemsStartIndexes[j.resultText.length]||[],j.problemsStartIndexes[j.resultText.length].push({type:c.type,value:b.attr(e,this.sandbox.getOption(c.attrName))||"",rule:b.attr(e,this.sandbox.getOption(c.attrRuleName))||""}));for(var k=0;k<e.childNodes.length;k++)d.splice(k,0,e.childNodes[k]);this.sandbox.isBlockElement(e)&&(d.length>e.childNodes.length&&d.splice(k,0,document.createTextNode("\u2029")),j.resultText.length>0&&-1===h.search(j.resultText)&&-1!==i.search(j.resultText)?d.splice(0,0,document.createTextNode("\u2029")):j.resultText.length>0&&" "!=j.resultText[j.resultText.length-1]&&d.splice(0,0,document.createTextNode(" ")))}e=d.shift()}return j.resultText=this.sandbox.cleanSpecialAndHtmlSpaceCharacters(j.resultText),j},collectTokens:function(a){var b=this.tokenizeSentences(a);return b},tokenizeSentences:function(a){function b(a,b){for(var c=[],d=a;b>=d;d++)f[d]&&(c=c.concat(f[d]));return c}function d(a){function d(a){var b=/[\t|\v|\f|\r]+/g;return b.lastIndex=0,a.replace(b," ")}function e(a,c,d){k=d.substring(a,c),k=k.trim(),k.length&&h.push({value:k,markuped:b(a,c)})}function f(a,b){this.position=a,this.offset=5,this.left=b.substr(this.position-5,5),this.right=b.substr(this.position+1,6),this.toString=this.left.concat(b.charAt(this.position),this.right)}function g(a,b,d){if(8233===a.charCodeAt(0)||10===a.charCodeAt(0))return e(i,b,d),void(i=j=b+1);var g=new f(b,d);/\d/g.test(g.left)||/[\n|\t|\v|\f|\r]+/g.test(g.left)||c.hasUppercaseLetter(g.left)||(g.position+1===d.length||c.startsWithSpaceAndUppercaseLetter(g.right))&&(e(i,g.position+1,d),i=j=g.position+1)}var h=[],i=0,j=0,k="",l=/[.!?\u2029\n](?=[\s\xA0]?)/gm;return l.lastIndex=0,a=a.trim(),a=d(a),a.replace(l,g),e(j,a.length,a),h}var e=a.resultText.source||a.resultText,f=a.problemsStartIndexes||{};return d(e)}},a.BasicCollector=d}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=function(a,b){this.name=a,this.sandbox=b,this.splitMainContainer=!0};b.prototype={constructor:b,getTokens:function(a){var b,c,a=a||this.sandbox.getTextContainer();return b=this.collectInfoFromNode(a),c=this.collectTokens(b)},collectInfoFromNode:function(a){return this.sandbox.collectInfoFromNode(a)},collectTokens:function(a){var b;return b=this.sandbox.tokenizeSentences(a.resultText),b=this.prepareTokens(b)},prepareTokens:function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push({value:a[c].value,markuped:[]});return b}},a.VirtualCollector=b}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=a.prototype.Utils,c=function(a,b){this.name=a,this.sandbox=b,this.type="Finder",this.strategy=null};c.prototype={constructor:c,init:function(){this.sandbox.subscribe("problemsFound",function(a){this.processFoundedProblems(a)},this)},processFoundedProblems:function(a){var b,c=this.sandbox.getOption("lang");return a.lang!==c?!1:(b=this.filterTokens(a.tokens,a.container,a.lang),b.length?void this.addDeferredFunction({problems:b,lang:a.lang,container:a.container,splittedMainContainer:a.splittedMainContainer}):!1)},filterTokens:function(a,b,c){for(var d=[],e=this.sandbox.getDictionary(),f=0;f<a.length;f++){var g=a[f],h=e.getTokenMatchesForMarkup(g,c);
(h.length||this.strategy.skipTokensFiltering)&&d.push({value:g.value,matches:h,container:b})}return d},addDeferredFunction:function(a){var c=this,d=this.strategy.saveSelection,e=b.createDeferredName("findProblemsForMarkupForLang",a.lang,a.container,a.splittedMainContainer);this.sandbox.addDeferredFunction(e,{delay:this.strategy.partialDelay,collection:a.problems,defferedFunctionArgs:[a.lang],partialItemsCount:this.strategy.partialItemsCount,inQueue:a.splittedMainContainer?!0:!1,deferredFunction:function(a,b){var e,f,g=c.sandbox.isFocused();d&&g&&(e=c.sandbox.saveSelection()),f=c.strategy.findProblemsForMarkup({problems:a}),c.sandbox.fire("markupProblems",{problems:f,lang:b}),c.sandbox.restoreSelection(e)}})},setStrategy:function(a){this.strategy=a}},a.ProblemFinder=c}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=function(a,b){this.name=a,this.sandbox=b,this.saveSelection=!0,this.partialDelay=100,this.partialItemsCount=1,this.skipTokensFiltering=!1};b.prototype={constructor:b,findProblemsForMarkup:function(a){return this.getDataForMarkup(a.problems)},getDataForMarkup:function(a){var b=this.createFinder(),c=this.sandbox.getOption("container"),d={addMarkup:[],removeMarkup:[]};b.collectBlockInfo(c);for(var e=0;e<a.length;e++)if(a[e].value.length)for(b.lastIndex=0;null!==b.findProblems(a[e]);)d.addMarkup=d.addMarkup.concat(b.problems.addMarkup),d.removeMarkup=d.removeMarkup.concat(b.problems.removeMarkup);return d.addMarkup.reverse(),d},createFinder:function(){var a=function(a){this.newParts={getPos:function(a){for(;!this[a];)a--;return this[a]}},this.foundedProblems={storage:{},getPreviousProblemsCount:function(a){for(;!this.storage[a]&&a>0;)a--;return this.storage[a]&&this.storage[a].problemsCount||0},getElementIfMarkuped:function(b,c){var d,e,f,g,h,i,j=this.storage[b];return j?(d=j.info.type,e=j.element.getAttribute(a.getOption(j.info.attrName)),f=j.element.getAttribute(a.getOption(j.info.attrRuleName)),g=c.type===d,h=c.value===e,i=c.rule&&c.rule!==f?!1:!0,g&&h&&i?this.storage[b].element:null):null},getFoundedProblemsInRange:function(a,b){var c,d={};for(var e in this.storage)this.storage.hasOwnProperty(e)&&(c=Number(e),a>c||c>b||(d[e]=this.storage[e]));return d}},this.resultText="",this.lastIndex=0,this.problemRange=null,this.collectBlockInfo=function(b){function c(a,b,c){if(a!==b){var d={node:c.el,start:i.resultText.length,end:i.resultText.length+b-a,offset:a};i.newParts[d.start]=d,i.newParts[d.end]=d,i.resultText+=0==c.editable?c.el.nodeValue.replace(/./g," ").substring(a,b):c.el.nodeValue.substring(a,b)}}function d(a,b,c){var d,e;i.foundedProblems.previous=i.foundedProblems.previous||0,d=i.foundedProblems.previous,e=i.foundedProblems.storage[d]&&i.foundedProblems.storage[d].problemsCount||0,i.foundedProblems.storage[c]={element:a,info:b,problemsCount:e+1},i.foundedProblems.previous=c}for(var e,f,g=[{el:b,editable:b.isContentEditable}],h=g.shift(),i=this,j=a.getRegExp("ignoreElementsRegex"),k=a.getRegExp("ieSeparator"),l=new RegExp("(^|\\s)rangySelectionBoundary(\\s|$)"),m=a.getRegExp("sentenceEndCharsGrammar"),n=a.getRegExp("nonWhiteSpaceExtended"),o=a.getRegExp("specialCharacters").set().onePlus(),p=0,q="",r=[];h;){switch(h.el.nodeType){case 3:h.el.length&&(p=h.indexOffset||0,q=h.el.nodeValue,r=o.match(q.substring(p)),r?(c(p,p+r.index,h),h.indexOffset=p+r.index+r[0].length,g.splice(0,0,h)):(c(p,q.length,h),h.emptyCharsCountInPart=0));break;case 1:if(l.test(a.UILib.attr(h.el,"className")))break;if(j.test(h.el.nodeName))break;if(a.isIgnoredByClass(h.el))break;if(a.isIgnoredByAttribute(h.el))break;f=a.getNodeInfo(h.el),f&&h.el.innerHTML&&d(h.el,f,this.resultText.length),e=h.el.hasAttribute("contenteditable")?h.el.isContentEditable:h.editable;for(var s=0;s<h.el.childNodes.length;s++)g.splice(s,0,{el:h.el.childNodes[s],editable:e});a.isBlockElement(h.el)&&(g.length>h.el.childNodes.length&&g.splice(s,0,{el:document.createTextNode("\u2029"),editable:!0}),this.resultText.length>0&&-1===m.search(this.resultText)&&-1!==n.search(this.resultText)?g.splice(0,0,{el:document.createTextNode("\u2029"),editable:!0}):this.resultText.length>0&&" "!=this.resultText[this.resultText.length-1]&&g.splice(0,0,{el:document.createTextNode(" "),editable:!0}))}h=g.shift()}this.resultText=k.replace(this.resultText," ")},this.findProblems=function(b){var c,d,e=b.value,f=this.resultText.indexOf(e,this.lastIndex),g=/[.!?\u2029\n][\s\xA0]*$/g,h=/^[\s\xA0]*(?=[\u2029\n]+)/g,i=a.getRegExp("nonWhiteSpaceExtended"),j=a.Utils,k=!1,l=!1,m={addMarkup:[],removeMarkup:[]},n=a.getOption("data_id_attribute"),o=a.getOption("data_lang_attribute");if(f>0)this.lastIndex=f+e.length,c=this.resultText.substring(0,f),d=this.resultText.substring(this.lastIndex),(g.test(c)||-1===i.search(c))&&(k=!0),(this.lastIndex===this.resultText.length||h.test(d)||-1===i.search(d)||j.startsWithSpaceAndUppercaseLetter(d))&&(l=!0),f=k&&l?f:"skipped";else{if(0!==f)return null;this.lastIndex=f+e.length,d=this.resultText.substring(this.lastIndex),(h.test(d)||-1===i.search(d)||j.startsWithSpaceAndUppercaseLetter(d))&&(l=!0),f=l?f:"skipped"}if("skipped"==f)return this.findProblems.call(this,b);for(var p=this.foundedProblems.getFoundedProblemsInRange(f,this.lastIndex),q=0;q<b.matches.length;q++){var r,s=a.createRange(),t=b.matches[q],u={},v=this.newParts.getPos(f+t.offset),w=this.newParts.getPos(f+t.offset+t.length-1);r=this.foundedProblems.getElementIfMarkuped(v.start,t),r?(delete p[v.start],u.id=r.getAttribute(n),u.lang=r.getAttribute(o),this.bindProblemWithToken(t,e,u)):(s.setStart(v.node,f+t.offset-v.start+v.offset),s.setEnd(w.node,f+t.offset+t.length-w.start+w.offset),s=this.fixRangeBoundaryPoints(s),m.addMarkup.push({range:s,text:t.value,rule:t.rule,problemType:t.type,index:this.foundedProblems.getPreviousProblemsCount(f+t.offset),match:t,context:e}))}return m.removeMarkup=this.getProblemsToRemove(p),this.problems=m,this.problems},this.bindProblemWithToken=function(b,c,d){a.fire("bindProblemWithToken",{id:d.id,lang:d.lang,match:b,context:c})},this.fixRangeBoundaryPoints=function(a){var b={startNode:a.startContainer(),endNode:a.endContainer(),startOffset:a.startOffset(),endOffset:a.endOffset()};if(b.startNode.parentNode!=b.endNode.parentNode){var c=a.commonAncestorContainer(),d=b.startNode;if(0===b.startOffset){for(;d.parentNode!=c&&d.parentNode.firstChild==d;)d=d.parentNode;b.startBeforeNode=d}if(b.startNode=d,d=b.endNode,d.length==b.endOffset){for(;d.parentNode!=c&&d.parentNode.lastChild==d;)d=d.parentNode;b.endAfterNode=d}}return a.setStart(b.startNode,b.startOffset),a.setEnd(b.endNode,b.endOffset),b.startBeforeNode&&a.setStartBefore(b.startBeforeNode),b.endAfterNode&&a.setEndAfter(b.endAfterNode),a},this.getProblemsToRemove=function(b){var c=[];for(var d in b)b.hasOwnProperty(d)&&c.push({id:b[d].element.getAttribute(a.getOption(b[d].info.attrId)),attrName:a.getOption(b[d].info.attrId),nodeName:a.getOption(b[d].info.nodeName)});return c}};return new a(this.sandbox)}},a.BasicFinder=b}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=a.prototype.Utils,c=a.prototype.CharCodeUtils,d=function(a,b){this.name=a,this.sandbox=b,this.partialDelay=20,this.partialItemsCount=1,this.skipTokensFiltering=!0};d.prototype={constructor:d,findProblemsForMarkup:function(a){for(var b,c,d,e,f={addMarkup:[],removeMarkup:[]},g=0;g<a.problems.length;g++)if(b=this.getContainerData(a.problems[g].container),b&&(c=this.getRawDataForMarkup({problem:a.problems[g],tokens:b.tokens,resultText:b.info.resultText,foundedProblems:b.info.foundedProblems,maskText:b.info.maskText}))){for(var h=0;h<c.addMarkup.length;h++)d=c.addMarkup[h],e=this.createRange(b.info.customModel,d.start,d.end),f.addMarkup.push({range:e,text:d.text,rule:d.rule||"",problemType:d.type,match:d.match,context:d.context});f.removeMarkup=f.removeMarkup.concat(c.removeMarkup)}return f},getContainerData:function(a){var b,c,d=this.sandbox.getTextContainer();return a&&!d.contains(a)?null:(a=a||d,b=this.sandbox.collectInfoFromNode(a,{fullInfo:!0,markTextNodes:!0}),c=this.sandbox.tokenizeSentences(b.resultText),c?{tokens:c,info:b}:null)},getRawDataForMarkup:function(a){var b=a.problem,c=a.tokens,d="value_"+b.value;return c.hasOwnProperty(d)?this.processCase(c[d],b,a.resultText,a.foundedProblems,a.maskText):null},processCase:function(a,b,c,d,e){for(var f,g,h,i,j,k,l,m,n={addMarkup:[],removeMarkup:[]},o={},p=0;p<a.positions.length;p++){f=a.positions[p],g=this.getFoundedProblemsInRange(d,f.start,f.end);for(var q=0;q<b.matches.length;q++){h=b.matches[q],i=this.getMatchBoundaryPoints({value:a.value,start:f.start,end:f.end},h,c),j=i.start,k=i.end,l=g[j],m=!1;for(var r=j;k>=r;r++)"0"!==e[r]?g.hasOwnProperty(r)&&g[r].label&&(g[r].remove=!0):m=!0;m||(l&&this.isEqualProblems(h,l)?(delete g[j],o.id=l.id,o.lang=this.sandbox.getOption("lang"),this.bindProblemWithToken(h,b.value,o)):n.addMarkup.push({start:j,end:k,text:h.value,rule:h.rule,type:h.type,match:h,context:b.value}))}}return n.removeMarkup=this.getProblemsToRemove(g),n},getFoundedProblemsInRange:function(a,b,c){var d,e={};for(var f in a)a.hasOwnProperty(f)&&(d=Number(f),b>d||d>c||(e[f]=a[f]));return e},getMatchBoundaryPoints:function(a,b,c){var d,e,f={start:a.start+b.offset,end:a.start+b.offset+b.length-1};if(a.end-a.start+1===a.value.length)return f;for(d=e=a.start;d!==f.start+1;)this.isSpecialCharacter(c[e])||d++,e++;for(f.start=e-1,d=e=f.start;d!==f.start+b.length;)this.isSpecialCharacter(c[e])||d++,e++;return f.end=e-1,f},isSpecialCharacter:function(a){return c.isSpecialCharacter(a.charCodeAt(0))},isEqualProblems:function(a,b){var c=a.type===b.type,d=a.value===b.text,e=a.rule&&a.rule!==b.rule?!1:!0;return c&&d&&e},bindProblemWithToken:function(a,b,c){this.sandbox.fire("bindProblemWithToken",{id:c.id,lang:c.lang,match:a,context:b})},getProblemsToRemove:function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&(!a[c].label||a[c].remove)&&b.push(a[c]);return b},createRange:function(a,c,d){var e=b.getCurrentDocument(this.sandbox.getOption("documentContainer")),f=e.createRange(),g=b.getRangeBoundaryPoints(a,c,d);return f.setStart(g.startContainer,g.startOffset),f.setEnd(g.endContainer,g.endOffset),f}},a.VirtualFinder=d}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=function(a,b){this.name=a,this.sandbox=b,this.type="Markuper",this.strategy=null};b.prototype={constructor:b,init:function(){this.sandbox.subscribe("markupProblems",function(a){this.markupProblems(a)},this),this.sandbox.subscribe("removeMarkup",function(a){this.removeMarkup(a)},this),this.sandbox.subscribe("removeMarkupInSelectionNode",function(a){this.removeMarkupInSelectionNode(a)},this),this.sandbox.subscribe("removeMarkupInDocument",function(a){this.removeMarkupInDocument(a)},this),this.sandbox.subscribe("removeMarkupFromProblems",function(a){this.removeMarkupFromProblems(a)},this),this.sandbox.subscribe("removeMarkupAfterKeydown",function(a){this.removeMarkupAfterKeydown(a)},this),this.sandbox.subscribe("removeMarkupForRules",function(a){this.removeMarkupForRules(a)},this)},markupProblems:function(a){this.sandbox.fireInAllApps("lockMutationsListener",{lock:!0}),this.strategy.markupProblems(a),this.sandbox.fireInAllApps("lockMutationsListener",{lock:!1})},removeMarkup:function(a){this.sandbox.fireInAllApps("lockMutationsListener",{lock:!0}),this.strategy.removeMarkup(a.nodes),this.sandbox.fireInAllApps("lockMutationsListener",{lock:!1})},removeMarkupInSelectionNode:function(a){this.sandbox.fireInAllApps("lockMutationsListener",{lock:!0}),this.strategy.removeMarkupInSelectionNode(a),this.sandbox.fireInAllApps("lockMutationsListener",{lock:!1})},removeMarkupInDocument:function(a){this.sandbox.fireInAllApps("lockMutationsListener",{lock:!0}),this.strategy.removeMarkupInDocument(a),this.sandbox.fireInAllApps("lockMutationsListener",{lock:!1})},removeMarkupFromProblems:function(a){this.sandbox.fireInAllApps("lockMutationsListener",{lock:!0}),this.strategy.removeMarkupFromProblems(a),this.sandbox.fireInAllApps("lockMutationsListener",{lock:!1})},removeMarkupAfterKeydown:function(a){this.sandbox.fireInAllApps("lockMutationsListener",{lock:!0}),this.strategy.removeMarkupAfterKeydown(a),this.sandbox.fireInAllApps("lockMutationsListener",{lock:!1})},removeMarkupForRules:function(a){this.sandbox.fireInAllApps("lockMutationsListener",{lock:!0}),this.strategy.removeMarkupForRules(a),this.sandbox.fireInAllApps("lockMutationsListener",{lock:!1})},setStrategy:function(a){this.strategy=a}},a.ProblemMarkuper=b}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=a.prototype.UILib,c=a.prototype.Utils,d=function(a,b){this.name=a,this.sandbox=b,this.problemTypes=b.getProblemTypes()};d.prototype={constructor:d,markupProblems:function(a){for(var b=c.getCurrentDocument(this.sandbox.getOption("documentContainer")),d=0;d<a.problems.addMarkup.length;d++){var e=a.problems.addMarkup[d],f=this.problemTypes[e.problemType];this.isNoNeedToMarkup(e,f)||(e.id=c.getUniqueId(),this.markupProblem({document:b,problemTypesItem:f,lang:a.lang,markupFor:e}),this.bindProblemWithToken(e.match,e.context,e.id,a.lang))}this.removeExtraMarkup(a.problems.removeMarkup)},isNoNeedToMarkup:function(a,d){var e,f,g,h=this.sandbox.getOption(d.attrName),i=this.sandbox.getOption(d.nodeName);return d?(e=a.range.commonAncestorContainer(),f=c.isEqualNode(e,h)?[e]:b.findNodeParents(e,i,h),g=this.sandbox.cleanSpecialAndHtmlSpaceCharacters(a.range.toString({"native":!0})),f.length?!0:g!==a.text?!0:!1):!0},markupProblem:function(a){a.text=this.prepareText(a.markupFor.range),a.element=this.createProblemElement(a),this.appendProblemElement(a.element,a.markupFor.range),this.fireMarkupedNode(a),this.removeChildProblemNodes(a)},prepareText:function(a){var b=this.sandbox.cleanSpecialAndHtmlSpaceCharacters(a.toString());return b},createProblemElement:function(a){var c=a.document.createElement(this.sandbox.getOption(a.problemTypesItem.nodeName));return b.addClass(c,this.sandbox.getOption(a.problemTypesItem.classOption)),c.setAttribute(this.sandbox.getOption(a.problemTypesItem.attrName),a.text),c.setAttribute(this.sandbox.getOption(a.problemTypesItem.attrLang),a.lang),c.setAttribute(this.sandbox.getOption(a.problemTypesItem.attrId),a.markupFor.id),a.markupFor.rule&&c.setAttribute(this.sandbox.getOption(a.problemTypesItem.attrRuleName),a.markupFor.rule),c},appendProblemElement:function(a,b){a.appendChild(b.extractContents()),b.insertNode(a)},fireMarkupedNode:function(a){var b={};b.node=a.element,b.index=a.markupFor.index,this.sandbox.fire("markupedNode",b)},removeChildProblemNodes:function(a){for(var c,d=this.sandbox.getOption(a.problemTypesItem.attrName),e=this.sandbox.getOption(a.problemTypesItem.nodeName),f=b.findNodeChildren(a.element,e,d);f.length>0;)c=f.shift(),this.removeMarkup(c)},bindProblemWithToken:function(a,b,c,d){this.sandbox.fire("bindProblemWithToken",{id:c,lang:d,match:a,context:b})},removeExtraMarkup:function(a){for(var c,d=this.sandbox.getOption("container"),e=[],f=0;f<a.length;f++)c=a[f],e=e.concat(b.query(d,c.nodeName+"["+c.attrName+'="'+c.id+'"]'));this.removeMarkup(e)},removeMarkup:function(a){var b,c,d,e,f=this.sandbox.isFocused(),a=[].concat(a);for(f&&a.length>0&&(b=this.sandbox.saveSelection());a.length>0;)c=a.shift(),c.innerHTML?(d=this.sandbox.createRange(),d.selectNodeContents(c),e=d.extractContents(),d.selectNode(c),d.deleteContents(),d.insertNode(e),this.sandbox.fire("removedMarkupInContainer",{node:d.commonAncestorContainer(),removedNodes:[c]})):this.sandbox.UILib.remove(c);this.sandbox.restoreSelection(b)},removeMarkupInSelectionNode:function(a){var a=a||{},b=this.sandbox.getOption("container"),c=[];a.problemTypes=this.problemTypes;for(var d in e)c.push.apply(c,e[d].getProblemNodesToRemove(a,this.sandbox));a.forceBookmark&&!this.sandbox.getOption("focused")&&c.length>0&&this.sandbox.fire({eventType:"focus",element:b}),this.removeMarkup(c)},removeMarkupInDocument:function(){var a,b=[];for(var c in this.problemTypes)a=this.problemTypes[c],b.push.apply(b,this.getProblemNodesByType(a));this.removeMarkup(b)},getProblemNodesByType:function(a){var c=this.sandbox.getOption("container"),d=this.sandbox.getOption(a.nodeName),e=this.sandbox.getOption(a.attrName);return b.query(c,d+"["+e+"]")},removeMarkupFromProblems:function(a){for(var b=[],c=this.problemTypes[a.problemType],d=0;d<a.problems.length;d++){var e=a.problems[d];b.push.apply(b,this.getProblemNodesByTypeAndText(c,e.value))}this.removeMarkup(b)},getProblemNodesByTypeAndText:function(a,c){var d=this.sandbox.getOption("container"),e=this.sandbox.getOption(a.nodeName),f=this.sandbox.getOption(a.attrName);return b.query(d,e+"["+f+'="'+c+'"]')},removeMarkupAfterKeydown:function(a){var b=[];a.problemTypes=this.problemTypes;for(var c in e)b.push.apply(b,e[c].getProblemNodesAfterKeydown(a,this.sandbox));this.removeMarkup(b)},removeMarkupForRules:function(a){var b=this.getProblemNodesByType(this.problemTypes.grammar);b=this.filterProblemNodesByRules(b,a.rules),this.removeMarkup(b)},filterProblemNodesByRules:function(a,d){for(var e,f,g=this.sandbox.getOption(this.problemTypes.grammar.attrRuleName),h=[],i=0;i<a.length;i++)e=a[i],f=b.attr(e,g),d.hasOwnProperty(f)&&h.push(e);return h=c.ArrayUtils.arrayUnique(h)}};var e={spelling:{getProblemNodesToRemove:function(a,b){var c,a=a||{},d=b.getSelection(),e=b.getOption("container"),f=[];return a.grammarOnly?f:(a.selectionNode?e.contains(a.selectionNode)&&(c=b.createRange(),c.selectNode(a.selectionNode),f=c.getNodes()):d.rangeCount()>0&&(c=d.getRangeAt(0),f=b.getNeighbourProblemNodes({leftStartNode:c.startContainer(),leftStartOffset:c.startOffset(),rightStartNode:c.endContainer(),rightStartOffset:c.endOffset(),attrName:a.problemTypes.spelling.attrName,nodeName:a.problemTypes.spelling.nodeName,wordBased:a.problemTypes.spelling.wordBased}),a.removeInside&&(f=f.concat(c.getNodes()))),f=this.filterProblemNodes({nodes:f,problemAttrName:a.problemTypes.spelling.attrName,problemNodeName:a.problemTypes.spelling.nodeName},b))},filterProblemNodes:function(a,b){var d=b.getOption(a.problemAttrName),e=[];return e=a.nodes.filter(function(a){return c.isEqualNode(a,d)}),e=c.ArrayUtils.arrayUnique(e)},getProblemNodesAfterKeydown:function(a,b){var c=a.event.keyCode,d=[13,32],e=[];if(d.includes(c)&&b.isCaretInEndOfMisspelledWord()){var f=this.getSpellingNodeIfCaretInEndOfIt(b),g=f?b.isNodeContentBroken(f,b.getOption(a.problemTypes.spelling.attrName)):!1;g?e=this.getProblemNodesToRemove(a,b):f&&this.moveCaretFromSpellingNode(f,b)}else e=this.getProblemNodesToRemove(a,b);return e},getSpellingNodeIfCaretInEndOfIt:function(a){var b,c=a.getSpellingNodeFromSelection(),d=a.getSelection(),e=d.getRangeAt(0).endContainer().childNodes;return!c&&e.length&&(b=e[d.getRangeAt(0).startOffset()-1],c=b&&1===b.nodeType?b:null),c},moveCaretFromSpellingNode:function(a,b){var c,d,e,f=b.getSelection();c=a.parentNode,d=b.createRange(),e=document.createTextNode("â€Œ"),c.insertBefore(e,a.nextSibling),d.setStartAfter(e),d.collapse(!0),f.removeAllRanges(),f.addRange(d),setTimeout(function(){var a=b.saveSelection();e.nodeValue=e.nodeValue.replace(/\u200C/,""),b.restoreSelection(a)},0)}},grammar:{getProblemNodesToRemove:function(a,b){var c,a=a||{},d=b.getSelection(),e=b.getOption("container"),f=b.getOption("enableGrammar"),g=[],h=[];return f?(a.selectionNode?e.contains(a.selectionNode)&&(c=b.createRange(),c.selectNode(a.selectionNode),g=c.getNodes(),h=g):d.rangeCount()>0&&(c=d.getRangeAt(0),g=b.getNeighbourProblemNodes({leftStartNode:c.startContainer(),leftStartOffset:c.startOffset(),rightStartNode:c.endContainer(),rightStartOffset:c.endOffset(),attrName:a.problemTypes.grammar.attrName,nodeName:a.problemTypes.grammar.nodeName,wordBased:a.problemTypes.grammar.wordBased}),h=c.getNodes(),h=g.concat(h),a.removeInside&&(g=h)),g=this.filterProblemNodes({nodes:g,problemAttrName:a.problemTypes.grammar.attrName,problemNodeName:a.problemTypes.grammar.nodeName},b),h=this.filterProblemNodes({nodes:h,problemAttrName:a.problemTypes.grammar.attrName,problemNodeName:a.problemTypes.grammar.nodeName},b),g):g},filterProblemNodes:function(a,d){var e=d.getOption(a.problemAttrName),f=d.getOption(a.problemNodeName),g=[];return g=a.nodes.filter(function(a){return c.isEqualNode(a,e)}),0===g.length&&(g=b.findNodeParents(a.nodes[0],f,e)),g=c.ArrayUtils.arrayUnique(g)},getProblemNodesAfterKeydown:function(a,b){return this.getProblemNodesToRemove(a,b)}}};a.BasicMarkuper=d}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=a.prototype.Utils,c=function(a,b){this.name=a,this.sandbox=b,this.problemTypes=b.getProblemTypes(),this.parentBlockIndex=0,this.virtualProblemManager=b.getVirtualProblemManager()};c.prototype={constructor:c,markupProblems:function(a){for(var c=this.sandbox.getTextContainer(),d=0;d<a.problems.addMarkup.length;d++){var e,f=a.problems.addMarkup[d],g=this.problemTypes[f.problemType];this.isNoNeedToMarkup(f,g)||(f.parentBlock=this.getParentBlockElement(f.range.startContainer,c),e=this.virtualProblemManager.getProblemIfAdded(f),e?(f.id=e.id,this.bindProblemWithToken(f.match,f.context,f.id,a.lang)):(f.id=b.getUniqueId(),this.virtualProblemManager.addProblem({range:f.range,problemTypesItem:g,text:f.text,type:f.problemType,rule:f.rule||"",lang:a.lang,id:f.id,parentBlock:f.parentBlock,label:f.label||!1}),this.bindProblemWithToken(f.match,f.context,f.id,a.lang)))}this.removeExtraMarkup(a.problems.removeMarkup)},isNoNeedToMarkup:function(a,b){var c;return b?(c=this.sandbox.cleanSpecialAndHtmlSpaceCharacters(a.range.toString()),c!==a.text?!0:!1):!0},getParentBlockElement:function(a,b){var c=this.sandbox.getParentBlockElement(a,b),d=this.sandbox.getOption("parentBlockPrefix");return void 0===c[d]&&(c[d]=this.parentBlockIndex++),c},bindProblemWithToken:function(a,b,c,d){this.sandbox.fire("bindProblemWithToken",{id:c,lang:d,match:a,context:b})},removeExtraMarkup:function(a){for(var b=0;b<a.length;b++){var c=a[b];this.virtualProblemManager.removeProblemById({id:c.id,text:c.text})}},removeMarkup:function(){},removeMarkupInSelectionNode:function(){},removeMarkupInDocument:function(){this.virtualProblemManager.clear()},removeMarkupFromProblems:function(a){for(var b=0;b<a.problems.length;b++){var c=a.problems[b];this.virtualProblemManager.removeProblemsByText({text:c.value,problemType:a.problemType})}},removeMarkupAfterKeydown:function(a){var b,c,d,e=this.sandbox.getWindow().getSelection(),f=this.sandbox.getTextContainer(),g=[];if(e.rangeCount){b=e.getRangeAt(0),c=this.sandbox.getNearestNotEmptyTextNode({startContainer:b.startContainer,startOffset:b.startOffset,direction:!1,stopContainer:f}),c.problems=this.virtualProblemManager.getProblemsByTextNode(c),d=this.sandbox.getNearestNotEmptyTextNode({startContainer:b.endContainer,startOffset:b.endOffset,direction:!0,stopContainer:f}),d.problems=this.virtualProblemManager.getProblemsByTextNode(d),g=this.getProblemsAfterKeydown({leftDirectionData:c,rightDirectionData:d,range:b,keyCode:a.event.keyCode});for(var h=0;h<g.length;h++)g[h].elements[0].removeLater=!0}},getProblemsAfterKeydown:function(a){var b=[];return b=b.concat(this.getProblemsToRemove(a,"left")),b=b.concat(this.getProblemsToRemove(a,"right"))},getProblemsToRemove:function(a,b){var c,d=[],e=this.sandbox.getRegExp("nonWhiteSpaceExtended"),f=this.sandbox.getRegExp("wordBoundaryRegex"),g=this.getDirectionData(a,b),h=this.isDeleteTextOrAndroidBugKeyCode(a.keyCode,b),i=this.getClosestData(g,b);if(i.otherSideProblem&&d.push(i.otherSideProblem),i.problem){if(c=this.getText(g,i,b),!c.length||i.removeProblem)return d.push(i.problem),d;h&&1===c.length&&(!e.test(c)||f.test(c))&&d.push(i.problem)}return d},getDirectionData:function(a,b){return"left"===b?a.leftDirectionData:a.rightDirectionData},isDeleteTextOrAndroidBugKeyCode:function(a,b){var c="left"===b?8:46;return a===c||0===a||229===a},getText:function(a,b,c){var d=a.node.nodeValue,e=a.offset,f=b.problem.range,g="left"===c?f.endOffset:e,h="left"===c?e:f.startOffset;return d=d.substring(g,h)},getClosestData:function(a,b){for(var c,d={problem:null,otherSideProblem:null,removeProblem:!1},e=0;e<a.problems.length;e++)if(c=a.problems[e],d.otherSideProblem||!this.isOtherSideProblem(a,c,b)){if(!d.removeProblem){if(this.isBackToBackProblem(a,c,b)){d.problem=c,d.removeProblem=!0;continue}if(this.isProblemOutOfRange(a,c,b))continue;if(this.isCursorInsideProblem(a,c)){d.problem=c,d.removeProblem=!0;continue}d.problem||(d.problem=c),this.isCloserProblem(c,d.problem,b)&&(d.problem=c)}if(d.otherSideProblem&&d.removeProblem)break}else d.otherSideProblem=c;return d},isOtherSideProblem:function(a,b,c){var d=this.isSameBackContainer(a,b,c),e=this.isSameBackOffset(a,b,c);return d&&e},isSameBackContainer:function(a,b,c){var d=this.isSameStartContainer(a,b),e=this.isSameEndContainer(a,b),f="left"===c?d:e;return f},isSameStartContainer:function(a,b){return b.range.startContainer===a.node},isSameEndContainer:function(a,b){return b.range.endContainer===a.node},isSameBackOffset:function(a,b,c){var d=this.isSameStartOffset(a,b),e=this.isSameEndOffset(a,b),f="left"===c?d:e;return f},isSameStartOffset:function(a,b){return b.range.startOffset===a.offset},isSameEndOffset:function(a,b){return b.range.endOffset===a.offset},isBackToBackProblem:function(a,b,c){return"left"===c?this.isCursorAtEndOfProblem(a,b):this.isCursorAtStartOfProblem(a,b)},isCursorAtEndOfProblem:function(a,b){var c=this.isSameEndContainer(a,b),d=b.range.endOffset===a.offset;return c&&d},isCursorAtStartOfProblem:function(a,b){var c=this.isSameStartContainer(a,b),d=b.range.startOffset===a.offset;return c&&d},isProblemOutOfRange:function(a,b,c){return"left"===c?this.isProblemAfterCursor(a,b):this.isProblemBeforeCursor(a,b)},isProblemAfterCursor:function(a,b){var c=this.isSameStartContainer(a,b),d=b.range.startOffset>a.offset;return c&&d},isProblemBeforeCursor:function(a,b){var c=this.isSameEndContainer(a,b),d=b.range.endOffset<a.offset;return c&&d},isCursorInsideProblem:function(a,b){var c=this.isSameStartContainer(a,b),d=this.isSameEndContainer(a,b),e=a.offset,f=b.range.startOffset<e,g=b.range.endOffset>e;return c&&d&&f&&g?!0:!c&&d&&g?!0:c&&!d&&f?!0:!1},isCloserProblem:function(a,b,c){return"left"===c?b.range.endOffset<a.range.endOffset:b.range.startOffset>a.range.startOffset},removeMarkupForRules:function(a){this.virtualProblemManager.removeProblemsByRules(a)}},a.VirtualMarkuper=c}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=a.prototype.Utils,c=function(a,b){this.name=a,this.sandbox=b,this.type="Processor",this.strategy=null};c.prototype={constructor:c,init:function(){this.sandbox.subscribe("replaceProblem",function(a){this.replaceProblem(a)},this),this.sandbox.subscribe("ignoreProblem",function(a){this.ignoreProblem(a)},this),this.sandbox.subscribe("ignoreAllProblems",function(a){this.ignoreAllProblems(a)},this),this.sandbox.subscribe("changeStateForIgnoredProblems",function(a){this.changeStateForIgnoredProblems(a)},this),this.sandbox.subscribe("disableRule",function(a){this.disableRule(a)},this),this.sandbox.subscribe("changeStateForProblemsWithDisabledRules",function(a){this.changeStateForProblemsWithDisabledRules(a)},this),this.sandbox.subscribe("changeStateForProblemsWithEnabledRules",function(a){this.changeStateForProblemsWithEnabledRules(a)},this),this.sandbox.subscribe("replaceText",function(a){this.replaceText(a)},this)},replaceProblem:function(a){this.strategy.replaceProblem(a)},ignoreProblem:function(a){this.sandbox.fireInAllApps("lockMutationsListener",{lock:!0}),this.strategy.ignoreProblem(a),this.sandbox.fireInAllApps("lockMutationsListener",{lock:!1})},ignoreAllProblems:function(a){this.strategy.ignoreAllProblems(a)},changeStateForIgnoredProblems:function(a){this.sandbox.fireInAllApps("lockMutationsListener",{lock:!0}),this.strategy.changeStateForIgnoredProblems(a),this.sandbox.fireInAllApps("lockMutationsListener",{lock:!1})},disableRule:function(a){this.strategy.disableRule(a)},changeStateForProblemsWithDisabledRules:function(a){var c=b.arrayToObject(a.rules);this.sandbox.fireInAllApps("lockMutationsListener",{lock:!0}),this.sandbox.fire("removeMarkupForRules",{rules:c}),this.sandbox.fire("resetDisabledRuleStatusForProblems",{disabledRules:c}),this.sandbox.fireInAllApps("lockMutationsListener",{lock:!1})},changeStateForProblemsWithEnabledRules:function(a){var c=b.arrayToObject(a.rules);this.sandbox.fireInAllApps("lockMutationsListener",{lock:!0}),this.sandbox.fire("resetDisabledRuleStatusForProblems",{enabledRules:c}),this.sandbox.fireInAllApps("lockMutationsListener",{lock:!1})},replaceText:function(a){this.strategy.replaceText(a)},setStrategy:function(a){this.strategy=a}},a.ProblemProcessor=c}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=a.prototype.UILib,c=function(a,b){this.name=a,this.sandbox=b,this.problemTypes=b.getProblemTypes()};c.prototype={constructor:c,replaceProblem:function(a){var b=this.sandbox.getOption("container"),c=a.node,d=a.text;c=c?c:this.sandbox.getProblemNodeFromSelection(a.problemType),c&&b.contains(c)&&(this.replaceProblemWithText({node:c,text:d,problemType:a.problemType}),this.sandbox.fire("sendStatistics",{action:"replace",node:c,newText:d,problemType:a.problemType}))},replaceProblemWithText:function(a){var b,c,d=this.sandbox.getChildProblemNodes(a.node),e=this.sandbox.getParentProblemNodes(a.node);a.node.innerHTML=a.text,this.setSelection(a.node,a.problemType),c=this.sandbox.saveSelection(),b=this.replaceNodeAndReturnRange(a.node),this.fireExtraEventsAfterReplace(b.commonAncestorContainer(),a.node,d,e),this.sandbox.restoreSelection(c)},setSelection:function(a,b){var c=this.sandbox.createRange(),d=this.sandbox.getSelection();c.selectNodeContents(a),c.collapse(!1),this.sandbox.getProblemNodeFromSelection(b)===a&&(d.removeAllRanges(),d.addRange(c))},replaceNodeAndReturnRange:function(a){var b,c=this.sandbox.createRange();return c.selectNode(a),b=c.createContextualFragment(a.innerHTML),c.deleteContents(),c.insertNode(b),c},fireExtraEventsAfterReplace:function(a,b,c,d){this.sandbox.fire("removedMarkupInContainer",{ancestorContainer:a,textChanged:!0,removedNodes:[b].concat(c)}),this.sandbox.fire("removeMarkup",{nodes:d})},ignoreProblem:function(a){var c=this.sandbox.getOption("container"),d=this.problemTypes[a.problemType],e=this.sandbox.getOption(d.ignoredClass),f=a.node;f=f?f:this.sandbox.getProblemNodeFromSelection(a.problemType),f&&c.contains(f)&&(b.addClass(f,e),this.sandbox.fire("sendStatistics",{action:"ignore",node:f}))},ignoreProblems:function(a){var b,c,d,e,f=this.sandbox.createRange(),g=this.sandbox.isFocused();for(g&&a.nodes.length>0&&(b=this.sandbox.saveSelection());a.nodes.length>0;)c=a.nodes.shift(),d=c.getAttribute(this.sandbox.getOption(a.problemTypesItem.attrName)),f.selectNodeContents(c),e=f.extractContents(),f.selectNode(c),f.deleteContents(),f.insertNode(e),this.sandbox.fire("removedMarkupInContainer",{ancestorContainer:f.commonAncestorContainer(),removedNodes:[c],problemType:a.problemTypesItem.type,text:d});this.sandbox.restoreSelection(b)},getDataFromNode:function(a,b){return{text:a.getAttribute(this.sandbox.getOption(b.attrName)).replace(/"/g,'\\"'),rule:a.getAttribute(this.sandbox.getOption(b.attrRuleName)),problemType:b.type}},setIgnoreStatus:function(a){var b=this.getProblemFromDictionary(a.text,a.rule,a.problemType);b&&this.setIgnoreStatusForProblem(b)},getProblemFromDictionary:function(a,b,c){var d=this.sandbox.getDictionary(),e=this.sandbox.getOption("lang"),f=d.getProblem({value:a,rule:b,type:c},e);return f},setIgnoreStatusForProblem:function(a){a.setUserIgnoreStatus()},ignoreAllProblems:function(a){var b,c=this.sandbox.getOption("container"),d=this.problemTypes[a.problemType],e=a.node;e=e?e:this.sandbox.getProblemNodeFromSelection(a.problemType),e&&c.contains(e)&&(b=this.getDataFromNode(e,d),this.sandbox.fire("sendStatistics",{action:"ignore",node:e}),this.sandbox.fireInAllApps("changeStateForIgnoredProblems",b))},changeStateForIgnoredProblems:function(a){var b=this.getAllSameProblemNodes(a),c=this.problemTypes[a.problemType];this.ignoreProblems({nodes:b,problemTypesItem:c}),this.setIgnoreStatus(a)},getAllSameProblemNodes:function(a){var c,d=this.sandbox.getOption("container"),e=[];
return c=this.prepareQueryString(a),e.push.apply(e,b.query(d,c)),e},prepareQueryString:function(a){var b=this.problemTypes[a.problemType],c=this.sandbox.getOption(b.nodeName),d=this.sandbox.getOption(b.attrName),e=this.sandbox.getOption(b.attrRuleName),f=c+"["+d+'="'+a.text+'"]';return a.rule&&(f+="["+e+'="'+a.rule+'"]'),f},disableRule:function(a){var b,c=this.sandbox.getOption("container"),d=this.problemTypes[a.problemType],e=a.node;e=e?e:this.sandbox.getProblemNodeFromSelection(a.problemType),e&&c.contains(e)&&(b=this.getDataFromNode(e,d),b.rules=[b.rule],this.sandbox.fire("sendStatistics",{action:"disable",node:e}),this.sandbox.fireInAllApps("changeStateForProblemsWithDisabledRules",b))},replaceText:function(){}},a.BasicProcessor=c}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=a.prototype.Utils,c=a.prototype.UILib,d=function(a,b){this.name=a,this.sandbox=b,this.problemTypes=b.getProblemTypes(),this.virtualProblemManager=b.getVirtualProblemManager()};d.prototype={constructor:d,replaceProblem:function(a){var b=this.getVirtualProblem(a.node,a.problemType);b&&(this.saveStateBeforeReplace(b.problem,a.text),this.replaceProblemWithText({node:a.node,text:a.text,range:b.problem.range,problemType:a.problemType}),this.sandbox.fire("sendStatistics",{action:"replace",node:a.node,newText:a.text,problemType:a.problemType}))},saveStateBeforeReplace:function(a,b){this.isTextBasedContainer()||this.sandbox.fire("saveStateBeforeReplace",{problem:a,text:b})},getVirtualProblem:function(a,b){var c=this.problemTypes[b];return this.virtualProblemManager.getProblem(a,c)},replaceProblemWithText:function(a){var b=this;this.setSelection(a.range),setTimeout(function(){b.replaceProblemWithTextAfterTimeout(a)},50)},setSelection:function(a){return this.isTextBasedContainer()?void this.setTextBasedSelection(a):void this.setContenteditableSelection(a)},isTextBasedContainer:function(){return b.isTextBased(this.sandbox.getOption("container"))},setTextBasedSelection:function(a){var b=this.sandbox.getOption("container"),c=this.sandbox.getRangeTextInfo(a);this.setFocus(),b.setSelectionRange(c.textBeforeRange.length,c.textBeforeRange.length+c.rangeText.length)},setFocus:function(){var a=this.sandbox.getOption("container"),b=this.sandbox.isFocused();b||a.focus()},setContenteditableSelection:function(a){this.setSelectionRange(a),this.isContenteditableSelectionValid(a)||(this.setFocus(),this.setSelectionRange(a))},setSelectionRange:function(a){var b=this.sandbox.getWindow().getSelection();b.removeAllRanges(),b.addRange(a)},isContenteditableSelectionValid:function(a){var c=this.sandbox.getSelectionRange();return c?b.isEqualRanges(c,a)?!0:c.toString()===a.toString()?!0:!1:!1},replaceProblemWithTextAfterTimeout:function(a){var b=this.getVirtualProblem(a.node,a.problemType),c={};b&&this.isSelectionValid(b.problem.range)&&(c=this.dispatchCustomInsertTextEvent(a.text),c.cancelled||this.doReplacement(a.text,b.problem.range),c.keepHighlight||this.removeVirtualProblem(b))},isSelectionValid:function(a){return this.isTextBasedContainer()?this.isTextBasedSelectionValid(a):this.isContenteditableSelectionValid(a)},isTextBasedSelectionValid:function(a){var b=this.sandbox.getOption("container"),c=this.sandbox.getRangeTextInfo(a);return b.selectionStart!==c.textBeforeRange.length?!1:b.selectionEnd-b.selectionStart!==c.rangeText.length?!1:!0},dispatchCustomInsertTextEvent:function(a){var b=this.sandbox.getOption("container"),c=document.createEvent("CustomEvent"),d={text:a},e=!1,f=!1;return c.initCustomEvent("customInsertText",!0,!0,d),e=!b.dispatchEvent(c),f=c.keepHighlight,{cancelled:e,keepHighlight:f}},doReplacement:function(a,b){return this.isCkeditorInstanceAvailable()?void this.doReplacementForCkeditor(a):this.isSlateEditor()?void this.doReplacementForSlateEditor(a,b):this.isDraftEditor()?void this.doReplacementForDraftEditor(a,b):this.isTextBasedContainer()?void this.doReplacementForTextBasedContainer(a):void this.doRegularReplacement(a,b)},isCkeditorInstanceAvailable:function(){var a=this.sandbox.getCkeditorInstance();return a&&a.execute?!0:!1},doReplacementForCkeditor:function(a){var b=this.sandbox.getCkeditorInstance();b.execute("input",{text:a})},isSlateEditor:function(){return b.isSlateEditor(this.sandbox.getOption("container"))},doReplacementForSlateEditor:function(a,b){return this.isSafari()||this.isIE11()?void this.doRegularReplacement(a,b):void this.dispatchClipboardEvent(a)},isSafari:function(){return b.Browser.safari?!0:!1},isIE11:function(){return b.Browser.ie&&11===b.Browser.version?!0:!1},doRegularReplacement:function(a,b){return this.isInsertTextCommandSupported()?void this.doReplacementForModernBrowsers(a):void this.doReplacementInOldWay(a,b)},isInsertTextCommandSupported:function(){var a=b.getCurrentDocument(this.sandbox.getOption("documentContainer"));return a.queryCommandSupported("insertText")},doReplacementForModernBrowsers:function(a){var c=b.getCurrentDocument(this.sandbox.getOption("documentContainer"));return c.execCommand("insertText",!1,a)},doReplacementInOldWay:function(a,c){var d=b.getCurrentDocument(this.sandbox.getOption("documentContainer")),e=this.sandbox.getWindow().getSelection(),f=d.createTextNode(a);c.deleteContents(),c.insertNode(f),c.selectNodeContents(f),c.collapse(!1),e.removeAllRanges(),e.addRange(c)},dispatchClipboardEvent:function(a){var b,c=this.sandbox.getOption("container");this.isFirefox()?b=new ClipboardEvent("paste",{dataType:"text/plain",data:a,bubbles:!0,cancelable:!0}):(b=new ClipboardEvent("paste",{clipboardData:new DataTransfer,bubbles:!0,cancelable:!0}),b.clipboardData.setData("text/plain",a)),c.dispatchEvent(b)},isFirefox:function(){return b.Browser.gecko},isDraftEditor:function(){return b.isDraftEditor(this.sandbox.getOption("container"))},doReplacementForDraftEditor:function(a,b){if(this.isSafari()||this.isIE11()){if(this.isSafari()&&!this.isRangeStartsAndEndsInSameContainer(b)&&(this.dispatchDeleteKeydownEvent(),this.isEmptyDraftBlock()))return;return void this.doRegularReplacement(a,b)}this.dispatchClipboardEvent(a)},isRangeStartsAndEndsInSameContainer:function(a){return a.startContainer===a.endContainer},dispatchDeleteKeydownEvent:function(){var a=this.sandbox.getOption("container"),b=document.createEvent("Event");b.initEvent("keydown",!0,!0),b.key="Delete",b.keyCode=46,a.dispatchEvent(b)},isEmptyDraftBlock:function(){var a=this.sandbox.getWindow().getSelection(),b=a.rangeCount?a.getRangeAt(0):null;return b?b.startContainer.innerHTML&&b.startContainer.innerHTML.includes('<br data-text="true">')?!0:!1:!0},doReplacementForTextBasedContainer:function(a){var b=!1;this.setFocus(),this.isInsertTextCommandSupported()&&(b=this.doReplacementForModernBrowsers(a)),b||this.doReplacementForTextBasedContainerInOldWay(a)},doReplacementForTextBasedContainerInOldWay:function(a){var b,c,d,e,f=this.sandbox.getOption("container");b=f.selectionStart,c=f.selectionEnd,d=this.getTextForFullReplacement(a,b,c),f.value=d.first+d.middle+d.last,e=b+d.middle.length,f.setSelectionRange(e,e),this.dispatchInputEvent()},getTextForFullReplacement:function(a,b,c){var d=this.sandbox.getOption("container"),e=d.maxLength,f=d.value.substring(0,b),g=d.value.substring(c),h=f.length+a.length+g.length-e,i={first:f,last:g};return-1===e||0>=h?(i.middle=a,i):(i.middle=a.substring(0,a.length-h),i)},dispatchInputEvent:function(){var a=this.sandbox.getOption("container"),b=document.createEvent("Event");b.initEvent("input",!0,!0),a.dispatchEvent(b)},removeVirtualProblem:function(a){this.virtualProblemManager.removeProblem({text:a.problem.text,index:a.index,parentBlockIndex:a.parentBlockIndex})},ignoreProblem:function(a){var b=this.problemTypes[a.problemType],d=this.sandbox.getOption(b.ignoredClass);c.addClass(a.node,d),this.setVirtualProblemToIgnoredState(a.node,a.problemType),this.sandbox.fire("sendStatistics",{action:"ignore",node:a.node})},setVirtualProblemToIgnoredState:function(a,b){var c=this.problemTypes[b];this.virtualProblemManager.setProblemToIgnoredState(a,c)},ignoreAllProblems:function(a){var b,c=this.problemTypes[a.problemType];b=this.getDataFromNode(a.node,c),this.sandbox.fire("sendStatistics",{action:"ignore",node:a.node}),this.sandbox.fireInAllApps("changeStateForIgnoredProblems",b)},getDataFromNode:function(a,b){return{text:a.getAttribute(this.sandbox.getOption(b.attrName)),rule:a.getAttribute(this.sandbox.getOption(b.attrRuleName)),problemType:b.type}},changeStateForIgnoredProblems:function(a){this.virtualProblemManager.removeProblemsByText(a),this.setIgnoreStatus(a)},setIgnoreStatus:function(a){var b=this.getProblemFromDictionary(a.text,a.rule,a.problemType);b&&this.setIgnoreStatusForProblem(b)},getProblemFromDictionary:function(a,b,c){var d=this.sandbox.getDictionary(),e=this.sandbox.getOption("lang"),f=d.getProblem({value:a,rule:b,type:c},e);return f},setIgnoreStatusForProblem:function(a){a.setUserIgnoreStatus()},disableRule:function(a){var b,c=this.problemTypes[a.problemType];b=this.getDataFromNode(a.node,c),b.rules=[b.rule],this.sandbox.fire("sendStatistics",{action:"disable",node:a.node}),this.sandbox.fireInAllApps("changeStateForProblemsWithDisabledRules",b)},replaceText:function(a){this.saveStateBeforeReplace(a.problem,a.text),this.replaceTextWithNewOne(a)},replaceTextWithNewOne:function(a){var b=this;this.setSelection(a.range),setTimeout(function(){b.replaceTextWithNewOneAfterTimeout(a)},0)},replaceTextWithNewOneAfterTimeout:function(a){this.isSelectionValid(a.range)&&this.doReplacement(a.text,a.range)}},a.VirtualProcessor=d}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=function(a,b){this.name=a,this.sandbox=b,this.state={},this.printableKeydownCounter=0};b.prototype={constructor:b,init:function(){this.sandbox.subscribe("wordBoundaryPressed",function(a){this.handleWordBoundaryPressed(a)},this),this.sandbox.subscribe("autocorrect",function(a){this.handleAutocorrect(a)},this),this.sandbox.subscribe("printableKeydownPressed",function(a){this.handlePrintableKeydownPressed(a)},this),this.sandbox.subscribe("optionsCommited",function(a){this.handleOptionsCommited(a)},this)},handleWordBoundaryPressed:function(){var a=this.sandbox.getWordDataBeforeCursor(),b=this.sandbox.getOption("minWordLength");!a.word||a.word.length<b||this.sandbox.fire("wordForAutocorrectFound",a)},handleAutocorrect:function(a){var b=this;setTimeout(function(){a.textBased&&(a.range=b.sandbox.getTextBasedRange(a.start,a.end)),a.range.collapsed||a.range.toString()!==a.word||(a.problem=a.textBased?{}:b.sandbox.createTemporaryProblem(a.range,a.word),b.markTextNode(a),b.saveStateBeforeReplace(a),b.sandbox.fire("replaceText",{text:a.suggestion,range:a.range,problem:a.problem}),b.restoreStateAfterReplace(a))},0)},markTextNode:function(a){a.textBased||this.sandbox.markTextNode(a.problem)},saveStateBeforeReplace:function(a){var b=a.suggestion.length-a.word.length;return a.restore={problem:{},cursor:0},a.textBased?void this.saveTextBasedState(a,b):void this.saveContenteditableState(a,b)},saveTextBasedState:function(a,b){var c=this.sandbox.getOption("container");a.restore.problem.start=a.start,a.restore.problem.end=a.end+b,a.restore.cursor=c.selectionStart>=a.end?c.selectionStart+b:c.selectionStart},saveContenteditableState:function(a,b){var c,d,e=this.sandbox.getSelectionRange();e&&(c=this.sandbox.getRangePosition(a.range),d=this.sandbox.getRangePosition(e),a.restore.problem.start=c.start,a.restore.problem.end=c.end+b,a.restore.cursor=d.start>=c.end?d.start+b:d.start)},restoreStateAfterReplace:function(a){var b=this;setTimeout(function(){return a.textBased?void b.restoreTextBasedState(a):void b.restoreContenteditableState(a)},0)},restoreTextBasedState:function(a){var b=this.sandbox.getOption("container"),c=this.sandbox.getTextBasedRange(a.restore.problem.start,a.restore.problem.end);b.selectionStart=a.restore.cursor,this.processAutocorrectedWord(a,c)},processAutocorrectedWord:function(a,b){this.removeMarkupForPreviouslyAutocorrectedWord(),this.markupAutocorrectedWord(a,b),this.saveAutocorrectedState(a)},removeMarkupForPreviouslyAutocorrectedWord:function(){this.hasMarkupedWord()&&(this.sandbox.fire("removeMarkupFromProblems",{problemType:"autocorrect",problems:[{value:this.state.suggestion}]}),this.cleanStateData())},hasMarkupedWord:function(){return this.state.word&&this.state.suggestion?!0:!1},cleanStateData:function(){this.state={},this.printableKeydownCounter=0},markupAutocorrectedWord:function(a,b){var c=this.sandbox.getOption("lang");this.sandbox.fire("markupProblems",{lang:c,problems:{addMarkup:[{context:"",problemType:"autocorrect",range:b,rule:"",text:a.suggestion,label:!0,match:{hash:0,length:a.suggestion.length,message:a.message,offset:0,suggestions:[a.word],type:"autocorrect",value:a.suggestion}}],removeMarkup:[]}})},saveAutocorrectedState:function(a){this.state.word=a.word,this.state.suggestion=a.suggestion},restoreContenteditableState:function(a){var b=this.sandbox.getWindow().getSelection(),c=this.sandbox.getOption("container"),d=this.sandbox.getRangeByPosition(c,a.restore.cursor,a.restore.cursor),e=this.sandbox.getRangeByPosition(c,a.restore.problem.start,a.restore.problem.end);b.removeAllRanges(),b.addRange(d),this.processAutocorrectedWord(a,e)},handlePrintableKeydownPressed:function(){this.hasMarkupedWord()&&(this.printableKeydownCounter++,this.printableKeydownCounter<3||this.removeMarkupForPreviouslyAutocorrectedWord())},handleOptionsCommited:function(a){a.hasOwnProperty("autocorrect")&&this.removeMarkupForPreviouslyAutocorrectedWord()}},a.Autocorrect=b}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b,c=function(a,c){var e=["scayt_ckeditor","scayt_tinymce","scayt_froala"],f=c.getOption("appType");this.name=a,b=c.getOption("basePath"),this.sandbox=c,this.closeBannerTimeout=void 0,this.contextMenuContainer=null,e.includes(f)&&(this.template="scayt_froala"!==f?d.editor():d.common(),this.bannerId="scayt_froala"!==f?"banner_tpl_editor":"banner_tpl_default")};c.prototype={init:function(){this.sandbox;this.template&&(this.sandbox.Template.create(this.bannerId,this.template),this.sandbox.subscribe("showBanner",function(a){this.showBannerHandler(a.contextMenuContainerSelector,a.contextMenuContainer)},this),this.sandbox.subscribe("hideBanner",function(){this.hideBanner()},this))},showBannerHandler:function(a,b){var c=this,d=this.sandbox.UILib;c.sandbox.getOption("banner")!==!1&&c.sandbox.addDeferredFunction("showBanner",{single:!0,delay:100,deferredFunction:function(){b=b||d.find(a)[0],c.contextMenuContainer=b,b&&(d.css(b,{overflow:"visible"}),c.showBanner(b))}})},actionLinks:function(a){var b=this,c=a.target||a.srcElement;c.href&&"closeBanner"!==c.id&&(window.open(c.href,"_blank"),b.contextMenuContainer&&b.sandbox.fire({eventType:"focus",element:b.contextMenuContainer}))},showBanner:function(a){function b(a){var e=a;f(e),c.sandbox.unsubscribe({eventType:"mousedown",element:d.find("#wsc_banner")[0]||d.find("#wsc_img_banner")[0],handler:b})}var c=this,d=this.sandbox.UILib,e=c.sandbox.Template.render(c.bannerId,{}),f=d.proxy(c.actionLinks,c);d.append(a,e),c.sandbox.subscribe({eventType:"mousedown",element:d.find("#wsc_banner")[0]||d.find("#wsc_img_banner")[0],handler:b})},hideBanner:function(){var a=this.sandbox.UILib,b=a.find("#wsc_banner")[0]||a.find("#wsc_img_banner")[0];b&&(a.css(a.parent(b),{overflow:""}),a.remove(b))}};var d={editor:function(){return'<div id="wsc_img_banner"><a target="_blank" style="background-image:url('+b+'css/banner.png)" class="wsc_banner-image-link" href="https://webspellchecker.com/wsc-scayt-ckeditor4/"></a></div>'},common:function(){return'<div id="wsc_banner"><div class="wsc-img-banner"><img src="'+b+'css/webspellchecker-logo-small.png"><span>WebSpellChecker</span></div><ul class="wsc-more-list"><li>No banner</li><li>More languages</li><li>Technical support</li><li>Extra features</li></ul><div class="wsc-button-holder"><a target="_blank" href="http://www.webspellchecker.net/pricing.html" class="wsc-upgrade">Upgrade Now</a></div>'}};a.Banner=c}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=function(a,b){this.name=a,this.sandbox=b};b.prototype={init:function(){var a=this;this.sandbox.subscribe({eventType:"keydown",element:this.getContainer(),handler:this.handleKeydown}),a.sandbox.subscribe({eventType:"compositionstart",element:this.getContainer(),handler:function(){a.sandbox.setPaused(!0)}}),a.sandbox.subscribe({eventType:"compositionend",element:this.getContainer(),handler:function(){a.sandbox.setPaused(!1),a.sandbox.addDeferredFunction("startProblemCheckAfterWorkIME",{single:!0,delay:0,deferredFunction:function(){a.sandbox.startProblemCheck()}})}})},handleKeydown:function(a){var b=this;(229===a.keyCode||0===a.keyCode)&&b.sandbox.fire("removeMarkupInSelectionNode")},getContainer:function(){var a=this;return a.sandbox.getOption("container")}},a.IME=b}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=function(a,b){this.name=a,this.sandbox=b,this.infoTypesMap={banner:"banner",langList:"langList",canRemoveBranding:"canRemoveBranding",sendStatistics:"sendStatistics",session:"session"}};b.prototype={constructor:b,init:function(){var a=this;this.sandbox.fire("remoteAction",{actionMethod:"getInfo",onSuccess:function(b){a.setOptions(b),a.validateLanguage()},onError:function(){a.setPause()}})},setOptions:function(a){var b;for(var c in this.infoTypesMap)b=this.infoTypesMap[c],"undefined"!=typeof a[b]&&this.sandbox.setOption(c,a[b])},validateLanguage:function(){var a=this.sandbox.getOption("langList"),b=this.sandbox.getOption("lang");return b in a.ltr||b in a.rtl?void this.sandbox.fire("moduleReady",{moduleID:this.name}):(this.setPause(),void console.warn("The defined language code "+b+" is not available or supported for your customer ID. Please contact us at support@webspellchecker.net or submit a ticket at webspellchecker.com website."))},setPause:function(){this.sandbox.setPaused(!0),this.sandbox.removeAllDeferredFunctions()}},b.async=!0,a.InfoGetter=b}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=a.prototype.Utils,c=function(a,b){this.name=a,this.sandbox=b,this.active=!1};c.prototype={init:function(){this.sandbox.subscribe("startProofreadInDialog",function(a){this.handleStartProofreadInDialog(a)},this),this.sandbox.subscribe("finishProofreadInDialog",function(a){this.handleFinishProofreadInDialog(a)},this),this.sandbox.subscribe("activeProblemChanged",function(a){this.handleActiveProblemChanged(a)},this),this.sandbox.subscribe("updateUiGlobally",function(a){this.handleUpdateUiGlobally(a)},this),this.sandbox.subscribe("setNextProblemActive",function(a){this.handleSetNextProblemActive(a)},this),this.sandbox.subscribe("setPrevProblemActive",function(a){this.handleSetPrevProblemActive(a)},this)},handleStartProofreadInDialog:function(){this.active||(this.active=!0,this.sandbox.setOption("isProofreadInDialogActive",!0),this.processGlobalProofreadDialogState(),this.activeSandbox=this.sandbox,this.virtualProblemManager=this.sandbox.getVirtualProblemManager(),this.virtualProblemManager.startWorkWithActiveProblem())},processGlobalProofreadDialogState:function(){this.globalProofreadDialog=this.sandbox.getOption("globalProofreadDialog"),b.isPageScrollable()||this.sandbox.setOption("globalProofreadDialog",!1)},handleFinishProofreadInDialog:function(){this.active&&(this.active=!1,this.sandbox.setOption("isProofreadInDialogActive",!1),this.restoreGlobalProofreadDialogState(),this.virtualProblemManager.finishWorkWithActiveProblem())},restoreGlobalProofreadDialogState:function(){this.sandbox.setOption("globalProofreadDialog",this.globalProofreadDialog)},handleActiveProblemChanged:function(a){var b,c,d=this.sandbox.getOption("globalProofreadDialog");if(this.active){if(a.problem||!d)return void this.sandbox.fire("createProblemItem",this.prepareProblemData(a.problem));if(b=this.getOrderedApps(),c=this.getNextPrevApp(b,a.prev),!c)return void this.sandbox.fire("createProblemItem",this.prepareProblemData(null));this.virtualProblemManager.finishWorkWithActiveProblem(),this.activeSandbox=c,this.virtualProblemManager=this.activeSandbox.getVirtualProblemManager(),this.virtualProblemManager.startWorkWithActiveProblem(a.prev)}},prepareProblemData:function(a){return{problem:a,info:a?this.activeSandbox.getProblemInfo(a.elements[0]):null,actions:a?this.activeSandbox.getProblemActions(a.elements[0]):null,scroll:{container:this.activeSandbox.getOption("container"),documentContainer:this.activeSandbox.getOption("documentContainer"),isIframe:this.activeSandbox.getOption("isIframe"),nodeContainer:this.activeSandbox.getOption("contenteditableMirrorContainer")}}},getOrderedApps:function(){var a=this.sandbox.getAllApps();return a.sort(function(a,c){var d=b.getCoordinates(a.getOption("documentContainer")).top,e=b.getCoordinates(c.getOption("documentContainer")).top;return e>d?-1:1}),a.filter(function(a){return a.isGlobalProofreadDialog()})},getNextPrevApp:function(a,b){for(var c=this.getCurrentAppIndex(a),d=0;d<a.length;d++)if(c=b?0===c?a.length-1:c-1:c===a.length-1?0:c+1,a[c].getProblemsCount()>0)return a[c];return null},getCurrentAppIndex:function(a){for(var b=0;b<a.length;b++)if(this.activeSandbox.getOption("uid")===a[b].getOption("uid"))return b},handleUpdateUiGlobally:function(a){this.active&&this.activeSandbox.getOption("uid")!==a.uid&&(this.activeSandbox.getProblemsCount()>0||this.handleActiveProblemChanged({problem:null,prev:!1}))},handleSetNextProblemActive:function(){this.virtualProblemManager.setNextProblemActive()},handleSetPrevProblemActive:function(){this.virtualProblemManager.setPrevProblemActive()},destroy:function(){}},a.ProofreadDialogManager=c}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=function(a,b){this.name=a,this.sandbox=b,this.sendStatistics=b.getOption("sendStatistics"),this.schema=["action","text","newText","lang","detectedLang","type","category","rule","description","context","offset"]};b.prototype={constructor:b,init:function(){this.sandbox.subscribe("sendStatistics",function(a){this.sendStatisticsHandler(a)},this)},sendStatisticsHandler:function(a){var b=this.createStatisticsData(a),c=this.createSendData(b);this.handleCallbacks(b),this.sendStatistics&&this.send(c)},createStatisticsData:function(a){var b=a.node?this.getDataFromNode(a.node):{},c=Object.assign({},a,b);return c.lang=this.sandbox.getOption("lang"),c.detectedLang=this.sandbox.getOption("detectedLang"),c=this.filterData(c)},getDataFromNode:function(a){return this.sandbox.getProblemInfo(a)},filterData:function(a){var b={};return this.schema.forEach(function(c){a.hasOwnProperty(c)&&""!==a[c]&&(b[c]=a[c])}),b},createSendData:function(a){var b={actionMethod:"statistics",onSuccess:function(){},onError:function(){}},c={};return a.hasOwnProperty("offset")?c.offset=String(a.offset):null,Object.assign({},b,a,c)},handleCallbacks:function(a){this.handleOnStatistics(a),this.handleOnAddWordToUserDictionary(a),this.handleOnDeleteWordFromUserDictionary(a)},handleOnStatistics:function(a){var b=this.sandbox.getOption("onStatistics"),c=this.sandbox.getInstance();b(a,c)},handleOnAddWordToUserDictionary:function(a){var b,c;"add"===a.action&&(b=this.sandbox.getOption("onAddWordToUserDictionary"),c=this.sandbox.getInstance(),b(a.text,c))},handleOnDeleteWordFromUserDictionary:function(a){var b,c;"delete"===a.action&&(b=this.sandbox.getOption("onDeleteWordFromUserDictionary"),c=this.sandbox.getInstance(),b(a.text,c))},send:function(a){this.sandbox.fire("remoteAction",a)}},a.Statistics=b}(WEBSPELLCHECKER.CORE),WEBSPELLCHECKER.CORE.UI=WEBSPELLCHECKER.CORE.UI||{},function(a,b){"use strict";var c=b.UILib,d=b.Utils;a=a||{};var e=function(){function a(b,c){var d=c.name,e=c.title,f=c.modificators,g=c.hide;_classCallCheck(this,a),this.sandbox=b,this._isVisible=!0,this.childDataAttr="data-children",this.prefix="wsc",this._elementOf=[],this._separators={modificator:"--",element:"__",prefix:"-"},this._modificatorsTypes={focusable:this.prefix+this._separators.modificator+"focusable",hidden:this.prefix+this._separators.modificator+"hidden",clearfix:this.prefix+this._separators.modificator+"clearfix",borderBox:this.prefix+this._separators.modificator+"border-box",fullscreen:this.prefix+this._separators.modificator+"fullscreen"},this._errorsMessages={modificatorNotRegistred:'Modificator - "{mod}" not registred in component - "{comp}". see: registerModificatorsTypes.',customModificatorParent:'For action with custom modificator - "{mod}" component - "{comp}" should be element of block - "{block}".',templateData:"{key} - is not defined in template data."},this._internalName=d,this._modificators=f||[],this._customModificators=[],this._events=[],this._lifeCycleMethods=["render","show","hide","remove"],this._UIDFields=["id","labelFor"],this._lifeCycleHandlers={before:{},after:{}},this._element=null,this._position=null,this._children=[],this._template="",this._templateData={prefix:this.prefix},this._createLifeCycles(this._lifeCycleMethods),g&&this.hide(),this._setTemplateField({name:d}),this._setTemplateField({title:e||d})}return _createClass(a,[{key:"registerChildren",value:function(a,b,c){var c,d=this;"number"==typeof b&&(c=b,b=void 0),c="undefined"==typeof c?this._children.length:c,a&&(a=Array.isArray(a)?a:[a],a.forEach(function(a){a._elementOf.push({block:d.name,element:b||a.name}),b&&(a._internalName=b),a.registerLifeCycleHandler("after","remove",function(){d._children.splice(d._children.indexOf(a),1)}),d.isVisible()||(a._hidByParent=!0,a.isVisible()&&(a._isVisible=!1))}),Array.prototype.splice.apply(this._children,[c,0].concat(a)),null!==this.getDOMElement()&&this._renderChildren())}},{key:"registerBemElements",value:function(a,b){var c=this,d=function(a){a._elementOf.push({block:c.name,element:b||a._internalName}),null!==a.getDOMElement()&&c._addChildClasses(a)};return Array.isArray(a)?a.forEach(d):d(a),a}},{key:"getChildren",value:function(a){for(var b=[],c=0;c<this._children.length;c+=1)(this._children[c]._internalName===a||this._children[c].name===a)&&b.push(this._children[c]);return 0===b.length?null:1===b.length?b[0]:b}},{key:"render",value:function(a){var b,d='<div title="'+this.title+'" class="'+this._buildCssString({block:this.name})+'"></div>';return this.sandbox.Template.create("Component",this.template||d),b=this.sandbox.Template.render("Component",a||this._templateData),this.sandbox.Template.remove("Component"),this._element=c.create(b)[0],this._position&&c.setPosition(this._element,this._position.left,this._position.top),c.addClass(this._element,this._buildModificators()),this.isVisible()&&this.show(),this._bindEvents(),this._renderChildren(),this._element}},{key:"remove_check",value:function(){return!0}},{key:"remove",value:function(){this._unBindEvents(),this.remove_check=function(){return!1},this.removeAllChildren(),c.remove(this._element),this._element=null}},{key:"removeAllChildren",value:function(){for(;this._children.length;)this._children[0].remove()}},{key:"setTemplate",value:function(a){this.template=a}},{key:"addTemplateData",value:function(a){a=Object.assign({},a);for(var b in a)this._UIDFields.includes(b)&&(a[b]+=this.getUID());Object.assign(this._templateData,a)}},{key:"getUID",value:function(){var a=this.sandbox.getOption("uid");return a?"_"+a:""}},{key:"getTemplateData",value:function(a){if(this._templateData.hasOwnProperty(a))return this._templateData[a];throw new Error(this._errorsMessages.templateData.replace("{key}",a))}},{key:"registerLifeCycleHandler",value:function(a,b,c){this._lifeCycleMethods.includes(b)&&(this._lifeCycleHandlers[a][b]=this._lifeCycleHandlers[a][b]||[],this._lifeCycleHandlers[a][b].push(c))}},{key:"getDOMElement",value:function(){return this._element}},{key:"show_check",value:function(a){return this._isInternalCommand(a)&&a.isDeep||this.removeModificator("hidden"),!this.isVisible()&&!this._hidByParent}},{key:"show",value:function(){this._children.forEach(function(a){var b=a._hidByParent;delete a._hidByParent,b&&!a._modificators.includes("hidden")&&a.show(new f("isDeep",!0))}),this._isVisible=!0}},{key:"hide_check",value:function(a){return this._isInternalCommand(a)&&a.isDeep||this.addModificator("hidden"),this.isVisible()}},{key:"hide",value:function(){this._children.forEach(function(a){a._hidByParent=!0,a.isVisible()&&a.hide(new f("isDeep",!0))}),this._isVisible=!1}},{key:"isVisible",value:function(){return this._isVisible}},{key:"getTitle",value:function(){return this.title}},{key:"setTitle",value:function(a){this.title=a,this.addTemplateData({title:this.title}),null!==this.getDOMElement()&&c.attr(this.getDOMElement(),"title",a)}},{key:"setFocus",value:function(){var a=this.getDOMElement();null!==a&&a.focus()}},{key:"setAriaLabel",value:function(a){this.addTemplateData({ariaLabel:a});var b=this.getDOMElement();null!==b&&c.attr(b,"aria-label",a)}},{key:"setAriaExpanded",value:function(a){this.addTemplateData({ariaExpanded:a});var b=this.getDOMElement();null!==b&&c.attr(b,"aria-expanded",a)}},{key:"setTabIndex",value:function(a){this.addTemplateData({tabIndex:a});var b=this.getDOMElement();null!==b&&c.attr(b,"tabindex",a)}},{key:"proxyMethodsFrom",value:function(a,b){var c=this;b.forEach(function(b){c[b]=a[b].bind(a)})}},{key:"attachEvents",value:function(a){this.getDOMElement()&&this._bindEvents(d.pushOrConcat([],a)),this._events=d.pushOrConcat(this._events,a)}},{key:"setPosition",value:function(a){if(a=Object.assign({},a),a.left=Math.round(a.left),a.top=Math.round(a.top),!this._position||this._position.top!==a.top||this._position.left!==a.left){this._position=a;var b=this.getDOMElement();b&&c.setPosition(b,a.left,a.top)}}},{key:"getSize",value:function(){var a=this.getDOMElement();return{width:c.outerWidth(a),height:c.outerHeight(a)}}},{key:"registerModificatorsTypes",value:function(a,b){a=Object.assign({},a);for(var c in a)a[c]=this._buildCssString({block:b||this.name,modificator:a[c]});Object.assign(this._modificatorsTypes,a)}},{key:"addModificator",value:function(a){if(!this._modificatorsTypes[a])throw new Error(this._errorsMessages.modificatorNotRegistred.replace("{mod}",a).replace("{comp}",this.name));this._modificatorAction({modificator:a,action:"add",modificatorsArray:this._modificators})}},{key:"removeModificator",value:function(a){this._modificatorAction({modificator:a,action:"remove",modificatorsArray:this._modificators})}},{key:"addCustomModificator",value:function(a,b){this._customModificatorAction({modificator:a,block:b,action:"add"})}},{key:"removeCustomModificator",value:function(a,b){this._customModificatorAction({modificator:a,block:b,action:"remove"})}},{key:"getModificators",value:function(){return this._modificators.slice(0)}},{key:"getFocusableElements",value:function(){for(var a=['input:not([disabled]):not([type="hidden"]):not([aria-hidden]):not([readonly])','[tabindex]:not([tabindex^="-"])'],b=this.getDOMElement().querySelectorAll(a.join(",")),c=[],e=0;e<b.length;e++){var f=b[e],g=d.getComputedStyle(f);"hidden"!==g.visibility&&("input"!==f.tagName.toLowerCase()||"radio"!==f.type||f.checked)&&c.push(f)}return c}},{key:"getTabIndexedElements",value:function(){return c.find("[tabindex]",this.getDOMElement()).filter(function(a){return!d.isHidden(a)&&"hidden"!==d.getComputedStyle(a).visibility})}},{key:"getNextPrevByActive",value:function(a){for(var b=document.activeElement,c={first:!1,last:!1},d=0;d<a.length;d++){var e=a[d];if(e===b){d===a.length-1?(c.next=a[0],c.last=!0):c.next=a[d+1],0===d?(c.prev=a[a.length-1],c.first=!0):c.prev=a[d-1];break}}return c}},{key:"resetAllTabIndexes",value:function(){for(var a=['[tabindex]:not([tabindex^="-"])'],b=this.getDOMElement().querySelectorAll(a.join(",")),d=0;d<b.length;d++)c.attr(b[d],"tabindex",-1)}},{key:"_createLifeCycles",value:function(a){for(var b,c=this,d=function(a){return function(){var b;return"function"!=typeof c[a+"_check"]||c[a+"_check"].apply(c,arguments)?((c._lifeCycleHandlers.before[a]||[]).forEach(function(a){return a()}),b=this["_original_"+a].apply(c,arguments),(c._lifeCycleHandlers.after[a]||[]).forEach(function(a){return a()}),b):!1}},e=0;e<a.length;e+=1)b=a[e],this["_original_"+b]=this[b],this[b]=d(b)}},{key:"_buildCssString",value:function(a){var b=a.block,c=a.element,d=a.modificator,e=c?this._separators.element+c:"",f=d?this._separators.modificator+d:"";
return this.prefix+this._separators.prefix+b+e+f}},{key:"_setTemplateField",value:function(a){var b=Object.keys(a)[0],c={},d=a[b];this[b]=d,c[b]=d,this.addTemplateData(c)}},{key:"_customModificatorAction",value:function(a){var b=a.modificator,c=a.block,d=a.action,e=this._buildCustomModificator(b,c);this._modificatorAction({modificator:e,action:d,modificatorsArray:this._customModificators,modificatorString:e})}},{key:"_modificatorAction",value:function(a){var b=a.modificator,d=a.action,e=a.modificatorsArray,f=a.modificatorString,g=e.includes(b),f=f||this._modificatorsTypes[b],h=this._element,i={add:{manageList:function(){g||e.push(b)},manageClass:function(){c.addClass(h,f)}},remove:{manageList:function(){g&&e.splice(e.indexOf(b),1)},manageClass:function(){c.removeClass(h,f)}}},j=i[d];j&&(j.manageList(),null!==h&&j.manageClass())}},{key:"_buildElements",value:function(){var a=this;return this._blocks.map(function(b){return a._buildCssString({block:b,element:a.name})}).join(" ")}},{key:"_buildModificators",value:function(){for(var a,b="",c=0;c<this._modificators.length;c+=1)a=this._modificatorsTypes[this._modificators[c]],a&&(b+=a+" ");return b+=this._customModificators.join(" "),b.trim()}},{key:"_buildCustomModificator",value:function(a,b){var c=this._elementOf.filter(function(a){return a.block===b})[0];if(!c)throw new Error(this._errorsMessages.customModificatorParent.replace("{mod}",a).replace("{comp}",this.name).replace("{block}",b));return this._buildCssString({block:b,element:c.element,modificator:a})}},{key:"_addChildClasses",value:function(a){var b=this;a._elementOf.forEach(function(d){c.addClass(a._element,b._buildCssString({block:d.block,element:d.element}))}),c.addClass(a._element,this._buildCssString({block:this.name,element:a.name}))}},{key:"_renderChildren",value:function(){for(var a,b,d,e=this,f=this.getDOMElement(),g=c.find("*["+this.childDataAttr+"]",f),h=function(a){a.render();return e._addChildClasses(a),a},i=0;i<this._children.length;i+=1)a=this._children[i],0!==g.length?g.forEach(function(b){var d=c.attr(b,e.childDataAttr);d===a._internalName&&c.insertBefore(h(a).getDOMElement(),b)}):(b=a.getDOMElement(),null!==b?d=b:(b=h(a).getDOMElement(),d?c.insertAfter(b,d):(c.prependTo(b,f),d=b)));g.forEach(c.remove)}},{key:"_findChildren",value:function(a){var b=[],c=this.getChildren(a);return null!==c&&d.pushOrConcat(b,c),this._children.forEach(function(c){b=b.concat(c._findChildren(a))}),b}},{key:"_bindEvents",value:function(a){var b=this;(a||this._events).forEach(function(a){b.sandbox.subscribe({eventType:a.eventType,handler:a.handler,element:b._element,context:b})})}},{key:"_unBindEvents",value:function(){var a=this;this._events.forEach(function(b){a.sandbox.unsubscribe({eventType:b.eventType,handler:b.handler,element:a._element,context:a})})}},{key:"_isInternalCommand",value:function(a){return a instanceof f}}]),a}(),f=function g(a,b){_classCallCheck(this,g),this[a]=b};a.Component=e}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){"use strict";var c=(b.Utils,a.Component),d=(b.UILib,function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"icon"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.setTemplate('<span class="<%=prefix%>-icon <%=prefix%>-icon-<%=iconName%>"></span>'),d.registerModificatorsTypes({big:"big",active:"active",small:"small",success:"success",error:"error",confirm:"confirm"},"icon-"+c.iconName),d.addTemplateData({iconName:c.iconName}),d}return _inherits(b,a),_createClass(b,[{key:"activate",value:function(){this.addModificator("active")}},{key:"deactivate",value:function(){this.removeModificator("active")}}]),b}(c));a.Icon=d}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){"use strict";var c=(b.UILib,a.Component),d=(b.Utils,function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"input"},c),c.modificators=c.modificators||[],c.modificators.push("focusable");var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.setTemplate('<input placeholder="<%=placeholder%>" id="<%=prefix%>-<%=id%>" name="<%=attrName%>" maxlength="<%=maxLength%>" class="<%=prefix%>-input <%=prefix%>-<%=type%>" type="<%=type%>" value="<%=value%>" <%=disabled%> <%=checked%> autocomplete="<%=autocomplete%>" autocorrect="<%=autocorrect%>" autocapitalize="<%=autocapitalize%>" spellcheck="<%=spellcheck%>" aria-labelledby="<%=labelledBy%>" />'),d.addTemplateData({id:c.id||"",attrNameClear:c.attrNameClear||"",attrName:c.attrName||"",type:c.type||"text",value:c.value||"",placeholder:c.placeholder||"",maxLength:c.maxLength||"",disabled:c.disabled?"disabled":"",style:c.style||"",autocomplete:c.autocomplete||"",autocorrect:c.autocorrect||"",autocapitalize:c.autocapitalize||"",spellcheck:c.spellcheck||"",labelledBy:c.labelledBy?d.prefix+"-label-"+c.labelledBy+d.getUID():"",checked:c.checked?"checked":""}),d.build(c),d}return _inherits(b,a),_createClass(b,[{key:"build",value:function(a){"function"==typeof a.onKeydown&&this.attachEvents({eventType:"keydown",handler:function(b){a.onKeydown(b)}}),"function"==typeof a.onInput&&this.attachEvents({eventType:"input",handler:function(b){a.onInput(b)}}),"function"==typeof a.onChange&&this.attachEvents({eventType:"change",handler:function(b){a.onChange(b)}})}},{key:"getAttrName",value:function(){return this.getTemplateData("attrNameClear")||this.getTemplateData("attrName")}},{key:"getValue",value:function(){return this._getField("value")}},{key:"setValue",value:function(a){this._setField("value",a)}},{key:"getChecked",value:function(){return!!this._getField("checked")}},{key:"setChecked",value:function(a){this._setField("checked",!!a)}},{key:"setFocus",value:function(){var a=this.getDOMElement();a&&a.focus()}},{key:"_getField",value:function(a){var b=this.getDOMElement();return b?b[a]:this.getTemplateData(a)}},{key:"_setField",value:function(a,b){var c=this.getDOMElement();if(c)c[a]=b;else{var d={};d[a]=b,this.addTemplateData(d)}}}]),b}(c));a.Input=d}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){"use strict";var c=(b.UILib,a.Component),d=(b.Utils,function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"label"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.setTemplate('<label for="<%=prefix%>-<%=labelFor%>" class="<%=prefix%>-label" id="<%=prefix%>-label-<%=id%>" title="<%=labelTitle%>"><%=labelText%></label>'),d.addTemplateData({labelFor:c.labelFor||"",id:c.id||"",labelText:c.labelText||"",labelTitle:c.labelText||""}),d}return _inherits(b,a),b}(c));a.Label=d}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){"use strict";var c=(b.UILib,a.Component),d=(b.Utils,a.Input),e=a.Label,f=function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"textInput"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.setTemplate('<div class="<%=prefix%>-input-wrapper <%=prefix%>-input-wrapper">	<div data-children="label"></div>	<div data-children="input"></div></div>'),d.build(c),d}return _inherits(b,a),_createClass(b,[{key:"build",value:function(a){this.buildInput(a),this.buildLabel(a),this.proxyMethodsFrom(this.getChildren("input"),["getValue","setValue","setFocus"])}},{key:"buildInput",value:function(a){var b=new d(this.sandbox,{id:a.id||"",type:a.type||"text",value:a.value||"",placeholder:a.placeholder||"",maxLength:a.maxLength||"",disabled:a.disabled?"disabled":"",style:a.style||"",autocomplete:a.autocomplete||"off",autocorrect:a.autocorrect||"off",autocapitalize:a.autocapitalize||"off",spellcheck:a.spellcheck||"false",labelledBy:a.id||"",onKeydown:a.onKeydown,onInput:a.onInput});this.registerChildren(b)}},{key:"buildLabel",value:function(a){var b=new e(this.sandbox,{id:a.id?a.id:"",labelFor:a.id||"",labelText:a.placeholder||"",hide:!0});this.registerChildren(b)}}]),b}(c);a.TextInput=f}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){"use strict";var c=b.UILib,d=a.Component,e=b.Utils,f=function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"button"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.text=c.text?e.escapeHTML(c.text):"",d.title=c.title?e.escapeHTML(c.title):"",d.ariaLabel=c.ariaLabel?e.escapeHTML(c.ariaLabel):d.title,d.setTemplate('<button class="<%=prefix%>-<%=name%> <%=prefix%>-<%=name%>--clear" type="button" style="<%=style%>" role="<%=role%>" title="<%=title%>" aria-label="<%=ariaLabel%>" tabindex="<%=tabIndex%>">    <div data-children="icon"></div>    <span class="<%=prefix%>-<%=name%>__description"><%=description%></span>    <span class="<%=prefix%>-<%=name%>__text"><%=text%></span></button>'),d.addTemplateData({title:d.title,text:d.text,description:c.description||"",style:c.style||"",role:c.role||"button",ariaLabel:d.ariaLabel,tabIndex:c.tabIndex||0}),d.registerModificatorsTypes({text:"text",disable:"disable",primary:"primary"}),d.addModificator("focusable"),d.disabled=!1,d.build(c),d}return _inherits(b,a),_createClass(b,[{key:"build",value:function(a){a.icon&&this.registerIcon(a.icon),"function"==typeof a.onClick&&this.attachEvents({eventType:"click",handler:function(b){this.disabled||a.onClick(b)}}),"function"==typeof a.onKeydown&&this.attachEvents({eventType:"keydown",handler:function(b){this.disabled||a.onKeydown(b)}}),"function"==typeof a.onFocus&&this.attachEvents({eventType:"focus",handler:function(b){this.disabled||a.onFocus(b)}}),"function"==typeof a.onBlur&&this.attachEvents({eventType:"blur",handler:function(b){this.disabled||a.onBlur(b)}})}},{key:"registerIcon",value:function(a){this.registerChildren(a)}},{key:"setText",value:function(a){this.addTemplateData({text:a});var b=this.getDOMElement();if(null!==b){var d=this._buildCssString({block:this.name,element:"text"});c.find("."+d,b)[0].innerHTML=a}}},{key:"getText",value:function(){return this.getTemplateData("text")}},{key:"enable",value:function(){this.disabled=!1,this.removeModificator("disable"),this.setTabIndex(0)}},{key:"disable",value:function(){this.disabled=!0,this.addModificator("disable"),this.setTabIndex(-1)}},{key:"activate",value:function(){var a=this.getChildren("icon");a&&a.activate()}},{key:"deactivate",value:function(){var a=this.getChildren("icon");a&&a.deactivate()}}]),b}(d);a.Button=f}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){"use strict";var c=(b.Utils,a.Component),d=a.Button,e=(b.UILib,function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"item"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.setTemplate('<li class="<%=prefix%>-item" role="<%=role%>">	<div data-children="content"></div></li>'),d.addTemplateData({role:c.role||""}),d.build(c.itemContent),d}return _inherits(b,a),_createClass(b,[{key:"build",value:function(a){this.registerChildren(a instanceof c?a:new d(this.sandbox,a),"content")}}]),b}(c));a.Item=e}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){"use strict";var c=a.Component,d=a.Item,e=b.UILib,f=(b.Utils,function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"list"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.setTemplate('<ul class="<%=prefix%>-list" id="<%=controlsBy%>" role="<%=role%>" aria-label="<%=ariaLabel%>"><div data-children="item"></div></ul>'),d.addTemplateData({controlsBy:c.controlsBy||"",role:c.role||"",ariaLabel:c.ariaLabel||""}),d.itemRole=c.itemRole||"",d.changeTabIndexOnFocus=c.changeTabIndexOnFocus||!1,d.nextKey=c.nextKey||40,d.prevKey=c.prevKey||38,d.keyboardTrapped=!1,d.build(c),d}return _inherits(b,a),_createClass(b,[{key:"build",value:function(a){var b=this;"function"==typeof a.onFocusin&&this.attachEvents({eventType:"focusin",handler:function(b){this.handleFocusin(b),a.onFocusin(b)}}),"function"==typeof a.onFocusout&&this.attachEvents({eventType:"focusout",handler:function(b){this.handleFocusout(b),a.onFocusout(b)}}),this.registerLifeCycleHandler("before","remove",function(){b.destroy()})}},{key:"addItems",value:function(a){for(var b=0;b<a.length;b+=1)this.addItem(a[b])}},{key:"addItem",value:function(a,b){var c=new d(this.sandbox,{role:this.itemRole,itemContent:a});return c.addTemplateData(this.templateData),c.getChildren("content").registerLifeCycleHandler("after","remove",c.remove.bind(c)),this.registerChildren(c,"item",b),c}},{key:"removeAllItems",value:function(){this.removeAllChildren()}},{key:"getLength",value:function(){return this._children.length}},{key:"handleFocusin",value:function(){this.keyboardTrapped||(this.attachKeyDownEvent(),this.keyboardTrapped=!0)}},{key:"attachKeyDownEvent",value:function(){this.sandbox.subscribe({eventType:"keydown",element:this.getDOMElement(),handler:this.trapKeyboard,context:this})}},{key:"handleFocusout",value:function(a){this.getDOMElement().contains(a.relatedTarget)||(this.detachKeyDownEvent(),this.keyboardTrapped=!1)}},{key:"detachKeyDownEvent",value:function(){this.sandbox.unsubscribe({eventType:"keydown",element:this.getDOMElement(),handler:this.trapKeyboard,context:this})}},{key:"trapKeyboard",value:function(a){var b=a.keyCode;b===this.prevKey?(this.handlePrevKeyPress(a),a.preventDefault()):b===this.nextKey&&(this.handleNextKeyPress(a),a.preventDefault())}},{key:"handlePrevKeyPress",value:function(){var a=this.getNextPrevByActive(this.getTabIndexedElements()).prev;a&&(a.focus(),this.changeTabIndexOnFocus&&(this.resetAllTabIndexes(),e.attr(a,"tabindex",0)))}},{key:"handleNextKeyPress",value:function(){var a=this.getNextPrevByActive(this.getTabIndexedElements()).next;a&&(a.focus(),this.changeTabIndexOnFocus&&(this.resetAllTabIndexes(),e.attr(a,"tabindex",0)))}},{key:"destroy",value:function(){this.detachKeyDownEvent()}}]),b}(c));a.ItemList=f}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){"use strict";var c=(b.UILib,a.Component),d=(b.Utils,a.Input),e=a.Label,f=function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"checkbox"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.setTemplate('<span class="<%=prefix%>-checkbox-wrapper <%=prefix%>-input-wrapper">	<div data-children="input"></div>	<div data-children="label"></div>	<span class="<%=prefix%>-checkbox-wrapper__cover"></span></span>'),d.build(c),d}return _inherits(b,a),_createClass(b,[{key:"build",value:function(a){this.buildInput(a),this.buildLabel(a),this.proxyMethodsFrom(this.getChildren("input"),["getAttrName","getValue","setValue","getChecked","setChecked"])}},{key:"buildInput",value:function(a){var b=new d(this.sandbox,{attrName:a.attrName,id:a.id,type:"checkbox",value:a.value,labelledBy:a.id,checked:a.checked||!1,onChange:a.onChange});this.registerChildren(b)}},{key:"buildLabel",value:function(a){var b=new e(this.sandbox,{id:a.id,labelText:a.placeholder||"",labelFor:a.id});this.registerChildren(b)}}]),b}(c);a.Checkbox=f}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a){"use strict";var b=a.Component,c=function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"option"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.setTemplate('<option <%=selected%> value="<%=value%>">&nbsp;<%=text%>&nbsp;</option>'),d.addTemplateData({value:c.value||"",text:c.text||"",selected:c.selected?"selected":""}),d}return _inherits(b,a),_createClass(b,[{key:"getValue",value:function(){var a=this.getDOMElement();return a?a.value:this.getTemplateData("value")}},{key:"setSelected",value:function(){var a=this.getDOMElement(),b="selected";if(a)a[b]=b;else{var c={};c[b]=b,this.addTemplateData(c)}}}]),b}(b);a.Option=c}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a){"use strict";var b=a.Component,c=a.Option,d=function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"select"},c),c.modificators=c.modificators||[],c.modificators.push("focusable");var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.focused=!1,d.attrName=c.attrName||"",d.setTitle(d.sandbox.getLocal("tab_languages")),d.setTemplate('<select id="<%=prefix%>-<%=id%>" name="<%=name%>" class="<%=prefix%>-select" title="<%=title%>" aria-labelledby="<%=labelledBy%>" tabindex="<%=tabIndex%>"><div data-children="option"></div></select>'),d.addTemplateData({title:c.title||"",id:c.id||"",name:c.name||"",tabIndex:c.tabIndex||0,labelledBy:c.labelledBy?d.prefix+"-label-"+c.labelledBy+d.getUID():""}),d.build(c),d}return _inherits(b,a),_createClass(b,[{key:"build",value:function(a){"function"==typeof a.onChange&&this.attachEvents({eventType:"change",handler:function(b){a.onChange(b)}}),this.attachEvents({eventType:"focus",handler:function(){this.focused=!0}}),this.attachEvents({eventType:"blur",handler:function(){this.focused=!1}})}},{key:"addOption",value:function(a){var b=new c(this.sandbox,{value:a.value,text:a.text,selected:a.selected});return this.registerChildren(b,"option"),b}},{key:"isFocused",value:function(){return this.focused}},{key:"getAttrName",value:function(){return this.attrName}},{key:"getValue",value:function(){return this.getDOMElement().value}}]),b}(b);a.Select=d}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){"use strict";var c=b.Utils,d=a.Component,e=a.Select,f=a.Label,g=function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"languages-select"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.setTemplate('<div class="<%=prefix%>-languages-select">	<div data-children="label"></div>	<div data-children="select"></div></div>'),d.registerModificatorsTypes({af_ZA:"af_ZA",ak_GH:"ak_GH",am_ET:"am_ET",an_ES:"an_ES",as_IN:"as_IN",ast_ES:"ast_ES",auto:"auto",az_AZ:"az_AZ",be_BY:"be_BY",bg_BG:"bg_BG",bn_IN:"bn_IN",br_FR:"br_FR",bs_BA:"bs_BA",ca_ES:"ca_ES",cs_CZ:"cs_CZ",csb_PL:"csb_PL",cv_RU:"cv_RU",cy_GB:"cy_GB",da_DK:"da_DK",de_AT:"de_AT",de_CH:"de_CH",de_DE:"de_DE",de_AI:"de_AI",dsb_DE:"dsb_DE",el_GR:"el_GR",en_AU:"en_AU",en_CA:"en_CA",en_GB:"en_GB",en_NZ:"en_NZ",en_US:"en_US",en_ZA:"en_ZA",en_AI:"en_AI",eo_EO:"eo_EO",es_AR:"es_AR",es_BO:"es_BO",es_CL:"es_CL",es_CO:"es_CO",es_CR:"es_CR",es_CU:"es_CU",es_DO:"es_DO",es_EC:"es_EC",es_ES:"es_ES",es_AI:"es_AI",es_GT:"es_GT",es_HN:"es_HN",es_MX:"es_MX",es_NI:"es_NI",es_PA:"es_PA",es_PE:"es_PE",es_PR:"es_PR",es_PY:"es_PY",es_SV:"es_SV",es_UY:"es_UY",es_VE:"es_VE",et_EE:"et_EE",eu_ES:"eu_ES",fi_FI:"fi_FI",fj_FJ:"fj_FJ",fo_FO:"fo_FO",fr_CA:"fr_CA",fr_FR:"fr_FR",fu_IT:"fu_IT",fy_NL:"fy_NL",ga_IE:"ga_IE",gd_GB:"gd_GB",gl_ES:"gl_ES",grc_GR:"grc_GR",gsc_FR:"gsc_FR",gu_IN:"gu_IN",ha_GH:"ha_GH",haw_US:"haw_US",hi_IN:"hi_IN",hl_PH:"hl_PH",hr_HR:"hr_HR",hsb_DE:"hsb_DE",ht_HT:"ht_HT",hu_HU:"hu_HU",hy_AM:"hy_AM",id_ID:"id_ID",is_IS:"is_IS",it_IT:"it_IT",ja_JP:"ja_JP",ka_GE:"ka_GE",kk_KZ:"kk_KZ",kn_IN:"kn_IN",ko_KR:"ko_KR",ku_TR:"ku_TR",ky_KG:"ky_KG",la_VA:"la_VA",lb_LU:"lb_LU",lg_UG:"lg_UG",ln_CD:"ln_CD",lt_LT:"lt_LT",lv_LV:"lv_LV",ma_IN:"ma_IN",mg_MG:"mg_MG",mi_NZ:"mi_NZ",mk_MK:"mk_MK",ml_IN:"ml_IN",mn_MN:"mn_MN",mo_BF:"mo_BF",mr_IN:"mr_IN",ms_MY:"ms_MY",mt_MT:"mt_MT",nb_NO:"nb_NO",nd_DE:"nd_DE",ne_NP:"ne_NP",nl_NL:"nl_NL",nn_NO:"nn_NO",nr_ZA:"nr_ZA",ns_ZA:"ns_ZA",oc_FR:"oc_FR",om_ET:"om_ET",or_IN:"or_IN",pa_IN:"pa_IN",pl_PL:"pl_PL",pt_BR:"pt_BR",pt_PT:"pt_PT",qu_BO:"qu_BO",qu_EC:"qu_EC",ro_MO:"ro_MO",ro_RO:"ro_RO",ru_RU:"ru_RU",ry_RU:"ry_RU",rw_RW:"rw_RW",sa_IN:"sa_IN",sc_IT:"sc_IT",se_NO:"se_NO",se_SE:"se_SE",shs_CA:"shs_CA",si_LK:"si_LK",sk_SK:"sk_SK",sl_SL:"sl_SL",smj_NO:"smj_NO",sn_ZW:"sn_ZW",so_SO:"so_SO",sq_AL:"sq_AL",sr_CY:"sr_CY",sr_LT:"sr_LT",ss_ZA:"ss_ZA",st_ZA:"st_ZA",sv_FI:"sv_FI",sv_SE:"sv_SE",sw_KE:"sw_KE",sw_TZ:"sw_TZ",ta_IN:"ta_IN",te_IN:"te_IN",tet_ID:"tet_ID",tg_TG:"tg_TG",ti_ER:"ti_ER",tk_TM:"tk_TM",tl_PH:"tl_PH",tn_ZA:"tn_ZA",tpi_PG:"tpi_PG",tr_TR:"tr_TR",ts_ZA:"ts_ZA",tt_RU:"tt_RU",uk_UA:"uk_UA",uz_LT:"uz_LT",uz_UZ:"uz_UZ",ve_ZA:"ve_ZA",vi_VN:"vi_VN",wa_BE:"wa_BE",xh_ZA:"xh_ZA",zh_CN:"zh_CN",zu_ZA:"zu_ZA",ar_SA:"ar_SA",fa_IR:"fa_IR",he_HE:"he_HE",ur_PK:"ur_PK",yi_YI:"yi_YI"}),d.build(c),d}return _inherits(b,a),_createClass(b,[{key:"build",value:function(a){this.buildLabel(a),this.buildSelect(a)}},{key:"buildLabel",value:function(a){var b=new f(this.sandbox,{id:a.id||"",labelFor:a.id||"",labelText:a.title||"",hide:!0});this.registerChildren(b,"label")}},{key:"buildSelect",value:function(a){var b=this;this.select=new e(this.sandbox,{title:a.title||"",id:a.id||"",name:a.title||"",labelledBy:a.id||"",tabIndex:a.tabIndex||0,attrName:a.attrName||"",onChange:a.onChange}),this.registerChildren(this.select,"select"),this.select.registerLifeCycleHandler("after","render",function(){b.buildOptions(),b.setFlag()}),this.proxyMethodsFrom(this.select,["isFocused"])}},{key:"buildOptions",value:function(){var a=this,b=c.sortLanguages(this.sandbox.getOption("langList")),d=this.sandbox.getOption("lang");b.forEach(function(b){a.select.addOption({value:b[0],text:b[1],selected:b[0]===d?!0:!1})})}},{key:"setFlag",value:function(a){var b=a||this.sandbox.getOption("lang");this.removeModificator(this.currentLang),this.currentLang=b,this.addModificator(this.currentLang)}},{key:"setLanguage",value:function(){var a=this.select.getChildren("option"),b=this.sandbox.getOption("lang");a.forEach(function(a){a.getValue()===b&&a.setSelected()}),this.setFlag()}}]),b}(d);a.LanguagesSelect=g}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){"use strict";{var c=(b.Utils,a.Component);b.UILib}a=a||{};var d=function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"page"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.setTemplate('<div class="<%=prefix%>-page <%=prefix%>--clearfix" id="<%=prefix%>-<%=role%>-<%=id%>" role="<%=role%>" aria-labelledby="<%=prefix%>-<%=ariaLabelledFor%>-<%=id%>">    <div class="<%=prefix%>-page__content">        <div data-children="body"></div>    </div></div>'),d.addTemplateData({id:c.id||"",role:c.role||"",ariaLabelledFor:c.ariaLabelledFor||""}),d.build(c),d}return _inherits(b,a),_createClass(b,[{key:"build",value:function(a){this.registerChildren(a.content,"body")}}]),b}(c);a.Page=d}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){var c=b.UILib,d=a.Component,e=b.Utils,f=b.UIMetrics,g=function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"dialog"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.mutationOptions={attributes:!0,attributeOldValue:!1,childList:!1,characterData:!1,characterDataOldValue:!1,subtree:!1},d.setTemplate('<div class="<%=prefix%>-dialog <%=themeClass%> <%=prefix%>-element" role="dialog" aria-modal="true" aria-labelledby="<%=prefix%>-header-title<%=id%>">	<div data-children="header"></div>	<div data-children="text-box"></div>	<div data-children="confirm-box"></div>	<div class="<%=prefix%>-body">		<div data-children="menu"></div>		<div data-children="content"></div>	</div></div>'),d.addTemplateData({themeClass:d.sandbox.getOption("themeClass"),id:""}),d.initialShift={},d.timeoutId=null,d.setInitialDialogCoords(),d.createMutationObservers(),d.build(c),d.registerLifeCycleHandler("after","show",function(){d.attachEvents(),d.setDialogCoords(),d.setFocusToFirstElement(),d.setPageScrollable(e.isPageScrollable()),d.timeoutId=setTimeout(function(){d.setDialogCoords()},0)}),d.registerLifeCycleHandler("before","hide",function(){d.clean(),d.setDialogTitle("")}),d.registerLifeCycleHandler("before","remove",function(){d.destroy()}),d}return _inherits(b,a),_createClass(b,[{key:"build",value:function(a){this.builder=a.builder;var b=this.builder.buildMenu({setDialogTitle:this.setDialogTitle.bind(this),setDialogCoords:this.setDialogCoords.bind(this)}),c=this.builder.buildContent({setFocusToFirstElement:this.setFocusToFirstElement.bind(this),setDialogTitle:this.setDialogTitle.bind(this),isDialogFocused:this.isDialogFocused.bind(this),isHeaderFocused:this.isHeaderFocused.bind(this)}),d=this.builder.buildHeader({closeDialogHandler:this.closeDialog.bind(this),dragStart:this.dragStart.bind(this),drag:this.drag.bind(this)}),e=this.builder.buildTextBox({closable:!0,setFocusToFirstElement:this.setFocusToFirstElement.bind(this)});this.registerChildren(d),this.registerChildren(e,"text-box"),this.registerChildren(b,"menu"),this.registerChildren(c,"content"),this.registerChildren(this.builder.buildFooter()),c&&b&&this.buildMenuButton(b,d,c),e.registerLifeCycleHandler("before","hide",function(){e.removeStateModificators()}),this.sandbox.subscribe("userDictionaryAction",function(a){this.handleShowMessage(a)},this),this.sandbox.subscribe("closeDialog",function(a){this.handleCloseDialog(a)},this)}},{key:"buildMenuButton",value:function(a,b,c){var d=this,e=b.buildMenuButton(function(){a.isVisible()?(a.hide(),c.show(),c.attachEvents(),c.setDialogTitle(""),c.setFocusToProblemItem(),c.setShouldScroll()):(a.show(),c.addModificator("hidden"),c.detachEvents(),c.unsetShouldScroll()),d.setDialogCoords()});a.registerLifeCycleHandler("after","show",function(){e.activate(),e.setTitle(d.sandbox.getLocal("btn_proofreadDialog")),e.setAriaLabel(d.sandbox.getLocal("btn_proofreadDialog"))}),a.registerLifeCycleHandler("after","hide",function(){e.deactivate(),e.setTitle(d.sandbox.getLocal("btn_settings")),e.setAriaLabel(d.sandbox.getLocal("btn_settings"))})}},{key:"showMenu",value:function(){var a=this.getChildren("content"),b=this.getChildren("menu");a&&a.hide(),b&&b.show()}},{key:"showContent",value:function(){var a=this.getChildren("menu"),b=this.getChildren("content");a&&a.hide(),b&&b.show()}},{key:"closeDialog",value:function(){var a=this.getChildren("menu"),b=this.getChildren("content"),c=this.getChildren("text-box");a&&a.hide(),b&&b.hide(),c&&c.hide(),this.hide()}},{key:"attachEvents",value:function(){this.sandbox.subscribe({eventType:"keydown",element:document,handler:this.trapKeyboard,context:this}),this.sandbox.subscribe({eventType:this.sandbox.getOption("isTouchDevice")?"orientationchange":"resize",element:window,handler:this.handleResize,context:this}),this.startMutationObservers()}},{key:"trapKeyboard",value:function(a){switch(a.keyCode){case 9:this.handleTabPress(a);break;case 27:this.handleEscPress(a)}}},{key:"handleTabPress",value:function(a){var b,c=this.isDialogFocused();c&&(b=this.getNextPrevByActive(this.getFocusableElements()),a.shiftKey?!b.first&&b.prev&&(this.focusPrev(b.prev),a.preventDefault()):!b.last&&b.next&&(this.focusNext(b.next),a.preventDefault()))}},{key:"isDialogFocused",value:function(){return this.getDialog().contains(document.activeElement)}},{key:"isHeaderFocused",value:function(){var a=this.getChildren("header"),b=a?a.getDOMElement():null;return b&&b.contains(document.activeElement)}},{key:"focusPrev",value:function(a){a&&a.focus()}},{key:"focusNext",value:function(a){a&&a.focus()}},{key:"handleEscPress",value:function(){this.closeDialog()}},{key:"startMutationObservers",value:function(){this.htmlMutationObserver&&this.bodyMutationObserver&&(this.htmlMutationObserver.observe(document.documentElement,this.mutationOptions),this.bodyMutationObserver.observe(document.body,this.mutationOptions))}},{key:"stopMutationObservers",value:function(){this.htmlMutationObserver&&this.bodyMutationObserver&&(this.htmlMutationObserver.disconnect(),this.bodyMutationObserver.disconnect())}},{key:"handleResize",value:function(){this.setDialogCoords()}},{key:"detachEvents",value:function(){this.sandbox.unsubscribe({eventType:"keydown",element:document,handler:this.trapKeyboard,context:this}),this.sandbox.unsubscribe({eventType:this.sandbox.getOption("isTouchDevice")?"orientationchange":"resize",element:window,handler:this.handleResize,context:this}),this.stopMutationObservers()}},{key:"handleShowMessage",value:function(a){var b,c,d;a.action&&(b=a.messagePostfix||"",c=this.sandbox.getLocal("message_"+a.status+"_"+a.action+b),d=a.replaceText?c.replace("%s",a.replaceText):c,this.sandbox.fire("showMessage",{message:d,modificator:a.status,type:"text"}))}},{key:"handleCloseDialog",value:function(a){a.except!==this.sandbox.getOption("uid")&&this.closeDialog()}},{key:"setInitialDialogCoords",value:function(){var a=this.sandbox.getOption("isIframe"),b=this.sandbox.getOption(a?"documentContainer":"container"),c=b.getBoundingClientRect();this.coords={left:c.right,top:c.top}}},{key:"createMutationObservers",value:function(){e.isMutationObserver()&&(this.htmlMutationObserver=new window.MutationObserver(this.handleMutations.bind(this)),this.bodyMutationObserver=new window.MutationObserver(this.handleMutations.bind(this)))}},{key:"handleMutations",value:function(){var a=e.isPageScrollable(),b=this.pageScrollable;b&&!a&&this.sandbox.getOption("globalProofreadDialog")&&this.closeDialog(),this.setPageScrollable(a)}},{key:"dragStart",value:function(a){var b=this.getDialog(),c=b.getBoundingClientRect();this.initialShift.left=a.clientX-c.left,this.initialShift.top=a.clientY-c.top}},{key:"getDialog",value:function(){return this.getDOMElement()}},{key:"drag",value:function(a){var b=a.clientX-this.initialShift.left,c=a.clientY-this.initialShift.top;this.setDialogCoords(b,c)}},{key:"setDialogCoords",value:function(a,b){var a=void 0!==a?a:this.coords.left,b=void 0!==b?b:this.coords.top,d=this.getDialog(),e=this.calculateDialogCoords(a,b);this.coords.left=e.left,this.coords.top=e.top,c.setPosition(d,e.left,e.top)}},{key:"calculateDialogCoords",value:function(a,b){var c=this.getDialog(),d=c.getBoundingClientRect(),e=f.getWindowSize(),g=e.width-(a+(d.right-d.left)),h=e.height-(b+(d.bottom-d.top));return 0>g&&(a-=Math.abs(g)),0>h&&(b-=Math.abs(h)),0>a&&(a=0),0>b&&(b=0),{left:a,top:b}}},{key:"setDialogTitle",value:function(a){var b=this.getChildren("header");b&&b.setTitle(a)}},{key:"setFocusToFirstElement",value:function(){var a=this.getFocusableElements();a.length&&a[0].focus()}},{key:"setPageScrollable",value:function(a){this.pageScrollable=a}},{key:"clean",value:function(){this.detachEvents(),clearTimeout(this.timeoutId)}},{key:"destroy",value:function(){this.clean()}}]),b}(d);a.Dialog=g}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){var c=a.Component,d=b.UILib,e=function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"header-title"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.dragStart=c.dragStart,d.drag=c.drag,d.isTouchDevice=d.sandbox.getOption("isTouchDevice"),d.setTemplate('<div class="<%=prefix%>-header-title" id="<%=prefix%>-header-title<%=id%>">	<div class="<%=prefix%>-header-title__text"><%=title%></div></div>'),d.addTemplateData({title:c.title||"",id:""}),d.build(),d}return _inherits(b,a),_createClass(b,[{key:"build",value:function(){var a=this;this.attachDraggableEvents(),this.registerLifeCycleHandler("before","remove",function(){a.destroy()})}},{key:"attachDraggableEvents",value:function(){this.dragStart&&this.drag&&(this.attachEvents({eventType:this.isTouchDevice?"touchstart":"mousedown",handler:function(a){this.attachDocumentEvents(),this.dragStart(a)}}),this.attachEvents({eventType:"dragstart",handler:function(){return!1}}))}},{key:"attachDocumentEvents",value:function(){this.sandbox.subscribe({eventType:this.isTouchDevice?"touchmove":"mousemove",element:document,handler:this.handleDrag,context:this}),this.sandbox.subscribe({eventType:this.isTouchDevice?"touchend":"mouseup",element:document,handler:this.handleDragEnd,context:this})}},{key:"handleDrag",value:function(a){this.drag(a)}},{key:"handleDragEnd",value:function(){this.detachDocumentEvents()}},{key:"detachDocumentEvents",value:function(){this.sandbox.unsubscribe({eventType:this.isTouchDevice?"touchmove":"mousemove",element:document,handler:this.handleDrag,context:this}),this.sandbox.unsubscribe({eventType:this.isTouchDevice?"touchend":"mouseup",element:document,handler:this.handleDragEnd,context:this})
}},{key:"setTitle",value:function(a){d.text(this._element.firstElementChild,a)}},{key:"destroy",value:function(){this.detachDocumentEvents()}}]),b}(c);a.HeaderTitle=e}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){var c=(b.UILib,a.Component),d=(b.Utils,a.HeaderTitle),e=a.Icon,f=a.Button,g=function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"header"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.setTemplate('<div class="<%=prefix%>-header">	<div class="<%=prefix%>-header-menu">		<div data-children="menuButton"></div>	</div>	<div class="<%=prefix%>-header-close">		<div data-children="closeDialogButton"></div>	</div>	<div data-children="header-title"></div></div>'),d.addTemplateData({title:c.title||"",id:""}),d.build(c),d}return _inherits(b,a),_createClass(b,[{key:"build",value:function(a){a.closeDialogHandler&&this.buildCloseDialogButton(a.closeDialogHandler),this.buildHeaderTitle(a)}},{key:"createIcon",value:function(a){var b=new e(this.sandbox,{iconName:a});return this.registerBemElements(b),b}},{key:"buildMenuButton",value:function(a){return this.menuIcon=this.createIcon("menu"),this.menuButton=new f(this.sandbox,{title:this.sandbox.getLocal("btn_settings"),icon:this.menuIcon,onClick:a}),this.registerChildren(this.menuButton,"menuButton"),this.menuButton}},{key:"buildCloseDialogButton",value:function(a){this.registerChildren(new f(this.sandbox,{title:this.sandbox.getLocal("btn_close"),icon:this.createIcon("close"),onClick:a}),"closeDialogButton")}},{key:"buildHeaderTitle",value:function(a){var b=new d(this.sandbox,{title:a.title||"",dragStart:a.dragStart,drag:a.drag});this.registerChildren(b,"header-title"),this.proxyMethodsFrom(b,["setTitle"])}}]),b}(c);a.Header=g}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){"use strict";var c=b.UILib,d=a.Component,e=(b.Utils,function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"text-box"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.setTemplate('<div class="<%=prefix%>-text-box"><%=text%></div>'),d.addTemplateData({text:c.text||d.sandbox.getOption("userDictionaryName")||""}),d}return _inherits(b,a),_createClass(b,[{key:"setText",value:function(a){c.text(this._element,a)}}]),b}(d));a.TextBox=e}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a){"use strict";var b=a.Component,c=a.Button,d=a.Icon,e=a.TextBox,f=function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"message-box"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.setFocusToFirstElement=c.setFocusToFirstElement||function(){},d.setTemplate('<div class="<%=prefix%>-message-box">    <div data-children="icon-box"></div>    <div data-children="text-box"></div>    <div data-children="close-message-box-button"></div></div>'),d.addTemplateData({}),d.stateModificators={success:"success",error:"error"},d.registerModificatorsTypes(d.stateModificators),d.timeoutDelay=3e3,d.timeoutId=null,d.closable=c.closable||!1,d.type=c.type||"text",d.build(),d.sandbox.subscribe("showMessage",function(a){a.type===this.type&&this.handleShowMessage(a)},d),d.sandbox.subscribe("hideMessage",function(a){this.handleHideMessage(a)},d),d}return _inherits(b,a),_createClass(b,[{key:"build",value:function(){this.buildIconBox(),this.buildTextBox(),this.closable&&this.buildCloseMessageBoxButton()}},{key:"buildIconBox",value:function(){this.registerChildren(this.createIcon("message"),"icon-box")}},{key:"buildTextBox",value:function(){this.registerChildren(new e(this.sandbox),"text-box")}},{key:"buildCloseMessageBoxButton",value:function(){this.registerChildren(new c(this.sandbox,{title:this.sandbox.getLocal("btn_close"),icon:this.createIcon("close"),onClick:this.handleCloseMessageButtonClick.bind(this)}),"close-message-box-button")}},{key:"createIcon",value:function(a){var b=new d(this.sandbox,{iconName:a});return this.registerBemElements(b),b}},{key:"handleShowMessage",value:function(a){var b=this,c=this.getChildren("icon-box");this.sandbox.fire("hideMessage",{}),a.modificator in this.stateModificators&&(this.addModificator(a.modificator),c.addModificator(a.modificator)),this.setText(a.message),this.show(),this.closable&&(this.timeoutId=setTimeout(function(){b.hide()},this.timeoutDelay))}},{key:"handleHideMessage",value:function(){this.clearTimeout(),this.hide()}},{key:"handleCloseMessageButtonClick",value:function(){this.handleHideMessage(),this.setFocusToFirstElement()}},{key:"setText",value:function(a){this.getChildren("text-box").setText(a)}},{key:"removeStateModificators",value:function(){var a=this.getChildren("icon-box");for(var b in this.stateModificators)this.removeModificator(this.stateModificators[b]),a.removeModificator(this.stateModificators[b])}},{key:"clearTimeout",value:function(a){function b(){return a.apply(this,arguments)}return b.toString=function(){return a.toString()},b}(function(){clearTimeout(this.timeoutId),this.timeoutId=null})}]),b}(b);a.MessageBox=f}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a){"use strict";var b=a.Component,c=a.Button,d=a.Icon,e=a.ItemList,f=function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"action-items"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.marginSize=0,d.controlActions=c.control||[],d.staticActions=c.static||[],d.tabIndex=c.hasOwnProperty("tabIndex")?c.tabIndex:-1,d.handleActionItemClick=c.handleActionItemClick||function(){},d.setTemplate('<div class="<%=prefix%>-<%=name%>-overlay">	<div class="<%=prefix%>-<%=name%>">		<div class="<%=prefix%>-<%=name%>__first-action">			<div data-children="first-action"></div>		</div>		<div class="<%=prefix%>-<%=name%>__other-actions <%=prefix%>--clearfix">			<div class="<%=prefix%>-<%=name%>__second-action">				<div data-children="second-action"></div>			</div>			<div class="<%=prefix%>-<%=name%>__more-actions">				<div data-children="more-actions-button"></div>				<div data-children="more-actions-list"></div>			</div>		</div>	</div></div>'),d.build(),d.handleFirstActionMarginSize(),d}return _inherits(b,a),_createClass(b,[{key:"build",value:function(){this.buildFirstAction(),this.buildSecondAction(),this.buildMoreActions()}},{key:"buildFirstAction",value:function(){var a,b;0!==this.controlActions.length&&(a=this.controlActions[0],b=this.createVisibleActionItem({action:a,text:!0}),b.registerModificatorsTypes({margin:"margin",largeMargin:"largeMargin"}),this.registerChildren(b,"first-action"))}},{key:"createVisibleActionItem",value:function(a){var b=this,d=a.action,e=a.text,f=a.handler,g=a.icon,h=new c(this.sandbox,{title:this.sandbox.getLocal("btn_"+d.getName()),icon:g||this.createIcon(d.getName()),text:e?this.sandbox.getLocal("btn_"+d.getName()):"",modificators:e?["text"]:[],tabIndex:this.tabIndex,ariaLevel:1,onClick:function(a){f?f(a):(d.call(a),b.handleActionItemClick())}});return this.attachPointerEvents(h),h}},{key:"createIcon",value:function(a){var b=new d(this.sandbox,{iconName:a});return this.registerBemElements(b),b}},{key:"buildSecondAction",value:function(){var a,b;this.controlActions.length<2||(this.marginSize++,a=this.controlActions[1],b=this.createVisibleActionItem({action:a,text:!1}),this.registerChildren(b,"second-action"))}},{key:"buildMoreActions",value:function(){var a,b=[].concat(this.controlActions.slice(2),this.staticActions);0!==b.length&&(this.marginSize++,a=this.buildMoreActionsList(b),a.hide(),this.buildMoreActionsButton(a))}},{key:"buildMoreActionsList",value:function(a){var b=this,c=new e(this.sandbox,{role:"group",itemRole:"none"});return this.registerChildren(c,"more-actions-list"),a.forEach(function(a){b.createMoreActionsItem(a)}),c}},{key:"createMoreActionsItem",value:function(a){var b,c=this,d=this.getChildren("more-actions-list");b=d.addItem({title:this.sandbox.getLocal("btn_"+a.getName()),icon:this.createIcon(a.getIconName?a.getIconName():a.getName()),text:this.sandbox.getLocal("btn_"+a.getName()),modificators:["text"],tabIndex:this.tabIndex,role:"treeitem",ariaLevel:1,onClick:function(b){a.call(b),c.handleActionItemClick()}}),this.attachPointerEvents(b)}},{key:"attachPointerEvents",value:function(a){a.attachEvents([{eventType:"mousedown",handler:function(a){return a.preventDefault()}}]),a.attachEvents([{eventType:"pointerdown",handler:function(a){return a.preventDefault()}}])}},{key:"buildMoreActionsButton",value:function(){var a=this,b=this.createVisibleActionItem({action:{getName:function(){return"showMore"}},text:!1,handler:function(){a.toggleMoreActionsList()},icon:new d(this.sandbox,{iconName:"more"})});return this.registerChildren(b,"more-actions-button"),b}},{key:"toggleMoreActionsList",value:function(){var a=this.getChildren("more-actions-list");a&&(a.isVisible()?this.hideMoreActionsList():this.showMoreActionsList())}},{key:"showMoreActionsList",value:function(){var a=this.getChildren("more-actions-list"),b=this.getChildren("more-actions-button");a&&b&&(a.show(),b.setTitle(this.sandbox.getLocal("btn_showLess")))}},{key:"hideMoreActionsList",value:function(){var a=this.getChildren("more-actions-list"),b=this.getChildren("more-actions-button");a&&b&&(a.hide(),b.setTitle(this.sandbox.getLocal("btn_showMore")))}},{key:"handleFirstActionMarginSize",value:function(){var a=this.getChildren("first-action");a&&0!==this.marginSize&&a.addModificator(1===this.marginSize?"margin":"largeMargin")}},{key:"setFocus",value:function(){this.getChildren("more-actions-button").setFocus()}}]),b}(b);a.ActionItems=f}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a){"use strict";var b=a.Component,c=a.TextInput,d=a.Button,e=function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"create-section"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.setTemplate('<div class="<%=prefix%>-create-section">	<div class="<%=prefix%>-dictionaries__input">		<div data-children="dictionaryNameInput"></div>	</div>	<div class="<%=prefix%>-dictionaries__button-table-placeholder"></div>	<div class="<%=prefix%>-dictionaries__button-holder">		<div data-children="createDictionaryButton"></div>	</div>	<div class="<%=prefix%>-dictionaries__button-holder">		<div data-children="connectDictionaryButton"></div>	</div></div>'),d.build(),d}return _inherits(b,a),_createClass(b,[{key:"build",value:function(){var a=this;this.buildDictionaryNameInput(),this.buildCreateDictionaryButton(),this.buildConnectDictionaryButton(),this.resetCreateElements(),this.registerLifeCycleHandler("before","show",function(){a.resetCreateElements()})}},{key:"buildDictionaryNameInput",value:function(){var a=new c(this.sandbox,{id:"dictionaryNameInput",maxLength:"64",placeholder:this.sandbox.getLocal("placeholder_fieldNameDic"),onInput:this.handleInput.bind(this)});this.registerChildren(a,"dictionaryNameInput"),this.proxyMethodsFrom(a,["setFocus"])}},{key:"handleInput",value:function(){var a=this.getChildren("dictionaryNameInput").getValue(),b=this.getChildren("createDictionaryButton"),c=this.getChildren("connectDictionaryButton");a?(b.enable(),c.enable()):(b.disable(),c.disable())}},{key:"buildCreateDictionaryButton",value:function(){this.registerChildren(new d(this.sandbox,{title:this.sandbox.getLocal("btn_createDic"),text:this.sandbox.getLocal("btn_createDic"),modificators:["text"],onClick:this.handleCreateDictionary.bind(this)}),"createDictionaryButton")}},{key:"handleCreateDictionary",value:function(){var a=this.getChildren("dictionaryNameInput").getValue();a&&this.sandbox.fire("createUserDictionary",{name:a})}},{key:"buildConnectDictionaryButton",value:function(){this.registerChildren(new d(this.sandbox,{title:this.sandbox.getLocal("btn_connectDic"),text:this.sandbox.getLocal("btn_connectDic"),modificators:["text","primary"],onClick:this.handleConnectDictionary.bind(this)}),"connectDictionaryButton")}},{key:"handleConnectDictionary",value:function(){var a=this.getChildren("dictionaryNameInput").getValue();a&&this.sandbox.fire("restoreUserDictionary",{name:a})}},{key:"resetCreateElements",value:function(){this.getChildren("dictionaryNameInput").setValue(""),this.getChildren("createDictionaryButton").disable(""),this.getChildren("connectDictionaryButton").disable("")}}]),b}(b);a.CreateSection=e}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a){"use strict";var b=a.Component,c=a.TextBox,d=(a.Button,a.Icon,a.ActionItems),e=function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"delete-section"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.setTemplate('<div class="<%=prefix%>-delete-section">	<div class="<%=prefix%>-dictionaries__text-box">		<div data-children="dictionaryNameTextBox"></div>	</div>	<div data-children="action-items"></div></div>'),d.build(c),d}return _inherits(b,a),_createClass(b,[{key:"build",value:function(a){var b=this;this.buildDictionaryNameTextBox(),this.buildActionItems(a),this.registerLifeCycleHandler("before","show",function(){b.setDictionaryName()})}},{key:"buildDictionaryNameTextBox",value:function(){this.registerChildren(new c(this.sandbox,{}),"dictionaryNameTextBox")}},{key:"buildActionItems",value:function(a){var b=[{getName:function(){return"renameDic"},getIconName:function(){return"edit"},call:a.changeToRenameSection},{getName:function(){return"disconnectDic"},getIconName:function(){return"disconnect"},call:this.handleDisconnectDictionary.bind(this)},{getName:function(){return"deleteDic"},getIconName:function(){return"trash"},call:this.handleDeleteDictionary.bind(this)}],c=new d(this.sandbox,{"static":b,tabIndex:0,handleActionItemClick:function(){c.hideMoreActionsList()}});this.registerChildren(c,"action-items"),this.proxyMethodsFrom(c,["setFocus"])}},{key:"handleDisconnectDictionary",value:function(){var a=this.sandbox.getOption("userDictionaryName");a&&this.sandbox.fire("disconnectFromUserDictionary",{name:a})}},{key:"handleDeleteDictionary",value:function(){var a=this.sandbox.getOption("userDictionaryName");a&&this.sandbox.fire("removeUserDictionary",{name:a})}},{key:"setDictionaryName",value:function(){var a=this.sandbox.getOption("userDictionaryName");this.getChildren("dictionaryNameTextBox").setText(a)}}]),b}(b);a.DeleteSection=e}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a){"use strict";var b=a.Component,c=a.TextInput,d=a.Button,e=function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"rename-section"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.setTemplate('<div class="<%=prefix%>-rename-section">	<div class="<%=prefix%>-dictionaries__input">		<div data-children="renameDictionaryInput"></div>	</div>	<div class="<%=prefix%>-dictionaries__button-table-placeholder"></div>	<div class="<%=prefix%>-dictionaries__button-holder">		<div data-children="cancelRenameDictionaryButton"></div>	</div>	<div class="<%=prefix%>-dictionaries__button-holder">		<div data-children="renameDictionaryButton"></div>	</div></div>'),d.build(c),d}return _inherits(b,a),_createClass(b,[{key:"build",value:function(a){var b=this;this.buildRenameDictionaryInput(),this.buildRenameDictionaryButton(),this.buildCancelRenameDictionaryButton(a),this.registerLifeCycleHandler("before","show",function(){b.activateRenameElements()})}},{key:"buildRenameDictionaryInput",value:function(){var a=new c(this.sandbox,{id:"renameDictionaryInput",maxLength:"64",placeholder:this.sandbox.getLocal("placeholder_fieldNameDic"),onInput:this.handleInput.bind(this)});this.registerChildren(a,"renameDictionaryInput"),this.proxyMethodsFrom(a,["setFocus"])}},{key:"handleInput",value:function(){var a=this.getChildren("renameDictionaryInput").getValue(),b=this.getChildren("renameDictionaryButton");a?b.enable():b.disable()}},{key:"buildRenameDictionaryButton",value:function(){this.registerChildren(new d(this.sandbox,{title:this.sandbox.getLocal("btn_renameDic"),text:this.sandbox.getLocal("btn_renameDic"),modificators:["text","primary"],onClick:this.handleRenameDictionary.bind(this)}),"renameDictionaryButton")}},{key:"handleRenameDictionary",value:function(){var a=this.getChildren("renameDictionaryInput").getValue();a&&this.sandbox.fire("renameUserDictionary",{newName:a})}},{key:"buildCancelRenameDictionaryButton",value:function(a){this.registerChildren(new d(this.sandbox,{title:this.sandbox.getLocal("btn_cancel"),text:this.sandbox.getLocal("btn_cancel"),modificators:["text"],onClick:a.changeToDeleteSection}),"cancelRenameDictionaryButton")}},{key:"activateRenameElements",value:function(){var a=this.sandbox.getOption("userDictionaryName");this.getChildren("renameDictionaryInput").setValue(a),this.getChildren("renameDictionaryButton").enable()}}]),b}(b);a.RenameSection=e}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){"use strict";var c=(b.UILib,a.Component),d=b.Utils,e=a.Icon,f=a.Button,g=function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"word-item"},c);var e=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return e.text=c.text?d.escapeHTML(c.text):"",e.setTemplate('<div class="<%=prefix%>-word-item" role="gridcell">    <span class="<%=prefix%>-word-item__text"><%=text%></span>    <div data-children="deleteWordButton"></div></div>'),e.addTemplateData({text:e.text}),e.build(c),e}return _inherits(b,a),_createClass(b,[{key:"build",value:function(a){this.buildDeleteButton(a),this.proxyMethodsFrom(this.getChildren("deleteWordButton"),["enable","disable"])}},{key:"buildDeleteButton",value:function(a){this.registerChildren(new f(this.sandbox,{title:this.sandbox.getLocal("btn_deleteWord"),icon:this.createIcon("close"),tabIndex:-1,ariaLabel:this.sandbox.getLocal("btn_deleteWord")+" "+this.text,onClick:a.handleDeleteWord}),"deleteWordButton")}},{key:"createIcon",value:function(a){var b=new e(this.sandbox,{iconName:a});return b}}]),b}(c);a.WordItem=g}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),WEBSPELLCHECKER.CORE.UI=WEBSPELLCHECKER.CORE.UI||{},function(a,b){"use strict";{var c=(b.UILib,a.Component);a.Icon,b.Utils}a=a||{};var d=function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"about"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.setTemplate('<div class="<%=prefix%>-about">	<div class="<%=prefix%>-about__title"><%=title%></div>	<div class="<%=prefix%>-about__logo">		<img alt="logo" title="logo" src="<%=logoPath%>">	</div>	<div class="<%=prefix%>-about__text"><%=textVersion%></div>	<div class="<%=prefix%>-copyright"><%=textCopyrights%></div></div>'),d.addTemplateData({textVersion:a.getLocal("version")+a.getOption("wscVersion"),textCopyrights:a.getLocal("text_copyrights"),logoPath:a.getLogo(),title:d.sandbox.getLocal("about")}),d}return _inherits(b,a),b}(c);a.About=d}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),WEBSPELLCHECKER.CORE.UI=WEBSPELLCHECKER.CORE.UI||{},function(a){"use strict";var b=a.Component,c=a.LanguagesSelect;a=a||{};var d=function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"languages"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.setTemplate('<div class="<%=prefix%>-languages">    <div class="<%=prefix%>-languages__title"><%=title%></div>    <div data-children="languages-select"></div></div>'),d.addTemplateData({title:d.sandbox.getLocal("tab_languages")}),d.build(),d}return _inherits(b,a),_createClass(b,[{key:"build",value:function(){var a=this;this.languagesSelect=new c(this.sandbox,{title:this.sandbox.getLocal("tab_languages"),id:"languages",attrName:"lang",onChange:function(b){a.sandbox.fire("commitOptions",{changedOptions:{lang:b.target.value}})}}),this.registerBemElements(this.languagesSelect),this.registerChildren(this.languagesSelect,"languages-select")}},{key:"defineValues",value:function(){this.languagesSelect&&this.languagesSelect.setLanguage()}}]),b}(b);a.Languages=d}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),WEBSPELLCHECKER.CORE.UI=WEBSPELLCHECKER.CORE.UI||{},function(a){"use strict";var b=a.Component,c=a.Checkbox,d=a.ItemList;a=a||{};var e=function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"generaloptions"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.setTemplate('<div class="<%=prefix%>-options">    <div class="<%=prefix%>-options__title"><%=title%></div>    <div data-children="general-list"></div></div>'),d.generalOptions=d.sandbox.getOption("generalOptions"),d.addTemplateData({title:d.sandbox.getLocal("tab_general")}),d.build(),d}return _inherits(b,a),_createClass(b,[{key:"build",value:function(){this.generalOptionsList=this.buildGeneralOptionsList(),this.registerBemElements(this.generalOptionsList),this.registerChildren(this.generalOptionsList,"general-list")}},{key:"buildGeneralOptionsList",value:function(){var a=this,b=null,e=new d(this.sandbox,{role:"group",itemRole:"none",ariaLabel:this.sandbox.getLocal("tab_general")});return this.generalOptions.forEach(function(d){b=new c(a.sandbox,{value:d,placeholder:a.sandbox.getLocal("label_"+d),id:"general-"+d,attrName:d,onChange:function(b){var c={};c[b.target.value]=b.target.checked,a.sandbox.fire("commitOptions",{changedOptions:c})}}),e.addItem(b)}),e}},{key:"defineValues",value:function(){var a=this,b=this.generalOptionsList.getChildren("item");b=Array.isArray(b)?b:[b],b.forEach(function(b){var c=b.getChildren("content"),d=c.getValue(),e=!!a.sandbox.getOption(d);c.setChecked(e)})}}]),b}(b);a.GeneralOptions=e}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),WEBSPELLCHECKER.CORE.UI=WEBSPELLCHECKER.CORE.UI||{},function(a){"use strict";var b=a.Component,c=a.Checkbox,d=a.ItemList;a=a||{};var e=function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"options"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.setTemplate('<div class="<%=prefix%>-options">    <div class="<%=prefix%>-options__title"><%=title%></div>    <div data-children="options-list"></div></div>'),d.proofreadOptions=d.sandbox.getOption("proofreadOptions"),d.addTemplateData({title:d.sandbox.getLocal("tab_options")}),d.build(),d}return _inherits(b,a),_createClass(b,[{key:"build",value:function(){this.optionsList=this.buildOptionsList(),this.registerBemElements(this.optionsList),this.registerChildren(this.optionsList,"options-list")}},{key:"buildOptionsList",value:function(){var a=this,b=null,e=new d(this.sandbox,{role:"group",itemRole:"none",ariaLabel:this.sandbox.getLocal("tab_options")});return this.proofreadOptions.forEach(function(d){b=new c(a.sandbox,{value:d,placeholder:a.sandbox.getLocal("label_"+d),id:"option-"+d,attrName:d,onChange:function(b){var c={};c[b.target.value]=b.target.checked,a.sandbox.fire("commitOptions",{changedOptions:c})}}),e.addItem(b)}),e}},{key:"defineValues",value:function(){var a=this,b=this.optionsList.getChildren("item");b=Array.isArray(b)?b:[b],b.forEach(function(b){var c=b.getChildren("content"),d=c.getValue(),e=!!a.sandbox.getOption(d);c.setChecked(e)})}}]),b}(b);a.Options=e}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a){"use strict";var b=a.Component,c=a.Button,d=a.TextInput,e=a.ItemList,f=a.WordItem,g=a.CreateSection,h=a.DeleteSection,i=a.RenameSection,j=function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"dictionaries"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.setTemplate('<div class="<%=prefix%>-dictionaries">    <div class="<%=prefix%>-dictionaries__preferences" style="<%=preferencesStyle%>">        <div data-children="createSection"></div>        <div data-children="deleteSection"></div>        <div data-children="renameSection"></div>        <div class="<%=prefix%>-dictionaries__preferences-actions">            <div class="<%=prefix%>-dictionaries__input">                <div data-children="dictionaryNameInput"></div>            </div>            <div class="<%=prefix%>-dictionaries__buttons">                <div data-children="createDictionaryButton"></div>                <div data-children="connectDictionaryButton"></div>                <div data-children="disconnectDictionaryButton"></div>            </div>        </div>        <div class="<%=prefix%>-dictionaries__buttons">            <div data-children="deleteDictionaryButton"></div>            <div data-children="renameDictionaryButton"></div>        </div>    </div>    <div class="<%=prefix%>-dictionaries__words" style="<%=wordsStyle%>">        <div class="<%=prefix%>-dictionaries__words-actions">            <div class="<%=prefix%>-dictionaries__input">                <div data-children="addWordInput"></div>            </div>            <div class="<%=prefix%>-dictionaries__button-holder">                <div data-children="addToDictionaryButton"></div>            </div>        </div>        <div data-children="words-list"></div>    </div></div>'),d.udWordsItems={},d.disableDictionariesPreferences=d.sandbox.getOption("disableDictionariesPreferences"),d.dictionariesPreferencesSections=["createSection","deleteSection","renameSection"],d.setDialogTitle=c.setDialogTitle||function(){},d.setDialogCoords=c.setDialogCoords||function(){},d.addTemplateData({preferencesStyle:d.disableDictionariesPreferences?"display: none;":"",wordsStyle:d.disableDictionariesPreferences?"top: 26px":""}),d.registerModificatorsTypes({createSection:"createSection",deleteSection:"deleteSection",renameSection:"renameSection"}),d.build(),d.changeDictionarySection({focus:!1}),d.sandbox.subscribe("userDictionaryAction",function(a){this.handleUserDictionaryAction(a)},d),d}return _inherits(b,a),_createClass(b,[{key:"build",value:function(){var a=this;this.buildDictionariesPreferencesSection(),this.buildDictionariesWordsSection(),this.registerLifeCycleHandler("before","show",function(){a.getUserDictionary()}),this.registerLifeCycleHandler("after","show",function(){a.setFocusToActiveSection(),a.setDialogTitle(a.sandbox.getLocal("btn_dictionaries")),a.setDialogCoords()}),this.registerLifeCycleHandler("before","remove",function(){a.destroy()})}},{key:"buildDictionariesPreferencesSection",value:function(){this.disableDictionariesPreferences||(this.buildCreateSection(),this.buildDeleteSection(),this.buildRenameSection())}},{key:"buildCreateSection",value:function(){this.registerChildren(new g(this.sandbox,{}),"createSection")}},{key:"buildDeleteSection",value:function(){this.registerChildren(new h(this.sandbox,{hide:!0,changeToRenameSection:this.changeToRenameSection.bind(this)}),"deleteSection")}},{key:"changeToRenameSection",value:function(){this.changeToSection("renameSection"),this.getChildren("renameSection").setFocus()}},{key:"changeToSection",value:function(a){for(var b,c,d=0;d<this.dictionariesPreferencesSections.length;d++)b=this.dictionariesPreferencesSections[d],c=this.getChildren(b),c&&(this.removeModificator(b),a===b?(c.show(),this.addModificator(a)):c.hide())}},{key:"buildRenameSection",value:function(){this.registerChildren(new i(this.sandbox,{changeToDeleteSection:this.changeToDeleteSection.bind(this),hide:!0}),"renameSection")}},{key:"changeToDeleteSection",value:function(){this.changeToSection("deleteSection"),this.getChildren("deleteSection").setFocus()}},{key:"buildDictionariesWordsSection",value:function(){this.buildAddWordInput(),this.buildAddToDictionaryButton(),this.buildWordsList(),this.resetAddWordElements()}},{key:"buildAddWordInput",value:function(){this.registerChildren(new d(this.sandbox,{id:"addWordInput",maxLength:"64",placeholder:this.sandbox.getLocal("placeholder_fieldAddWord"),onKeydown:this.handleKeydown.bind(this),onInput:this.handleInput.bind(this)}),"addWordInput")}},{key:"handleKeydown",value:function(a){var b=a.keyCode||a.which,c=this.getChildren("addWordInput").getValue(),d=this.getChildren("addToDictionaryButton");13===b&&c&&!d.disabled&&this.handleAddToDictionary()}},{key:"handleInput",value:function(){var a=this.getChildren("addWordInput").getValue(),b=this.getChildren("addToDictionaryButton");a?b.enable():b.disable()}},{key:"buildAddToDictionaryButton",value:function(){this.registerChildren(new c(this.sandbox,{title:this.sandbox.getLocal("btn_addWord"),text:this.sandbox.getLocal("btn_add"),modificators:["text","primary"],onClick:this.handleAddToDictionary.bind(this)}),"addToDictionaryButton")}},{key:"handleAddToDictionary",value:function(){var a=this.getChildren("addWordInput").getValue(),b=this.sandbox.getRegExp("wordBoundaryRegexAndQuotes");if(a){if(b.test(a))return void this.sandbox.fire("userDictionaryAction",{request:{},response:{},action:"wordWithBannedSymbols",status:"error",replaceText:a,messagePostfix:"Dic"});if(this.udWordsItems[a])return this.sandbox.fire("userDictionaryAction",{request:{},response:{},action:"wordAlreadyAdded",status:"success",replaceText:a,messagePostfix:"Dic"}),void this.resetAddWordElements();this.resetAddWordElements(),this.sandbox.fire("addWordToUserDictionary",{word:a})}}},{key:"resetAddWordElements",value:function(){this.getChildren("addWordInput").setValue(""),this.getChildren("addToDictionaryButton").disable()}},{key:"buildWordsList",value:function(){this.registerChildren(new e(this.sandbox,{role:"grid",itemRole:"row",ariaLabel:this.sandbox.getLocal("text_dictionaryWords"),changeTabIndexOnFocus:!0,onFocusin:function(){}.bind(this),onFocusout:function(){}.bind(this)}),"words-list")}},{key:"getUserDictionary",value:function(){var a=this;this.sandbox.fire("getUserDictionary",{callback:function(b){b.error||(a.clearWordsList(),a.buildWordsListItems(b.wordlist))}})}},{key:"clearWordsList",value:function(){this.getChildren("words-list").removeAllItems(),this.udWordsItems={}}},{key:"buildWordsListItems",value:function(a){for(var b=0;b<a.length;b++)this.createWordItem(a[b])}},{key:"createWordItem",value:function(a){var b=this,c=this.getChildren("words-list"),d=this.getChildren("addWordInput"),e=new f(this.sandbox,{text:a,handleDeleteWord:function(){c.handleNextKeyPress(),b.sandbox.fire("deleteWordFromUserDictionary",{word:a}),e.disable(),!c.getChildren("item")&&d.setFocus()}});c.addItem(e),this.udWordsItems[a]=e,c.getFocusableElements().length||this.activateFirstWord()}},{key:"activateFirstWord",value:function(){var a,b=this.getChildren("words-list"),c=b.getChildren("item");c&&(a=c.length?c[0]:c),a&&a.getChildren("word-item").getChildren("deleteWordButton").setTabIndex(0)}},{key:"setFocusToActiveSection",value:function(){for(var a,b,c=0;c<this.dictionariesPreferencesSections.length;c++)if(a=this.dictionariesPreferencesSections[c],b=this.getChildren(a),b&&b.isVisible())return void(b.setFocus&&b.setFocus())}},{key:"changeDictionarySection",value:function(a){var b,c;this.disableDictionariesPreferences||(b=this.sandbox.getOption("userDictionaryName"),c=b?"deleteSection":"createSection",this.changeToSection(c),a.focus&&this.getChildren(c).setFocus())}},{key:"handleUserDictionaryAction",value:function(a){this.toggleDictionarySections(a),this.toggleWordsList(a),this.handleAddWordAction(a),this.handleDeleteWordAction(a)}},{key:"toggleDictionarySections",value:function(a){var b=["create","restore","rename","disconnect","remove"];a.action&&"error"!==a.status&&b.includes(a.action)&&this.changeDictionarySection({focus:!0})}},{key:"toggleWordsList",value:function(a){if(a.action&&"error"!==a.status)switch(a.action){case"restore":this.clearWordsList(),this.buildWordsListItems(a.response.wordlist);break;case"disconnect":this.clearWordsList();break;case"remove":this.clearWordsList()}}},{key:"handleAddWordAction",value:function(a){a.action&&"addWord"===a.action&&"error"!==a.status&&this.createWordItem(a.request.word)
}},{key:"handleDeleteWordAction",value:function(a){if(a.action&&"deleteWord"===a.action){var b=this.udWordsItems[a.request.word];b&&(b.enable(),"error"!==a.status&&(b.remove(),delete this.udWordsItems[a.request.word]))}}},{key:"destroy",value:function(){this.setDialogTitle=null,this.setDialogCoords=null}}]),b}(b);a.Dictionaries=j}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a){"use strict";var b=a.Component,c=function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"description"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.setTemplate('<div class="<%=prefix%>-problem-item__description"><%=description%></div>'),d.addTemplateData({description:c.problemDescription||""}),d}return _inherits(b,a),b}(b);a.Description=c}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a){"use strict";var b=a.Component,c=function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"problem-text"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.setTemplate('<div class="<%=prefix%>-problem-item__problem-text">	<span class="<%=prefix%>-problem-item__problem-text-value"><%=text%></span></div>'),d.addTemplateData({text:c.text||""}),d}return _inherits(b,a),b}(b);a.ProblemText=c}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){"use strict";var c=b.UILib,d=a.Component,e=a.ItemList,f=a.Description,g=a.ProblemText,h=a.ActionItems,i=function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"problem-item"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.text=c.text||"",d.nodes=c.nodes||[],d.setShouldFocusProblemItem=c.setShouldFocusProblemItem||function(){},d.activeNodeClass=a.getOption("problem_text_from_dialog_active"),d.setTemplate('<div class="<%=prefix%>-problem-item">    <div class="<%=prefix%>-problem-item__body">        <div data-children="description"></div>        <div data-children="problem-text"></div>        <div class="<%=prefix%>-problem-item__content">            <div data-children="suggestions"></div>        </div>    </div>    <div data-children="action-items"></div></div>'),d.addTemplateData({text:c.info.text?c.info.text:""}),d.registerModificatorsTypes({spelling:"spelling",grammar:"grammar"}),d.build(c),d}return _inherits(b,a),_createClass(b,[{key:"build",value:function(a){var b=this;this.buildDescription(a),this.buildProblemText(a),this.buildSuggestions(a),this.buildControlActions(a),this.registerLifeCycleHandler("after","render",function(){b.addActiveNode(),b.setTabIndex()}),this.registerLifeCycleHandler("before","remove",function(){b.destroy()})}},{key:"buildDescription",value:function(a){var b=a.info.problemDescription;b&&this.registerChildren(new f(this.sandbox,{problemDescription:b}),"description")}},{key:"buildProblemText",value:function(a){this.registerChildren(new g(this.sandbox,{text:a.info.text}),"problem-text")}},{key:"buildSuggestions",value:function(a){var b=a.actions.suggestions||[],c=Math.min(this.sandbox.getOption("suggestionsCount")+this.sandbox.getOption("moreSuggestionsCount"),b.length);this.registerChildren(new e(this.sandbox,{role:"group",itemRole:"none"}),"suggestions");for(var d=0;c>d;d+=1)this.createSuggestionsItem(b[d]);0===c&&this.createSuggestionsItem({text:this.sandbox.getLocal("btn_noSuggestions"),noSuggestions:!0,onClick:function(){}})}},{key:"createSuggestionsItem",value:function(a){var b,c=this,d=this.getChildren("suggestions"),e=d.addItem({title:a.text,text:a.text,modificators:["text"],tabIndex:-1,role:"treeitem",ariaLevel:1,onClick:function(b){c.setShouldFocusProblemItem(),a.call(b)}});a.noSuggestions&&(b=e.getChildren("content"),this.registerBemElements(b,"button"),b.disable(),b.addCustomModificator("noSuggestions",this.name)),this.registerBemElements(e,"suggestion")}},{key:"buildControlActions",value:function(a){var b=a.actions.control||[],c=new h(this.sandbox,{control:b,handleActionItemClick:this.setShouldFocusProblemItem});this.registerChildren(c,"action-items")}},{key:"addActiveNode",value:function(){for(var a=0;a<this.nodes.length;a++)c.addClass(this.nodes[a],this.activeNodeClass)}},{key:"setTabIndex",value:function(){var a=this.getFirstSuggestionButton();a&&a.setTabIndex(0)}},{key:"getFirstSuggestionButton",value:function(){var a,b,c;try{return a=this.getChildren("suggestions").getChildren("item"),b=a.length?a[0]:a,c=b.getChildren("content")}catch(d){return null}}},{key:"setFocus",value:function(){var a=this.getFirstSuggestionButton();a&&a.setFocus()}},{key:"removeActiveNode",value:function(){for(var a=0;a<this.nodes.length;a++)c.removeClass(this.nodes[a],this.activeNodeClass)}},{key:"isFocused",value:function(){return this.getDOMElement().contains(document.activeElement)}},{key:"destroy",value:function(){this.removeActiveNode(),this.nodes=null,this.setShouldFocusProblemItem=null}}]),b}(d);a.ProblemItem=i}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a){"use strict";var b=a.Component,c=a.ItemList,d=a.TextBox,e=function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"problem-section"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.setTemplate('<div class="<%=prefix%>-problem-section">    <div data-children="placeholder"></div>    <div data-children="problem-items"></div></div>'),d.problemItem=null,d.build(),d}return _inherits(b,a),_createClass(b,[{key:"build",value:function(){this.buildPlaceholder(),this.buildSection()}},{key:"buildPlaceholder",value:function(){var a=new d(this.sandbox,{text:this.sandbox.getLocal(this.sandbox.getTextLength()>0?"text_noProblems":"text_nothingToCheck")});this.registerChildren(a,"placeholder"),this.proxyMethodsFrom(a,["setText"])}},{key:"buildSection",value:function(){this.registerChildren(new c(this.sandbox,{role:"none",itemRole:"none",changeTabIndexOnFocus:!0,onFocusin:function(){}.bind(this),onFocusout:function(){}.bind(this)}),"problem-items")}},{key:"addProblemItem",value:function(a){this.getChildren("problem-items").addItem(a)}}]),b}(b);a.ProblemSection=e}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),WEBSPELLCHECKER.CORE.UI=WEBSPELLCHECKER.CORE.UI||{},function(a){"use strict";var b=a.Component,c=a.TextBox,d=a.Button,e=a.Icon;a=a||{};var f=function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"navigation-section"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.setTemplate('<div class="<%=prefix%>-navigation-section">    <div class="<%=prefix%>-problems-count">        <span class="<%=prefix%>-problems-count__text"><%=text%>:</span>        <div data-children="number-box"></div>    </div>    <div class="<%=prefix%>-navigation-action">        <div data-children="prevProblemButton"></div>    </div>    <div class="<%=prefix%>-navigation-action">        <div data-children="nextProblemButton"></div>    </div></div>'),d.addTemplateData({text:d.sandbox.getLocal("text_problemsCount")}),d.build(c),d}return _inherits(b,a),_createClass(b,[{key:"build",value:function(a){this.buildTextBox(),this.buildPrevProblemButton(a),this.buildNextProblemButton(a)}},{key:"buildTextBox",value:function(){this.registerChildren(new c(this.sandbox,{text:"0"}),"number-box")}},{key:"buildPrevProblemButton",value:function(a){this.registerChildren(new d(this.sandbox,{title:this.sandbox.getLocal("btn_prevProblem"),icon:this.createIcon("menu--active"),hide:!0,onClick:a.handlePrevProblemClick}),"prevProblemButton")}},{key:"createIcon",value:function(a){var b=new e(this.sandbox,{iconName:a});return this.registerBemElements(b),b}},{key:"buildNextProblemButton",value:function(a){this.registerChildren(new d(this.sandbox,{title:this.sandbox.getLocal("btn_nextProblem"),icon:this.createIcon("menu--active"),hide:!0,onClick:a.handleNextProblemClick}),"nextProblemButton")}},{key:"changeProblemsCount",value:function(a){this.getChildren("number-box").setText(a)}},{key:"showNavigationButtons",value:function(){this.getChildren("prevProblemButton").show(),this.getChildren("nextProblemButton").show()}},{key:"hideNavigationButtons",value:function(){this.getChildren("prevProblemButton").hide(),this.getChildren("nextProblemButton").hide()}}]),b}(b);a.NavigationSection=f}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),WEBSPELLCHECKER.CORE.UI=WEBSPELLCHECKER.CORE.UI||{},function(a){"use strict";var b=a.Component,c=a.ProblemSection,d=a.NavigationSection,e=a.ProblemItem;a=a||{};var f=function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"problem-container"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.setTemplate('<div class="<%=prefix%>-problem-container">    <div data-children="problem-section"></div>    <div data-children="navigation-section"></div></div>'),d.setShouldFocusProblemItem=c.setShouldFocusProblemItem||function(){},d.build(c),d}return _inherits(b,a),_createClass(b,[{key:"build",value:function(a){var b=this;this.buildProblemSection(),this.buildNavigationSection(a),this.registerLifeCycleHandler("before","remove",function(){b.destroy()})}},{key:"buildProblemSection",value:function(){var a=new c(this.sandbox,{});this.registerChildren(a,"problem-section"),this.proxyMethodsFrom(a,["setText"])}},{key:"buildNavigationSection",value:function(a){var b=new d(this.sandbox,{handlePrevProblemClick:a.handlePrevProblemClick,handleNextProblemClick:a.handleNextProblemClick});this.registerChildren(b,"navigation-section"),this.proxyMethodsFrom(b,["changeProblemsCount","showNavigationButtons","hideNavigationButtons"])}},{key:"createProblemItem",value:function(a){var b=this.getChildren("problem-section"),c=new e(this.sandbox,{info:a.info,actions:a.actions,nodes:a.problem.elements,setShouldFocusProblemItem:this.setShouldFocusProblemItem});return c.addModificator(a.info.type),b.addProblemItem(c),c}},{key:"destroy",value:function(){this.setShouldFocusProblemItem=null}}]),b}(b);a.ProblemContainer=f}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),WEBSPELLCHECKER.CORE.UI=WEBSPELLCHECKER.CORE.UI||{},function(a,b){"use strict";var c=a.Component,d=a.ProblemContainer,e=a.Icon,f=b.Utils;a=a||{};var g=function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"proofreaddialog"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.setTemplate('<div class="<%=prefix%>-proofreaddialog">    <div data-children="problem-container"></div></div>'),d.icon=new e(a,{iconName:d.name}),d.nodeWithProblemItem=null,d.problemItem=null,d.setFocusToFirstElement=c.setFocusToFirstElement||function(){},d.setDialogTitle=c.setDialogTitle||function(){},d.isDialogFocused=c.isDialogFocused||function(){return!1},d.isHeaderFocused=c.isHeaderFocused||function(){return!1},d.eventsAttached=!1,d.shouldFocusProblemItem=!1,d.shouldScroll=!0,d.build(),d.sandbox.subscribe("createProblemItem",function(a){this.handleCreateProblemItem(a)},d),d.sandbox.subscribe("updateUi, updateUiGlobally",function(){this.handleUpdateUi()},d),d}return _inherits(b,a),_createClass(b,[{key:"build",value:function(){var a=this;this.buildProblemContainer(),this.registerLifeCycleHandler("before","show",function(){a.setShouldFocusProblemItem(),a.setShouldScroll()}),this.registerLifeCycleHandler("after","show",function(){a.sandbox.fire("startProofreadInDialog",{}),a.setDialogTitle(""),a.unsetShouldFocusProblemItem(),a.attachEvents(),a.customizeNavigationSection()}),this.registerLifeCycleHandler("before","hide",function(){a.sandbox.fire("finishProofreadInDialog",{}),a.cleanDialog(),a.detachEvents(),a.unsetShouldScroll()}),this.registerLifeCycleHandler("before","remove",function(){a.destroy()})}},{key:"buildProblemContainer",value:function(){var a=new d(this.sandbox,{handlePrevProblemClick:this.handlePrevProblemClick.bind(this),handleNextProblemClick:this.handleNextProblemClick.bind(this),setShouldFocusProblemItem:this.setShouldFocusProblemItem.bind(this)});this.registerChildren(a,"problem-container")}},{key:"handlePrevProblemClick",value:function(a){this.sandbox.getTotalProblemsCount()<2||(a.shouldFocusProblemItem&&this.setShouldFocusProblemItem(),this.sandbox.fire("setPrevProblemActive",{}))}},{key:"handleNextProblemClick",value:function(a){this.sandbox.getTotalProblemsCount()<2||(a.shouldFocusProblemItem&&this.setShouldFocusProblemItem(),this.sandbox.fire("setNextProblemActive",{}))}},{key:"attachEvents",value:function(){this.eventsAttached||(this.sandbox.subscribe({eventType:"keydown",element:document,handler:this.trapKeyboard,context:this}),this.eventsAttached=!0)}},{key:"trapKeyboard",value:function(a){switch(a.keyCode){case 39:this.handleRightPress(a);break;case 37:this.handleLeftPress(a)}}},{key:"handleRightPress",value:function(a){var b={shouldFocusProblemItem:!0};this.isDialogFocused()&&(this.isRTL()?this.handlePrevProblemClick(b):this.handleNextProblemClick(b),a.preventDefault())}},{key:"isRTL",value:function(){return"rtl"===f.getComputedStyle(this.getDOMElement()).direction}},{key:"handleLeftPress",value:function(a){var b={shouldFocusProblemItem:!0};this.isDialogFocused()&&(this.isRTL()?this.handleNextProblemClick(b):this.handlePrevProblemClick(b),a.preventDefault())}},{key:"customizeNavigationSection",value:function(){var a=this.sandbox.getTotalProblemsCount();this.changeProblemsCount(a),this.toggleNavigationButtons(a)}},{key:"changeProblemsCount",value:function(a){this.getChildren("problem-container").changeProblemsCount(a)}},{key:"toggleNavigationButtons",value:function(a){var b=this.getChildren("problem-container");a>1?b.showNavigationButtons():b.hideNavigationButtons()}},{key:"setPlaceholder",value:function(){var a=this.getChildren("problem-container"),b=this.sandbox.getLocal(this.sandbox.getTotalTextLength()>0?"text_noProblems":"text_nothingToCheck");a.setText(b)}},{key:"cleanDialog",value:function(){this.removeProblemItem(),this.customizeNavigationSection()}},{key:"removeProblemItem",value:function(){this.problemItem&&(this.problemItem.remove(),this.problemItem=null,this.nodeWithProblemItem=null)}},{key:"detachEvents",value:function(){this.sandbox.unsubscribe({eventType:"keydown",element:document,handler:this.trapKeyboard,context:this}),this.eventsAttached=!1}},{key:"handleCreateProblemItem",value:function(a){return this.isProofreadInDialogActive()?a.problem?void this.createProblemItem(a):(this.removeProblemItem(),this.setPlaceholder(),this.shouldFocusProblemItem&&this.setFocusToFirstElement(),void this.unsetShouldFocusProblemItem()):void 0}},{key:"isProofreadInDialogActive",value:function(){return this.sandbox.getOption("isProofreadInDialogActive")}},{key:"createProblemItem",value:function(a){var b=this,c=this.isProblemItemFocused(),d=this.isDialogFocused(),e=this.isHeaderFocused();this.nodeWithProblemItem!==a.problem.elements[0]&&(this.removeProblemItem(),this.problemItem=this.getChildren("problem-container").createProblemItem(a),this.nodeWithProblemItem=a.problem.elements[0],(this.shouldFocusProblemItem||c||d)&&this.shouldScroll&&this.scrollToActiveNode(a),(this.shouldFocusProblemItem||c||e)&&setTimeout(function(){b.setFocusToProblemItem()},0),this.unsetShouldFocusProblemItem())}},{key:"isProblemItemFocused",value:function(){return this.problemItem&&this.problemItem.isFocused()}},{key:"scrollToActiveNode",value:function(a){var b=f.getCurrentDocument(a.scroll.documentContainer),c=a.scroll.isIframe?a.scroll.documentContainer:a.scroll.container,d=a.scroll.isIframe?b.documentElement:a.scroll.container;f.scrollToNodeInContainer({measureContainer:c,scrollContainer:d,nodeContainer:a.scroll.nodeContainer,node:a.problem.elements[0],isIframe:a.scroll.isIframe}),f.scrollToNodeInDocument({measureContainer:c,node:a.problem.elements[0],isIframe:a.scroll.isIframe})}},{key:"handleUpdateUi",value:function(){this.isVisible()&&(this.customizeNavigationSection(),this.setPlaceholder())}},{key:"setFocusToProblemItem",value:function(){this.problemItem&&this.problemItem.setFocus()}},{key:"setShouldFocusProblemItem",value:function(){this.shouldFocusProblemItem=!0}},{key:"unsetShouldFocusProblemItem",value:function(){this.shouldFocusProblemItem=!1}},{key:"setShouldScroll",value:function(){this.shouldScroll=!0}},{key:"unsetShouldScroll",value:function(){this.shouldScroll=!1}},{key:"destroy",value:function(){this.cleanDialog(),this.detachEvents(),this.unsetShouldScroll(),this.setFocusToFirstElement=null,this.setDialogTitle=null,this.isDialogFocused=null,this.isHeaderFocused=null}}]),b}(c);a.ProofreadDialog=g}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),WEBSPELLCHECKER.CORE.UI=WEBSPELLCHECKER.CORE.UI||{},function(a){"use strict";var b=a.Component,c=a.Button,d=a.Icon;a=a||{};var e=function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"settings"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.setDialogTitle=c.setDialogTitle||function(){},d.setDialogCoords=c.setDialogCoords||function(){},d.setTemplate('<div class="<%=prefix%>-settings">	<div data-children="setting-component"></div></div>'),d.settingComponents=[],d.build(),d}return _inherits(b,a),_createClass(b,[{key:"build",value:function(){var a=this;this.registerLifeCycleHandler("before","hide",function(){a.setDefaultView(),a.setDialogTitle("")}),this.registerLifeCycleHandler("before","show",function(){a.defineValues()}),this.registerLifeCycleHandler("after","show",function(){a.setDialogTitle(a.sandbox.getLocal("btn_settings"))}),this.registerLifeCycleHandler("after","remove",function(){a.destroy()}),this.sandbox.subscribe("commitOptions, syncOptions",function(){a.defineValues()})}},{key:"setDefaultView",value:function(){var a=this;this.settingComponents.forEach(function(b){a.isDictionaries(b.name)?b.hide():b.show()})}},{key:"isDictionaries",value:function(a){var a=a.toLowerCase();return"dictionaries"===a}},{key:"defineValues",value:function(){this.settingComponents.forEach(function(a){a.defineValues&&a.defineValues()})}},{key:"createSetting",value:function(a){var b=new a(this.sandbox,{setDialogTitle:this.setDialogTitle,setDialogCoords:this.setDialogCoords}),c=this.isDictionaries(b.name);c&&(b.hide(),this.buildGoToDictionaryButton()),this.registerChildren(b,"setting-component"),this.registerSettingsComponent(b)}},{key:"buildGoToDictionaryButton",value:function(){var a=new c(this.sandbox,{title:this.sandbox.getLocal("btn_goToDic"),text:this.sandbox.getLocal("btn_goToDic"),icon:new d(this.sandbox,{iconName:"dictionaries"}),modificators:["text"],onClick:this.handleGoToDictionary.bind(this)});this.registerChildren(a,"setting-component"),this.registerSettingsComponent(a)}},{key:"handleGoToDictionary",value:function(){var a=this;this.settingComponents.forEach(function(b){a.isDictionaries(b.name)?b.show():b.hide()})}},{key:"registerSettingsComponent",value:function(a){var b=a.getChildren("form"),c=b&&b.getChildren("list"),d=c&&c.getChildren("item");this.settingComponents.push(a),d&&this.registerBemElements(d)}},{key:"destroy",value:function(){this.settingComponents=[],this.setDialogTitle=null,this.setDialogCoords=null}}]),b}(b);a.Settings=e}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){"use strict";var c,d=b.Utils,e=a.Component,f=a.Icon,g=a.ItemList,h=a.ActionItems,i=b.UILib;a=a||{};var j=function(a){function b(a,d){_classCallCheck(this,b),d=Object.assign({name:"contextmenu"},d);var e=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,d));return c=e.sandbox.UIMetrics,e.setTemplate('<div class="<%=prefix%>-contextmenu <%=prefix%>-element <%=themeClass%>">	<div data-children="list"></div>	<div data-children="action-items"></div></div>'),e.addTemplateData({themeClass:e.sandbox.getOption("themeClass")}),e.problemItems=[],e.problemNode={},e.activeNodeClass=a.getOption("problem_text_active"),e.delay=500,e.generalEvents=[],e.build(),e}return _inherits(b,a),_createClass(b,[{key:"build",value:function(){var a=this;this.list=new g(this.sandbox,{role:"group",itemRole:"none",ariaLabel:this.sandbox.getLocal("text_correctionBox")}),this.registerChildren(this.list),this.registerLifeCycleHandler("after","hide",function(){a.deactivateNode(),a.problemNode={},a.clearProblemItems()}),this.registerLifeCycleHandler("after","show",function(){a.activateNode()}),this.registerLifeCycleHandler("after","render",function(){a.defineBehavior()}),this.registerLifeCycleHandler("before","remove",function(){a.destroy()})}},{key:"showAtPosition",value:function(a){this.problemNode=a,this.buildProblemItems(this.problemNode.node),this.setPosition(this.definePosition(this.problemNode.node)),this.show()}},{key:"getProblemNode",value:function(){return this.problemNode}},{key:"createItem",value:function(a){var b,c,d=this,g=a.title,h=a.name,i=a.text,j=a.description,k=a.handler,l=a.icon,m=a.position,n=a.modificator;return null!==l&&(l=l instanceof e?l:new f(this.sandbox,{iconName:l||h})),g=this.sandbox.getLocal("btn_"+g),g=this.sandbox.RegularsManager.wrap("btn_").start().replace(g,""),i="undefined"==typeof i?g:i,b=this.list.addItem({title:g,text:i,description:j,icon:l,tabIndex:-1,role:"treeitem",onClick:function(a){!k(a)&&d.hide()}},m),b.attachEvents([{eventType:"mousedown",handler:function(a){return a.preventDefault()}}]),b.attachEvents([{eventType:"pointerdown",handler:function(a){return a.preventDefault()}}]),this.registerBemElements(b),c=b.getChildren("content"),this.registerBemElements(c,"button"),n&&c.addCustomModificator(n,this.name),l&&this.registerBemElements(l),b}},{key:"buildProblemItems",value:function(a){var b=this.sandbox.getProblemInfo(a),c=this.sandbox.getProblemActions(a),d=this.sandbox.getActionItemsForContextMenu(a),e=!d.control.length&&!d.static.length,f="spelling"===b.type?"":b.problemDescription;this.clearProblemItems(),this.problemItems=this.problemItems.concat(c.suggestions.length?this.buildSuggestions(c.suggestions,f,e):[this.buildNoSuggestions(f)],d.control.length||d.static.length?this.buildActionItems(d):[])}},{key:"clearProblemItems",value:function(){this.problemItems.forEach(function(a){return a.remove()}),this.problemItems=[]}},{key:"buildSuggestions",value:function(a,b,c){for(var d,e,f=this.sandbox.getOption("suggestionsCount")||3,g=this.sandbox.getOption("moreSuggestionsCount"),h=(this.sandbox.getOption("actionItems"),Math.min(f+g,a.length)),i=[],j=[],k=0;h>k;k+=1)e=a[k],d=this.createItem({title:e.text,text:e.text,description:0===k&&b?b:"",handler:e.call,position:k,icon:"suggestion",modificator:"suggestion"}),j.push(d),k>=f&&(i.push(d),d.hide());return g>0&&a.length>f&&j.push(this.buildMoreSuggestionItem({handler:function(){i.forEach(function(a){a.isVisible()?a.hide():a.show()})},position:h})),c&&j[j.length-1].addCustomModificator("last",this.name),j}},{key:"buildMoreSuggestionItem",value:function(a){var b=this,c=a.handler,d=a.position,e=new f(this.sandbox,{iconName:"chevron"}),g=this.createItem({title:"showMore",text:"",handler:function(){return c(),g.open?(e.removeModificator("active"),g.open=!1,g.getChildren("content").setTitle(b.sandbox.getLocal("btn_showMore"))):(e.addModificator("active"),g.open=!0,g.getChildren("content").setTitle(b.sandbox.getLocal("btn_showLess"))),!0},modificator:"moreSuggestions",icon:e,position:d});return g.addCustomModificator("moreSuggestions",this.name),g.open=!1,g}},{key:"buildNoSuggestions",value:function(a){return this.createItem({title:"noSuggestions",description:a?a:"",handler:function(){return!0},position:0,modificator:"noSuggestions"})}},{key:"buildActionItems",value:function(a){var b=this,a=new h(this.sandbox,{control:a.control,"static":a.static,handleActionItemClick:function(){b.hide()}});return this.registerChildren(a,"action-items"),a}},{key:"defineBehavior",value:function(){var a,b=this,c=this.sandbox.getOption("container"),d={problem:{componentOpen:function(a){e(),a.node!==b.getProblemNode().node&&(b.deactivateNode(),b.activateNode(a),b.showAtPosition(a))},componentClose:function(c){return b.activateNode(c),a?void 0:function(){return b.showAtPosition(c)}}},noProblem:{componentOpen:function(){return a?void 0:function(){return b.hide()}},componentClose:function(){b.deactivateNode(),e()}}},e=function(){clearTimeout(a),a=void 0},f=function(){e(),b.isVisible()&&b.hide()},g=function(c,f){var g,h=b.sandbox.getProblemNodeFromMouseEvent(c),i=h.node,j=b.isVisible()?"componentOpen":"componentClose",f=f||(i&&b.sandbox.getProblemContainer().contains(i)?"problem":"noProblem");g=d[f][j](h),g&&(a=setTimeout(function(){g(),e()},b.delay))};this.attachEvents([{eventType:"mouseleave",handler:g},{eventType:"mouseenter",handler:e}]),this.attachGeneralEvents([{eventType:"mousemove",element:c,handler:g},{eventType:"mouseleave",element:c,handler:function(a){for(var c=a.relatedTarget;c;){if(b.getDOMElement()===c)return;c=c.parentNode}g(a,"noProblem")}},{eventType:"keydown",element:this.sandbox.getOption("container"),handler:f}]),this.attachGeneralEvents({eventType:this.sandbox.getOption("isTouchDevice")?"orientationchange":"resize",element:window,handler:f})}},{key:"attachGeneralEvents",value:function(a){var b=this;a=Array.isArray(a)?a:[a],a.forEach(function(a){b.sandbox.subscribe(a),b.generalEvents.push(a)})}},{key:"detachGeneralEvents",value:function(){var a=this;this.generalEvents.forEach(function(b){return a.sandbox.unsubscribe(b)}),this.generalEvents=[]}},{key:"activateNode",value:function(a){var b,c;if(!this.activatedNode&&(this.activatedNode=a,b=a&&a.node||this.problemNode.node,c=a&&a.parts||this.problemNode.parts,i.addClass(b,this.activeNodeClass),c))for(var d=0;d<c.length;d++)i.addClass(c[d],this.activeNodeClass)}},{key:"deactivateNode",value:function(a){var b,c;if(this.activatedNode&&(b=a&&a.node||this.activatedNode.node,c=a&&a.parts||this.activatedNode.parts,i.removeClass(b,this.activeNodeClass),this.activatedNode=null,c))for(var d=0;d<c.length;d++)i.removeClass(c[d],this.activeNodeClass)}},{key:"definePosition",value:function(a){var b=a.getBoundingClientRect(),e=this.getSize(),f=c.getWindowSize(),g=c.getScrollInfo(),h=c.getDocumentHeight(),i=this.sandbox.getOption("isIframe"),j=i?this.sandbox.getOption("documentContainer"):null,k=i?d.getComputedStyle(j):null,l=!1,m=d.reduceCoordinates([{top:0,left:0},i?b:d.getCoordinates(a),i?d.getCoordinates(j):null,i?{top:k.paddingTop,left:k.paddingLeft}:null,i?{top:k.borderTop,left:k.borderLeft}:null]);return m.left+e.width>f.width+g.left&&(l=!0,m.left=m.left-e.width+b.width,m.left<g.left&&(m.left=g.left)),m.top+e.height+b.height>f.height+g.top?(m.top=m.top-e.height,m.top<g.top&&(m.top=g.top+e.height<=h?g.top:h-e.height,m.left=l?m.left-b.width+b.width/2:m.left+b.width/2)):m.top+=b.height,m}},{key:"getOffset",value:function(a){for(var b=0,c=0;a;)b+=parseInt(a.offsetTop-a.scrollTop+a.clientTop),c+=parseInt(a.offsetLeft-a.scrollLeft+a.clientLeft),a=a.offsetParent;return{top:b,left:c}}},{key:"destroy",value:function(){this.deactivateNode(),this.detachGeneralEvents()}}]),b}(e);a.ContextMenu=j}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a){"use strict";var b=a.Component,c=a.LanguagesSelect,d=function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"badge-languages"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.setTemplate('<div class="<%=prefix%>-badge-languages">	<div data-children="badge-languages"></div></div>'),d.build(),d}return _inherits(b,a),_createClass(b,[{key:"build",value:function(){this.buildSelect()}},{key:"buildSelect",value:function(){var a=this,b=new c(this.sandbox,{title:this.sandbox.getLocal("tab_languages"),id:"badgeLanguages",tabIndex:-1,onChange:function(b){a.sandbox.fire("commitOptions",{changedOptions:{lang:b.target.value}})}});this.registerChildren(b,"badge-languages"),this.proxyMethodsFrom(b,["isFocused","setLanguage"])}}]),b}(b);a.BadgeLanguages=d}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){"use strict";var c=b.Utils,d=a.Component,e=a.Icon,f=a.Button,g=a.ItemList,h=a.BadgeLanguages;a=a||{};var i=function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"badge"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.setTemplate('<div class="<%=prefix%>-badge <%=themeClass%>" style="<%=style%>" tabindex="0" aria-controls="<%=ariaControls%>" aria-expanded="<%=ariaExpanded%>" aria-haspopup="<%=ariaHaspopup%>">	<div class="<%=prefix%>-badge__inner">		<div data-children="list"></div>		<div data-children="label-button"></div>	</div></div>'),d.addTemplateData({themeClass:d.sandbox.getOption("themeClass"),style:c.style||"position: absolute; visibility: hidden;",ariaHaspopup:!0,ariaExpanded:!1,ariaControls:d.prefix+"-"+d.name+d.getUID()}),d.container=d.sandbox.getOption("documentContainer"),d.hideStaticActions=d.sandbox.getOption("hideStaticActions"),d.problemsCount=0,d.timeoutDelay=2e3,d.scrollTimeoutDelay=1e3,d.timeoutId,d.scrollTimeoutId,d.positionAndSizeTimeoutId,d.small=!1,d.expanded=!1,d.expandedByKey=!1,d.registerModificatorsTypes({small:"small",error:"error",disabled:"disabled",checking:"checking",animationMove:"animationMove",manyErrors:"manyErrors",focused:"focused",expanded:"expanded",pulsing:"pulsing",hideStaticActions:"hideStaticActions",rtl:"rtl"}),d.setInitialState(),d.setZIndex="function"==typeof c.setZIndex?c.setZIndex:function(){},d.getWrapperCoordinates="function"==typeof c.getWrapperCoordinates?c.getWrapperCoordinates:function(){return{left:0,top:0}},d.alwaysViewed=["toggle"],d.registerLifeCycleHandler("after","render",function(){d.build(c)}),d.registerLifeCycleHandler("before","remove",function(){d.destroy()}),d}return _inherits(b,a),_createClass(b,[{key:"build",value:function(){var a=this,b=this,d=this.sandbox.getOption("enableLanguagesInBadgeButton"),i=c.Browser.ie&&11===c.Browser.version?!0:!1,j=this.isRTL();if(this.hideStaticActions||(this.list=new g(this.sandbox,{role:"menu",itemRole:"none",ariaLabel:this.sandbox.getLocal("text_productActions"),controlsBy:this.prefix+"-"+this.name+this.getUID(),prevKey:j?39:37,nextKey:j?37:39,onFocusin:function(){}.bind(this),onFocusout:function(){}.bind(this)}),this.registerChildren(this.list),this.sandbox.getStaticActions().reverse().map(function(b){var c=a.list.addItem({title:a.sandbox.getLocal("btn_"+b.getTitle()),icon:a.registerBemElements(new e(a.sandbox,{iconName:b.getName()})),role:"menuitem",tabIndex:-1,onClick:function(c){b.call(c),a.setUnfocusedState()},text:""});return a.registerBemElements(c,"button"),a.alwaysViewed.includes(b.getName())?a.toggleButton=c.getChildren("content"):c.addCustomModificator("visible-toggle",a.name),c})),d&&!this.hideStaticActions&&!i){this.languagesSelect=new h(this.sandbox,{});var k=this.list.addItem(this.languagesSelect);this.registerBemElements(k,"select"),k.addCustomModificator("visible-toggle",this.name)}this.labelButton=new f(this.sandbox,{title:this.sandbox.getOption("productName"),icon:this.registerBemElements(new e(this.sandbox,{iconName:this.name}),"label-icon"),tabIndex:-1}),this.registerChildren(this.labelButton,"label-button"),this.sandbox.getOption("disableBadgePulsing")||this.addModificator("pulsing"),this.positionAndSizeTimeoutId=setTimeout(function(){a.setPositionAndSize(),a.addModificator("animationMove")},0),this.hideStaticActions||this.attachEvents(),this.hideStaticActions&&(this.setTabIndex(-1),this.addModificator("hideStaticActions")),this.sandbox.subscribe("startProblemCheck",function(){b.setChecking(!0)},this,-2e3),this.sandbox.subscribe("problemCheckEnded",function(){b.setChecking()},this,-2e3),this.sandbox.subscribe("finishProofreadInDialog",function(){b.sandbox.getOption("proofreadAsYouType")&&(b.isEnabled=!0)},this,2e3),this.sandbox.subscribe("updateUi",function(){b.update(),b.changeBgColor()},this,-2e3),this.sandbox.subscribe("periodicalChecking",function(){b.changePosition()},this,-2e3),this.sandbox.subscribe("toggleApp",function(a){this.handleToggle(a)
},this),this.sandbox.subscribe("commitOptions, syncOptions",function(){this.setLanguage()},this)}},{key:"isRTL",value:function(){return"rtl"===c.getComputedStyle(this.sandbox.getOption("container")).direction}},{key:"setInitialState",value:function(){this.sandbox.getOption("appStarted")?this.isEnabled=this.sandbox.getOption("proofreadAsYouType")?!0:!1:(this.isEnabled=!1,this.setDisabled(!0))}},{key:"setChecking",value:function(a){this.isEnabled&&(a?this.addModificator("checking"):this.removeModificator("checking"))}},{key:"update",value:function(){this.isEnabled&&(this.problemsCount=this.sandbox.getProblemsCount()||0,this.problemsCount<=99?(this.setBadgeText(this.problemsCount||""),this.removeModificator("manyErrors")):(this.setBadgeText("99+"),this.addModificator("manyErrors")),this.setBadgeAttributes())}},{key:"setBadgeText",value:function(a){try{this.labelButton.setText(a)}catch(b){}}},{key:"setBadgeAttributes",value:function(a){var a=this.sandbox.getLocal("text_problemsCount")+": "+this.problemsCount;try{this.labelButton.setTitle(a),this.labelButton.setAriaLabel(a)}catch(b){}}},{key:"attachEvents",value:function(){this.sandbox.getOption("isTouchDevice")?this.sandbox.subscribe({eventType:"orientationchange",element:window,handler:this.changePosition,context:this}):this.sandbox.subscribe({eventType:"resize",element:window,handler:this.changePosition,context:this},this),this.sandbox.subscribe({eventType:"keydown",element:this.getDOMElement(),handler:this.handleKeydown,context:this}),this.sandbox.subscribe({eventType:"focusin",element:this.getDOMElement(),handler:this.handleFocusin,context:this}),this.sandbox.subscribe({eventType:"focusout",element:this.getDOMElement(),handler:this.handleFocusout,context:this}),this.sandbox.subscribe({eventType:"mouseenter",element:this.getDOMElement(),handler:this.handleMouseenter,context:this}),this.sandbox.subscribe({eventType:"mouseleave",element:this.getDOMElement(),handler:this.handleMouseleave,context:this}),this.sandbox.subscribe({eventType:"scroll",element:this.getScrollContainer(),handler:this.handleScroll,context:this})}},{key:"detachEvents",value:function(){this.sandbox.unsubscribe(this.sandbox.getOption("isTouchDevice")?{eventType:"orientationchange",element:window,handler:this.changePosition,context:this}:{eventType:"resize",element:window,handler:this.changePosition,context:this}),this.sandbox.unsubscribe({eventType:"keydown",element:this.getDOMElement(),handler:this.handleKeydown,context:this}),this.sandbox.unsubscribe({eventType:"focusin",element:this.getDOMElement(),handler:this.handleFocusin,context:this}),this.sandbox.unsubscribe({eventType:"focusout",element:this.getDOMElement(),handler:this.handleFocusout,context:this}),this.sandbox.unsubscribe({eventType:"mouseenter",element:this.getDOMElement(),handler:this.handleMouseenter,context:this}),this.sandbox.unsubscribe({eventType:"mouseleave",element:this.getDOMElement(),handler:this.handleMouseleave,context:this}),this.sandbox.unsubscribe({eventType:"scroll",element:this.getScrollContainer(),handler:this.handleScroll,context:this})}},{key:"getScrollContainer",value:function(){var a=this.sandbox.getOption("originalContainer"),b=this.sandbox.getOption("documentContainer"),c=this.sandbox.getOption("isIframe");return c&&b.contentWindow?b.contentWindow:a}},{key:"changePosition",value:function(a){var b=this,c=0;a&&"orientationchange"===a.type&&(c=500),this.timeoutId=setTimeout(function(){b.setPositionAndSize()},c)}},{key:"changeBgColor",value:function(){this.isEnabled&&(this.problemsCount>0?this.addModificator("error"):this.removeModificator("error"))}},{key:"setPositionAndSize",value:function(){var a=this.getPosition();a.small?(this.addModificator("small"),this.small=!0):(this.removeModificator("small"),this.small=!1),a.isRTL?this.addModificator("rtl"):this.removeModificator("rtl"),this.setZIndex(),this.setPosition(a),this.isVisible()||this.show()}},{key:"setDisabled",value:function(a){a?this.addModificator("disabled"):this.removeModificator("disabled")}},{key:"getPosition",value:function(){var a,b,d,e={left:0,top:0,small:!1},f=this.isRTL(),g=this.getContainerCoordinates(),h=this.getContainerClientSizes(g,f),i=this.getWrapperCoordinates(),j=c.isInputBased(this.sandbox.getOption("originalContainer")),k=j?14:18,l=j?4:6,m=32,n=6,o=26,p=26,q=this.sandbox.getOption("isIframe"),r=(q?0:g.left)+(f?n+o+1:h.width)+h.left-(f?0:m+1),s=(q?0:g.top)+h.height+h.top-m,t=this.isEnabled,u=h.height<38||h.width<38,v=this.small&&this.expanded;return a=this.isTextCovered(r,s,s+p,f),!t||u||v||a?(b=k,d=l,e.small=!0):(b=m,d=n),e.left=g.left-i.left+(f?d:h.width)+h.left-(f?0:b),e.top=g.top-i.top+h.height+h.top-b,e.isRTL=f,e}},{key:"getContainerCoordinates",value:function(){var a;try{a=this.container.getBoundingClientRect()}catch(b){a={top:0,right:0,bottom:0,left:0,width:0,height:0}}return a}},{key:"getContainerClientSizes",value:function(a,b){var d,e,f=this.sandbox.getOption("isIframe"),g=a.bottom-a.top;return f?(d=c.getCurrentDocument(this.container),e=c.getWindowByDocument(d),{width:d.documentElement.clientWidth,height:Math.min(d.documentElement.clientHeight,g),left:b?e.innerWidth-d.documentElement.clientWidth:0,top:0}):{width:this.container.clientWidth||this.container.offsetWidth,height:this.container.clientHeight||this.container.offsetHeight,left:this.container.clientLeft,top:this.container.clientTop}}},{key:"isTextCovered",value:function(a,b,c,d){return this.expanded?!1:this.sandbox.getOption("isTextBasedContainer")?this.isTextBasedTextCovered(a,b,c,d):this.isContenteditableTextCovered(a,b,c,d)}},{key:"isTextBasedTextCovered",value:function(a,b,c,d){for(var e,f=this.sandbox.getTextBasedClientRects(),g=0;g<f.length&&(e=f[g],!(e.top>c));g++)if(!(e.bottom<b||!d&&e.right<=a||d&&e.left>=a))return!0;return!1}},{key:"isContenteditableTextCovered",value:function(a,b,c,d){var e,f=this.sandbox.getCaretRangeFromPoint(a,(c-b)/2+b),g=5,h=this.getDOMElement();return f?h&&h.contains(f.startContainer)?!1:(e=f.getBoundingClientRect(),e.top>c||e.bottom<b?!1:!d&&e.right+g<a?!1:d&&e.left-g>a?!1:!0):!1}},{key:"addRequiredForShowActions",value:function(){this.setAriaExpanded(!0),this.addModificator("expanded"),this.expanded=!0}},{key:"removeRequiredForHideActions",value:function(){this.setAriaExpanded(!1),this.removeModificator("expanded"),this.expanded=!1}},{key:"handleMouseenter",value:function(){this.addRequiredForShowActions()}},{key:"handleMouseleave",value:function(){this.languagesSelect&&this.languagesSelect.isFocused()||(this.removeRequiredForHideActions(),this.expandedByKey&&(this.setFocus(),this.setTabIndex(0),this.expandedByKey=!1))}},{key:"handleKeydown",value:function(a){switch(a.keyCode){case 13:case 32:if(this.getDOMElement()===a.target){var b;this.addRequiredForShowActions(),this.setTabIndex(-1),b=this.list.getTabIndexedElements(),b.length&&(b[b.length-1].focus(),this.expandedByKey=!0),a.preventDefault()}break;case 27:this.removeRequiredForHideActions(),this.setFocus(),this.setTabIndex(0),this.expandedByKey=!1,a.preventDefault()}}},{key:"handleFocusin",value:function(){this.addModificator("focused")}},{key:"handleFocusout",value:function(a){this.getDOMElement().contains(a.relatedTarget)||this.setUnfocusedState()}},{key:"handleToggle",value:function(a){a.flag?(this.sandbox.getOption("proofreadAsYouType")&&(this.isEnabled=!0,this.setChecking(!0)),this.setDisabled(),this.toggleButton&&(this.toggleButton.setTitle(this.sandbox.getLocal("btn_disable")),this.toggleButton.setAriaLabel(this.sandbox.getLocal("btn_disable")))):(this.problemsCount=0,this.changeBgColor(),this.setChecking(),this.setDisabled(!0),this.isEnabled=!1,this.toggleButton&&(this.toggleButton.setTitle(this.sandbox.getLocal("btn_enable")),this.toggleButton.setAriaLabel(this.sandbox.getLocal("btn_enable"))))}},{key:"handleScroll",value:function(){var a=this;clearTimeout(this.scrollTimeoutId),this.scrollTimeoutId=setTimeout(function(){a.setPositionAndSize()},this.scrollTimeoutDelay)}},{key:"setLanguage",value:function(){this.languagesSelect&&this.languagesSelect.setLanguage()}},{key:"setUnfocusedState",value:function(){this.removeModificator("focused"),this.removeRequiredForHideActions(),this.setTabIndex(0),this.expandedByKey=!1}},{key:"destroy",value:function(){this.detachEvents(),clearTimeout(this.timeoutId),clearTimeout(this.scrollTimeoutId),clearTimeout(this.positionAndSizeTimeoutId)}}]),b}(d);a.Badge=i}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b){"use strict";var c=b.Utils,d=a.Component,e=a.Badge;a=a||{};var f=function(a){function b(a,c){_classCallCheck(this,b),c=Object.assign({name:"badgewrapper"},c);var d=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,c));return d.setTemplate('<div class="<%=prefix%>-badge__wrapper <%=prefix%>-element" style="<%=style%>">	<div data-children="badge"></div></div>'),d.addTemplateData({style:c.style||"position: relative; overflow: visible; float: left; display: inline; width: 0; height: 0; margin: 0; padding: 0; border: none;"}),d.container=d.sandbox.getOption("documentContainer"),d.build(),d}return _inherits(b,a),_createClass(b,[{key:"build",value:function(){this.registerChildren(new e(this.sandbox,{hide:!0,setZIndex:this.setZIndex.bind(this),getWrapperCoordinates:this.getWrapperCoordinates.bind(this)}),"badge")}},{key:"setZIndex",value:function(){c.setZIndex(this.container,this.getDOMElement())}},{key:"getWrapperCoordinates",value:function(){var a;try{a=this.getDOMElement().getBoundingClientRect()}catch(b){a={top:0,right:0,bottom:0,left:0,width:0,height:0}}return a}}]),b}(d);a.BadgeWrapper=f}(WEBSPELLCHECKER.CORE.UI,WEBSPELLCHECKER.CORE.prototype),function(a,b,c){"use strict";function d(a,b){this.name=a,this.sandbox=b,this.components={},e=b.UILib}var e,f=c.Dialog,g=c.Settings,h=c.Header,i=c.MessageBox,j=c.ProofreadDialog,k=c.ContextMenu,l=c.BadgeWrapper,m=[{name:"dictionaries",component:c.Dictionaries},{name:"languages",component:c.Languages},{name:"general",component:c.GeneralOptions},{name:"options",component:c.Options},{name:"about",component:c.About}];d.prototype={constructor:d,init:function(){var a=this;this.sandbox.subscribe({eventType:"showUiElement",handler:this.showUiElement}),this.sandbox.subscribe({eventType:"hideUiElement",handler:this.hideUiElement}),this.sandbox.subscribe("problemCheckEnded, removeMarkupInDocument, removedMarkupInContainer, removeMarkupFromProblems, ignoreAllProblems, ignoreProblem, changeStateForIgnoredProblems",function(){this.handleUpdateUi()},this),this.buildElement("contextMenu"),this.prepareActionItems(),this.sandbox.getOption("enableBadgeButton")&&this.sandbox.getOption("isMutationObserver")&&this.buildElement("badge",function(b){var c=a.sandbox.getOption("documentContainer");e.insertAfter(b,c)})},prepareActionItems:function(){for(var a,b=this.sandbox.getSettingsSections(),c=this.sandbox.getOption("disableDialog"),d=this.sandbox.getOption("enableDisableRule"),e=this.sandbox.getOption("actionItems"),f=[],g=0;g<e.length;g++)a=e[g],(b.length||"settings"!==a)&&(c&&"proofreadDialog"===a||(d||"disableRule"!==a)&&f.push(a));this.sandbox.setOption("actionItems",f)},destroy:function(){for(var a in this.components)this.components[a].remove(),delete this.components[a]},showUiElement:function(a){var b=this.components[a.elementName];b||(b=this.buildElement(a.elementName)),b.show(a.parameters)},hideUiElement:function(a){var b=this.components[a.elementName];b&&b.hide()},handleUpdateUi:function(){var a=this.sandbox.getOption("globalProofreadDialog"),b=this.sandbox.getOption("uid");this.sandbox.fire("updateUi",{}),a&&this.sandbox.fireInAllApps("updateUiGlobally",{uid:b})},buildElement:function(a,b){b=b||e.appendTo.bind(e);var c=this.directors[a]&&this.directors[a](this.sandbox,this.components);if(!c)throw new Error(a+" - is not defined in UIBuilder module.");return c.addModificator("borderBox"),this.components[a]=c,c.getDOMElement()||b(c.render(),"body"),c},directors:{_createFacade:function(a){return{show:function(){return a.show()},hide:function(){return a.hide()},render:function(){return a.render()},remove:function(){return a.remove()},getDOMElement:function(){return a.getDOMElement()},addModificator:function(b){return a.addModificator(b)}}},WSCDialog:function(a,b){return b.WSCDialog||(b.WSCDialog=new f(a,{builder:new o(a),hide:!0})),b.WSCDialog},proofreadDialog:function(a,b){var c=this.WSCDialog(a,b),d=this._createFacade(c);return d.show=function(){c.show(),c.showContent()},d},settings:function(a,b){var c=this.WSCDialog(a,b),d=this._createFacade(c);return d.show=function(){c.show(),c.showMenu()},d},contextMenu:function p(a){var p=new k(a,{hide:!0}),b=this._createFacade(p);return b.show=function(a){p.showAtPosition(a)},p.registerLifeCycleHandler("after","show",function(){a.fire("showBanner",{contextMenuContainer:p.getDOMElement()})}),p.registerLifeCycleHandler("before","hide",function(){a.fire("hideBanner")}),b},badge:function(a){return new l(a,{})}}};var n=function(){function a(){_classCallCheck(this,a)}return _createClass(a,[{key:"buildHeader",value:function(a){return new h(this.sandbox,a)}},{key:"buildTextBox",value:function(a){return a.hide=!0,a.type="text",new i(this.sandbox,a)}},{key:"buildMenu",value:function(){}},{key:"buildContent",value:function(){}},{key:"buildFooter",value:function(){}}]),a}(),o=function(a){function b(a){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return c.sandbox=a,c}return _inherits(b,a),_createClass(b,[{key:"buildHeader",value:function(a){return _get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"buildHeader",this).call(this,a)}},{key:"buildTextBox",value:function(a){return _get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"buildTextBox",this).call(this,a)}},{key:"buildMenu",value:function(a){var b,c=this.sandbox.getSettingsSections(),a=a||{};if(this.sandbox.getOption("actionItems").includes("settings"))return b=new g(this.sandbox,Object.assign({},a,{hide:!0})),m.forEach(function(a){c.includes(a.name)&&b.createSetting(a.component)}),b}},{key:"buildContent",value:function(a){return a=Object.assign({},a,{hide:!0}),this.sandbox.getOption("actionItems").includes("proofreadDialog")?new j(this.sandbox,a):void 0}},{key:"buildFooter",value:function(){return null}}]),b}(n);a.UIBuilder=d}(WEBSPELLCHECKER.CORE,WEBSPELLCHECKER.CORE.prototype,WEBSPELLCHECKER.CORE.UI),function(a){"use strict";var b=function(a,b){this.name=a,this.sandbox=b,this.delay=1e3,this.timeoutId=null,this.mutationObserver=null,this.mutationOptions={attributes:!0,attributeOldValue:!0,childList:!0,characterData:!0,characterDataOldValue:!1,subtree:!0},this.inThrottle=!1};b.prototype={init:function(){this.sandbox.getOption("isMutationObserver")&&(this.mutationObserver=new window.MutationObserver(this.handleMutations.bind(this)),this.startMutationObserver(),this.sandbox.subscribe("lockMutationsListener",function(a){this.lockMutationsListener(a)},this))},lockMutationsListener:function(a){a.lock?this.stopMutationObserver():this.startMutationObserver()},startMutationObserver:function(){this.mutationObserver&&this.mutationObserver.observe(document.getElementsByTagName("body")[0],this.mutationOptions)},stopMutationObserver:function(){this.mutationObserver&&this.mutationObserver.disconnect()},handleMutations:function(){var a=this;this.inThrottle||(this.inThrottle=!0,this.timeoutId=setTimeout(function(){a.inThrottle=!1,a.sandbox.fire("periodicalChecking")},this.delay))},destroy:function(){this.stopMutationObserver(),this.mutationObserver=null,clearTimeout(this.timeoutId)}},a.DOMChangesListener=b}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b={htmlToText:function(a,b){var c="address|article|aside|blockquote|canvas|dd|div|dl|fieldset|figcaption|figure|footer|form|h[1-6]|header|hgroup|hr|li|main|nav|noscript|ol|output|p|pre|section|table|tfoot|ul|video";return a=a.replace(new RegExp("<("+c+")(>|.*?[^?]>)","gi"),'<br class="wsc-marker">$&').replace(new RegExp("</("+c+")(>|.*?[^?]>)","gi"),'$&<br class="wsc-marker">').replace(/<br class="wsc-marker">\s*<br class="wsc-marker">/gi,'<br class="wsc-marker">').replace(/^(<br class="wsc-marker">)+/gi,"").replace(/(<br class="wsc-marker">)+$/gi,"").replace(/<br class="wsc-marker">/gi,"\r\n").replace(/<br>/gi,"\r\n").replace(/&nbsp;/g," ").replace(/\ufeff/g,"").replace(/\u0002/g,""),a=a.replace(/<br[^>]*class[^>]*=[^>]*"[^>]*wsc-bogus[^>]*"[^>]*>/g,""),a=this.encodingTools.htmlDecode(a),b&&(a=a.replace(/\r\n/g," ")),a},textToHtml:function(a,b){return a=a.replace(/</gi,"&lt;").replace(/>/gi,"&gt;").replace(/\r\n/g,"<br>").replace(/\n/gi,"<br>").replace(/\t/gi,"&nbsp;&nbsp;&nbsp;&nbsp;"),b&&(a=a.replace(/ /g,"&nbsp;"),a=a.replace(/<br>/gi,"&nbsp;")),a},htmlToPlainText:function(a){return this.encodingTools.htmlDecode(a)},tagsToLowerCase:function(a){return a=a.replace(/<\/?[A-Z]+>/g,function(a){return a.toLowerCase()})},getHtmlWithoutSpellingNodes:function(a,b,c){var a=this.getHtmlWithoutGivenNodes(a,b,c);return a=this.getHtmlWithoutGivenNodes(a,"span","scayt-misspell-word")},getHtmlWithoutGrammarNodes:function(a,b,c){var a=this.getHtmlWithoutGivenNodes(a,b,c);return a=this.getHtmlWithoutGivenNodes(a,"span","gramm-problem")},getHtmlWithoutRangyMarkerNodes:function(a){var a=this.getHtmlWithoutGivenNodes(a,"span","rangySelectionBoundary");return a=a.replace(/\ufeff/g,"")},getHtmlWithoutGivenNodes:function(b,c,d){for(var e=0,f=0,g=b,h=!1,i=a.Utils,c=i.Browser.ie&&8===i.Browser.version?c.toUpperCase():c;-1!==g.indexOf(d);)if(e=g.indexOf("<"+c,e),f=g.indexOf(">",e),h=e===g.lastIndexOf("<"+c)?!0:!1,g.indexOf(d,e)>f){if(h)break;e=f}else{if(g=g.substring(0,e)+g.substring(f+1,g.indexOf("</"+c+">",f))+g.substring(g.indexOf("</"+c+">",f)+c.length+3,g.length),h)break;e=0,f=0}return g},recogniseContentType:function(a){var b=new RegExp("<[s]*[a-z0-9]+[s]*>|<[s]*/[s]*[a-z0-9]+[s]*>|<[s]*[a-z0-9]+[s]*/[s]*>","gi");return a.match(b)?"html":"text"},encodingTools:function(){var a={symbolsToSave:[{searchFor:/\n/g,replaceWith:"__%N%__"},{searchFor:/\r/g,replaceWith:"__%R%__"}],symbolsToRestore:[{searchFor:/__%N%__/g,replaceWith:"\n"},{searchFor:/__%R%__/g,replaceWith:"\r"}],save:function(a){a=a||"";for(var b=0;b<this.symbolsToSave.length;b++)a=a.replace(this.symbolsToSave[b].searchFor,this.symbolsToSave[b].replaceWith);return a},restore:function(a){a=a||"";for(var b=0;b<this.symbolsToRestore.length;b++)a=a.replace(this.symbolsToRestore[b].searchFor,this.symbolsToRestore[b].replaceWith);return a}};return{htmlEncode:function(b){var c,d,e;return c=a.save(b),d=document.createElement("span"),e=document.createTextNode(c),d.appendChild(e),c=a.restore(d.innerHTML)},htmlDecode:function(b){var c,d=document.createElement("span");return c=a.save(b),d.innerHTML=c,c=a.restore(d.textContent||d.innerText)}}}()};a.DataProcessor=b}(WEBSPELLCHECKER.CORE.prototype),function(a){"use strict";function b(b,d,h,j){function o(a){var f,g=a,i="",j=h?"text":k,l=null,o=b.Utils,s=o.getCurrentDocument(b.getOption("documentContainer")),w=b.getOption("isTextBasedContainer"),x=[];if(l=o.Browser.edge?o.getWindowByDocument(s).clipboardData:g&&g.clipboardData,u||v)return a.preventDefault(),a.stopPropagation(),!1;if(p(),r&&(q=b.saveSelection()),f=d.innerHTML,!l||!l.getData)return j=h?"text":"html",n.getPastedData(j,function(a){b.fire({eventType:"focus",element:d}),b.restoreSelection(q),(!o.Browser.ie||a)&&setTimeout(function(){b.fire("pasteProcessed",{event:g,text:a,contentType:j,pasteInto:d,transferType:m.INTERNAL})},0)}),!0;if(e(l.types))for(var y=0;y<l.types.length;y++)x[y]=l.types[y];t=!0,h&&/text\/plain/.test(x)?(j="text",i=l.getData("text/plain")):/text\/html/.test(x)?(j="html",i=l.getData("text/html")):/text\/plain/.test(x)?(j="text",i=l.getData("text/plain")):i="",w&&(i=i.replace(/&/gi,"&amp;")),d.innerHTML=i,c(d,f,function(a){b.restoreSelection(q),(!o.Browser.ie||a)&&setTimeout(function(){b.fire("pasteProcessed",{event:g,text:a,contentType:j,pasteInto:d,transferType:m.INTERNAL})},0)})}function p(){u=!0,setTimeout(function(){u=!1},100)}{var q,r=b.getFocused(),s=b.getOption("isIframe"),t=!1,u=!1,v=!1;a.Utils}b.subscribe({eventType:"focus",element:d,handler:function(){r=!0}}),b.subscribe({eventType:"blur",element:d,handler:function(){r=!1}}),b.subscribe({eventType:"cut",element:d,handler:function(a){b.fire({eventType:"cutProcessed",data:a})}}),b.subscribe({eventType:"copy",element:d,handler:function(a){b.fire({eventType:"copyProcessed",data:a})}}),b.subscribe({eventType:l,element:d,handler:o}),b.subscribe({eventType:"paste",element:d,handler:function(a){return t?(a.preventDefault(),a.stopPropagation(),!1):void 0}}),b.subscribe("pasteProcessed",function(a){{var b=a.pasteInto;f(a)}b==d&&(a.contentTrueType="html"==a.contentType?"html":i.recogniseContentType(a.text),"html"==a.contentTrueType&&(a.text=i.tagsToLowerCase(a.text)),"text"==a.contentType&&"html"==a.contentTrueType&&(a.text=i.encodingTools.htmlEncode(a.text)),"auto"==a.contentType&&(a.contentType="html"==a.contentTrueType?"html":"text"))},b,2e3),b.subscribe("pasteProcessed",function(a){var c=a.pasteInto;c==d&&(v=!0,setTimeout(function(){var c,d,e,f,h=document.createElement("span");c=j&&s?b.getSelection(!0):b.getSelection(),d=c.getRangeAt(0),h.innerHTML=a.text,d.deleteContents(),d.insertNode(h),e=b.createRange(),f=b.createRange(),e.selectNode(h),f.selectNodeContents(h),e.commonAncestorContainer().insertBefore(f.extractContents(),h),d.setStartBefore(h),d.collapse(!0),c.removeAllRanges(),c.addRange(d),v=!1,g.remove(h),b.fire("afterPaste")},0))},b,-2e3)}function c(a,b,c){var d=a.innerHTML;a.innerHTML=b,"function"==typeof c&&c(d)}function d(a){var b=a.container,c=a.sandbox;c.unsubscribe({eventType:"focus",element:b}),c.unsubscribe({eventType:"blur, cut, copy, paste, beforepaste",element:b}),c.unsubscribe("pasteProcessed",c)}function e(a){return a&&!a.propertyIsEnumerable("length")&&"object"===("undefined"==typeof a?"undefined":_typeof(a))&&"number"==typeof a.length}function f(a){return a.transferType=a.transferType||m.EXTERNAL,a.transferType}if(!a.clipboardManager){var g=a.UILib,h=a.Utils,i=a.DataProcessor,j=[],k="html",l=h.Browser.ie?"beforepaste":"paste",m={INTERNAL:1,EXTERNAL:2},n={init:function(a){if(this.sandbox=a,!this.initialized){this.initialized=!0;for(var b in this.contentTypes)this.contentTypes[b].element=g.create(this.contentTypes[b].template)[0],g.appendTo(this.contentTypes[b].element,"body")}},getScrollTop:function(){return g.scrollTop(window)+10+"px"},getScrollLeft:function(){return g.scrollLeft(window)+"px"},contentTypes:{text:{template:'<textarea id="sc-hidden-paste-text-holder" style="position:absolute;left:-99999px;"></textarea>',element:null,cleanup:function(){this.element.value="",this.element.style.top=n.getScrollTop(),n.sandbox.fire({eventType:"focus",element:this.element})},getData:function(){return this.element.value},setData:function(a){this.element.value=a}},html:{template:'<div contenteditable="true" id="sc-hidden-paste-html-holder" style="position:absolute;left:-99999px;"></div>',element:null,cleanup:function(){this.element.innerHTML="",this.element.style.top=n.getScrollTop(),n.sandbox.fire({eventType:"focus",element:this.element})},getData:function(){return this.element.innerHTML},setData:function(a){this.element.innerHTML=a}}},getPastedData:function(a,b){var c=this,d=h.Browser.ie&&11===h.Browser.version;b||(b=a,a="html"),this.contentTypes[a].element&&"function"==typeof b&&(this.contentTypes[a].cleanup(),setTimeout(function(){var e=c.contentTypes[a].getData();d&&"html"===a&&"<br>"===e&&(e=""),b(e)},0))}},o={add:function(a,c,d,e){j.push({sandbox:a,container:c}),n.init(a),b(a,c,d,e)},remove:function(a){for(var b,c=0;c<j.length;c++)j[c].sandbox.getOption("uid")===a&&(b=j[c],d(b),j.splice(c,1))}};a.clipboardManager=o}}(WEBSPELLCHECKER.CORE.prototype),function(a){function b(a){return c.is(a,":visible")}var c,d,e,f=function(a,b){var f=this;this.name=a,this.sandbox=b,d=this.Utils=b.Utils,c=this.UILib=b.UILib,e=this.DataProcessor=b.DataProcessor,this.originalElement=this.sandbox.getOption("originalContainer"),this.styles=this.sandbox.getOption("styles"),this.isTextBased=function(){var a=["textarea","text","email","search","url"];return a.indexOf(f.originalElement.type)>=0}(),this.sandbox.setOption("isTextBasedContainer",this.isTextBased),this.isInputBased=function(){var a=["text","email","search","url"];return a.indexOf(f.originalElement.type)>=0}(),this.prefix="wsc-",this.fakeElement=this.createFakeElement(),this.isTextBasedContainer=this.sandbox.getOption("isTextBasedContainer")};f.prototype={init:function(){var a;this.attachEvents(),this.setMaxLength(),this.fakeElement?(this.adjustStyles(this.originalElement,this.fakeElement,this.styles),a=g(this.fakeElement,this.sandbox,this),a.init(this.originalElement),this.fakeElement.innerHTML=this.DataProcessor.textToHtml(this.originalElement.value,this.isInputBased),this.UILib.hide(this.originalElement),this.originalElement.proofraytFakeElement=this.fakeElement,this.sandbox.setContainer(this.fakeElement),this.sandbox.setOption("documentContainer",this.fakeElement)):(c.attr(this.originalElement,"aria-readonly",!1),c.attr(this.originalElement,"spellcheck",!1))},destroy:function(){this.fakeElement&&(this.UILib.remove(this.fakeElement),this.originalElement.proofraytFakeElement=null,this.UILib.css(this.originalElement,{display:""})),this.detachEvents()},getOriginalElement:function(){return this.originalElement},getFakeElement:function(){return this.fakeElement},getTextContainer:function(){return this.fakeElement||this.originalElement},setData:function(a){var b=this.DataProcessor;a=this.sandbox.getHtmlWithoutSpellingNodes(a),a=this.sandbox.getHtmlWithoutGrammarNodes(a),this.fakeElement?(this.fakeElement.innerHTML=b.textToHtml(a,this.isInputBased),this.originalElement.value=b.htmlToText(this.fakeElement.innerHTML,this.isInputBased)):this.originalElement.innerHTML=a},getData:function(){return this.originalElement.value||this.sandbox.getHtmlWithoutProblemNodes(this.originalElement.innerHTML)},createFakeElement:function(){var a,d=null,e=this;return e.isTextBased&&b(e.originalElement)&&(d=c.create("<div>")[0],e.originalElement.disabled||e.originalElement.readOnly||c.attr(d,"contenteditable",!0),c.attr(d,"aria-readonly",!1),c.addClass(d,e.prefix+"wrapper"),a=c.attr(e.originalElement,"id"),a&&c.attr(d,"id",e.prefix+a),c.insertAfter(d,e.originalElement)),d},adjustStyles:function(a,b,d){var e,f,g,h="."+this.prefix+"wrapper{overflow: auto;overflow-x: hidden;padding: 1px;font-style: normal;font-weight: normal;text-align: start;color: #000;border: 1px solid #b3b3b3;background: #fff;}."+this.prefix+"input{overflow-y: hidden;white-space: nowrap;border-color: #a9a9a9;}."+this.prefix+"textarea{white-space: pre-wrap;padding: 2px;border-color: #808080;-moz-appearance: textfield-multiline;-webkit-appearance: textfield;appearance: textfield;resize: both;}."+this.prefix+"wrapper[contentEditable=true]:empty:before{content: attr(data-placeholder);color: #888;}";if(e=c.attr(a,"style"),e="string"==typeof e?e:e.cssText,c.attr(b,"style",e),f=c.attr(a,"class"),c.addClass(b,f),g=c.find("#"+this.prefix+"wrapper-styles")[0],!g||g.innerHTML!==h){var i=c.create("<style>")[0];c.attr(i,"id",this.prefix+"wrapper-styles"),c.attr(i,"type","text/css"),i.styleSheet?i.styleSheet.cssText=h:i.innerHTML=h,c.prependTo(i,"head")}c.addClass(b,this.prefix+(this.isInputBased?"input":"textarea"));var j=c.css(a,"width"),k=c.css(a,"height");c.css(b,{width:j,height:k});var l=c.css(a,"fontFamily"),m=c.css(a,"fontSize");c.css(b,{fontFamily:l,fontSize:m}),c.attr(b,"spellcheck","false");var n=c.attr(a,"title"),o=c.attr(a,"placeholder");c.attr(b,"title",n),c.attr(b,"data-placeholder",o),"object"===("undefined"==typeof d?"undefined":_typeof(d))&&c.css(b,this.styles)},attachEvents:function(){var a,b,c,e=this;this.fakeElement?(this.sandbox.subscribe({eventType:"keydown",element:this.fakeElement,handler:function(d){var f=d;c=1,a=!1,b=!1,13===f.keyCode&&(f.preventDefault(),a=!0,e.isInputBased?b=!0:f.altKey||f.ctrlKey?b=!0:c=2),e.sandbox.fire({eventType:"keydownCharLengthOnFakeElement",data:{charLength:c}})},priority:2e3}),this.sandbox.subscribe({eventType:"keyup",element:this.fakeElement,handler:function(){e.originalElement.value=e.DataProcessor.htmlToText(e.fakeElement.innerHTML,e.isInputBased)}})):this.sandbox.subscribe({eventType:"keydown",element:e.getOriginalElement(),handler:function(c){b&&c.stopImmediatePropagation(),a&&c.preventDefault()},priority:2e3}),e.sandbox.subscribe("pasteProcessed",this.onPasteHandler,e,1e3),this.fakeElement&&(e.isInputBased||e.sandbox.subscribe({eventType:"keydown",element:this.originalElement,handler:function(a){var b=a;13===b.keyCode&&(b.preventDefault(),e.onEnterKeyHandler()),!d.Browser.gecko||8!==b.keyCode&&46!==b.keyCode||e.onDeleteKeyHandler()}}),e.sandbox.subscribe("afterPaste,replaceProblem,afterDrop,undo,redo",function(){e.originalElement.value=e.DataProcessor.htmlToText(e.fakeElement.innerHTML,e.isInputBased)},e,-2e3))},setMaxLength:function(){var a;this.isTextBased&&(a=parseInt(c.attr(this.originalElement,"maxlength"),10),a>=0&&this.sandbox.setOption("maxLength",a))},detachEvents:function(){var a=this;a.sandbox.unsubscribe("replaceProblem",a),a.sandbox.unsubscribe("afterPaste",a),a.sandbox.unsubscribe("paste",a),a.sandbox.unsubscribe("keypress",a),a.sandbox.unsubscribe("afterDrop",a),a.sandbox.unsubscribe("undo",a),a.sandbox.unsubscribe("redo",a),a.sandbox.unsubscribe({eventType:"keydown, keyup",element:a.getTextContainer()})},onEnterKeyHandler:function(){var a,b=this.sandbox.getSelection(),d=c.create("<br>")[0];a=b.getRangeAt(0),a.collapsed()||(a.deleteContents(),a.collapse(!0)),this.isEndOfContainer(a)&&this.appendBogus(),a.insertNode(d),a.setStartAfter(d),b.removeAllRanges(),b.addRange(a)},onDeleteKeyHandler:function(){var a=this.sandbox.getOption("container");setTimeout(function(){"<br>"===a.innerHTML&&(a.innerHTML="")},0)},onPasteHandler:function(a){var b,c=a.pasteInto,d=this,e=d.sandbox.getOption("container");c===e&&(a.text=d.sandbox.getHtmlWithoutSpellingNodes(a.text),a.text=d.sandbox.getHtmlWithoutGrammarNodes(a.text),a.text=a.text.replace(/<meta.*?>/i,""),a.text=a.text.replace(/style="[^\"]*"/gi,""),b=a.text.match(/<!--StartFragment-->([\s\S]*?)<!--EndFragment-->/i),a.text=b?b[1]:a.text,d.isTextBased&&("html"===a.contentType&&(a.text=d.DataProcessor.htmlToText(a.text),a.text=d.DataProcessor.encodingTools.htmlEncode(a.text)),a.text=d.DataProcessor.textToHtml(a.text,d.isInputBased)))},isEndOfContainer:function(a){var b,c,d=this,e=d.sandbox.getOption("container"),f=a.cloneRange();return f.collapse(!1),f.setEnd(e,e.childNodes.length),f.toString().length>0?!1:(b=f.getNodes(),c=b.filter(function(a){return"br"===a.nodeName.toLowerCase()}),c.length>0?!1:!0)},appendBogus:function(){var a,b=this,e=b.sandbox.getOption("container");a=c.find("br.wsc-bogus",e)[0],a=a||c.create('<br class="wsc-bogus">')[0],d.Browser.gecko&&c.attr(a,"type","_moz"),c.appendTo(a,e)}};var g=function(a,b,c){var f,g,h,i=a||this,j=["click","focus","keypress","keydown","keyup","blur","mouseout","change","dblclick","mousedown","mousemove","mouseover","mouseup","select","paste","cut","copy","contextmenu","drag","dragend","dragenter","dragleave","dragover","dragstart","drop"];return{init:function(a){b.addEventProxy({from:i,to:a,eventsNames:j}),d.Browser.ie&&b.subscribe("pasteProcessed",function(){b.fire({element:a,eventType:"paste"})}),b.subscribe({element:i,eventType:"mouseup",handler:function(){f=b.getSelection(),f.rangeCount()>0&&!f.getRangeAt(0).collapsed()&&b.fire({element:a,eventType:"select"})}}),b.subscribe({element:i,eventType:"focus",handler:function(){g=e.htmlToText(i.innerHTML,c.isInputBased)}}),b.subscribe({element:i,eventType:"blur",handler:function(){h=e.htmlToText(i.innerHTML,c.isInputBased),g!==h&&b.fire({element:a,eventType:"change"})}})}}};a.Wrapper=f}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=function(a,b){this.name=a,this.sandbox=b,this.maxLength=this.sandbox.getOption("maxLength"),this.blockDOMKeyDown=!1,this.isInputBased=this.sandbox.UILib.hasClass(this.sandbox.getOption("container"),"proofrayt-input"),this.keydownCharLength=1
};b.prototype={init:function(){var a=this;return this.maxLength<0?!1:(this.sandbox.subscribe({eventType:"keydown",element:this.sandbox.getOption("container"),handler:this.onKeyDownHandler,priority:2e3}),this.sandbox.subscribe({eventType:"keydownCharLengthOnFakeElement",handler:function(a){this.keydownCharLength=a.charLength}}),a.sandbox.subscribe("pasteProcessed",this.onPasteHandler,a,0),void a.sandbox.subscribe("drop",this.onDropHandler,a,0))},onKeyDownHandler:function(a){function b(a){for(var b=!1,c=!0,d=0;d<k.length;d+=1){c=!0;for(var e in k[d])if(c=c&&a[e]===k[d][e],!c)break;b=b||c}return b}var c,d,e,f=(this.sandbox.Utils,a),g=67,h=88,i=65,j=[186,187,188,189,190,191,192,219,220,221,222,96,97,98,99,100,101,102,103,104,105,106,107,109,110,111],k=[{keyCode:13,altKey:!1,ctrlKey:!1},{keyCode:32,altKey:!1}];return this.blockDOMKeyDown=!1,c=(f.ctrlKey||f.metaKey)&&f.keyCode===h,d=(f.ctrlKey||f.metaKey)&&f.keyCode===g,e=(f.ctrlKey||f.metaKey)&&f.keyCode===i,(!c&&!d&&!e&&!f.ctrlKey&&!f.altKey&&!f.metaKey&&f.keyCode>=48&&f.keyCode<=90||!f.ctrlKey&&!f.altKey&&j.indexOf(f.keyCode)>=0||b(f))&&this.checkMaxLength(this.keydownCharLength)>0&&(this.blockDOMKeyDown=!0),this.blockDOMKeyDown?(f.preventDefault(),f.stopPropagation(),!1):void 0},onPasteHandler:function(a){var b,c=a.pasteInto,d=this.sandbox.DataProcessor,e=this.sandbox.getOption("container"),f=a.text;c==e&&(f=d.htmlToText(f,this.isInputBased),b=this.checkMaxLength(f.length),b>0&&(f=f.substring(0,f.length-b),f=d.textToHtml(f,this.isInputBased),a.text=f))},onDropHandler:function(a){var b,c=this.sandbox.DataProcessor,d=(this.sandbox.getOption("container"),a.text);1!==a.dropState&&(d=c.htmlToText(d,this.isInputBased),b=this.getTextLength()+d.length-this.maxLength,b>0&&(d=d.substring(0,d.length-b),d=c.textToHtml(d,this.isInputBased),a.text=d))},checkMaxLength:function(a){var b,c=0;return b=this.sandbox.getSelection().getRangeAt(0),b.collapsed()||(b.deleteContents(),b.collapse(!0)),c=this.getTextLength()+a-this.maxLength},getTextLength:function(){var a,b=this.sandbox.getOption("container"),c=this.sandbox.DataProcessor,d=-1;return a=b.innerHTML,this.isInputBased&&this.sandbox.Utils.Browser.gecko&&(a=a.replace(/<br>/gi,"")),d=c.htmlToText(a,this.isInputBased).length}},a.MaxLength=b}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=function(a,b){this.name=a,this.UILib=b.UILib,this.Utils=b.Utils,this.control=b.getOption("container"),this.controlFocused=b.getOption("focused"),this.browser=this.Utils.Browser,this.eventsNames={focus:"focus",blur:"blur",beforefocus:"beforefocus",beforeblur:"beforemanualcontrolblur",restoreSelection:"restoreSelection"},this.sandbox=b,this.bookmark=null};b.prototype={constructor:b,init:function(){var a=this.sandbox,b=this.control;a.subscribe({eventType:this.eventsNames.focus,element:b,handler:this.focusHandler}),a.subscribe({eventType:this.eventsNames.restoreSelection,element:b,handler:this.restoreSelection}),a.subscribe({eventType:this.eventsNames.beforeblur,handler:this.beforeBlurHandler})},restoreSelection:function(){this.bookmark&&(this.sandbox.fire({eventType:"focus",element:this.control}),this.sandbox.restoreSelection(this.bookmark),this.bookmark=null)},focusHandler:function(){var a=this;setTimeout(function(){a.bookmark&&a.sandbox.removeMarkers(a.bookmark)},0)},beforeBlurHandler:function(){this.bookmark=this.sandbox.saveSelection()}},a.FocusManager=b}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b,c,d,e,f=a.prototype.UILib,g=a.prototype.Utils,h=(a.prototype.DataProcessor,{internalDrop:1,externalDrop:2,crossContainerDrop:3}),i=0,j=!1,k=function(a,b){this.name=a,this.sandbox=b,this.container=this.sandbox.getOption("container"),this.isTextBasedContainer=this.sandbox.getOption("isTextBasedContainer")};k.prototype={init:function(){var a=this;return g.Browser.ie&&g.Browser.version<=8?void this.sandbox.subscribe({eventType:"drop",element:this.container,handler:function(b){b.preventDefault(),a.sandbox.console.warn("Drag and Drop functionality are not supported in Internet Explorer 8 and its earlier versions.")}}):(this.sandbox.subscribe({eventType:"drop",element:a.container,handler:a.handleNativeDrop}),this.sandbox.subscribe({eventType:"dragstart",element:a.container,handler:a.handleDragStart}),this.sandbox.subscribe({eventType:"dragend",element:a.container,handler:a.handleDragEnd}),void this.sandbox.subscribe("dropProcessed",function(b){a.handleDrop(b)},this,-2e3))},destroy:function(){this.removeAllEventHandlers()},handleNativeDrop:function(a){var e,f,j,k,l,m,n=this.container;return e=this.isTextBasedContainer||g.Browser.safari||g.Browser.ie?a.dataTransfer.getData("Text")||a.dataTransfer.getData("text/plain"):a.dataTransfer.getData("text/html"),!e&&this.isTextBasedContainer?void a.preventDefault():(i=b?b&&d===n?h.internalDrop:h.crossContainerDrop:h.externalDrop,f=this.getCaretRangeFromDrop(a),!f||this.isCaretRangeInEndOfDragRange(b,f)?void a.preventDefault():(b?(j=this.isCaretRangeWillAffected(b,f),j||(c=this.sandbox.saveRange(b)),k=this.sandbox.saveRange(f),j&&(c=this.sandbox.saveRange(b))):k=this.sandbox.saveRange(f),l=i===h.internalDrop?c:k,m=i===h.internalDrop?k:null,void this.sandbox.fire("dropProcessed",{event:a,text:e,dropState:i,savedRange:l,savedRangeToRemove:m,savedCaretRange:k})))},handleDrop:function(a){a.event.preventDefault(),j=!0,this.addContent(a.text,a.savedCaretRange)},handleDragStart:function(){b=this.sandbox.getSelection().getRangeAt(0),d=this.container},handleDragEnd:function(a){{var d,e;this.sandbox.getOption("data_attribute_name")}(j||"none"!==a.dataTransfer.dropEffect)&&(i===h.crossContainerDrop&&this.sandbox.fire("crossContainerDrop",{event:a,savedRange:c}),d=j?this.sandbox.restoreRange(c):b,d&&j&&(e=this.sandbox.getSelection(),e.removeAllRanges(),e.addRange(d),g.Browser.ie&&this.sandbox.setOption("leftMouseButtonPressed",!1),this.sandbox.fire("removeMarkupInSelectionNode"),d=e.getRangeAt(0),d.deleteContents(),this.sandbox.fire("afterDrop"))),this.clearTemporaryData()},addContent:function(a,b){var c,d,e,h,i,j=this,k=this.sandbox.createRange(),l=this.sandbox.getOption("data_attribute_name"),m=document.createElement("span");a=this.sandbox.getHtmlWithoutSpellingNodes(a),a=this.sandbox.getHtmlWithoutGrammarNodes(a),a=a.replace(/<meta.*?>/i,""),a=a.replace(/style="[^\"]*"/gi,""),m.innerHTML=a,setTimeout(function(){j.sandbox.fire({element:j.container,eventType:"focus"}),i=j.sandbox.getSelection(),c=j.sandbox.restoreRange(b),d=c.startContainer(),g.Browser.ie&&j.sandbox.setOption("leftMouseButtonPressed",!1),g.Browser.ie&&j.sandbox.setOption("focused",!0),0===c.startOffset()&&g.isEqualNode(d,l)?(b=j.sandbox.saveRange(c),j.sandbox.fire("removeMarkupInSelectionNode",{selectionNode:d}),c=j.sandbox.restoreRange(b)):(i.removeAllRanges(),i.addRange(c),j.sandbox.fire("removeMarkupInSelectionNode"),c=i.getRangeAt(0)),c.insertNode(m),e=j.sandbox.createRange(),h=j.sandbox.createRange(),e.selectNode(m),h.selectNodeContents(m),e.commonAncestorContainer().insertBefore(h.extractContents(),m),k.setStartAfter(m),k.collapse(!0),i.removeAllRanges(),i.addRange(k),f.remove(m),j.clearTemporaryData(),j.sandbox.fire("afterDrop")},50)},getCaretRangeFromDrop:function(a){var b=this.sandbox.getSelection(),c=b.rangeCount()>0?b.getRangeAt(0):void 0;return this.sandbox.Utils.Browser.ie&&this.sandbox.Utils.Browser.version>8&&void 0!==c&&i===h.internalDrop?c:this.sandbox.getCaretRangeFromEvent(a)},isCaretRangeWillAffected:function(a,b){return a.endContainer()===b.startContainer()&&a.endOffset()<b.endOffset()?!0:!1},isCaretRangeInEndOfDragRange:function(a,b){return a&&a.endContainer()===b.startContainer()&&a.endOffset()===b.endOffset()?!0:!1},clearTemporaryData:function(){i=0,b=null,c=null,d=null,e=null,j=!1},removeAllEventHandlers:function(){this.sandbox.unsubscribe({eventType:"drop, dragstart, dragend",element:this.container})}},a.DragAndDropManager=k}(WEBSPELLCHECKER.CORE),function(a){"use strict";a.prototype.UILib;WEBSPELLCHECKER.ALT=a.ALT=.1,WEBSPELLCHECKER.CTRL=a.CTRL=.2,WEBSPELLCHECKER.SHIFT=a.SHIFT=.4;var b=function(a,b){this.name=a,this.sandbox=b,this.shortcutsList={},this.modifierKeys=this.sandbox.getOption("modifierKeys")};b.prototype={init:function(){this.setShortcuts(this.sandbox.getOption("shortcutsList")),this.sandbox.subscribe({eventType:"keydown",element:this.sandbox.getOption("container"),handler:this.handleKeydown,priority:1e3}),this.sandbox.subscribe("setShortcuts",function(a){this.setShortcuts(a.shortcuts)},this),this.sandbox.subscribe("removeShortcuts",function(a){this.removeShortcuts(a.shortcuts)},this)},handleKeydown:function(a){var b,c,d=a.keyCode||a.which;if((a.ctrlKey||a.metaKey)&&(d+=this.modifierKeys.CTRL),a.shiftKey&&(d+=this.modifierKeys.SHIFT),a.altKey&&(d+=this.modifierKeys.ALT),d=d.toFixed(1),this.shortcutsList.hasOwnProperty(d))for(var e=0,f=this.shortcutsList[d].length;f>e;e++)b=this.shortcutsList[d][e].callback,c=this.shortcutsList[d][e].context,b.call(c,a)||(a.preventDefault(),a.stopPropagation())},setShortcuts:function(a){if(a.length)for(var b=0,c=a.length;c>b;b++)this.setShortcut(a[b].shortcut,a[b].callback,a[b].context)},setShortcut:function(a,b,c){a=a.toFixed(1),this.shortcutsList.hasOwnProperty(a)||(this.shortcutsList[a]=[]),this.shortcutsList[a].push({callback:b,context:c||this})},removeShortcuts:function(a){if(a.length)for(var b=0,c=a.length;c>b;b++)this.removeShortcut(a[b].shortcut,a[b].callback)},removeShortcut:function(a,b){a=a.toFixed(1);for(var c=0,d=this.shortcutsList[a].length;d>c;c++)this.shortcutsList[a][c].callback===b&&this.shortcutsList[a].splice(c,1)}},a.KeyboardManager=b}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=(a.prototype.UILib,a.prototype.Utils),c=a.prototype.DataProcessor,d=function(a,b){this.name=a,this.sandbox=b,this.data=[],this.container=this.sandbox.getOption("container"),this.limit=this.sandbox.getOption("undoDataSize")||20,this.index=-1,this.isTyping=!1,this.isDeleted=!1,this.isDirty=!1};d.prototype={init:function(){var a=this;this.sandbox.subscribe("allModulesReady",function(){this.setShortcuts()},this),this.sandbox.subscribe({eventType:"keydown",element:this.container,handler:this.handleKeydown,priority:1e3}),this.sandbox.subscribe({eventType:"click",element:this.container,handler:a.handleNavigation}),this.sandbox.subscribe("cutProcessed, replaceProblem",function(){this.handleCutReplace()},this,1e3),this.sandbox.subscribe("pasteProcessed",function(a){this.handlePaste(a)},this,-1e3),this.sandbox.subscribe("dropProcessed",function(a){this.handleDrop(a)},this,-1e3),this.sandbox.subscribe("crossContainerDrop",function(a){this.handleCrossContainerDrop(a)},this),this.sandbox.subscribe("executeUndo",function(){this.undo()},this),this.sandbox.subscribe("executeRedo",function(){this.redo()},this),this.sandbox.subscribe("checkUndoRedoPosibility",function(){this.checkUndoRedoPosibility()},this),this.breakingRichMarkupCommands={bold:!1,underline:!1,italic:!1}},destroy:function(){this.removeAllEventHandlers()},handleKeydown:function(a){var b=a.keyCode||a.which,c=b>=16&&20>=b||91===b||a.altKey||a.ctrlKey||a.metaKey,d=13===b||8===b||46===b;return b>=33&&40>=b?void this.handleNavigation():(d||c||this.isTyping||(this.add({fixRichMarkup:!0}),this.isTyping=!0,this.isDeleted=!1,this.isDirty=!0),13===b&&(this.add(),this.isTyping=!1,this.isDeleted=!1,this.isDirty=!0),void(8!==b&&46!==b||this.isDeleted||(this.add(),this.isTyping=!1,this.isDeleted=!0,this.isDirty=!0)))},setShortcuts:function(){var a=this,b=this.sandbox.getOption("modifierKeys");this.sandbox.fire("setShortcuts",{shortcuts:[{shortcut:b.CTRL+90,callback:a.undo,context:a},{shortcut:b.CTRL+b.SHIFT+90,callback:a.redo,context:a},{shortcut:b.CTRL+89,callback:a.redo,context:a}]}),this.sandbox.getOption("isTextBasedContainer")||this.sandbox.fire("setShortcuts",{shortcuts:[{shortcut:b.CTRL+66,callback:function(){a.execCommand("bold",!1,null),a.setBreakingRichMarkupCommands("bold")},context:a},{shortcut:b.CTRL+73,callback:function(){a.execCommand("italic",!1,null),a.setBreakingRichMarkupCommands("italic")},context:a},{shortcut:b.CTRL+85,callback:function(){a.execCommand("underline",!1,null),a.setBreakingRichMarkupCommands("underline")},context:a}]})},handlePaste:function(a){(!a||a.text)&&(this.add(),this.isDirty=!0)},handleCutReplace:function(){this.add(),this.isDirty=!0},handleDrop:function(a){(!a||a.text)&&(this.add(a),this.isDirty=!0)},handleCrossContainerDrop:function(a){this.add(a),this.isDirty=!0},handleNavigation:function(){this.isTyping&&(this.isTyping=!1),this.isDeleted&&(this.isDeleted=!1),this.clearBreakingRichMarkupCommands()},add:function(a){{var d,e,f;b.getCurrentDocument(this.sandbox.getOption("documentContainer"))}this.data.length&&(d=this.sandbox.removeMarkupFromString(this.data[this.index].html),d=c.getHtmlWithoutRangyMarkerNodes(d)),e=this.sandbox.removeMarkupFromString(this.container.innerHTML),e=c.getHtmlWithoutRangyMarkerNodes(e),this.clearRedo(),(d!==e||a&&a.savedRangeToRemove)&&(a&&a.savedRange||(f=this.sandbox.saveSelection()),this.checkDataLimit(),this.data.push({html:b.removeFillingCharacter(this.container.innerHTML),savedSelection:f?f:null,savedRange:a&&a.savedRange?a.savedRange:null,savedRangeToRemove:a&&a.savedRangeToRemove?a.savedRangeToRemove:null}),f&&this.sandbox.restoreSelection(f),a&&a.fixRichMarkup&&this.fixRichMarkup(),this.clearBreakingRichMarkupCommands(),this.index=this.data.length-1)},undo:function(){this.isDirty&&(this.add(),this.clearFlags()),this.index<=0||(this.container.innerHTML=this.data[--this.index].html,this.restoreSelection(),this.clearFlags(),this.clearBreakingRichMarkupCommands(),this.sandbox.fire("undo",{undoLevel:this.data[this.index]}))},redo:function(){this.index>=this.data.length-1||(this.container.innerHTML=this.data[++this.index].html,this.restoreSelection(),this.clearFlags(),this.clearBreakingRichMarkupCommands(),this.sandbox.fire("redo",{undoLevel:this.data[this.index]}))},checkUndoRedoPosibility:function(){this.sandbox.fire("undoRedoPosibility",{canUndo:this.isDirty||this.index>0?!0:!1,canRedo:this.index<this.data.length-1?!0:!1})},clearRedo:function(){this.data.splice(this.index+1)},clearFlags:function(){this.isTyping=!1,this.isDeleted=!1,this.isDirty=!1},checkDataLimit:function(){this.data.length>this.limit&&this.data.shift()},restoreSelection:function(){var a,b=this.sandbox.getSelection(),c=this.data[this.index].savedSelection,d=this.data[this.index].savedRange,e=this.data[this.index].savedRangeToRemove;e&&this.sandbox.restoreRange(e),c&&(c.restored=!1,this.sandbox.restoreSelection(c)),d&&(a=this.sandbox.restoreRange(d),b.removeAllRanges(),b.addRange(a))},removeAllEventHandlers:function(){this.sandbox.unsubscribe({eventType:"keydown",element:this.container,handler:this.handleKeydown}),this.sandbox.unsubscribe({element:this.container,eventType:"click",handler:this.handleNavigation})},setBreakingRichMarkupCommands:function(a){a in this.breakingRichMarkupCommands&&this.breakingRichMarkupCommands.hasOwnProperty(a)&&(this.breakingRichMarkupCommands[a]=!this.breakingRichMarkupCommands[a])},clearBreakingRichMarkupCommands:function(){for(var a in this.breakingRichMarkupCommands)this.breakingRichMarkupCommands.hasOwnProperty(a)&&(this.breakingRichMarkupCommands[a]=!1)},fixRichMarkup:function(){for(var a in this.breakingRichMarkupCommands)this.breakingRichMarkupCommands.hasOwnProperty(a)&&this.breakingRichMarkupCommands[a]===!0&&this.execCommand(a,!1,null)},execCommand:function(a){var c=b.getCurrentDocument(this.sandbox.getOption("documentContainer"));c.execCommand(a,!1,null)}},a.UndoManager=d}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=(a.prototype.Utils,a.prototype.UILib),c=function(a,b){this.name=a,this.sandbox=b,this.container=this.sandbox.getOption("container"),this.mutationOptions={attributes:!1,attributeOldValue:!1,childList:!0,characterData:!0,characterDataOldValue:!1,subtree:!0}};c.prototype={init:function(){this.sandbox.subscribe("fixBrokenNodes",function(a){this.fixBrokenNodes(a)},this)},fixBrokenNodes:function(a){{var b=this;this.sandbox.getOption("problem_grammar_data_attribute")}this.sandbox.addDeferredFunction("collectBrokenNodesAfterChanges",{single:!0,delay:1e3,deferredFunction:function(){var c=b.collectBrokenNodes(a);b.sandbox.fire("removeMarkup",{nodes:c}),b.sandbox.fire("garbageCollected")}})},lockMutationsListener:function(a){a.lock?this.stopMutationObserver():this.startMutationObserver()},startMutationObserver:function(){this.mutationObserver&&this.mutationObserver.observe(this.container,this.mutationOptions)},stopMutationObserver:function(){this.mutationObserver&&this.mutationObserver.disconnect()},collectBrokenNodes:function(a){for(var c=a&&a.container?[a.container]:[this.container],d=c.shift(),e=this.sandbox.getRegExp("ignoreElementsRegex"),f=new RegExp("(^|\\s)rangySelectionBoundary(\\s|$)"),g=this.sandbox.getRegExp("wordBoundaryRegexAndQuotes"),h=this.sandbox.getRegExp("space"),i=this.sandbox.getDictionary(),j=this.sandbox.getOption("lang"),k=this.sandbox.getOption("data_lang_attribute"),l=[],m=[],n="";d;){switch(d.nodeType){case 3:n+=d.nodeValue;break;case 1:var o=this.sandbox.getFullNodeInfo(d);if(o&&o.broken&&m.push(d),!f.test(b.attr(d,"className"))&&!e.match(d.nodeName)){if(o&&!o.broken){var p,q,r,s,t=d.getAttribute(this.sandbox.getOption(o.attrName)),u=d.textContent||d.innerText,v=u.length,w="grammar"===o.type?d.getAttribute(this.sandbox.getOption(o.attrRuleName)):"";u=this.sandbox.cleanSpecialAndHtmlSpaceCharacters(u),p=j!==b.attr(d,k)?!0:!1,q=i.getProblem({value:u,rule:w,type:o.type},j),r=q?!0:!1,d.isGrammarNode="grammar"===o.type?!0:!1,s={node:d,start:n.length,end:n.length+(v-1)},t!==u||p||!r?m.push(d):l.push(s),d.removeAttribute("style")}for(var x=0;x<d.childNodes.length;x++)c.splice(x,0,d.childNodes[x]);this.sandbox.isBlockElement(d)&&(c.length>d.childNodes.length&&c.splice(x,0,document.createTextNode(" ")),n.length>0&&" "!=n[n.length-1]&&c.splice(0,0,document.createTextNode(" ")))}}d=c.shift()}for(var x=0;x<l.length;x++){var y=l[x],z=n[y.start],A=n[y.end],B=n[y.start-1],C=n[y.end+1];(0!==y.start&&!h.test(z)&&!g.test(B)||y.end!==n.length-1&&!h.test(A)&&!g.test(C))&&m.push(y.node)}return m.reverse()},destroy:function(){this.stopMutationObserver(),this.mutationObserver=null}},a.GarbageCollector=c}(WEBSPELLCHECKER.CORE),window.WEBSPELLCHECKER_CONFIG=window.WEBSPELLCHECKER_CONFIG||{},WEBSPELLCHECKER.init=function(a,b,c){return b="function"==typeof b?b:function(){},c="function"==typeof c?c:function(a){throw a},new WEBSPELLCHECKER._ECInstanceCreator(a,b,c).getInstance()},WEBSPELLCHECKER.getControlById=function(a){return WEBSPELLCHECKER.CORE.prototype.instanceManager.getControlById(a)},WEBSPELLCHECKER.createControlById=function(a,b,c,d){return b=b||{},b.container=document.getElementById(a),WEBSPELLCHECKER.init(b,c,d)},WEBSPELLCHECKER.getInstances=function(){return WEBSPELLCHECKER.CORE.prototype.instanceManager.getInstances()},WEBSPELLCHECKER.destroyAll=function(){WEBSPELLCHECKER.CORE.prototype.instanceManager.destroyAll()},WEBSPELLCHECKER.changeStateForAddedWordsToUserDictionary=function(a){var b,c=WEBSPELLCHECKER.getInstances();if(0!==a.length&&0!==c.length&&(b=c[0],b.changeStateForAddedWordToUserDictionary))for(var d=0;d<a.length;d++)b.changeStateForAddedWordToUserDictionary(a[d])},WEBSPELLCHECKER.changeStateForDeletedWordsFromUserDictionary=function(a){var b,c=WEBSPELLCHECKER.getInstances();if(0!==a.length&&0!==c.length&&(b=c[0],b.changeStateForDeletedWordFromUserDictionary&&b.reloadMarkupInAllInstances)){for(var d=0;d<a.length;d++)b.changeStateForDeletedWordFromUserDictionary(a[d]);b.reloadMarkupInAllInstances()}},WEBSPELLCHECKER.changeStateForProblemsWithDisabledRules=function(a){var b,c=WEBSPELLCHECKER.getInstances();0!==a.length&&0!==c.length&&(b=c[0],b.changeStateForProblemsWithDisabledRules&&b.changeStateForProblemsWithDisabledRules(a))},WEBSPELLCHECKER.changeStateForProblemsWithEnabledRules=function(a){var b,c=WEBSPELLCHECKER.getInstances();0!==a.length&&0!==c.length&&(b=c[0],b.changeStateForProblemsWithEnabledRules&&b.reloadMarkupInAllInstances&&(b.changeStateForProblemsWithEnabledRules(a),b.reloadMarkupInAllInstances()))},function(){var a,b=WEBSPELLCHECKER.OptionsManager,c=b.optionTypes,d=b.importOptionsTemplate("AppTemplate"),e=WEBSPELLCHECKER.CORE.prototype.Utils;a=b.mergeOptionsTemplates({disableOptionsStorage:{defaultValue:[],type:c.array},ecVersion:{defaultValue:2,type:c.positive}},d),a.setDefaults({appType:"proofreader_editable_controls",autoStartup:!0,units:["editableControls","ui"]}),WEBSPELLCHECKER._ECInstanceCreator=function(a,b,c){this.options=a?Object.assign({},a):{},this.callbackSuccess=b,this.callbackError=c,this.instance=null,this.config=window.WEBSPELLCHECKER_CONFIG,this.criticalMessage="",this.create()},WEBSPELLCHECKER._ECInstanceCreator.prototype={constructor:WEBSPELLCHECKER._ECInstanceCreator,create:function(){return this.setContainer(),this.setInstanceIfCreated(),this.isInstanceCreated()?void this.callbackSuccess(this.instance):(this.prepareOptions(),this.setOptions(),this.isIncorrectOptions()?(this.createError(),void this.callbackError(this.error)):(this.setUnitsForOldEc(),this.setMarkupStrategy(),void this.createAppBasedOnConditions()))},setContainer:function(){this.options.container="string"==typeof this.options.container?document.getElementById(this.options.container):this.options.container},setInstanceIfCreated:function(){var a=WEBSPELLCHECKER.CORE.prototype.instanceManager;this.instance=a.getInstanceByElement(this.options.container)},isInstanceCreated:function(){return null!==this.instance},prepareOptions:function(){for(var b in a)this.isOptionInUserOptions(b)||(this.isOptionInConfig(b)&&this.setOptionFromConfig(b),this.isOptionInAttributes(b)&&this.setOptionFromAttributes(b))},isOptionInUserOptions:function(a){return"undefined"!=typeof this.options[a]},isOptionInConfig:function(a){return this.config.hasOwnProperty(a)},setOptionFromConfig:function(a){this.options[a]=this.config[a]},isOptionInAttributes:function(a){var b=a.toLowerCase();return this.options[b]&&b!==a},setOptionFromAttributes:function(a){var b=a.toLowerCase();this.options[a]=this.options[b],delete this.options[b]},setOptions:function(){var c=this;this.options=b.createOptions(this.options,a,function(a){a.reports.forEach(function(a){a.critical&&(c.criticalMessage+=a.message+"; ")})})},isIncorrectOptions:function(){return""!==this.criticalMessage},createError:function(){this.error=new Error(this.criticalMessage)},setUnitsForOldEc:function(){this.isOldEc()&&(this.options.units=["editableControlsVersion1","ui"])},isOldEc:function(){return 1===this.options.ecVersion},setMarkupStrategy:function(){this.options.markupStrategy=this.isOldEc()?"Basic":"Virtual"},createAppBasedOnConditions:function(){return this.isIframe()?this.isIE()?void this.createAppForIframeForIEBrowser():void this.createAppForIframeForOtherBrowsers():void this.createApp()},isIframe:function(){return this.options.container&&this.options.container.nodeName&&"iframe"===this.options.container.nodeName.toLowerCase()},createApp:function(){var a=this,b=WEBSPELLCHECKER._createApp(this.options,function(b){a.instance=a.instance||b,a.extendInstance(),a.callbackSuccess(a.instance)});b&&!this.instance&&(this.instance=b)},extendInstance:function(){Object.assign(this.instance,WEBSPELLCHECKER._ECInstance)},isIE:function(){return this.options.container.attachEvent},createAppForIframeForIEBrowser:function(){var a=this;return"complete"===this.options.container.readyState?void this.createApp():void this.options.container.attachEvent("onload",function(){a.createApp()})},createAppForIframeForOtherBrowsers:function(){var a=this.options.container.contentWindow,b=a.document,c="about:blank",d=this.options.container.src.trim();return"interactive"===b.readyState||"complete"===b.readyState?void(e.Browser.chrome&&a.location.href===c&&d!==c?this.observeOnload():this.createApp()):void this.observeOnload()},observeOnload:function(){var a=this;this.options.container.addEventListener("load",function(){a.createApp()})},getInstance:function(){return this.instance}}}(),WEBSPELLCHECKER._ECInstance={openDialog:function(){this._sandbox.openDialog()},openSettings:function(){this._sandbox.openSettings()},setCssStyles:function(a){var b=this._sandbox.getOption("container");for(var c in a)a.hasOwnProperty(c)&&(b.style[c]=a[c])},setShortcuts:function(a){this._sandbox.fire("setShortcuts",{shortcuts:a})},removeShortcuts:function(a){this._sandbox.fire("removeShortcuts",{shortcuts:a})},getTextLength:function(){var a=this._getService("MaxLength");return a&&a.getTextLength()},refresh:function(){var a=this._getService("Wrapper"),b=this._sandbox.getOption("container");a&&a.isTextBased&&(b.innerHTML=this._sandbox.DataProcessor.textToHtml(a.getData(),a.isInputBased),this.reloadMarkup())},getData:function(){var a=this._getService("Wrapper");return a&&a.getData()},setData:function(a){var b=this._getService("Wrapper");"string"==typeof a&&b&&(b.setData(a),this.reloadMarkup())}},function(){var a=WEBSPELLCHECKER.CORE.prototype.UILib;WEBSPELLCHECKER._autoSearch||a.domReady(function(){WEBSPELLCHECKER._autoSearch=new WEBSPELLCHECKER._AutoSearchCreator,WEBSPELLCHECKER._autoSearch.start({checkAutoSearchOption:!0})})}(),WEBSPELLCHECKER.startAutoSearch=function(){WEBSPELLCHECKER._autoSearch&&WEBSPELLCHECKER._autoSearch.start()},WEBSPELLCHECKER.stopAutoSearch=function(){WEBSPELLCHECKER._autoSearch&&WEBSPELLCHECKER._autoSearch.stop()},function(){var a=WEBSPELLCHECKER.CORE.prototype.UILib,b=WEBSPELLCHECKER.CORE.prototype.Utils,c=WEBSPELLCHECKER.OptionsManager.importOptionsTemplate("AppTemplate"),d=WEBSPELLCHECKER.CORE.prototype.instanceManager,e=b.getBaseData("wscbundle.js").script;WEBSPELLCHECKER._AutoSearchCreator=function(){this.isStarted=!1,this.optionAttrPrefix="data-wsc-",this.options=null,this.config=window.WEBSPELLCHECKER_CONFIG,this.timeoutId=null,this.timeoutDelay=2e3,this.createInstanceTimeoutId=null,this.visibilityApiData=b.getVisibilityApiData(),this.filterType="",this.filterBy={classes:[],attributes:[],ids:[],elements:[]},this.instanceAttribute=c.getDefaultValue("instance_attribute"),this.ignoreByDefaultAttribute=c.getDefaultValue("ignore_by_default__attribute"),this.disableByClass=["sc-input-text","sc-cm-paste-holder","wsc-input","cke_source","fr-code","vO","CodeMirror-code","ql-clipboard"],this.create()},WEBSPELLCHECKER._AutoSearchCreator.prototype={constructor:WEBSPELLCHECKER._AutoSearchCreator,create:function(){this.bindMethods(),this.isBaseScriptAvailable()&&(this.setOptions(),this.configureOptions(),this.configureFilterFunctionality())},bindMethods:function(){this.createInstanceIfRequired=this.createInstanceIfRequired.bind(this),this.handleVisibilityChange=this.handleVisibilityChange.bind(this)},isBaseScriptAvailable:function(){return e},setOptions:function(){var a=b.getOptionsFromDataAttrs(e,this.optionAttrPrefix);this.options=a},configureOptions:function(){this.options.autoStartup=this.options.autostartup===!1||this.config.autoStartup===!1?!1:!0,this.options.enableBadgeButton=this.options.enablebadgebutton===!1||this.config.enableBadgeButton===!1?!1:!0,this.options.appType=this.config.appType||"proofreader_autosearch",this.options.autoDestroy=!0},configureFilterFunctionality:function(){var a,b=this.options.enableautosearchin||this.config.enableAutoSearchIn,c=this.options.disableautosearchin||this.config.disableAutoSearchIn,d=!b&&!c;b?(a=b,this.filterType="enable"):(a=c||[],this.filterType="disable");for(var e=0;e<a.length;e++){var f=a[e];switch(f[0]){case".":this.filterBy.classes.push(f.substring(1));break;case"#":this.filterBy.ids.push(f.substring(1));break;case"[":this.filterBy.attributes.push(f.substring(1,f.length-1));break;default:this.filterBy.elements.push(f)}}d&&this.filterBy.elements.push("input")},start:function(a){a=a||{},this.isStarted||this.isBaseScriptAvailable()&&this.isMutationObserverAvailable()&&(!a.checkAutoSearchOption||this.isAutoSearchIncludedByUser())&&(this.startActiveElementChecking(),this.attachEvents(),this.isStarted=!0)},stop:function(){this.stopActiveElementChecking(),this.stopInstanceCreating(),this.detachEvents(),this.isStarted=!1},isMutationObserverAvailable:function(){return b.isMutationObserver()},isAutoSearchIncludedByUser:function(){return this.options.autosearch||this.config.autoSearch},startActiveElementChecking:function(){var a=this;this.timeoutId=setTimeout(function(){a.startActiveElementChecking()},this.timeoutDelay),this.createInstanceIfRequired()},stopActiveElementChecking:function(){clearTimeout(this.timeoutId),this.timeoutId=null},attachEvents:function(){a.on("blur",window,this.createInstanceIfRequired),a.on("focusin",document,this.createInstanceIfRequired),this.visibilityApiData.hidden&&a.on(this.visibilityApiData.visibilityChangeEvent,document,this.handleVisibilityChange)},detachEvents:function(){a.off("blur",window,this.createInstanceIfRequired),a.off("focusin",document,this.createInstanceIfRequired),a.off(this.visibilityApiData.visibilityChangeEvent,document,this.handleVisibilityChange)},handleVisibilityChange:function(){this.stopActiveElementChecking(),document[this.visibilityApiData.hidden]||this.startActiveElementChecking()},createInstanceIfRequired:function(){var a=this;this.createInstanceTimeoutId=setTimeout(function(){var b,c=a.getActiveElementWithoutInstance();c&&(b=Object.assign({},a.options),b.container=c.iframe?c.iframe:c.element,b.container.wscInProcess||(b.container.wscInProcess=!0,a.handleBeforeInstanceCreate(c),WEBSPELLCHECKER.init(b,function(){delete b.container.wscInProcess})))},0)},stopInstanceCreating:function(){clearTimeout(this.createInstanceTimeoutId),this.createInstanceTimeoutId=null},getActiveElementWithoutInstance:function(){var c,d,e,f=document.activeElement,g=document.getElementsByTagName("body")[0],h=f===g?!0:!1,i=this.isIframe(f),j=b.isTextBased(f),k=b.isInputBased(f),l=f;return i&&(c=this.getIframeBody(f),c?l=c:f=null),f?this.isInstanceCreated(l)?null:this.isDisabledByDefault(l)?null:this.isInFilters(f)?null:h||i?l.isContentEditable?{element:l,iframe:i?f:null}:null:j?this.isIgnoredDueToSpellcheckAttribute(l)?null:(d=b.getComputedStyle(l),b.Browser.edge&&k?null:!k&&this.isTextareaWithHorizontalScroll(l,d)?null:this.isUnsupportedTextBasedElement(l,d)?null:{element:l,type:"textBased"}):a.parents(l,"["+this.instanceAttribute+"]")[0]?null:(e=a.parents(l,'[contenteditable="true"]'),e.length&&(l=e[e.length-1]),l.isContentEditable?{element:l}:null):null},isIframe:function(a){return a&&a.nodeName&&"iframe"===a.nodeName.toLowerCase()},getIframeBody:function(a){var b;try{b=a.contentWindow.document.getElementsByTagName("body")[0]}catch(c){}return b},isInstanceCreated:function(a){return null!==d.getInstanceByElement(a)},isDisabledByDefault:function(b){if("false"===a.attr(b,this.ignoreByDefaultAttribute))return!0;for(var c=0;c<this.disableByClass.length;c++)if(a.hasClass(b,this.disableByClass[c]))return!0;return!1},isInFilters:function(a){var b=this,c={enable:function(a){return b.isElementInFilters(a)?void 0:!0},disable:function(a){return b.isElementInFilters(a)?!0:void 0}};return c[this.filterType](a)},isElementInFilters:function(b){for(var c=0;c<this.filterBy.classes.length;c++)if(a.hasClass(b,this.filterBy.classes[c]))return!0;for(var c=0;c<this.filterBy.attributes.length;c++)if(a.attr(b,this.filterBy.attributes[c]))return!0;for(var c=0;c<this.filterBy.ids.length;c++)if(b.id===this.filterBy.ids[c])return!0;for(var c=0;c<this.filterBy.elements.length;c++)if(b.nodeName.toLowerCase()===this.filterBy.elements[c].toLowerCase())return!0;return!1},isIgnoredDueToSpellcheckAttribute:function(b){return!this.config.ignoreSpellcheckAttribute&&"false"===a.attr(b,"spellcheck")},isTextareaWithHorizontalScroll:function(b,c){return"off"===a.attr(b,"wrap")||"nowrap"===c.whiteSpace},isUnsupportedTextBasedElement:function(a,c){return a.disabled||a.readOnly||b.isHidden(a)||"none"===c.pointerEvents},handleBeforeInstanceCreate:function(a){var b=this.config.onBeforeAutoSearchInstanceCreate;b&&"function"==typeof b&&b(a)}}}(),function(){var a="data-wsc-",b=WEBSPELLCHECKER.CORE.prototype.UILib,c=WEBSPELLCHECKER.CORE.prototype.Utils;
WEBSPELLCHECKER._staticControlCreationActivated||(WEBSPELLCHECKER._staticControlCreationActivated=!0,b.domReady(function(){setTimeout(function(){for(var d,e=b.find("*["+a+"autocreate]"),f=0;f<e.length;f++)d=c.getOptionsFromDataAttrs(e[f],a),d.container=e[f],d.autoStartup=d.autostartup===!1?!1:!0,function(a){WEBSPELLCHECKER.init(d,function(b){e[a].webspellcheckerInstance=b})}(f)},20)}))}(),function(){var a=WEBSPELLCHECKER.CORE.prototype.UILib;a.domReady(function(){var b=a.find("*[autofocus]")[0],c=b&&b.proofraytFakeElement;c&&c.isContentEditable&&c.focus()})}(),function(){var a=WEBSPELLCHECKER.CORE.prototype.UILib;WEBSPELLCHECKER._alreadyAddedFunctionExecuted||(WEBSPELLCHECKER._alreadyAddedFunctionExecuted=!0,a.domReady(function(){"function"==typeof window.webspellcheckerAlreadyLoaded&&window.webspellcheckerAlreadyLoaded()}))}(),function(){var a=WEBSPELLCHECKER.CORE.prototype.UILib,b=WEBSPELLCHECKER.CORE.prototype.Utils;WEBSPELLCHECKER._beforeUnloadSubscribed||(WEBSPELLCHECKER._beforeUnloadSubscribed=!0,(b.Browser.ie&&11===b.Browser.version||b.Browser.edge)&&a.on("beforeunload",window,function(){WEBSPELLCHECKER.stopAutoSearch(),WEBSPELLCHECKER.destroyAll();for(var a in window.WEBSPELLCHECKER)window.WEBSPELLCHECKER.hasOwnProperty(a)&&delete window.WEBSPELLCHECKER[a];delete window.WEBSPELLCHECKER}))}(),function(a){"use strict";var b=a.prototype.UILib,c=a.prototype.Utils,d=a.prototype.DataProcessor,e=function(a,b){this.name=a,this.sandbox=b,this.originalElement=this.sandbox.getOption("originalContainer"),this.mirrorElement=null,this.mirrorElementTextContainer=null,this.oldText="",this.isInput=c.isInputBased(this.originalElement),this.isIE11=c.Browser.ie&&11===c.Browser.version,this.timeoutDelay=1e3,this.timeoutId=null,this.minimalDelay=20,this.longDelay=500,this.isSentenceFinished=!1,this.mutationOptions={attributes:!0,attributeOldValue:!1,childList:!1,characterData:!1,characterDataOldValue:!1,subtree:!1},this.visibilityApiData=c.getVisibilityApiData(),this.properties={outer:["boxSizing","width","height","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderTopStyle","borderRightStyle","borderBottomStyle","borderLeftStyle","borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius","paddingTop","paddingRight","paddingBottom","paddingLeft","direction","fontSize","lineHeight","fontFamily","textAlign"],inner:["fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"]}};e.prototype={init:function(){var a=this;c.isTextBased(this.originalElement)&&!c.isHidden(this.originalElement)&&"MutationObserver"in window&&(this.createMirrorElement(),this.copyStyles(!0),this.updateTextInMirrorContainer(),this.startChecking(),this.sandbox.setOption("mirrorContainer",this.mirrorElement),this.sandbox.setOption("mirrorTextContainer",this.mirrorElementTextContainer),this.sandbox.setOption("isTextBasedContainer",!0),this.mutationObserver=new window.MutationObserver(this.handleMutations.bind(this)),this.startInputListener(),c.Browser.safari||(this.startMutationObserver(),this.sandbox.subscribe("periodicalChecking",function(){a.copyStyles(!0)},this,-2e3)),this.sandbox.subscribe({eventType:"scroll",element:this.originalElement,handler:this.handleScroll}),this.sandbox.subscribe("periodicalChecking",function(){a.copyStyles(!0)},this,-2e3),this.sandbox.subscribe("sentenceFinished",function(){a.handleSentenceFinished()},this,-2e3),this.isInput&&(this.sandbox.subscribe({eventType:"input, keyup, click, change, mousewheel, touchmove",element:this.originalElement,handler:this.handleScroll}),this.sandbox.subscribe({eventType:"focus, blur",element:this.originalElement,handler:this.handleScrollWithDelay})),this.visibilityApiData.hidden&&this.sandbox.subscribe({eventType:this.visibilityApiData.visibilityChangeEvent,element:document,handler:this.handleVisibilityChange}))},createMirrorElement:function(){var a=c.getComputedStyle(this.originalElement),d=this.sandbox.getOption("ignore_by_default__attribute"),e=null,f=null,g=null;e=b.create("<div>")[0],e.style.position="relative",e.style.overflow="visible",e.style.float="left",e.style.display="inline",e.style.width="0",e.style.height="0",e.style.margin="0",e.style.padding="0",e.style.border="none",b.addClass(e,"wsc-mirror"),b.addClass(e,"wsc-element"),f=b.create("<div>")[0],f.style.position="relative",f.style.whiteSpace="pre-wrap",f.style.borderColor="transparent",f.style.color="transparent",f.style.pointerEvents="none",this.isInput||(f.style.wordWrap="break-word"),b.attr(f,"contenteditable",!0),b.attr(f,"spellcheck",!1),b.attr(f,"tabindex",-1),b.attr(f,d,!1),g=b.create("<span>")[0],g.style.visibility="visible",g.style.color="transparent",g.style.whiteSpace="pre-wrap",g.style.margin="0",g.style.padding="0",g.style.border="0",c.Browser.gecko&&(g.style.display="inline-block",this.isInput||(g.style.width="100%")),this.isInput&&(g.style.whiteSpace="nowrap"),b.appendTo(f,e),b.appendTo(g,f),b.appendTo(b.create("<br>")[0],f),b.insertBefore(e,this.originalElement),("static"===this.originalElement.style.position||"static"===a.position)&&(this.originalElement.style.position="relative"),c.Browser.gecko&&!this.isInput&&(this.originalElement.style.lineHeight=a.lineHeight),c.Browser.ie&&(this.originalElement.style.fontFamily=a.fontFamily,this.originalElement.style.fontSize=a.fontSize,this.originalElement.style.lineHeight=a.lineHeight,this.isInput||(this.originalElement.style.msOverflowStyle="-ms-autohiding-scrollbar")),!c.Browser.chrome&&!c.Browser.safari||this.isInput||"border-box"===a.boxSizing||(this.originalElement.style.boxSizing="border-box"),this.mirrorElementWrapper=e,this.mirrorElement=f,this.mirrorElementTextContainer=g,this.oldText=this.originalElement.value},copyStyles:function(a){var b,d,e,f=c.getComputedStyle(this.originalElement),g="rtl"===c.getComputedStyle(this.mirrorElementWrapper).direction,h=this.originalElement.getBoundingClientRect();a&&this.sandbox.fireInAllApps("lockMutationsListener",{lock:!0});for(var i=0;i<this.properties.outer.length;i++){var j=this.properties.outer[i],k=this.mirrorElement.style[j];if("height"!==j&&"width"!==j||!c.Browser.ie)if("textAlign"===j&&this.isIE11)""!==k&&(this.mirrorElement.style[j]="");else{if("overflowY"===j&&c.Browser.gecko)continue;"lineHeight"===j&&this.isInput?this.mirrorElement.style[j]=f.height:k!==j&&(this.mirrorElement.style[j]=f[j])}else this.mirrorElement.style[j]="border-box"===f.boxSizing?h[j]+"px":f[j]}for(var i=0;i<this.properties.inner.length;i++){var j=this.properties.inner[i],l=this.mirrorElementTextContainer.style[j];!this.isInput&&"lineHeight"===j&&c.Browser.gecko&&l!==j?(this.mirrorElementTextContainer.style[j]=f[j],this.originalElement.style[j]!==f[j]&&(this.originalElement.style[j]=f[j])):l!==j&&(this.mirrorElementTextContainer.style[j]=f[j])}if("hidden"!==this.mirrorElement.style.overflowX&&(this.mirrorElement.style.overflowX="hidden"),c.Browser.gecko){var m=Math.round(parseFloat(f.height));this.originalElement.scrollHeight>m&&"scroll"!==this.mirrorElement.style.overflowY&&(this.mirrorElement.style.overflowY="scroll"),this.originalElement.scrollHeight<=m&&"hidden"!==this.mirrorElement.style.overflowY&&(this.mirrorElement.style.overflowY="hidden")}c.Browser.ie&&!this.isInput&&"hidden"!==this.mirrorElement.style.overflowY&&(this.mirrorElement.style.overflowY="hidden"),b=this.mirrorElementWrapper.getBoundingClientRect(),d=this.mirrorElement.getBoundingClientRect(),e=d.right-d.left,d.top!==h.top&&(this.mirrorElement.style.top=h.top-b.top+"px"),d.left!==h.left&&(this.mirrorElement.style.left=h.left-b.left+(g?e:0)+"px"),c.setZIndex(this.originalElement,this.mirrorElementWrapper),a&&this.sandbox.fireInAllApps("lockMutationsListener",{lock:!1})},updateTextInMirrorContainer:function(){var a=this.originalElement.value;this.isInput&&(a=a.replace(/\s/g,"Â ")),a=c.escapeHTML(a),a=a.replace(/\n$/,"\n\n"),this.mirrorElementTextContainer.innerHTML=a},startChecking:function(){var a=this;this.timeoutId=setTimeout(function(){a.startChecking()},this.timeoutDelay),c.Browser.safari&&this.copyStyles(!0),this.checkTextChanges()},stopChecking:function(){clearTimeout(this.timeoutId),this.timeoutId=null},getPosition:function(){var a={x:0,y:0},b=this.sandbox.getOffsetData(this.mirrorElement),c=this.originalElement.getBoundingClientRect();return a.x=c.left-b.left,a.y=c.top-b.top,a},handleMutations:function(){(this.originalElement.style.width&&this.originalElement.style.width!==this.mirrorElement.style.width||this.originalElement.style.height&&this.originalElement.style.height!==this.mirrorElement.style.height)&&this.copyStyles()},handleInput:function(){var a,b=this.getStringsDiff();b&&(a=this.getUpdatedProblemsOffsets(b),this.updateTextInMirrorContainer(),this.sandbox.updateProblemsRanges(a,this.mirrorElementTextContainer.childNodes[0])),this.startProblemCheck()},startProblemCheck:function(){var a=this.isSentenceFinished?this.minimalDelay:this.longDelay,b=this;this.sandbox.addDeferredFunction("collectProblemsAfterDelay",{single:!0,delay:a,deferredFunction:function(){b.sandbox.startProblemCheck(),b.isSentenceFinished=!1}})},handleSentenceFinished:function(){this.isSentenceFinished=!0},handleScroll:function(){var a,b,d,e=this.originalElement.scrollWidth+"px",f=this.originalElement.scrollHeight+"px";c.Browser.gecko&&(this.isInput&&this.mirrorElementTextContainer.style.width!==e?this.mirrorElementTextContainer.style.width=e:this.isInput||this.mirrorElementTextContainer.style.height===f||(this.mirrorElementTextContainer.style.height=f)),c.Browser.ie&&(d=c.getScrollWidthForInput(this.originalElement)+"px",this.isInput&&this.mirrorElementTextContainer.style.width!==d?this.mirrorElementTextContainer.style.width=d:this.isInput||this.mirrorElementTextContainer.style.height===f||(this.mirrorElementTextContainer.style.height=f)),a=this.originalElement.scrollTop,this.mirrorElement.scrollTop=a,this.isInput?(b=c.getScrollLeftForInput(this.originalElement),this.mirrorElement.scrollLeft=b):(b=this.originalElement.scrollLeft,this.mirrorElement.scrollLeft=b),this.sandbox.fire("scrollInMirrorContainer",{})},handleScrollWithDelay:function(){var a=this;setTimeout(function(){a.handleScroll()},0)},handleVisibilityChange:function(){this.stopChecking(),document[this.visibilityApiData.hidden]||this.startChecking()},checkMaxLength:function(){var a=this.originalElement.maxLength,b=this.originalElement.value,c=b.length-a;-1===a||0>=c||(this.originalElement.value=b.substring(0,b.length-c))},checkTextChanges:function(){this.originalElement.value!==this.oldText&&this.handleInput()},getStringsDiff:function(){var a,b,c=this.originalElement.value,d=this.oldText,e=c.length>d.length?!0:!1,f=c.length===d.length?!0:!1,g=e?c:d,h=e?d:c,i=e?c.length-d.length:d.length-c.length;if(d!==c){if(this.oldText=c,c.length>d.length){if(c.substring(0,d.length)===d)return{operation:"insert",clear:!0,changed:0,start:d.length,end:d.length,text:g.substring(d.length),lengthDiff:i};if(c.substring(i)===d)return{operation:"insert",clear:!0,changed:0,start:0,end:0,text:g.substring(0,i),lengthDiff:i}}if(d.length>c.length){if(d.substring(0,c.length)===c)return{operation:"delete",clear:!0,changed:0,start:c.length,end:c.length,text:g.substring(h.length),lengthDiff:i};if(d.substring(i)===c)return{operation:"delete",clear:!0,changed:0,start:0,end:0,text:g.substring(0,i),lengthDiff:i}}for(var j=0;j<g.length;j++)if(g[j]!==h[j]){a=j;break}for(var j=g.length-1;j>=0;j--)if(g[j]!==h[j-i]){b=a-j>0?a+i-1:j;break}return{operation:e?"insert":f?"change":"delete",clear:b-a+1===i?!0:!1,changed:b-a+1===i?0:b-a+1-i,start:a,end:b,text:g.substring(a,b+1),lengthDiff:i}}},startMutationObserver:function(){this.mutationObserver&&this.mutationObserver.observe(this.originalElement,this.mutationOptions)},stopMutationObserver:function(){this.mutationObserver&&this.mutationObserver.disconnect()},startInputListener:function(){this.sandbox.subscribe({eventType:"input",element:this.originalElement,handler:this.handleInput})},stopInputListener:function(){this.sandbox.unsubscribe({eventType:"input",element:this.originalElement,handler:this.handleInput})},getUpdatedProblemsOffsets:function(a){var b,c=[this.mirrorElementTextContainer],d=c.shift(),e=this.sandbox.getRegExp("wordBoundaryRegexAndQuotes"),f=this.sandbox.getOption("markPrefixStart"),g=[],h={},i="";for(this.sandbox.markTextNodes(this.mirrorElement);d;){switch(d.nodeType){case 3:if(d[f])for(var j=0;j<d[f].length;j++)b=d[f][j],g.push({start:i.length+b.offset,end:i.length+b.offset+b.text.length,text:b.text,id:b.id});i+=d.nodeValue;break;case 1:for(var j=0;j<d.childNodes.length;j++)c.splice(j,0,d.childNodes[j])}d=c.shift()}for(var j=0;j<g.length;j++){var k=g[j];if("insert"===a.operation){var l=a.clear?a.start:a.end-a.lengthDiff+1;if(k.start>=l&&(k.start+=a.lengthDiff,k.end+=a.lengthDiff),this.originalElement.value.substring(k.start,k.end)!==k.text)continue}if(!(k.start>=a.start&&k.end-1<=a.end||a.start>=k.start&&a.start<=k.end-1||a.end>=k.start&&a.end<=k.end-1||k.start-a.end===1&&!e.test(this.originalElement.value[a.end])||a.start-(k.end-1)===1&&!e.test(this.originalElement.value[a.start]))){if("delete"===a.operation){var m=a.clear?a.start:a.end-a.lengthDiff+1;if(k.start>=m&&(k.start-=a.lengthDiff,k.end-=a.lengthDiff),this.originalElement.value.substring(k.start,k.end)!==k.text)continue}h[k.id]=k}}return h},getData:function(){return this.originalElement.value||this.sandbox.getHtmlWithoutProblemNodes(this.originalElement.innerHTML)},setData:function(a){a=this.sandbox.getHtmlWithoutProblemNodes(a),this.sandbox.getOption("isTextBasedContainer")?(this.originalElement.value=d.htmlToText(a,this.isInput),this.checkMaxLength(),this.updateTextInMirrorContainer()):this.originalElement.innerHTML=a},destroy:function(){this.stopMutationObserver(),this.mutationObserver=null,this.stopChecking(),this.stopInputListener(),this.mirrorElementWrapper&&(b.remove(this.mirrorElementWrapper),this.mirrorElementWrapper=null,this.mirrorElement=null,this.mirrorElementTextContainer=null)}},a.Mirror=e}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=a.prototype.UILib,c=a.prototype.Utils,d=a.prototype.CharCodeUtils,e=function(a,b){this.name=a,this.sandbox=b,this.isTextBasedContainer=this.sandbox.getOption("isTextBasedContainer"),this.originalElement=this.sandbox.getOption(this.sandbox.getOption("isTextBasedContainer")?"mirrorContainer":"originalContainer"),this.mirrorElement=null,this.isVirtualMarkupStrategy="Virtual"===this.sandbox.getOption("markupStrategy"),this.properties=["boxSizing","width","height","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderTopStyle","borderRightStyle","borderBottomStyle","borderLeftStyle","paddingTop","paddingRight","paddingBottom","paddingLeft"],this.timeoutId=null,this.mutatedParentBlocks=[],this.updateDelay=1e3/60,this.cleanDelay=250,this.stateBeforeReplace={}};e.prototype={constructor:e,init:function(){this.isVirtualMarkupStrategy&&(this.createMirrorElement(),this.copyStyles(),this.handleScroll(),this.sandbox.setOption("contenteditableMirrorContainer",this.mirrorElement),this.attachEvents(),this.virtualProblemManager=new f(this.sandbox,this.mirrorElementProblemBox,this.getProblemTypes()),this.sandbox.subscribe("periodicalChecking",function(){this.repaintMirrorLayout()},this,-2e3),this.sandbox.subscribe("toggleApp",function(a){a.flag?this.attachEvents():this.detachEvents()},this),this.sandbox.subscribe("containerMutated",function(a){this.handleMutations(a)},this),this.sandbox.subscribe("saveStateBeforeReplace",function(a){this.saveStateBeforeReplace(a)},this))},createMirrorElement:function(){var a=null,c=null,d=null;a=b.create("<div>")[0],a.style.position="relative",a.style.overflow="visible",a.style.float="left",a.style.display="inline",a.style.width="0",a.style.height="0",a.style.margin="0",a.style.padding="0",a.style.border="none",b.addClass(a,"wsc-contenteditable-mirror"),b.addClass(a,"wsc-element"),c=b.create("<div>")[0],c.style.position="relative",c.style.overflow="hidden",c.style.borderColor="transparent",c.style.color="transparent",c.style.pointerEvents="none",b.appendTo(c,a),d=b.create("<div>")[0],d.style.position="relative",d.style.margin="0",d.style.padding="0",d.style.minWidth="100%",d.style.minHeight="100%",d.style.border="0",b.appendTo(d,c),b.insertBefore(a,this.originalElement),this.mirrorElementWrapper=a,this.mirrorElement=c,this.mirrorElementProblemBox=d},disableNativeSpellCheck:function(){var a=b.attr(this.originalElement,"spellcheck"),c=!1;(void 0===a||"true"===a||a===!0)&&(c=!0),c&&b.attr(this.originalElement,"spellcheck",!1)},copyStyles:function(){var a,b,d,e=c.getComputedStyle(this.originalElement),f="rtl"===c.getComputedStyle(this.mirrorElementWrapper).direction,g=this.originalElement.getBoundingClientRect();this.sandbox.fireInAllApps("lockMutationsListener",{lock:!0});for(var h=0;h<this.properties.length;h++){var i,j=this.properties[h],k=this.mirrorElement.style[j];i="height"===j||"width"===j?c.Browser.ie&&"border-box"===e.boxSizing?g[j]+"px":"auto"===e[j]?this.originalElement["offset"+j[0].toUpperCase()+j.slice(1)]+"px":e[j]:e[j],k!==i&&(this.mirrorElement.style[j]=i)}a=this.mirrorElementWrapper.getBoundingClientRect(),b=this.mirrorElement.getBoundingClientRect(),d=b.right-b.left,b.top!==g.top&&(this.mirrorElement.style.top=g.top-a.top+"px"),b.left!==g.left&&(this.mirrorElement.style.left=g.left-a.left+(f?d:0)+"px"),c.setZIndex(this.originalElement,this.mirrorElementWrapper),this.sandbox.fireInAllApps("lockMutationsListener",{lock:!1})},handleScroll:function(){var a=this.originalElement.scrollWidth+"px",b=this.originalElement.scrollHeight+"px";this.mirrorElementProblemBox.style.width!==a&&(this.mirrorElementProblemBox.style.width=a),this.mirrorElementProblemBox.style.height!==b&&(this.mirrorElementProblemBox.style.height=b),this.mirrorElement.scrollTop=this.originalElement.scrollTop,this.mirrorElement.scrollLeft=this.originalElement.scrollLeft},attachEvents:function(){this.sandbox.subscribe(this.sandbox.getOption("isTouchDevice")?{eventType:"orientationchange",element:window,handler:this.repaintMirrorLayout}:{eventType:"resize",element:window,handler:this.repaintMirrorLayout}),this.isTextBasedContainer?this.sandbox.subscribe("scrollInMirrorContainer",function(){this.handleScroll()},this):this.sandbox.subscribe({eventType:"scroll",element:this.originalElement,handler:this.handleScroll})},repaintMirrorLayout:function(a){var b=this,c=0;a&&"orientationchange"===a.type&&(c=500),this.timeoutId=setTimeout(function(){b.copyStyles(),b.handleScroll(),b.virtualProblemManager.updateProblems()},c)},getProblemTypes:function(){return this.problemTypes||(this.problemTypes=this.sandbox.getProblemTypes()),this.problemTypes},detachEvents:function(){this.sandbox.unsubscribe(this.sandbox.getOption("isTouchDevice")?{eventType:"orientationchange",element:window,handler:this.repaintMirrorLayout}:{eventType:"resize",element:window,handler:this.repaintMirrorLayout}),this.isTextBasedContainer||this.sandbox.unsubscribe({eventType:"scroll",element:this.originalElement,handler:this.handleScroll})},handleMutations:function(a){var b=this;this.mutatedParentBlocks=this.mutatedParentBlocks.concat(a.mutatedParentBlocks),this.mutatedParentBlocks=c.ArrayUtils.arrayUnique(this.mutatedParentBlocks,function(a,b){return a===b}),a.isStylesChanged&&this.disableNativeSpellCheck(),this.sandbox.addDeferredFunction("updateProblems",{single:!0,delay:this.updateDelay,deferredFunction:function(){b.virtualProblemManager.updateProblems(b.mutatedParentBlocks,b.stateBeforeReplace),b.mutatedParentBlocks=[],b.stateBeforeReplace={}}}),this.sandbox.addDeferredFunction("cleanProblems",{single:!0,delay:this.cleanDelay,deferredFunction:function(){b.virtualProblemManager.cleanProblems()}})},saveStateBeforeReplace:function(a){var b=this.sandbox.collectInfoFromNode(a.problem.parentBlock,{markTextNodes:!0}),c=a.problem.text,d=a.text,e=d.length-c.length,f=!1;for(var g in b.foundedProblems)b.foundedProblems.hasOwnProperty(g)&&(b.foundedProblems[g].id!==a.problem.id?f&&(b.foundedProblems[g].start+=e,b.foundedProblems[g].end+=e):(b.resultText=b.resultText.substring(0,b.foundedProblems[g].start)+d+b.resultText.substring(b.foundedProblems[g].end+1),delete b.foundedProblems[g],f=!0));this.stateBeforeReplace={foundedProblems:b.foundedProblems,resultText:b.resultText,parentBlock:a.problem.parentBlock}},destroy:function(){this.detachEvents(),clearTimeout(this.timeoutId),this.mirrorElementWrapper&&(this.virtualProblemManager.clear(),b.remove(this.mirrorElementWrapper),this.mirrorElementWrapper=null,this.mirrorElement=null,this.mirrorElementProblemBox=null)}};var f=function(a,b,c){this.sandbox=a,this.container=b,this.problemTypes=c,this.prefix="problem_",this.storage=Object.create(null),this.problemsCount=0,this.mutatedBlocksIndexes=Object.create(null),this.workWithActiveProblem=!1,this.activeProblem=null,this.head=null,this.tail=null};f.prototype={addProblem:function(a){var b=new f.Problem({text:a.text,type:a.type,range:a.range,lang:a.lang,rule:a.rule||"",id:a.id,parentBlock:a.parentBlock,problemTypesItem:a.problemTypesItem,label:a.label||!1,sandbox:this.sandbox,container:this.container});this.addProblemToStorage(b),b.isLabel()||(this.addToLinkedList(b),this.isActiveProblemUnset()&&this.changeActiveProblem(b))},addProblemToStorage:function(a){var b,c=this.prefix+a.text,d=this.sandbox.getOption("parentBlockPrefix"),e=a.parentBlock[d],f=this.container.getBoundingClientRect();this.storage[e]=this.storage[e]||Object.create(null),this.storage[e].node=this.storage[e].node||a.parentBlock,this.storage[e].coordinates||(b=a.parentBlock.getBoundingClientRect(),this.storage[e].coordinates={top:b.top-f.top,left:b.left-f.left,width:b.right-b.left,height:b.bottom-b.top}),this.storage[e].problems=this.storage[e].problems||Object.create(null),this.storage[e].problems[c]=this.storage[e].problems[c]||[],this.storage[e].problems[c].push(a),!a.isLabel()&&this.problemsCount++},addToLinkedList:function(a){var b;if(null===this.head)return this.head=a,void(this.tail=a);for(b=this.head;null!==b;){if(-1===a.range.compareBoundaryPoints(Range.START_TO_START,b.range))return this.head===b?this.head=a:(b.prev.next=a,a.prev=b.prev),a.next=b,void(b.prev=a);if(this.tail===b)return a.prev=b,b.next=a,void(this.tail=a);b=b.next}},removeFromLinkedList:function(a){var b=a.prev,c=a.next;return a.prev=null,a.next=null,this.head===a&&this.tail===a?(this.head=null,void(this.tail=null)):this.head===a?(this.head=c,void(c.prev=null)):this.tail===a?(this.tail=b,void(b.next=null)):(null!==b&&(b.next=c),void(null!==c&&(c.prev=b)))},getFirstProblem:function(){return this.head},getLastProblem:function(){return this.tail},getNextProblem:function(a){var b=this.sandbox.getOption("globalProofreadDialog");return this.tail===a?this.head===a||b?null:this.head:a.next},getPrevProblem:function(a){var b=this.sandbox.getOption("globalProofreadDialog");return this.head===a?this.tail===a||b?null:this.tail:a.prev},isActiveProblemUnset:function(){return this.workWithActiveProblem&&null===this.activeProblem},changeActiveProblem:function(a,b){this.workWithActiveProblem&&(this.setActiveProblem(a),this.sandbox.fireInAllApps("activeProblemChanged",{problem:a,prev:b?!0:!1}))},setActiveProblem:function(a){this.activeProblem=a},startWorkWithActiveProblem:function(a){this.workWithActiveProblem=!0,this.changeActiveProblem(a?this.getLastProblem():this.getFirstProblem())},finishWorkWithActiveProblem:function(){this.workWithActiveProblem=!1,this.activeProblem=null},isActiveProblem:function(a){return this.workWithActiveProblem&&this.activeProblem===a},setNextProblemActive:function(){this.changeActiveProblem(this.getNextProblem(this.activeProblem))},setPrevProblemActive:function(){this.changeActiveProblem(this.getPrevProblem(this.activeProblem),!0)},clear:function(){this.container.innerHTML="",this.storage=Object.create(null),this.problemsCount=0,this.mutatedBlocksIndexes=Object.create(null),this.changeActiveProblem(null),this.head=null,this.tail=null},getProblemIfAdded:function(a){var b,c=this.prefix+a.text,d=this.sandbox.getOption("parentBlockPrefix"),e=a.parentBlock[d];if(void 0===e||!this.storage[e]||!this.storage[e].problems[c])return null;for(var f=0;f<this.storage[e].problems[c].length;f++)if(b=this.storage[e].problems[c][f],b.isEqual(a))return b;return null},removeProblemsByText:function(a){var b,c=this.prefix+a.text;for(var d in this.storage)if(this.storage[d].problems[c])for(var e=this.storage[d].problems[c].length-1;e>=0;e--)b=this.storage[d].problems[c][e],b.type===a.problemType&&(a.rule&&b.rule!==a.rule||this.removeProblem({text:a.text,index:e,parentBlockIndex:d}))},removeProblem:function(a){var b,c,d,e,f=this.prefix+a.text;if(this.storage[a.parentBlockIndex]&&this.storage[a.parentBlockIndex].problems[f]){b=this.storage[a.parentBlockIndex].problems[f],c=b[a.index],d=c.isIgnored()||c.isLabel(),this.sandbox.fireInAllApps("lockMutationsListener",{lock:!0});for(var g=0;g<c.elements.length;g++)e=c.elements[g],e.parentNode.removeChild(e);this.sandbox.fireInAllApps("lockMutationsListener",{lock:!1}),b.splice(a.index,1),!d&&this.problemsCount--,!a.skipActiveProblemChange&&this.isActiveProblem(c)&&this.changeActiveProblem(this.getNextProblem(c)),!d&&this.removeFromLinkedList(c),b.length||delete this.storage[a.parentBlockIndex].problems[f],Object.keys(this.storage[a.parentBlockIndex].problems).length||delete this.storage[a.parentBlockIndex]}},removeProblemById:function(a){var b,c=this.prefix+a.text,d=!1;for(var e in this.storage){if(d)break;if(this.storage[e].problems[c])for(var f=this.storage[e].problems[c].length-1;f>=0;f--)if(b=this.storage[e].problems[c][f],b.id===a.id){this.removeProblem({text:a.text,index:f,parentBlockIndex:e}),d=!0;break}}},removeProblemsByRules:function(a){var b=this;this.each(function(c,d,e){a.rules.hasOwnProperty(c.rule)&&b.removeProblem({text:c.text,index:d,parentBlockIndex:e})})},updateProblems:function(a,b){var c,a=a||[],b=b||{};this.sandbox.fireInAllApps("lockMutationsListener",{lock:!0}),c=this.getProblemsToUpdatingAndRemoveBrokenProblems(a,b),this.updatePositions(c),this.sandbox.fireInAllApps("lockMutationsListener",{lock:!1})},getProblemsToUpdatingAndRemoveBrokenProblems:function(a,b){var d,e,f,g,h,i,j,k=function(a){a.updateCoordinates(),m.push(a)},b=c.isEmptyObject(b)?null:b,l=!1,m=[];this.markMutatedBlocks(a);for(var n in this.storage)if(d=this.storage[n],e=null,f=this.isParentBlockChangedPosition(d)||d.isMutated){null!==b&&b.parentBlock===d.node&&(e=this.getStateForRestoringAfterReplace(b));for(var o in this.storage[n].problems){g=this.storage[n].problems[o];for(var p=g.length-1;p>=0;p--)h=g[p],h.isBroken()&&(null===e||!e.problems.hasOwnProperty(h.id)||(i=e.problems[h.id],j=c.getRangeBoundaryPoints(e.customModel,i.start,i.end),h.updateRange(j.startContainer,j.startOffset,j.endContainer,j.endOffset),h.isBroken()))?(this.isActiveProblem(h)&&(l=!0,this.setActiveProblem(this.getNextProblem(h))),this.removeProblem({text:h.text,index:p,parentBlockIndex:n,skipActiveProblemChange:!0})):k(h)}delete d.isMutated}return l&&this.changeActiveProblem(this.activeProblem),m},markMutatedBlocks:function(a){for(var b,c,d=this.sandbox.getOption("parentBlockPrefix"),e=0;e<a.length;e++)b=a[e],c=b[d],void 0!==c&&this.storage[c]&&(this.storage[c].isMutated=!0,this.mutatedBlocksIndexes[c]=!0)},isParentBlockChangedPosition:function(a){var b,c,d=this.container.getBoundingClientRect();try{b=a.node.getBoundingClientRect()}catch(e){b={top:0,right:0,bottom:0,left:0,width:0,height:0}}return c={top:b.top-d.top,left:b.left-d.left,width:b.right-b.left,height:b.bottom-b.top},a.coordinates.top!==c.top||a.coordinates.left!==c.left||a.coordinates.width!==c.width||a.coordinates.height!==c.height||0===c.width||0===c.height?(a.coordinates=c,!0):!1},getStateForRestoringAfterReplace:function(a){var b,c,d=this.sandbox.getOption("container"),e={problems:{}};if(!d.contains(a.parentBlock))return null;if(b=this.sandbox.collectInfoFromNode(a.parentBlock,{fullInfo:!0}),b.resultText!==a.resultText)return null;e.customModel=b.customModel;for(var f in a.foundedProblems)a.foundedProblems.hasOwnProperty(f)&&(c=a.foundedProblems[f],e.problems[c.id]={start:c.start,end:c.end});return e},updatePositions:function(a){for(var b,c,d=this.container.getBoundingClientRect(),e=0;e<a.length;e++)b=a[e],c=!b.updatePosition(d),c&&this.isActiveProblem(b)&&this.changeActiveProblem(b)},getProblem:function(a,b){var c,d,e=a.getAttribute(this.sandbox.getOption(b.attrName)),f=this.prefix+e,g=this.sandbox.getOption("parentBlockPrefix"),h=a[g],i=null,j=!1;if(!this.storage[h])return i;if(!this.storage[h].problems[f])return i;for(var k=0;k<this.storage[h].problems[f].length;k++){c=this.storage[h].problems[f][k];for(var l=0;l<c.elements.length;l++)if(d=c.elements[l],d===a){i={problem:c,index:k,parentBlockIndex:h},j=!0;break}if(j)break}return i},getProblemsByTextNode:function(a){var b,c,d,e,f,g,h=this.sandbox.getOption("parentBlockPrefix"),i=[];if(!a.node||!a.parentBlock)return i;if(b=a.parentBlock[h],!this.storage[b])return i;for(var c in this.storage[b].problems){d=this.storage[b].problems[c];for(var j=0;j<d.length;j++)e=d[j],f=a.node===e.range.startContainer,g=a.node===e.range.endContainer,(f||g)&&i.push(e)}return i},setProblemToIgnoredState:function(a,b){var c=this.getProblem(a,b);c&&(c.problem.setIgnored(),this.problemsCount--,this.changeActiveProblem(this.getNextProblem(c.problem)),this.removeFromLinkedList(c.problem))},each:function(a){if("function"==typeof a)for(var b in this.storage)for(var c in this.storage[b].problems)for(var d=this.storage[b].problems[c].length-1;d>=0;d--)a(this.storage[b].problems[c][d],d,b)},getProblemsCount:function(){return this.problemsCount},getProblemNodeFromMouseEvent:function(a){var b,d,e,f=this.container.getBoundingClientRect(),g={left:a.clientX-f.left,top:a.clientY-f.top},h={node:null},i=[];for(var j in this.storage)if(c.inRect(g,this.storage[j].coordinates))for(var k in this.storage[j].problems)for(var l=0;l<this.storage[j].problems[k].length;l++)if(b=this.storage[j].problems[k][l],d=b.getElementByCoordinates(g),null!==d){b.isIgnored()||i.push({problem:b,node:d});break}for(var e in this.problemTypes)for(var l=0;l<i.length;l++)if(i[l].problem.type===e)return h.node=i[l].node,h.parts=i[l].problem.elements,h;return h},cleanProblems:function(){var a,b,e,f,g,h,i=this.sandbox.prepareCustomPunctuation(),j=!1;for(var a in this.mutatedBlocksIndexes)if(b=this.storage[a]){e=this.sandbox.collectInfoFromNode(b.node,{fullInfo:!0});for(var k in b.problems){f=b.problems[k];for(var l=f.length-1;l>=0;l--){var m,n,o,p;g=f[l],h=c.getRangeOffsetInText(g.range,e.textNodes),void 0!==h.start&&void 0!==h.end&&(h.start>0&&(m=e.resultText[h.start].charCodeAt(0),n=e.resultText[h.start-1].charCodeAt(0)),h.end<e.resultText.length-1&&(o=e.resultText[h.end].charCodeAt(0),p=e.resultText[h.end+1].charCodeAt(0)),(0!==h.start&&!d.isWordBoundaryExtended(m,i)&&!d.isWordBoundaryExtended(n,i)||h.end!==e.resultText.length-1&&!d.isWordBoundaryExtended(o,i)&&!d.isWordBoundaryExtended(p,i))&&(this.isActiveProblem(g)&&(j=!0,this.setActiveProblem(this.getNextProblem(g))),this.removeProblem({text:g.text,index:l,parentBlockIndex:a,skipActiveProblemChange:!0})))}}}j&&this.changeActiveProblem(this.activeProblem),this.mutatedBlocksIndexes=Object.create(null)},markTextNodes:function(a){var b,c=this.sandbox.getOption("parentBlockPrefix"),d=this.sandbox.getTextContainer(),e=d===a,f=a[c];if(e||this.storage[f])for(var g in this.storage)if(e||Number(g)===f)for(var h in this.storage[g].problems){b=this.storage[g].problems[h];for(var i=0;i<b.length;i++)this.sandbox.markTextNode(b[i])}},updateProblemsRanges:function(a,b){this.each(function(c){if(a.hasOwnProperty(c.id)){var d=a[c.id],e=d.node||b;c.updateRange(e,d.start,e,d.end)}})}},f.Problem=function(a){this.text=a.text,this.type=a.type,this.range=a.range,this.lang=a.lang,this.rule=a.rule||"",this.id=a.id,this.parentBlock=a.parentBlock,this.sandbox=a.sandbox,this.container=a.container,this.problemTypesItem=a.problemTypesItem,this.label=a.label,this.coordinates=c.getCoordinatesFromRange(a.range),this.ignored=!1,this.elements=this.createElements(),this.prev=null,this.next=null
},f.Problem.prototype={constructor:f.Problem,createElements:function(){for(var a,c=[],d=0;d<this.coordinates.length;d++)a=this.createElement(this.coordinates[d]),b.appendTo(a,this.container),c.push(a);return c},createElement:function(a){var d,e=c.getCurrentDocument(this.sandbox.getOption("documentContainer")),f=this.container.getBoundingClientRect(),g=this.problemTypesItem,h=this.sandbox.getOption("parentBlockPrefix"),i=this.parentBlock[h];return d=e.createElement(this.sandbox.getOption(g.nodeName)),b.addClass(d,this.sandbox.getOption(g.classOption)),d.setAttribute(this.sandbox.getOption(g.attrName),this.text),d.setAttribute(this.sandbox.getOption(g.attrLang),this.lang),d.setAttribute(this.sandbox.getOption(g.attrId),this.id),this.rule&&d.setAttribute(this.sandbox.getOption(g.attrRuleName),this.rule),d.style.position="absolute",d.style.width=(a.right-a.left).toFixed(1)+"px",d.style.height=(a.bottom-a.top).toFixed(1)+"px",d.style.top=(a.top-f.top).toFixed(1)+"px",d.style.left=(a.left-f.left).toFixed(1)+"px",d[h]=i,d},isEqual:function(a){var b=this.type===a.problemType,d=c.isEqualRanges(this.range,a.range);return b&&d?!0:!1},isBroken:function(){var a=this.range.collapsed,b=this.sandbox.cleanSpecialAndHtmlSpaceCharacters(this.range.toString())!==this.text,c=3!==this.range.startContainer.nodeType||3!==this.range.endContainer.nodeType,d=0===this.range.startContainer.length||0===this.range.endContainer.length,e=this.elements[0].removeLater||this.elements[this.elements.length-1].removeLater;return a||b||c||d||e},updateCoordinates:function(){this.coordinates=c.getCoordinatesFromRange(this.range)},updatePosition:function(a){var b,c,d,e,f=this.coordinates,a=a||this.container.getBoundingClientRect();if(f.length!==this.elements.length)return this.elements.forEach(function(a){a.parentNode.removeChild(a)}),this.elements=this.createElements(),!1;for(var g=0;g<f.length;g++)b=Number((f[g].right-f[g].left).toFixed(1))+"px",c=Number((f[g].bottom-f[g].top).toFixed(1))+"px",d=Number((f[g].top-a.top).toFixed(1))+"px",e=Number((f[g].left-a.left).toFixed(1))+"px",b!==this.elements[g].style.width&&(this.elements[g].style.width=b),c!==this.elements[g].style.height&&(this.elements[g].style.height=c),d!==this.elements[g].style.top&&(this.elements[g].style.top=d),e!==this.elements[g].style.left&&(this.elements[g].style.left=e);return!0},getElementByCoordinates:function(a){for(var b,d,e=0;e<this.elements.length;e++)if(b=this.elements[e],d={top:parseFloat(b.style.top),left:parseFloat(b.style.left),width:parseFloat(b.style.width),height:parseFloat(b.style.height)},c.inRect(a,d))return b;return null},setIgnored:function(){this.ignored=!0},isIgnored:function(){return this.ignored},updateRange:function(a,b,c,d){this.range.setStart(a,b),this.range.setEnd(c,d)},isLabel:function(){return this.label}},a.ContenteditableMirror=e}(WEBSPELLCHECKER.CORE),function(a){"use strict";var b=function(a,b){this.name=a,this.sandbox=b,this.container=this.sandbox.getOption(this.sandbox.getOption("isTextBasedContainer")?"mirrorContainer":"container"),this.mutationOptions={attributes:!0,attributeOldValue:!1,childList:!0,characterData:!0,characterDataOldValue:!1,subtree:!0}};b.prototype={init:function(){this.sandbox.getOption("isMutationObserver")&&(this.mutationObserver=new window.MutationObserver(this.handleMutations.bind(this)),this.startMutationObserver(),this.sandbox.subscribe("toggleApp",function(a){a.flag?this.startMutationObserver():this.stopMutationObserver()},this))},handleMutations:function(a){for(var b,c,d,e=[],f=!1,g=!1,h=!1,i=0;i<a.length;i++)b=a[i],c=this.sandbox.getParentBlockElement(b.target,this.container),d=!1,this.isDataChanged(b)&&(f=!0,d=!0,this.isDataChangedInContainer(c)&&(g=!0)),this.isStylesChanged(b)&&(h=!0,d=!0),d&&e.push(c);(f||h)&&(e=this.sandbox.Utils.ArrayUtils.arrayUnique(e,function(a,b){return a===b}),this.sandbox.fire("containerMutated",{mutations:a,mutatedParentBlocks:e,isDataChanged:f,isStylesChanged:h,isDataChangedInContainer:g}))},isDataChanged:function(a){return"attributes"!==a.type},isDataChangedInContainer:function(a){return a===this.container?!0:a.parentNode===this.container&&1===this.container.children.length?!0:!1},isStylesChanged:function(a){var b=["style","dir","spellcheck"];return"attributes"!==a.type?!1:b.includes(a.attributeName)?!0:"class"===a.attributeName&&a.target!==this.container?!0:!1},startMutationObserver:function(){this.mutationObserver&&this.mutationObserver.observe(this.container,this.mutationOptions)},stopMutationObserver:function(){this.mutationObserver&&this.mutationObserver.disconnect()},destroy:function(){this.stopMutationObserver(),this.mutationObserver=null}},a.MutationObserver=b}(WEBSPELLCHECKER.CORE),function(){function a(a,b){var c;a=Object.assign({},a);for(var d in a)c=b[d],c&&(a[c]=a[d],delete a[d]);return a}function b(b,c,d,e,f){b=a(b,c);var g=d(b,e,f);return g}function c(a){function b(a,b){for(var c in b)"undefined"==typeof a[c]&&(a[c]=b[c])}var c;if(a.scayt_srcUrl&&(a.basePath=a.scayt_srcUrl.replace("ckscayt.js",""),a.basePath=a.basePath.replace("tinymcescayt.js","")),!a.basePath)for(var d in i)if(a.basePath=e.getBaseData(d+".js").path,a.basePath)break;return a.basePath?(c=e.getLocationInfo(a.basePath),b(a,{serviceProtocol:c.protocol,serviceHost:c.host,servicePort:c.port,servicePath:c.pathname+"./../../../script/ssrv.cgi"}),a):void 0}function d(){if("object"===_typeof(window.SCAYT_CONFIG)){window.WEBSPELLCHECKER_CONFIG=window.WEBSPELLCHECKER_CONFIG||{};var a="";for(var b in window.SCAYT_CONFIG)a=h[b]||b,window.WEBSPELLCHECKER_CONFIG[a]=window.SCAYT_CONFIG[b]}}window.SCAYT=WEBSPELLCHECKER.CORE;var e=SCAYT.prototype.Utils,f={customer_id:"serviceId",ignoreElementsRegex:"ignoreElements",ignoreGraytElementsRegex:"ignoreGrammarElements",graytAutoStartup:"enableGrammar",service_protocol:"serviceProtocol",service_host:"serviceHost",service_port:"servicePort",service_path:"servicePath",customDictionary:"customDictionaryIds","ignore-words-with-mixed-cases":"ignoreWordsWithMixedCases","ignore-all-caps-words":"ignoreAllCapsWords","ignore-domain-names":"ignoreDomainNames","ignore-words-with-numbers":"ignoreWordsWithNumbers"},g=function(c,d,e){var g,h,i=f,j={graytStateChanged:"enableGrammarChanged",getGrammarSuggestionsList:"getSuggestionsList"};if(c.autoStartup=!0,c.units=[],c["options-to-restore"])for(var k=0;k<c["options-to-restore"].length;k+=1)g=c["options-to-restore"][k],i[g]&&(c["options-to-restore"][k]=i[g]);window.WEBSPELLCHECKER_CONFIG&&window.WEBSPELLCHECKER_CONFIG.syncOptions===!1&&(c.syncOptions=!1);var l=b(c,i,WEBSPELLCHECKER._createApp,d,e),m=l.subscribe;l._getOption=l.getOption,l.getOption=function(a){return h={wordBoundaryRegex:l._sandbox.getRegExp("wordBoundaryRegex")._getRegExp()},h[a]?h[a]:l._getOption(a)},l.subscribe=function(a){var b=[];a=j[a]?j[a]:a,b[0]=a;for(var c=1;c<arguments.length;c++)b[c]=arguments[c];m.apply(l,b)};var n=l.fire;l.fire=function(a,b){var c=[],d=l._sandbox.getOption("data_id_attribute");"getSuggestionsList"===a&&(b.value=b.word,b.type="spelling",b.id=l.problemNodeFromSelection&&l.problemNodeFromSelection.getAttribute(d)),"getGrammarSuggestionsList"===a&&(b.rule||(b.rule=l.problemNodeFromSelection&&l.problemNodeFromSelection.getAttribute(l.getGrammarNodeRuleAttributeName())),b.value=b.phrase,b.type="grammar",b.id=l.problemNodeFromSelection&&l.problemNodeFromSelection.getAttribute(d)),a=j[a]?j[a]:a,c[0]=a;for(var e=1;e<arguments.length;e++)c[e]=arguments[e];n.apply(l,arguments)};var o=l.getProblemDescriptionText;l.getProblemDescriptionText=function(a,b,c){var d,e=l._sandbox.getOption("data_id_attribute");return 2===arguments.length&&(c=b,b=l.problemNodeFromSelection&&l.problemNodeFromSelection.getAttribute(l.getGrammarNodeRuleAttributeName())),d=l.problemNodeFromSelection&&l.problemNodeFromSelection.getAttribute(e),o.call(l,a,b,c,d)};var p=l.getProblemNodeFromSelection;l.getProblemNodeFromSelection=function(){return l.problemNodeFromSelection=p.call(l),l.problemNodeFromSelection},l.isScaytNode=l.isSpellingNode,l.getScaytNodeAttributeName=l.getSpellingNodeAttributeName,l.getScaytLangList=l.getSpellingLangList,l.getGraytNodeAttributeName=l.getGrammarNodeAttributeName,l.getGraytNodeRuleAttributeName=l.getGrammarNodeRuleAttributeName,l.getGraytLangList=l.getGrammarLangList,l.getSelectionNode=l.getProblemNodeFromSelection,l.isGraytNode=l.isGrammarNode,l.isLicensed=function(){return!l.isBannerEnable()};var q=l.getApplicationConfig;l.getApplicationConfig=function(){var a,b=q.call(l),c={};for(var d in i)a=i[d],"undefined"!=typeof b[a]&&(c[d]=b[a]);return c};var r=l.commitOption;return l.commitOption=function(b){var c=b.changedOptions;c=a(c,i),b.changedOptions=c,r.call(l,b)},l._sandbox.getOption("basePath")&&(SCAYT.CKSCAYT.prototype.basePath=l._sandbox.getOption("basePath")),l},h={spellcheckLang:"lang",elementsToIgnore:"ignoreElements",contextMenuCommands:"actionItems",uiTabs:"settingsSections",enableGrayt:"enableGrammar",customerId:"serviceId"},i={scayt:e.getBaseData("scayt.js").path,customscayt:e.getBaseData("customscayt.js").path,ckscayt:e.getBaseData("ckscayt.js").path,tinymcescayt:e.getBaseData("tinymcescayt.js").path};SCAYT.SCAYT=function(a,d,e){a.basePath=i.scayt,c(a),a.contextMenuSections&&(a.contextMenuSections=a.contextMenuSections.replace(/\s/g,""),a.contextMenuSections=a.contextMenuSections.split("|")),a.contextMenuCommands&&(a.contextMenuCommands=a.contextMenuCommands.replace(/\s/g,""),a.contextMenuCommands=a.contextMenuCommands.replace(/toggleproofrayt/g,"toggle"),a.contextMenuCommands=a.contextMenuCommands.split("|"),a.contextMenuCommands.includes("problemdescription")===!1&&(a.disableProblemDescription=!0)),a.enableBadgeButton="undefined"==typeof a.enableBadgeButton?!1:a.enableBadgeButton,a.uiTabs&&(a.uiTabs=a.uiTabs.replace(/\s/g,""),a.uiTabs=a.uiTabs.split(",")),Array.isArray(a.disableOptionsStorage)&&(a.disableOptionsStorage=a.disableOptionsStorage.map(function(a){return f[a]||a})),a.ecVersion=1;var g=b(a,h,WEBSPELLCHECKER.init,d,e);return g},SCAYT.SCAYT.createScaytControl=function(a,b,c,d){return b.container=a,new SCAYT.SCAYT(b,c,d)},SCAYT.SCAYT.createScaytControlById=function(a,b,c,d){return b.container=a,new SCAYT.SCAYT(b,c,d)},SCAYT.SCAYT.getScaytControlById=WEBSPELLCHECKER.getControlById,SCAYT.prototype.instanceManager.getScaytControlById=SCAYT.prototype.instanceManager.getControlById,SCAYT.CUSTOMSCAYT=function(a,d,e){a=Object.assign({units:["ui"]},a),"suggest|moresuggest"===a.contextMenuSections&&(a.actionItems=[]),a.enableBadgeButton="undefined"==typeof a.enableBadgeButton?!1:a.enableBadgeButton,a.enableGrammar="undefined"==typeof a.enableGrammar?!1:a.enableGrammar,a.basePath=i.customscayt,a.data_attribute_name=a.data_attribute_name||"data-scayt-word",a.problem_grammar_data_attribute=a.problem_grammar_data_attribute||"data-grayt-phrase",a.appType="scayt_froala",SCAYT.CUSTOMSCAYT.prototype.basePath=a.basePath,c(a),a.contextMenuSections&&(a.contextMenuSections=a.contextMenuSections.replace(/\s/g,""),a.contextMenuSections=a.contextMenuSections.split("|")),a.contextMenuCommands&&(a.contextMenuCommands=a.contextMenuCommands.replace(/\s/g,""),a.contextMenuCommands=a.contextMenuCommands.split("|")),Array.isArray(a.disableOptionsStorage)&&(a.disableOptionsStorage=a.disableOptionsStorage.map(function(a){return f[a]||a}));var g=b(a,h,WEBSPELLCHECKER._createApp,d,e);return g},SCAYT.CKSCAYT=function(a,b,d){a.basePath=i.ckscayt,a.appType="scayt_ckeditor",a.graytAutoStartup="undefined"==typeof a.graytAutoStartup?!1:a.graytAutoStartup,c(a),SCAYT.CKSCAYT.prototype.basePath=a.basePath;var e=g(a,b,d),f=e.getLocal,h={label_allCaps:"label_ignoreAllCapsWords",label_mixedCase:"label_ignoreWordsWithMixedCases",label_mixedWithDigits:"label_ignoreWordsWithNumbers"};return e.getLocal=function(a){a=h[a]||a;var b="oldck_",c=f.call(e,b+a);return c===b+a&&(c=f.call(e,a)),c},e},SCAYT.CKSCAYT.prototype.basePath=i.ckscayt,SCAYT.TINYMCE=function(a,b,d){a.basePath=i.tinymcescayt,a.appType="scayt_tinymce",a.enableGrammar=!1,c(a),SCAYT.TINYMCE.prototype.basePath=a.basePath;var e=g(a,b,d);return e.getLangList=e.getSpellingLangList,e},function(){var a="data-scayt-",b="data-wsc-",e=WEBSPELLCHECKER.CORE.prototype.UILib,f=WEBSPELLCHECKER.CORE.prototype.Utils;e.domReady(function(){d();var g,j,k,l,m,n,o=e.find("*["+a+"autocreate]");g=c({basePath:i.scayt}),n=window.WEBSPELLCHECKER_CONFIG;for(var p=0;p<o.length;p++){j=o[p],k=f.HTMLCollectionToArray(j.attributes);for(var q=0;q<k.length;q+=1)if(l=k[q].name,l.includes(a)){m=j.getAttribute(l),j.removeAttribute(l),l=l.replace(a,b);for(var r in h)l.includes(r.toLowerCase())&&(l=l.replace(r.toLowerCase(),h[r]));j.setAttribute(l,m||"")}for(var s in g)!g.hasOwnProperty(s)||j.getAttribute(b+s)||n[s]||j.setAttribute(b+s,g[s])}})}(),window.scaytAlreadyLoaded&&window.scaytAlreadyLoaded(),e.inArray=function(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return!0;return!1},e.indexOf=function(a){function b(a){"use strict";if(null==this)throw new TypeError;var b,c,d=Object(this),e=d.length>>>0;if(0===e)return-1;if(b=0,arguments.length>1&&(b=Number(arguments[1]),b!=b?b=0:0!=b&&1/0!=b&&b!=-1/0&&(b=(b>0||-1)*Math.floor(Math.abs(b)))),b>=e)return-1;for(c=b>=0?b:Math.max(e-Math.abs(b),0);e>c;c++)if(c in d&&d[c]===a)return c;return-1}var c,d=Array.prototype.slice.apply(arguments);return d.shift(),c="[object Array]"!==Object.prototype.toString.call(a)||Array.prototype.indexOf?Array.prototype.indexOf.apply(a,d):b.apply(a,d)}}(),window.WEBSPELLCHECKER&&"function"==typeof window.WEBSPELLCHECKER.onload&&window.WEBSPELLCHECKER.onload(window.WEBSPELLCHECKER),window.WEBSPELLCHECKER=WEBSPELLCHECKER}(this);